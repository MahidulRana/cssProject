if (self.CavalryLogger) { CavalryLogger.start_js(["lds5Z"]); }

__d("SkywalkerWebClientTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:SkywalkerWebClientLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:SkywalkerWebClientLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:SkywalkerWebClientLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setClientSessionUuid=function(a){this.$1.client_session_uuid=a;return this};c.setClientTime=function(a){this.$1.client_time=a;return this};c.setEventName=function(a){this.$1.event_name=a;return this};c.setGateway=function(a){this.$1.gateway=a;return this};c.setMessage=function(a){this.$1.message=a;return this};c.setTopic=function(a){this.$1.topic=a;return this};return a}();c={client_session_uuid:!0,client_time:!0,event_name:!0,gateway:!0,message:!0,topic:!0};e.exports=a}),null);
__d("SkywalkerLogger",["BanzaiODS","FBLogger","LogHistory","SkywalkerWebClientTypedLogger","nullthrows","uuid"],(function(a,b,c,d,e,f){var g="skywalker_web_client",h=b("LogHistory").getInstance(g);a=function(){function a(a){a===void 0&&(a={}),this.$1=a,this.$1.client_session_uuid==null&&(this.$1.client_session_uuid=b("uuid")())}var c=a.prototype;c.log=function(a){a=this.$2(a);var c=b("nullthrows")(a.event_name);h.log(c,a);this.$3(a)};c.warn=function(a){a=this.$2(a);var c=b("nullthrows")(a.event_name);h.warn(c,a);b("FBLogger")(g).warn(c);this.$3(a)};c.error=function(a){a=this.$2(a);var c=b("nullthrows")(a.event_name);h.error(c,a);b("FBLogger")(g).mustfix(c);this.$3(a)};c.bump=function(a){b("BanzaiODS").bumpEntityKey(822,g,a)};c.$2=function(a){a=babelHelpers["extends"]({},this.$1,a);a.client_time==null&&(a.client_time=Date.now());return a};c.$3=function(a){var c=new(b("SkywalkerWebClientTypedLogger"))();c.updateData(a);c.log()};return a}();e.exports=a}),null);
__d("StreamStateMachine",["StreamStateMachineConstants"],(function(a,b,c,d,e,f){"use strict";var g=babelHelpers["extends"]({},b("StreamStateMachineConstants").events,{GQLS_STATE_TRANSIT_ON_REFRESH:"onRefresh"});a=function(){function a(a,b){a===void 0&&(a=!1),b===void 0&&(b=1e4),this.$1=b,this.$2=null,this.$3=null,this.$5=a,this.$4=null}var c=a.prototype;c.start=function(){this.$6(g.GQLS_STATE_TRANSIT_ON_CREATE),this.$5||this.$6(g.GQLS_STATE_TRANSIT_ON_ACTIVE)};c.ping=function(){switch(this.$4){case b("StreamStateMachineConstants").states.GQLS_STATE_ACTIVE:this.$6(g.GQLS_STATE_TRANSIT_ON_REFRESH);break;case b("StreamStateMachineConstants").states.GQLS_STATE_PAUSED:this.$6(g.GQLS_STATE_TRANSIT_ON_RESUME);break;case b("StreamStateMachineConstants").states.GQLS_STATE_CREATED:this.$6(g.GQLS_STATE_TRANSIT_ON_ACTIVE);break;case b("StreamStateMachineConstants").states.GQLS_STATE_TERMINATED:break}};c.kill=function(){this.$6(g.GQLS_STATE_TRANSIT_ON_TERMINATE)};c.setLifecycleHandler=function(a){this.$3=a};c.getState=function(){return this.$4};c.$6=function(a){switch(a){case g.GQLS_STATE_TRANSIT_ON_CREATE:this.$7();break;case g.GQLS_STATE_TRANSIT_ON_ACTIVE:this.$8();break;case g.GQLS_STATE_TRANSIT_ON_REFRESH:this.$9();break;case g.GQLS_STATE_TRANSIT_ON_PAUSE:this.$10();break;case g.GQLS_STATE_TRANSIT_ON_RESUME:this.$11();break;case g.GQLS_STATE_TRANSIT_ON_TERMINATE:this.$12();break}};c.$7=function(){this.$4=b("StreamStateMachineConstants").states.GQLS_STATE_CREATED,this.$3&&this.$3(b("StreamStateMachineConstants").events.GQLS_STATE_TRANSIT_ON_CREATE)};c.$8=function(){this.$4=b("StreamStateMachineConstants").states.GQLS_STATE_ACTIVE,this.$3&&this.$3(b("StreamStateMachineConstants").events.GQLS_STATE_TRANSIT_ON_ACTIVE),this.$13()};c.$9=function(){clearTimeout(this.$2),this.$13()};c.$10=function(){this.$4=b("StreamStateMachineConstants").states.GQLS_STATE_PAUSED,this.$3&&this.$3(b("StreamStateMachineConstants").events.GQLS_STATE_TRANSIT_ON_PAUSE)};c.$11=function(){this.$4=b("StreamStateMachineConstants").states.GQLS_STATE_ACTIVE,this.$3&&this.$3(b("StreamStateMachineConstants").events.GQLS_STATE_TRANSIT_ON_RESUME),this.$13()};c.$12=function(){clearTimeout(this.$2),this.$4=b("StreamStateMachineConstants").states.GQLS_STATE_TERMINATED};c.$13=function(){var a=this;this.$5&&(this.$2=setTimeout(function(){a.$6(b("StreamStateMachineConstants").events.GQLS_STATE_TRANSIT_ON_PAUSE)},this.$1))};return a}();e.exports=a}),null);
__d("MqttSkywalkerManager",["regeneratorRuntime","CurrentUser","FBMqttChannel","RTIFriendFanoutConfig","SkywalkerLogger","SkywalkerUtils","StreamStateMachine","gkx","promiseDone"],(function(a,b,c,d,e,f){var g="/pubsub",h={t:"pong"},i=function(){"use strict";function a(a,b,c,d){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=Date.now(),this.$8()}var c=a.prototype;c.unsubscribe=function(){return o.unsubscribe(this)};c.getViewId=function(){return this.$1};c.getTopic=function(){return this.$2};c.getMessageListener=function(){return this.$3};c.getSubscribeOptions=function(){return this.$4};c.getCreationTime=function(){return this.$5};c.getStreamStateMachine=function(){return this.$6};c.getFriendFanoutSubscription=function(){return this.$7};c.getContext=function(){return this.$4.context};c.setFriendFanoutSubscription=function(a){this.$7=a};c.$8=function(){if(!j())return;this.$6=new(b("StreamStateMachine"))(n(this.$4.context));this.$4.gqlsLifecycleHandler&&this.$6.setLifecycleHandler(this.$4.gqlsLifecycleHandler);this.$6.start()};return a}();a=function(){"use strict";function a(){var a=this;this.$1=new Map();this.$2=0;this.$3=new(b("SkywalkerLogger"))({gateway:"mqtt"});this.$4=b("FBMqttChannel");this.$5=this.$4.getConnectionState()==="Connected";this.$4.subscribeChannelEvents({onMQTTStateChanged:function(b){return a.$7(b)},onJSError:function(b){return a.$8(b)}});this.$4.subscribe(g,function(b){return a.$9(b)})}var c=a.prototype;c.subscribe=function(a,c,d){d===void 0&&(d={});d.context=b("SkywalkerUtils").patchContext(d.context);var e=this.$10(a,c,d),f=a.substr(0,a.lastIndexOf("/"));if(b("RTIFriendFanoutConfig").passFriendFanoutSubscribeGK&&b("RTIFriendFanoutConfig").topicPrefixes.indexOf(f)>=0){f=l(a);a={context:d.context};d=this.$10(f,c,a);e.setFriendFanoutSubscription(d)}return e};c.unsubscribe=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=this.$11(a);d=a.getFriendFanoutSubscription();if(!(d!=null)){e.next=5;break}e.next=5;return b("regeneratorRuntime").awrap(this.$11(d));case 5:e.next=7;return b("regeneratorRuntime").awrap(c);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},null,this)};c.isSubscribed=function(a){return this.$1.has(a.getViewId())};c.getSubscriptions=function(){return Array.from(this.$1.values())};c.setOnMqttError=function(a){this.$6=a};c.$9=function(a){a=this.$12(a);if(a==null)return;var b=a.topic,c=a.view_id,d=this.$1.get(c);if(d==null){var e="No subscription exists for this topic, view ID "+c;for(var f=this.$1.values(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;if(b===i.getTopic()){i=i.getViewId();e="Found subscription with view ID "+i+", payload has "+c;break}}this.$3.log({event_name:"missing_subscription",topic:b,message:e});return}if(!k(b,d.getTopic())){i="View ID matches subscription of topic "+d.getTopic();this.$3.error({event_name:"topic_view_id_mismatch",topic:b,message:i});return}this.$3.log({event_name:"payload_received",topic:b});if(j()&&m(a)){this.$3.log({event_name:"heartbeat_received",topic:b});h=d.getStreamStateMachine();h&&h.ping();return}d.getMessageListener()(a)};c.$10=function(a,c,d){var e=++this.$2;a=new i(e,a,c,d);this.$1.set(e,a);this.$4.getConnectionState()==="Connected"&&b("promiseDone")(this.$13(a));return a};c.$11=function(a){var c,d=this,e,f,g,i,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:e=a.getTopic();f=a.getViewId();this.$3.log({event_name:"unsubscribe_attempt",topic:e});this.$1["delete"](f);g=a.getSubscribeOptions();g.onUnsubscribeEager&&g.onUnsubscribeEager();i={unsub:[e],viewId:(c={},c[e]=f,c)};k=JSON.stringify(i);l.next=10;return b("regeneratorRuntime").awrap(this.$14(k).then(function(){d.$3.log({event_name:"unsubscribe_success",topic:e});return{data:h,error:null}},function(a){var b="unsubscribe_failure";a=a.toString()+", Payload:"+k;d.$3.log({event_name:b,topic:e,message:a});return{data:null,error:a}}).then(function(b){g.onUnsubscribe&&g.onUnsubscribe(b);if(j()){b=a.getStreamStateMachine();b&&b.kill()}}));case 10:return l.abrupt("return",l.sent);case 11:case"end":return l.stop()}},null,this)};c.$13=function(a){var c,d=this,e,f,g,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:e=a.getTopic();f=a.getViewId();g=a.getSubscribeOptions();i={sub:[e],viewId:(c={},c[e]=f,c)};g.context!=null&&(i.context=(j={},j[e]=g.context,j));this.$3.log({event_name:"subscribe_attempt",topic:e});k=JSON.stringify(i);l.next=9;return b("regeneratorRuntime").awrap(this.$14(k).then(function(){d.$3.log({event_name:"subscribe_success",topic:e});return{data:h,error:null}},function(a){var b="subscribe_failure";a=a.toString()+", Payload:"+k;d.$3.log({event_name:b,topic:e,message:a});return{data:null,error:a}}).then(function(a){return g.onSubscribe&&g.onSubscribe(a)}));case 9:return l.abrupt("return",l.sent);case 10:case"end":return l.stop()}},null,this)};c.$14=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$4.publish(g,a));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},null,this)};c.$12=function(a){try{a=JSON.parse(a);if(a.raw==null){this.$3.error({event_name:"payload_parse_error",message:"Missing Skywalker payload object"});return null}a=JSON.parse(a.raw);var b=["topic","payload","view_id"];for(var c=0;c<b.length;c++){var d=b[c];if(!Object.prototype.hasOwnProperty.call(a,d)){this.$3.error({event_name:"payload_parse_error",message:"Missing Skywalker "+d+" field in payload"});return null}}if(typeof a.topic!=="string"){this.$3.error({event_name:"payload_parse_error",message:"Topic has type "+typeof a.topic});return null}if(typeof a.view_id!=="number"){this.$3.error({event_name:"payload_parse_error",message:"Topic has type "+typeof a.view_id});return null}return a}catch(a){this.$3.error({event_name:"payload_parse_error",message:a.toString()});return null}};c.$7=function(a){if(a!=="Connected")return;this.$5=!0;for(var a=this.$1,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e[0];e=e[1];b("promiseDone")(this.$13(e))}};c.$8=function(a){var b=a!=null?JSON.stringify(a):null,c=a!=null&&typeof a.isRecoverable==="boolean"?a.isRecoverable:!1;c?this.$3.log({event_name:"transport_recoverable_error",message:b}):this.$3.log({event_name:"transport_error",message:b});this.$5||(this.$3.log({event_name:"fallback_error",message:b}),this.$6&&this.$6(a))};return a}();function j(){return b("gkx")("676931")}function k(a,b){return a===b||b===l(a)}function l(a){return a+"_user_id_"+b("CurrentUser").getID()}function m(a){try{a=JSON.parse(a.payload);return a!=null&&a.heartbeat!=null}catch(a){return!1}}function n(a){if(a==null||a.transformContext==null)return!1;try{a=JSON.parse(a.transformContext);if(a.serializedQueryParameters==null)return!1;a=JSON.parse(a.serializedQueryParameters);return a!=null&&a["%options"]!=null&&a["%options"].heartbeat!=null}catch(a){return!1}}var o=new a();e.exports=o}),null);