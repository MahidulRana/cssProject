if (self.CavalryLogger) { CavalryLogger.start_js(["Y5dRO"]); }

__d("FBRTCAppMessageDataAppCommandAction",[],(function(a,b,c,d,e,f){e.exports={PING:0,STREAM_DRY:1}}),null);
__d("FBRTCAppMessageDataAppCommandLayoutType",[],(function(a,b,c,d,e,f){e.exports={NONE:0,PICTURE_IN_PICTURE:1,SIDE_BY_SIDE:2,CUSTOM:3,DOMINANT:4}}),null);
__d("FBRTCEndpointServiceType",[],(function(a,b,c,d,e,f){e.exports={UNKNOWN:0,COMPOSITING_SERVICE:1}}),null);
__d("RTWebCallModelTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:RTWebCallModelLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setCallModelEvent=function(a){this.$1.call_model_event=a;return this};c.setFluxStores=function(a){this.$1.flux_stores=a;return this};c.setInfraCallModel=function(a){this.$1.infra_call_model=a;return this};c.setPublicCallModel=function(a){this.$1.public_call_model=a;return this};return a}();c={call_id:!0,call_model_event:!0,flux_stores:!0,infra_call_model:!0,public_call_model:!0};e.exports=a}),null);
__d("ZenonMWSendMessageMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"RtcWebSendMultiwaySignalingMessageResponsePayload",kind:"LinkedField",name:"rtc_web_send_multiway_signaling_message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"header",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ZenonMWSendMessageMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ZenonMWSendMessageMutation",selections:b},params:{id:"2430330443724069",metadata:{},name:"ZenonMWSendMessageMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("ZenonP2PSendMessageMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],kind:"ScalarField",name:"rtc_web_send_p2p_signaling_message",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ZenonP2PSendMessageMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ZenonP2PSendMessageMutation",selections:b},params:{id:"2599144283486119",metadata:{},name:"ZenonP2PSendMessageMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("FluxDebugUtils",["areEqual","flattenArray","getByPath"],(function(a,b,c,d,e,f){"use strict";var g;function h(a,c){return(g||(g=b("areEqual")))(a,c.slice(0,a.length))}function i(a){return Object.prototype.toString.call(a)==="[object Object]"}function j(a){return Object.keys(a).sort()}function k(a,b){return j(a).filter(function(a){return!(a in b)})}function l(a,b){return j(b).filter(function(b){return!(b in a)})}function m(a,b){return j(a).filter(function(a){return a in b})}function n(a,c){if(!i(a)||!i(c))return[];var d=l(a,c).map(function(a){var b;return{path:[],op:"add",value:(b={},b[a]=c[a],b)}}),e=k(a,c).map(function(a){return{path:[a],op:"delete"}}),f=[].concat(b("flattenArray")(m(a,c).map(function(d){if((g||(g=b("areEqual")))(a[d],c[d]))return[];return!i(a[d])||!i(c[d])?{path:[d],op:"update",oldValue:a[d],newValue:c[d]}:n(a[d],c[d]).map(function(a){return babelHelpers["extends"]({},a,{path:[d].concat(a.path)})})})));return[].concat(d,e,f)}var o={diff:n,diffStoreMutation:function(a){return a.prevState&&a.prevState.toJS?n(a.prevState.toJS(),a.currState.toJS()):n(a.prevState,a.currState)},diffStoreMutationInstance:function(a){return o.diffStoreMutation(a.mutation)},isOperationTouchingPath:function(a,c){if((g||(g=b("areEqual")))(a.path,c))return!0;if(h(a.path,c)){c=c.slice(a.path.length);a=a.value||a.newValue;return!!b("getByPath")(a,c)}return!1},getStoreStateFromStoreConfig:function(a){return a.store&&a.stateGetter?a.stateGetter():a.getState()},getStoreInstanceFromStoreConfig:function(a){return a.store||a},applyPlugins:function(a,b,c){b.forEach(function(d){return a[d.name]=function(){for(var a=arguments.length,e=new Array(a),f=0;f<a;f++)e[f]=arguments[f];var g=d.run.apply(d,[c()].concat(e));o.applyPlugins(g,b,function(){return g});return g}})}};e.exports=o}),null);
__d("ThriftTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,STRUCT:12,MAP:13,SET:14,LIST:15,FLOAT:19});e.exports=a}),null);
__d("TWriteBuffer",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(b){b===void 0&&(b=a.DEFAULT_BYTE_BUFFER_SIZE),this.$1=new DataView(new ArrayBuffer(b)),this.$2=0}var b=a.prototype;b.write=function(a){this.$2+a.length>this.$1.byteLength&&this.$3(this.$2+a.length);for(var b=0;b<a.length;b++)this.$1.setUint8(this.$2+b,a[b]);this.$2+=a.length;return a.length};b.writeByte=function(a){this.$2+1>this.$1.byteLength&&this.$3(this.$2+1);this.$1.setUint8(this.$2,a);this.$2++;return 1};b.writeFloatBE=function(a){this.$2+Float32Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float32Array.BYTES_PER_ELEMENT);this.$1.setFloat32(this.$2,a);this.$2+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$2+Float64Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float64Array.BYTES_PER_ELEMENT);this.$1.setFloat64(this.$2,a);this.$2+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){var a=new Uint8Array(this.$1.buffer,0,this.$2);return a};b.currentSize=function(){return this.$2};b.getUnderlyingDataView=function(){return this.$1};b.$3=function(a){a=a*2;if(!Number.isSafeInteger(a))throw new Error("unable to resize");a=new DataView(new ArrayBuffer(a));for(var b=0;b<this.$2;b++)a.setUint8(b,this.$1.getUint8(b));this.$1=a};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();a.DEFAULT_BYTE_BUFFER_SIZE=16;e.exports=a}),null);
__d("StringToUtf8",["TWriteBuffer"],(function(a,b,c,d,e,f){a=function(a){var c=new(b("TWriteBuffer"))(a.length),d;for(var e=0;e<a.length;e++){d=a.charCodeAt(e);if(d<128)c.writeByte(d);else if(d<2048)c.writeByte(d>>6|192),c.writeByte(d&63|128);else if((d&64512)==55296){if(e+1>=a.length)throw new Error("UTF-16 string is truncated: ["+d.toString(16)+"]");if((a.charCodeAt(e+1)&64512)!==56320)throw new Error("Invalid UTF-16 string: ["+d.toString(16)+", "+a.charCodeAt(e+1).toString(16)+"]");d=65536+((d&1023)<<10)+(a.charCodeAt(++e)&1023);c.writeByte(d>>18|240);c.writeByte(d>>12&63|128);c.writeByte(d>>6&63|128);c.writeByte(d&63|128)}else c.writeByte(d>>12|224),c.writeByte(d>>6&63|128),c.writeByte(d&63|128)}return c.toByteArray()};e.exports={StringToUtf8:a}}),null);
__d("Utf8ToString",[],(function(a,b,c,d,e,f){var g=function(a,b){throw new Error(a+": ["+b.map(function(a){return a.toString(16)}).toString()+"]")},h=function(a){g("Invalid UTF-8 sequence",a)},i=function(a,b){g("Not enough bytes for "+a+"-byte sequence",b)};a=function(a){var b=0,c=[];while(b<a.length){var d=a[b++];if(d<128)c.push(String.fromCharCode(d));else if(d>=128&&d<194)h([d]);else if(d>=194&&d<224){b>=a.length&&i(2,[d]);var e=a[b++];(e&192)!==128&&h([d,e]);c.push(String.fromCharCode((d&31)<<6|e&63))}else if(d>=240&&d<245){b+2>=a.length&&i(4,[d]);e=a[b++];var f=a[b++],g=a[b++];(d==240&&(!(e>=144&&e<192)||(f&192)!==128||(g&192)!==128)||d>=241&&d<244&&((e&192)!==128||(f&192)!==128||(g&192)!==128)||d==244&&(!(e>=128&&e<144)||(f&192)!==128||(g&192)!==128))&&h([d,e,f,g]);e=((d&7)<<18|(e&63)<<12|(f&63)<<6|g&63)-65536;c.push(String.fromCharCode(55296+(e>>10)));c.push(String.fromCharCode(56320+(e&1023)))}else if(d>=245)h([d]);else{b+1>=a.length&&i(3,[d]);f=a[b++];g=a[b++];d==224?f>=160&&f<192||h([d,f,g]):d>=225&&d<237?f>=128&&f<192||h([d,f,g]):d==237?f>=128&&f<160||h([d,f,g]):d>=238&&d<240&&(f>=128&&f<192||h([d,f,g]));g>=128&&g<192||h([d,f,g]);c.push(String.fromCharCode((d&15)<<12|(f&63)<<6|g&63))}}return c.join("")};e.exports={Utf8ToString:a}}),null);
__d("TNoOpWriteBuffer",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){this.$1=0}var b=a.prototype;b.write=function(a){this.$1+=a.length;return a.length};b.writeByte=function(a){this.$1++;return 1};b.writeFloatBE=function(a){this.$1+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$1+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){throw new Error("operation not supported")};b.currentSize=function(){return this.$1};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();e.exports=a}),null);
__d("TReadBuffer",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a){this.$1=a,this.$2=0}var b=a.prototype;b.readByte=function(){if(this.$2<this.$1.length)return this.$1[this.$2++];throw new Error("no available byte to read")};b.readBytes=function(a){if(a<0)throw new Error("cannot readBytes of negative length: "+a);if(a+this.$2>this.$1.length)throw new Error("not enough bytes to read");var b=new Uint8Array(this.$1.buffer,this.$3(),a);this.$2+=a;return b};b.readFloatBE=function(){if(Float32Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat32(this.$3());this.$2+=Float32Array.BYTES_PER_ELEMENT;return a};b.readDoubleBE=function(){if(Float64Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat64(this.$3());this.$2+=Float64Array.BYTES_PER_ELEMENT;return a};b.$3=function(){return this.$2+this.$1.byteOffset};b.getCurrentCursor=function(){return this.$2};b.writeByte=function(a){throw new Error("operation not supported")};b.write=function(a){throw new Error("operation not supported")};b.toByteArray=function(){throw new Error("operation not supported")};b.writeFloatBE=function(a){throw new Error("operation not supported")};b.writeDoubleBE=function(a){throw new Error("operation not supported")};return a}();e.exports=a}),null);
__d("RTCChromeScreenSharingUtils",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";function a(){return b("CurrentUser").isWorkUser()?"workplace":"rtc_call"}e.exports={getMediaRequestSourceAppId:a}}),null);
__d("ScotchFBRTCUtils",["AsyncRequest","FBIDCheck","FBRTCConfig","RTCConfig","ScotchRTWebUserActionLogger","assignMediaStream","emptyFunction"],(function(a,b,c,d,e,f){var g=6e3,h="setSinkId"in window.HTMLMediaElement.prototype;a={attachMediaStream:function(a,c){if(a==null)return;b("assignMediaStream")(a,c);if(c){c=a.play();c!==void 0&&c["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"autoplay was prevented",errorType:a.toString()})})}},aboutEqual:function(a,b){return a-b<.01&&b-a<.01},sendServerRequest:function(a,c,d,e,f,h){c===void 0&&(c=b("emptyFunction"));d===void 0&&(d=b("emptyFunction"));e===void 0&&(e=!1);f===void 0&&(f=g);h===void 0&&(h={});a=new(b("AsyncRequest"))().setURI(a).setData(h).setAllowCrossPageTransition(!0).setHandler(c).setErrorHandler(d).setTimeoutHandler(f,function(){d()});e&&a.setOption("asynchronous_DEPRECATED",!1);a.send()},supportsSetSink:function(){return h},isPeerVCEndpoint:function(a){var c=b("FBRTCConfig").isVCEndpointCall();return c!==void 0?c:!!a&&!b("FBIDCheck").isUser_deprecated(a)&&b("RTCConfig").CollabVCEndpointsVideoCallGK},isCollabTrigger:function(a){return a==="quickdial"||a==="meeting_room_page_profile"}};e.exports=a}),null);
__d("ScotchFBRTCAdminMessage",["FBRTCCallConstants","FBRTCConstants","FBRTCLogger","ScotchFBRTCUtils","ScotchRTWebUserActionLogger","XVideoCallAdminMessageController","emptyFunction","performanceNow"],(function(a,b,c,d,e,f){var g;a=function(){"use strict";function a(a,b){this.$1=a,this.$2=b,this.$3=Date.now(),this.$4=null,this.$5=null}var c=a.prototype;c.getPeerID=function(){return this.$1};c.getCallID=function(){return this.$2};c.getStartTimestamp=function(){return this.$3};c.getConnectedTime=function(){return this.$4};c.getEndTime=function(){return this.$5};c.onCallConnected=function(){this.$4||(this.$4=(g||(g=b("performanceNow")))())};c.onCallEnded=function(){this.$5||(this.$5=(g||(g=b("performanceNow")))())};c.submit=function(a,c,d){this.$5||this.onCallEnded();var e=0,f=b("FBRTCCallConstants").FBRTCCallConnectionType.MISSED_CALL;this.$4&&this.$5&&(e=Math.ceil(this.$5-this.$4),f=b("FBRTCCallConstants").FBRTCCallConnectionType.CONNECTED_CALL);c=f===b("FBRTCCallConstants").FBRTCCallConnectionType.CONNECTED_CALL||c===b("FBRTCConstants").CallEndReason.IGNORE_CALL;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"admin_message_"+f});this.$6({peer_id:this.$1,call_id:this.$2,start_time:this.$3,call_duration:e,message_type:f,call_category:a,call_acknowledged:c,conference_name:d})};c.$6=function(a){var c=b("XVideoCallAdminMessageController").getURIBuilder().getURI();b("ScotchFBRTCUtils").sendServerRequest(c,b("emptyFunction"),this.$7.bind(this,a.peer_id,a.call_id),!1,void 0,a)};c.$7=function(a,c,d){d?d="Fail to log admin message, error "+d.error:d="Server timed out on logging admin message";b("FBRTCLogger").getInstance().logError(a,c,d)};return a}();e.exports=a}),null);
__d("ScotchFBRTCIceCache",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){this.$1=new Map()}var b=a.prototype;b.getCache=function(){var a={};for(var b=this.$1,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];a[f]={};for(var e=e,g=Array.isArray(e),h=0,e=g?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=e.length)break;i=e[h++]}else{h=e.next();if(h.done)break;i=h.value}i=i;var j=i[0];i=i[1];a[f][j]=i}}return a};b.reset=function(a,b){var c=this.$1.get(a);c||(c=new Map(),this.$1.set(a,c));c.set(b,[])};b.cacheCandidate=function(a,b,c){var d=this.$1.get(a);d||(d=new Map(),this.$1.set(a,d));a=d.get(b);a||(a=[],d.set(b,a));a.unshift(c)};b.drainCandidates=function(a,b,c){a=this.$1.get(a);if(a){a=a.get(b)||[];while(a.length>0){b=a.pop();c(b)}}};return a}();e.exports=a}),null);
__d("ScotchRTWebExperiments",["FBRTCConfig","ScotchRTWebUserActionLogger","gkx","qex"],(function(a,b,c,d,e,f){"use strict";a={enableCallCollisionFix:function(){var a;return b("FBRTCConfig").isVCEndpointCall()?!1:(a=b("qex")._("771668"))!=null?a:!1},passOfferWithWindowMessages:function(){var a;return b("FBRTCConfig").isVCEndpointCall()?!1:(a=b("qex")._("771669"))!=null?a:!1},shouldUseZenonMediaStatsParser:function(){var a;a=(a=b("qex")._("901545"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_zenon_stats_parser"});return a},shouldUseZenonStarRating:function(){var a;a=(a=b("qex")._("903503"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: new_star_rating_container"});return a},shouldUseZenonHeaderContainer:function(){var a;a=(a=b("qex")._("946845"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_zenon_header_container"});return a},shouldUseZenonSignaling:function(){var a;a=(a=b("qex")._("907889"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: refactor_listener"});return a},shouldUseZenonCallStatus:function(){var a;a=(a=b("qex")._("944477"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: new_call_status"});return a},getNumSimulcastLayers:function(){var a;return(a=b("qex")._("1574288"))!=null?a:1},shouldUseUnifiedPlan:function(){var a=b("gkx")("1429707");a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_sdp_interop"});return a},shouldUseMWUnifiedPlanSDP:function(){var a;a=(a=b("qex")._("1146131"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_unified_plan"});return a},shouldUseP2PUnifiedPlanSDP:function(){var a;a=(a=b("qex")._("1162655"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_www_scotch, param: use_p2p_unified_plan"});return a},shouldUseSingleMediaStream:function(){return b("gkx")("1369511")||b("gkx")("1428146")},shouldSubscribeToSimpleTopicOnJoin:function(){var a;a=(a=b("qex")._("1447474"))!=null?a:!1;a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({checkpoint:"QE universe: rtc_state_sync_test, param: subscribe_simple_on_join"});return a}};e.exports=a}),null);
__d("ScotchRTWebClientFeatureGating",["CurrentUser","FBRTCConfig","FBRTCExperiment","FBRTCSupport","ScotchRTWebExperiments","gkx"],(function(a,b,c,d,e,f){"use strict";a={isVCCallOrWorkUser:function(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()},addScreenContentTypeInSDP:function(){return!1},draggableSelfView:function(){return b("FBRTCExperiment").gen("rtc_www_larger_self_view").getBool("draggable_self_view",!1)},endCallSurveyDropdownOptions:function(){return!this.isVCCallOrWorkUser()},canUseMWVideoFilters:function(){return!b("CurrentUser").isWorkUser()&&b("FBRTCSupport").isVideoFilterEffectSupported()},isChatEnabled:function(){return!b("FBRTCConfig").isVCEndpointCall()},isGroupChatEnabled:function(){return!1},useNewIncomingCallDialog:function(){return b("FBRTCExperiment").getIncomingCallExperiments().getBool("use_new_incoming_call_dialog",!1)},answerCallWithThreeButtons:function(){return b("FBRTCExperiment").getIncomingCallExperiments().getBool("use_three_buttons",!1)},callUnification:function(){return b("FBRTCExperiment").gen("rtc_www_call_unification").getBool("in_call_background_updated",!1)},waitForMediaPermission:function(){return!1},canUseMultiwaySandbox:function(){return b("gkx")("678350")},stopVideoWhenMute:function(){if(b("FBRTCConfig").isVCEndpointCall())return!1;var a=b("FBRTCExperiment").gen("turnoff_camera_when_facemute");return a.getBool("camera_off",!1)},restartVideoWithTrackAPI:function(){var a=b("FBRTCExperiment").gen("turnoff_camera_when_facemute");return a.getBool("track_api",!1)},shouldAlwaysShowRedial:function(){return!this.isVCCallOrWorkUser()},disableOpusStereo:function(){return b("gkx")("678351")},shouldApplySdpMidTranslation:function(){return b("gkx")("700608")||b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP()},preserveFirefoxInactiveDataChannelBlock:function(){return b("gkx")("724606")},showMojavePermissionsWarning:function(){return navigator.userAgent.indexOf("Intel Mac OS X 10_14")!==-1},alwaysOpenChatTab:function(){return b("FBRTCExperiment").gen("rt_web_fb_profile_rtc_buttons").getBool("open_chat_tab",!1)},shouldShowNetworkQualityIndicator:function(){return this.isVCCallOrWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("show_network_indicator",!1)},shouldMonitorNetworkQuality:function(){return this.isVCCallOrWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("monitor_network_quality",!1)},preferIsacForGroupCalls:function(){return!b("FBRTCConfig").isVCEndpointCall()}};e.exports=a}),null);
__d("ScotchFBRTCSdpUtils",["FBLogger","ScotchRTWebClientFeatureGating","UserAgent"],(function(a,b,c,d,e,f){var g="a=x-fb-feature:",h="\r\n",i="m=video 0";f=["audio","video"].map(function(a){return new RegExp("m="+a+"\\s+\\d+\\s+(\\w+\\/?)+(\\s+\\d+)+")});var j=f[0],k=f[1],l=["http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01","http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time","urn:3gpp:video-orientation","urn:ietf:params:rtp-hdrext:ssrc-audio-level","urn:ietf:params:rtp-hdrext:toffset"],m=function(a){return a.match(/^a=rtpmap:(\d+)\s/)[1]},n=function(a,b,c){var d=m(a[b]);o(a,c,[d]);a.splice(b,1)},o=function(a,b,c){var d=a[b].split("RTP/SAVPF"),e=d[1].split(/\s+/);for(var f=0;f<c.length;f++){var g=e.indexOf(c[f]);g>=0&&e.splice(g,1)}d[1]=e.join(" ");a[b]=d.join("RTP/SAVPF")},p=function(a,b,c){var d=m(a[b]);n(a,b,c);var e=new RegExp("^a=(rtcp-fb|fmtp):"+d+" ");a=a.filter(function(a,b){return!(e.test(a)&&b>=c)});var f=new RegExp("^a=fmtp:(\\d+)\\s+apt="+d+"($|;)");b=a.reduce(function(a,b,c){c=b.match(f);return c?[].concat(a,[c[1]]):a},[]);d=b.join("|");o(a,c,b);var g=new RegExp("^a=rtpmap:("+d+")\\s+rtx/|^a=fmtp:("+d+")\\s+apt=");return a.filter(function(a){return!g.test(a)})};f={RX_SDP_MEDIA_AUDIO:j,RX_SDP_MEDIA_VIDEO:k,replaceRTPSAVPFProfile:function(a){var b="UDP/TLS/RTP/SAVPF",c="RTP/SAVPF";while(a.indexOf(b)>=0)a=a.replace(b,c);return a},addIceOptionToSdp:function(a,b){"use strict";var c="a=ice-options:",d=a.indexOf(c);if(d>=0)return a.split(h).map(function(a){return a.startsWith(c)?a+" "+b:a}).join(h);d=c+b;var e=a.split(h),f=!1,g=-1;for(var i=0;i<e.length;i++){var j=e[i].slice(0,2);if(j=="s="){f=!0;continue}if(f&&j=="a="){g=i;break}}if(g>=0){e.splice(g,0,d);return e.join(h)}return[a,d,h].join("")},preferIsac:function(a){a=a.split(h);var b=-1,c=-1,d=-1;for(var e=0;e<a.length;e++){var f=a[e];f.match(j)&&(b=e);d===-1&&b>-1&&f.match(/^a=rtpmap:/)&&(d=e);f.match(/^a=rtpmap:\d+\s+ISAC\/16000/)&&(c=e)}if(b===-1||c===-1||d===-1||a[b].indexOf("RTP/SAVPF")===-1)return a.join(h);f=a[c];n(a,c,b);a.splice(d,0,f);a[b]=a[b].replace("RTP/SAVPF","RTP/SAVPF "+m(f));return a.join(h)},preferCodec:function(a,b,c){a=a.split(h);var d=c?k:j,e=a.findIndex(function(a){return d.test(a)});if(e!==-1&&a[e].indexOf("RTP/SAVPF")!==-1){var f=new RegExp("^a=rtpmap:\\d+\\s+"+b);c=a.findIndex(function(a){return f.test(a)});var g=/^a=rtpmap:/;b=a.findIndex(function(a,b){return b>e&&g.test(a)});if(c!==-1&&b!==-1){var i=a[c];n(a,c,e);a.splice(b,0,i);a[e]=a[e].replace("RTP/SAVPF","RTP/SAVPF "+m(i))}}return a.join(h)},disableVideo:function(a){var c=/m=video\s+\S+/;a=a.replace(c,i);b("UserAgent").isBrowser("Firefox <= 37")&&(a=this._makeDisabledVideoReceiveOnly(a));return a},_makeDisabledVideoReceiveOnly:function(a){if(a.indexOf(i)>-1){var b=a.split(i);b[1]=b[1].replace(/send(recv|only)/,"recvonly");a=b.join(i)}return a},fixMobileIceSdp:function(a){a=a.replace(/^a=/,"");a=a.split(/\s+username\s+.+password.+/)[0];var b=a.match(/\s+relay\s+|\s+srflx\s+/),c=a.match(/raddr.+rport.+/);if(b&&!c){b=b[0];c=a.split(b);var d=c[1].match(/^(\d+\.\d+\.\d+\.\d+)\s+(\d+)\s+/),e,f;d?(e=d[1],f=d[2],c[1]=c[1].replace(d[0],"")):(d=c[0].split(/\s+/),e=d[4],f=d[5]);a=""+c[0]+b+"raddr "+e+" rport "+f+" "+c[1]}return a},addAudioNack:function(a){var b=this,c=[];a=a.split(h).map(function(a){var d="";c.length>0&&(/^a=rtpmap:(\d+)/.test(a)||/^a=ssrc/.test(a)||/^m=/.test(a))&&(d+=b._getrtcpFeedbackLinesFromAudioFMTs(c)+h,c=[]);/^m=audio/.test(a)&&(c=a.match(/^m=audio\s+[\d\/]+\s+[\w\/]+([\s+\d+]+)/)[1].trim().split(" "));return d+a}).join(h);c.length>0&&(a+=h+this._getrtcpFeedbackLinesFromAudioFMTs(c));return a},addSetup:function(a){if(a.indexOf("a=setup:")>=0)return a;a=a.split(h);var b=a.findIndex(function(a){return a.startsWith("s=")}),c=a.findIndex(function(a,c){return c>b&&a.startsWith("a=")});a.splice(c,0,"a=setup:actpass");return a.join(h)},_replaceFmtp:function(a,b,c,d){a=a==b?[]:a.substr(b.length).split(";");var e=a.findIndex(function(a){return a.startsWith(c+"=")});d=c+"="+d;e<0?a.push(d):a[e]=d;return""+b+a.join(";")},_addFmtpToMediaSection:function(a,b,c,d){var e=new RegExp("^a=rtpmap:(\\d+)\\s"+b);b=a.findIndex(function(a){return a.match(e)});if(b<0)return a;var f=a[b].match(e);f=f[1];var g="a=fmtp:"+f+" ";f=a.findIndex(function(a){return a.startsWith(g)});f===-1&&(f=b+1,a.splice(f,0,g));a[f]=this._replaceFmtp(a[f],g,c,d);return a},addFmtp:function(a,b,c,d){a=a.split(h);var e=-1;for(var f=0;f<=a.length;f++)if(f===a.length||a[f].startsWith("m=")){if(e!==-1){var g=a.splice(e,f-e);g=this._addFmtpToMediaSection(g,b,c,d);a.splice.apply(a,[e,0].concat(g));f=e+1+g.length}e=f}return a.join(h)},_getrtcpFeedbackLinesFromAudioFMTs:function(a){return a.map(function(a){return"a=rtcp-fb:"+a+" nack"}).join(h)},_removeCodec:function(a,b){a=a;var c=new RegExp("^a=rtpmap:\\d+\\s+"+b+"\\/"),d=new RegExp("^m=video");do{b=a.split(h);var e=b.findIndex(function(a){return c.test(a)}),f=b.findIndex(function(a){return d.test(a)});if(e==-1||f==-1)break;a=p(b,e,f).join(h)}while(!0);return a},removeRED:function(a){return this._removeCodec(a,"red")},removeH264:function(a){return this._removeCodec(a,"H264")},removeVP9:function(a){return this._removeCodec(a,"VP9")},removeUnknownRtpHeaderExtensions:function(a,b){b===void 0&&(b=null);var c=b==null?l:l.concat(b);b=a.split(h);b=b.filter(function(a){return!a.match(/^a=extmap:/)||c.some(function(b){return a.includes(b)})});return b.join(h)},isVideoSupported:function(a){return!!a&&a.indexOf("m=video")!==-1&&a.indexOf(i)===-1},setDtlsRole:function(a,b){if(!a.match(/setup:(active|passive|actpass)/))return a.replace(/(a=fingerprint:.+)/g,"$1"+h+"a=setup:"+b);else return a.replace(/setup:actpass/g,"setup:"+b)},setVideoBitrateConstraint:function(a){var c=b("UserAgent").isBrowser("Firefox"),d=c?"TIAS":"AS";c=c?72e4:720;var e=new RegExp("^b="+d+":","m");if(a.match(e))return a;a=a.replace(/^a=mid:video\r\n/m,"a=mid:video"+h+"b="+d+":"+c+h);return a},removeSdparta:function(a){if(b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return a;a=a.split(h);var c="audio",d=!1,e=-1;for(var f=0;f<a.length;f++){var g=a[f];g.indexOf("m=audio")===0&&(c="audio");g.indexOf("m=video")===0&&(d=!0,c="video");g.indexOf("a=mid:sdparta_")===0&&(a[f]="a=mid:"+c);g.indexOf("a=group:BUNDLE sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio video sdparta_")===0&&b("FBLogger")("rtc_www").mustfix("content_name rewriting will not work anymore, fix sdparta_# in Firefox.")}e>-1&&(d?a[e]="a=group:BUNDLE audio video":a[e]="a=group:BUNDLE audio");return a.join(h)},constructMidMap:function(a){if(!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return{remoteSdpMap:null,localSdpMap:null};a=a.split(h);var c={},d={},e=null;a.forEach(function(b){b.startsWith("m=audio")?e="audio":b.startsWith("m=video")?e="video":b.startsWith("m=")?e=null:b.startsWith("a=mid:")&&e&&(a=b.split("a=mid:")[1],a!==e&&(c[a]=e,d[e]||(d[e]=a)))});return{localSdpMap:Object.keys(c).length?c:null,remoteSdpMap:Object.keys(d).length?d:null}},constructMidMapFromRemoteOffer:function(a){if(!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return{remoteSdpMap:null,localSdpMap:null};a=a.split(h);var c={},d={};a.forEach(function(a){a.startsWith("m=audio")?(c["0"]="audio",d.audio="0"):a.startsWith("m=video")&&(c["1"]="video",d.video="1")});return{localSdpMap:Object.keys(c).length?c:null,remoteSdpMap:Object.keys(d).length?d:null}},transformSdpMids:function(a,c){if(c==null||!b("ScotchRTWebClientFeatureGating").shouldApplySdpMidTranslation())return a;var d=c,e=a.split(h);c=-1;e.forEach(function(b,f){if(b.startsWith("a=group:BUNDLE"))c=f;else if(b.startsWith("a=mid:")){a=b.split("a=mid:")[1];b=d[a]||a;e[f]="a=mid:"+b}});if(c>-1){var f=e[c].split("a=group:BUNDLE ")[1].split(" ");f=f.map(function(a){return d[a]||a});e[c]="a=group:BUNDLE "+f.join(" ")}return e.join(h)},useDTLSOverCrypto:function(a){if(!(b("UserAgent").isBrowser("Chrome >= 57")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera >= 44")))return a;return!/^a=fingerprint:/m.test(a)?a:a.split(h).filter(function(a){return a.indexOf("a=crypto:")!==0}).join(h)},validateOfferSdp:function(a,b){if(a.split(":")[0]==="LIVE"){a=/^m=/;var c=/^m=audio/,d=/^m=video/,e=/^a=ssrc:/;b=b.split(h);var f=[];for(var g=b.length-1;g>=0;g--)a.test(b[g])&&f.push(b.splice(g));var i=!1,j=!1;f.forEach(function(a){c.test(a[0])&&!i?i=a.some(function(a){return e.test(a)}):d.test(a[0])&&!j&&(j=a.some(function(a){return e.test(a)}))});return i&&j}return!0},_removeCodecID:function(a,b){var c=a.findIndex(function(a){a=a.match(/^a=rtpmap:(\S+)\s/);return a&&a[1]===b?!0:!1}),d=a.findIndex(function(a){return/^m=video/.test(a)});return c===-1||d===-1?a:p(a,c,d)},_getAllCodecIds:function(a,b){var c=a.findIndex(function(a){return/^m=video/.test(a)});if(c===-1)return[];var d=new RegExp("^a=rtpmap:\\S+\\s+"+b+"\\/"),e=[];a.forEach(function(b,f){if(d.test(b)){b=m(a[f]);a[c].indexOf(b)>0&&e.push(b)}});return e},_getCodecIDMatchingH264Profile:function(a,b){var c=b.levelAsymmetryAllowed?"1":"0",d=b.packetizationMode?"1":"0";c=new RegExp("^a=fmtp:(\\S+)\\s+level-asymmetry-allowed="+c+";packetization-mode="+d+";profile-level-id="+b.profileLevelId);for(var d=0;d<a.length;d++){b=a[d].match(c);if(b)return b[1]}return null},pickSpecificH264ProfileIfExists:function(a,b){var c=this,d=a.split(h),e=this._getCodecIDMatchingH264Profile(d,b);if(!e)return a;b=this._getAllCodecIds(d,"H264");return b.reduce(function(a,b){return b!==e?c._removeCodecID(a,b):a},d).join(h)},promoteSpecificH264ProfileIfExists:function(a,b){var c=a.split(h);b=this._getCodecIDMatchingH264Profile(c,b);if(!b)return a;var d=k,e=c.findIndex(function(a){return d.test(a)});if(e!==-1&&c[e].indexOf("RTP/SAVPF")!==-1){a="H264";var f=new RegExp("^a=rtpmap:"+b+"\\s+"+a);b=c.findIndex(function(a){return f.test(a)});var g=/^a=rtpmap:/;a=c.findIndex(function(a,b){return b>e&&g.test(a)});if(b!==-1&&a!==-1){a=c[b];o(c,e,[m(a)]);c[e]=c[e].replace("RTP/SAVPF","RTP/SAVPF "+m(a))}}return c.join(h)},clearFirefoxInactiveDataChannelBlock:function(a){if(!b("UserAgent").isBrowser("Firefox")||b("ScotchRTWebClientFeatureGating").preserveFirefoxInactiveDataChannelBlock())return a;var c=a.split(h),d=c.findIndex(function(a){return a.startsWith("m=application")});if(d===-1)return a;var e=c.slice(d),f=e.findIndex(function(a,b){return b>0&&a.startsWith("m=")});f!==-1&&(e=e.slice(0,f));if(e[0]!=null&&e[0].endsWith("0")&&e.some(function(a){return a.startsWith("a=inactive")})){f=e.findIndex(function(a){return a.startsWith("c=")});return[].concat(c.slice(0,d+1+(f!==-1?f:0)),c.slice(d+e.length),[""]).join(h)}return a},maybeAddPtimeForOpusOnly:function(a,b){var c=a.split(h),d=c.findIndex(function(a){return a.startsWith("m=audio")});if(d<0)return a;var e=!1,f=!1,g=!1;for(var d=d+1;d<c.length;d++){var i=c[d];if(i.startsWith("m="))break;i.startsWith("a=rtpmap")?i.includes("opus")?e=!0:f=!0:i.startsWith("a=ptime")&&(g=!0)}if(!e||f||g)return a;c.splice(d,0,"a=ptime:"+b);return c.join(h)},toLoggingString:function(a){var b=[" IP4 "," IP6 "],c=a.split(h);c.forEach(function(a,d){a.startsWith("a=crypto:")?c[d]="a=crypto:**-----**":a.startsWith("a=candidate:")?c[d]="a=candidate:**-----**":b.forEach(function(b){var e=a.indexOf(b);e!==-1&&(c[d]=a.slice(0,e+b.length)+"**-----**")})});return c.join(h)},addFBFeatures:a,getFBFeatures:c,addSSRCContentType:d};function a(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(c.length<1)return a;var e=q(a),f=e[0],i=e[1],j=f.split(h),k=r(j),l=j.filter(function(a){return!a.startsWith(g)}),m=1+l.map(function(a){return a?a.substr(0,2):""}).lastIndexOf("a=")||l.length;return[].concat(l.slice(0),s([].concat(k,c)).map(function(a){return""+g+a}),l.slice(m),[i?[i.trim(),""].join(h):""]).join(h)}function c(a){a=q(a);a=a[0];return r(a.split(h))}function q(a){if(!a)return["",""];var b=a.trim().split(h),c=0;while(c<b.length){if(b[c].startsWith("m="))break;c++}return c===b.length?[a.trim(),""]:[b.slice(0,c).join(h).trim(),b.slice(c).join(h).trim()]}function r(a){return s(a.filter(function(a){return a.startsWith(g)}).map(function(a){return a.substr(g.length)}))}function s(a){var b=Object.create(null);for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e&&(b[e]=!0)}return Object.keys(b).sort()}function d(a,b){var c=a.split(h);b.forEach(function(a,b){var d=new RegExp("^a=ssrc:\\d+ label:"+b);b=c.findIndex(function(a){return d.test(a)});if(b!==-1){var e=c[b].trim().split(" ")[0];if(/^a=ssrc:\d+$/.test(e)){e=e+" x-fb-content:"+a;c.splice(b+1,0,e)}}});return c.join(h)}e.exports=f}),null);
__d("ZenonSimulcastExperiments",["ScotchRTWebExperiments","UserAgent","ZenonPlatformExperiments","ZenonVideoConstraintUtils","qex"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonVideoConstraintUtils").createConstraints;function h(){var a;a=(a=b("qex")._("1420551"))!=null?a:!1;return a}function i(){var a;return(a=b("qex")._("1599317"))!=null?a:!1}function a(){var a;return(a=b("qex")._("1606177"))!=null?a:!1}function c(a){if(!a)return!1;if(b("ZenonPlatformExperiments").isZenonPlatform())return j();else return k()}function j(){return l()&&i()&&h()}function k(){return l()&&!m()&&h()}function l(){return b("UserAgent").isBrowser("Chrome >= 69")}function m(){return b("ScotchRTWebExperiments").shouldUseUnifiedPlan()}function d(){var a=b("qex")._("1577194"),c=b("qex")._("1577195"),d=b("qex")._("1577196");return g(a,c,d)}function f(){var a;return(a=b("qex")._("1574288"))!=null?a:1}e.exports={allowH264Simulcast:a,getNumLayers:f,getSimulcastVideoConstraintsFromQe:d,isCurrentBrowserCompatibleWithSimulcast:l,shouldUsePlanBChromeSimulcast:h,shouldUseSimulcast:c}}),null);
__d("ScotchRTCSignalingExperiments",["CurrentUser","FBRTCConfig","FBRTCExperiment","ZenonSimulcastExperiments","gkx","qex"],(function(a,b,c,d,e,f){"use strict";a={shouldCapMWBitrate:function(){return b("FBRTCExperiment").gen("rtc_www_mw_video_quality").getBool("cap_bitrate",!1)},shouldCapAudioBitrate:function(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("use_audio_bitrate_cap",!1)},shouldPreferIsac:function(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!0:b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_isac",!0)},shouldPreferOpus:function(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_opus",!1)},shouldPreferOpusMultiway:function(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_opus_mws",!1)},shouldPreferVp9:function(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_vp9",!1)},shouldPreferVp9Multiway:function(){return b("FBRTCExperiment").getMediaQualityExperiments().getBool("prefer_vp9_mws",!1)},shouldPreferH264Multiway:function(){var a;a=(a=b("qex")._("1453831"))!=null?a:!1;return a&&b("ZenonSimulcastExperiments").shouldUseSimulcast(!0)?b("ZenonSimulcastExperiments").allowH264Simulcast():a},shouldPreferHWH264Multiway:function(){var a;return(a=b("qex")._("1606697"))!=null?a:!1},shouldEnableAudioNack:function(){return b("FBRTCConfig").isVCEndpointCall()||b("CurrentUser").isWorkUser()?!1:b("FBRTCExperiment").getMediaQualityExperiments().getBool("enable_audio_nack",!1)},shouldEnablePlayoutDelayRtpHeaderExtensionForMw:function(){var a;return(a=b("qex")._("1390078"))!=null?a:!1},shouldAllowContentTypeRtpHeaderExtensionForMw:function(){return b("qex")._("1595537")===1},isOpusPtimeMungeEnabled:function(){var a;return(a=b("qex")._("1426589"))!=null?a:!0},getOpusPtimeMungeValue:function(){var a;return(a=b("qex")._("1426590"))!=null?a:60},shouldP2PPreserveH264:function(){var a;return(a=b("qex")._("1407741"))!=null?a:!1},shouldMungeUseDtxForOpus:function(){var a;return(a=b("qex")._("1435732"))!=null?a:!1},mungeMinParticipantsForEnablingDtx:function(){var a;return(a=b("qex")._("1441388"))!=null?a:Infinity},enableSDPRenegotiation:function(){var a;return(a=b("gkx")("1484828"))!=null?a:!0}};e.exports=a}),null);
__d("ScotchFBRTCMessage",["FBRTCConstants","FBRTCExperiment","FBRTCSupport","ScotchFBRTCSdpUtils","ScotchRTCSignalingExperiments"],(function(a,b,c,d,e,f){var g="mobile";a=function(){"use strict";function a(a){var b;if(!this.$1(a))throw new Error("invalid webrtc message");this.originalMessageData=a;this.peerID=a.from;this.selfID=(b=a.to)!=null?b:null;this.callID=parseInt(a.call_id,10);this.msg=JSON.parse(a.payload);this.msg.json_payload&&(this.escalationName=this.msg.sessionName,this.msg=this.msg.json_payload);this.msgType=this.msg.type;this.msgID=this.msg.msg_id;this.ackID=this.msg.ack_id;this.source=a.source;this.peerSupportsVideoInterop=!!this.msg.supports_video_interop;this.$2();this.$3();this.$4();this.$5()}var c=a.prototype;c.$1=function(a){return a.from&&a.call_id&&a.payload};c.$2=function(){if(this.peerSupportsVideoInterop)return;this.isFromMobile()&&this.disableVideo()};c.disableVideo=function(){this.msg.sdp&&(this.msg.sdp=b("ScotchFBRTCSdpUtils").disableVideo(this.msg.sdp)),(this.msgType===b("FBRTCConstants").PayloadType.SET_VIDEO||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ANSWER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_ANSWER)&&(this.msg.videoon=!1)};c.$3=function(){this.isFromMobile()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE&&(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeRED(this.msg.sdp))};c.$4=function(){if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264();a||(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeH264(this.msg.sdp))}};c.$5=function(){if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("FBRTCExperiment").gen("rtc_browser_use_vp9");a.getBool("allow_vp9",!1)||(this.msg.sdp=b("ScotchFBRTCSdpUtils").removeVP9(this.msg.sdp))}};c.isOffer=function(){return this.msgType===b("FBRTCConstants").PayloadType.OFFER};c.isFromMobile=function(){return this.source===g};c.isRemoteVideoSupported=function(){return!this.msg.sdp||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE?!0:b("ScotchFBRTCSdpUtils").isVideoSupported(this.msg.sdp)};c.isRetry=function(){return!!this.msg.flag};c.isForCall=function(a,c){return this.escalationName&&(this.msgType===b("FBRTCConstants").PayloadType.HANGUP||this.msgType===b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY)?c===this.escalationName:!a||a===this.callID||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.PCRESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE};c.getSignalingExperiments=function(){if(this.isFromMobile()){if(!this.msg.experiments)return["sdp_update"];this.msg.experiments.includes("sdp_update")||this.msg.experiments.push("sdp_update")}return this.msg.experiments};return a}();e.exports=a}),null);
__d("ScotchFBRTCMessageDedup",[],(function(a,b,c,d,e,f){var g={};a={check:function(a,b,c){g[a]||(g[a]={});g[a][b]||(g[a][b]={});if(g[a][b][c])return!1;g[a][b][c]=!0;return!0}};e.exports=a}),null);
__d("MessengerCowatchConfig",["gkx"],(function(a,b,c,d,e,f){"use strict";a={hasZenonCowatchCapability:function(){return b("gkx")("1499608")},hasZenonGroupCowatchCapability:function(){return b("gkx")("1499608")}};e.exports=a}),null);
__d("ScotchFBRTCVersionDetection",["UserAgent","UserAgentData"],(function(a,b,c,d,e,f){a={isChrome:function(){return b("UserAgent").isBrowser("Chrome")},isFirefox:function(){return b("UserAgent").isBrowser("Firefox")},isChromiumBasedEdge:function(){return b("UserAgent").isBrowser("Edge (Chromium Based)")},isChromium:function(){return!!navigator.webkitGetUserMedia},webrtcVersion:function(){if(this.isFirefox()||this.isChrome()||this.isChromiumBasedEdge())return b("UserAgentData").browserVersion||0;if(this.isChromium()){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a!=null?parseInt(a[2],10):999}return 0}};e.exports=a}),null);
__d("ScotchRTCAudioTrackNoiseDetector",["invariant","Promise","MediaStream"],(function(a,b,c,d,e,f,g){"use strict";var h="audio track with absolute silence",i="audio track data timeout",j='wrong track type, expected "audio"',k=100;a={ABSOLUTE_SILENCE_ERROR:h,DATA_TIMEOUT_ERROR:i,WRONG_TRACK_TYPE_ERROR:j,detect:function(a,c){if("kind"in a&&a.kind!=="audio")return b("Promise").reject(new Error(j));var d=new(b("MediaStream"))();d.addTrack(a);var e=new AudioContext(),f=e.createMediaStreamSource(d),l=e.createScriptProcessor(0,1,1),m=k,n=function(){l!=null||g(0,2865);l.onaudioprocess=null;l.disconnect();l=null;f!=null||g(0,2866);f.disconnect();f=null;d!=null||g(0,2867);d.removeTrack(a);d=null;e!=null||g(0,2868);return b("Promise").resolve(e.close())["catch"](function(){return b("Promise").resolve()}).then(function(){e=null})};return b("Promise").race([new(b("Promise"))(function(a,b){l!=null||g(0,2865),l.onaudioprocess=function(c){c=c.inputBuffer;for(var c=c.getChannelData(0),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;if(f!==0){a();return}}m>0?m--:b(new Error(h))},f!=null||g(0,2866),f.connect(l),e!=null||g(0,2868),l.connect(e.destination)}),new(b("Promise"))(function(a){return window.setTimeout(a,c)}).then(function(){throw new Error(i)})]).then(function(){return n()})["catch"](function(a){return n().then(function(){throw a})})}};e.exports=a}),null);
__d("ScotchRTWebStrings",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={busy:g._("Busy"),callAgain:g._("Call Again"),callEnded:g._("Call Ended"),callFailed:g._("Call Failed"),callInterrupted:g._("Call Interrupted"),cannotConnect:g._("Can't Connect Call"),chatLinksLeftVideoChat:g._("You left the group video chat"),clientEncryptionError:g._("Client Encryption Error"),close:g._("Close"),connected:g._("Connected"),connecting:g._("Connecting..."),connectionDropped:g._("Connection Dropped"),connectionLost:g._("Connection Lost"),contacting:g._("Contacting..."),copiedVideoChatLink:g._("Copied"),copyVideoChatLink:g._("Copy Video Chat Link"),disconnected:g._("Disconnected"),dismiss:g._("Dismiss"),hangingUp:g._("Hanging up..."),inactive:g._("Call is Inactive"),inAnotherCall:g._("In Another Call"),incomingVideoChat:g._("Incoming video chat"),invalidStreamConfiguration:g._("Too many clients connected to the room"),noAnswer:g._("No Answer"),notNow:g._("Not Now"),participantLimitReached:g._("Participant Limit Reached"),pleaseWait:g._("Please wait..."),profilePictureAlt:g._("Profile Picture"),reconnecting:g._("Reconnecting..."),redial:g._("Redial"),ringing:g._("Ringing..."),switchToWiFi:g._("Switch to Wi-Fi to complete your call"),unreachable:g._("Unreachable"),userVideoOff:function(a){return g._("{name}'s camera is off",[g._param("name",a)])},viewerVideoOff:g._("Your camera is off"),waitingForOthers:g._("Waiting for others to join...")};e.exports=a}),null);
__d("ScotchRTCEndCallReason",["FBRTCConstants","FBRTCDismissReason","FBRTCHangupReason","FBRTCRtcResponseStatusCode","ScotchRTWebStrings"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").CallEndReason,h=b("FBRTCConstants").CollabCallEndSubreason;a=function(){function a(a){this.$3="local",typeof a==="string"||a instanceof String?this.$1=b("FBRTCConstants").endCallReasonFromString(a):this.$1=a}var c=a.prototype;c.setSubreason=function(a){this.$2=a;return this};c.getSubreason=function(){return this.$2};c.setRemoteEnded=function(a){this.$3=a?"remote":"local";return this};c.getRemoteEnded=function(){return this.$3==="remote"};c.toStrName=function(a){a===void 0&&(a=!0);return a?this.$4()+"_"+this.$3:this.$4()};c.$4=function(){return b("FBRTCConstants").callEndReasonString(this.$1)};c.getReasonID=function(){return this.$1};c.toString=function(a){var b;a===void 0&&(a=!1);b=((b=this.$5(a))!=null?b:"").toString();return a?b+" "+this.$6():b};c.$5=function(a){switch(this.$1){case g.NO_ANSWER_TIMEOUT:case g.IGNORE_CALL:return b("ScotchRTWebStrings").noAnswer;case g.OTHER_NOT_CAPABLE:if(this.$2===h.MCU_INVALID_STREAM_CONFIGURATION)return b("ScotchRTWebStrings").invalidStreamConfiguration;case g.INCOMING_TIMEOUT:case g.NO_PERMISSION:case g.OTHER_CARRIER_BLOCKED:return b("ScotchRTWebStrings").unreachable;case g.SIGNALING_MESSAGE_FAILED:case g.WEBRTC_ERROR:case g.NO_UI_ERROR:case g.CALLER_NOT_VISIBLE:case g.CLIENT_ERROR:return b("ScotchRTWebStrings").callFailed;case g.UNSUPPORTED_VERSION:return b("ScotchRTWebStrings").cannotConnect;case g.IN_ANOTHER_CALL:return b("ScotchRTWebStrings").inAnotherCall;case g.CARRIER_BLOCKED:return b("ScotchRTWebStrings").switchToWiFi;case g.CLIENT_INTERRUPTED:return b("ScotchRTWebStrings").callInterrupted;case g.HANGUP_CALL:case g.ACCEPT_AFTER_HANGUP:return a?"":b("ScotchRTWebStrings").callEnded;case g.CONNECTION_DROPPED:return b("ScotchRTWebStrings").connectionLost;case g.OTHER_INSTANCE_HANDLED:return null;case g.CLIENT_ENCRYPTION_ERROR:return b("ScotchRTWebStrings").clientEncryptionError;case g.INACTIVE_TIMEOUT:return b("ScotchRTWebStrings").inactive;default:return null}};c.$6=function(){var a;if(this.$1!==g.OTHER_NOT_CAPABLE&&this.$1!==g.SIGNALING_MESSAGE_FAILED&&this.$1!==g.HANGUP_CALL&&this.$1!==g.ACCEPT_AFTER_HANGUP)return"";switch(this.$2){case h.REMOTE_PEER_HANGUP:return"Call ended";case h.REMOTE_PEER_REJECT:return"Call declined";case h.CLOSED_BY_MCU:return"Call expired";case h.CLOSED_AS_STALE:return"Server failed, call is stale";case h.CALL_INITIALIZATION_FAILED:return"Call initialization to room failed";case h.SIP_CONNECTION_INITIALIZATION_FAILED:return"No Answer";case h.LOST_MCU_CONNECTION:return"MCU Media connection failed";case h.LOST_MCU_THRIFT_CONNECTION:return"MCU infrastructure dropped connection";case h.LOST_SIP_ADAPTER_CONNECTION:return"SIP infrastructure dropped connection";case h.MCU_NO_AUDIO_STREAM:return"Invalid audio stream";case h.MCU_INVALID_STREAM_CONFIGURATION:return"Invalid stream configuration";case h.INVALID_MEETING_ID:return"Invalid meeting ID";case h.UNKNOWN:default:a=(a=this.$2)!=null?a:"Unknown";return this.$2!=null&&this.$2!==""?"Unexpected call failure: "+a:"Call ended"}};a.fromHangupReason=function(c){switch(c){case b("FBRTCHangupReason").IGNORE_CALL:return new a(g.IGNORE_CALL);case b("FBRTCHangupReason").NO_ANSWER_TIMEOUT:return new a(g.NO_ANSWER_TIMEOUT);case b("FBRTCHangupReason").HANGUP_CALL:return new a(g.HANGUP_CALL);case b("FBRTCHangupReason").CLIENT_ERROR:return new a(g.CLIENT_ERROR);case b("FBRTCHangupReason").IN_ANOTHER_CALL:return new a(g.IN_ANOTHER_CALL);case b("FBRTCHangupReason").CLIENT_INTERRUPTED:return new a(g.CLIENT_INTERRUPTED);default:return new a(g.HANGUP_CALL)}};a.subreasonFromDismissRequest=function(a){if(!a)return null;switch(a.reason){case b("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return"REMOVED_BY_PARTICIPANT";default:return null}};a.fromDismissRequest=function(c){if(!c)return new a(g.HANGUP_CALL);switch(c.reason){case b("FBRTCDismissReason").ANSWERED_ON_ANOTHER_DEVICE:case b("FBRTCDismissReason").REJECTED_ON_ANOTHER_DEVICE:return new a(g.OTHER_INSTANCE_HANDLED);case b("FBRTCDismissReason").CALL_ENDED:return new a(g.HANGUP_CALL);case b("FBRTCDismissReason").IN_ANOTHER_CALL:return new a(g.IN_ANOTHER_CALL);case b("FBRTCDismissReason").CONNECTION_DROPPED:return new a(g.CONNECTION_DROPPED);case b("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return new a(g.HANGUP_CALL);case b("FBRTCDismissReason").REJECTED_BY_CALLEE:return new a(g.IGNORE_CALL);case b("FBRTCDismissReason").INTERNAL_ERROR:return new a(g.SIGNALING_MESSAGE_FAILED);default:return new a(g.HANGUP_CALL)}};a.fromResponseStatusCode=function(c){switch(c){case b("FBRTCRtcResponseStatusCode").PRECONDITION_FAILURE:case b("FBRTCRtcResponseStatusCode").METHOD_NOT_ALLOWED:case b("FBRTCRtcResponseStatusCode").UNAUTHORIZED:return new a(g.NO_PERMISSION);case b("FBRTCRtcResponseStatusCode").SERVICE_UNAVAILABLE:return new a(g.SIGNALING_MESSAGE_FAILED);case b("FBRTCRtcResponseStatusCode").SERVER_INTERNAL_ERROR:case b("FBRTCRtcResponseStatusCode").BAD_REQUEST:case b("FBRTCRtcResponseStatusCode").BUSY_HERE:case b("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED:case b("FBRTCRtcResponseStatusCode").NOT_FOUND:return new a(g.CLIENT_ERROR);default:return new a(g.HANGUP_CALL)}};return a}();e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("sdp-2.9.0",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a={};a.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)};a.localCName=a.generateIdentifier();a.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};a.splitSections=function(a){a=a.split("\nm=");return a.map(function(a,b){return(b>0?"m="+a:a).trim()+"\r\n"})};a.getDescription=function(b){b=a.splitSections(b);return b&&b[0]};a.getMediaSections=function(b){b=a.splitSections(b);b.shift();return b};a.matchPrefix=function(b,c){return a.splitLines(b).filter(function(a){return a.indexOf(c)===0})};a.parseCandidate=function(a){var b;a.indexOf("a=candidate:")===0?b=a.substring(12).split(" "):b=a.substring(10).split(" ");a={foundation:b[0],component:parseInt(b[1],10),protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],address:b[4],port:parseInt(b[5],10),type:b[7]};for(var c=8;c<b.length;c+=2)switch(b[c]){case"raddr":a.relatedAddress=b[c+1];break;case"rport":a.relatedPort=parseInt(b[c+1],10);break;case"tcptype":a.tcpType=b[c+1];break;case"ufrag":a.ufrag=b[c+1];a.usernameFragment=b[c+1];break;default:a[b[c]]=b[c+1];break}return a};a.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var c=a.type;b.push("typ");b.push(c);c!=="host"&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&a.protocol.toLowerCase()==="tcp"&&(b.push("tcptype"),b.push(a.tcpType));(a.usernameFragment||a.ufrag)&&(b.push("ufrag"),b.push(a.usernameFragment||a.ufrag));return"candidate:"+b.join(" ")};a.parseIceOptions=function(a){return a.substr(14).split(" ")};a.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=a.length===3?parseInt(a[2],10):1;b.numChannels=b.channels;return b};a.writeRtpMap=function(a){var b=a.payloadType;a.preferredPayloadType!==void 0&&(b=a.preferredPayloadType);var c=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(c!==1?"/"+c:"")+"\r\n"};a.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1]}};a.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&a.direction!=="sendrecv"?"/"+a.direction:"")+" "+a.uri+"\r\n"};a.parseFmtp=function(a){var b={},c;a=a.substr(a.indexOf(" ")+1).split(";");for(var d=0;d<a.length;d++)c=a[d].trim().split("="),b[c[0].trim()]=c[1];return b};a.writeFmtp=function(a){var b="",c=a.payloadType;a.preferredPayloadType!==void 0&&(c=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?d.push(b+"="+a.parameters[b]):d.push(b)});b+="a=fmtp:"+c+" "+d.join(";")+"\r\n"}return b};a.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};a.writeRtcpFb=function(a){var b="",c=a.payloadType;a.preferredPayloadType!==void 0&&(c=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};a.parseSsrcMedia=function(a){var b=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},d=a.indexOf(":",b);d>-1?(c.attribute=a.substr(b+1,d-b-1),c.value=a.substr(d+1)):c.attribute=a.substr(b+1);return c};a.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};a.getMid=function(b){b=a.matchPrefix(b,"a=mid:")[0];if(b)return b.substr(6)};a.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};a.getDtlsParameters=function(b,c){b=a.matchPrefix(b+c,"a=fingerprint:");return{role:"auto",fingerprints:b.map(a.parseFingerprint)}};a.writeDtlsParameters=function(a,b){var c="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return c};a.getIceParameters=function(b,c){b=a.splitLines(b);b=b.concat(a.splitLines(c));c={usernameFragment:b.filter(function(a){return a.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:b.filter(function(a){return a.indexOf("a=ice-pwd:")===0})[0].substr(10)};return c};a.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"};a.parseRtpParameters=function(b){var c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},d=a.splitLines(b);d=d[0].split(" ");for(var e=3;e<d.length;e++){var f=d[e],g=a.matchPrefix(b,"a=rtpmap:"+f+" ")[0];if(g){g=a.parseRtpMap(g);var h=a.matchPrefix(b,"a=fmtp:"+f+" ");g.parameters=h.length?a.parseFmtp(h[0]):{};g.rtcpFeedback=a.matchPrefix(b,"a=rtcp-fb:"+f+" ").map(a.parseRtcpFb);c.codecs.push(g);switch(g.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(g.name.toUpperCase());break;default:break}}}a.matchPrefix(b,"a=extmap:").forEach(function(b){c.headerExtensions.push(a.parseExtmap(b))});return c};a.writeRtpDescription=function(b,c){var d="";d+="m="+b+" ";d+=c.codecs.length>0?"9":"0";d+=" UDP/TLS/RTP/SAVPF ";d+=c.codecs.map(function(a){return a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";d+="c=IN IP4 0.0.0.0\r\n";d+="a=rtcp:9 IN IP4 0.0.0.0\r\n";c.codecs.forEach(function(b){d+=a.writeRtpMap(b),d+=a.writeFmtp(b),d+=a.writeRtcpFb(b)});var e=0;c.codecs.forEach(function(a){a.maxptime>e&&(e=a.maxptime)});e>0&&(d+="a=maxptime:"+e+"\r\n");d+="a=rtcp-mux\r\n";c.headerExtensions&&c.headerExtensions.forEach(function(b){d+=a.writeExtmap(b)});return d};a.parseRtpEncodingParameters=function(b){var c=[],d=a.parseRtpParameters(b),e=d.fecMechanisms.indexOf("RED")!==-1,f=d.fecMechanisms.indexOf("ULPFEC")!==-1,g=a.matchPrefix(b,"a=ssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return a.attribute==="cname"}),h=g.length>0&&g[0].ssrc,i;g=a.matchPrefix(b,"a=ssrc-group:FID").map(function(a){a=a.substr(17).split(" ");return a.map(function(a){return parseInt(a,10)})});g.length>0&&g[0].length>1&&g[0][0]===h&&(i=g[0][1]);d.codecs.forEach(function(a){if(a.name.toUpperCase()==="RTX"&&a.parameters.apt){a={ssrc:h,codecPayloadType:parseInt(a.parameters.apt,10)};h&&i&&(a.rtx={ssrc:i});c.push(a);e&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:h,mechanism:f?"red+ulpfec":"red"},c.push(a))}});c.length===0&&h&&c.push({ssrc:h});var j=a.matchPrefix(b,"b=");j.length&&(j[0].indexOf("b=TIAS:")===0?j=parseInt(j[0].substr(7),10):j[0].indexOf("b=AS:")===0?j=parseInt(j[0].substr(5),10)*1e3*.95-50*40*8:j=void 0,c.forEach(function(a){a.maxBitrate=j}));return c};a.parseRtcpParameters=function(b){var c={},d=a.matchPrefix(b,"a=ssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return a.attribute==="cname"})[0];d&&(c.cname=d.value,c.ssrc=d.ssrc);d=a.matchPrefix(b,"a=rtcp-rsize");c.reducedSize=d.length>0;c.compound=d.length===0;d=a.matchPrefix(b,"a=rtcp-mux");c.mux=d.length>0;return c};a.parseMsid=function(b){var c=a.matchPrefix(b,"a=msid:");if(c.length===1){c=c[0].substr(7).split(" ");return{stream:c[0],track:c[1]}}b=a.matchPrefix(b,"a=ssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return a.attribute==="msid"});if(b.length>0){c=b[0].value.split(" ");return{stream:c[0],track:c[1]}}};a.generateSessionId=function(){return Math.random().toString().substr(2,21)};a.writeSessionBoilerplate=function(b,c,d){c=c!==void 0?c:2;b?b=b:b=a.generateSessionId();d=d||"thisisadapterortc";return"v=0\r\no="+d+" "+b+" "+c+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};a.writeMediaSection=function(b,c,d,e){c=a.writeRtpDescription(b.kind,c);c+=a.writeIceParameters(b.iceGatherer.getLocalParameters());c+=a.writeDtlsParameters(b.dtlsTransport.getLocalParameters(),d==="offer"?"actpass":"active");c+="a=mid:"+b.mid+"\r\n";b.direction?c+="a="+b.direction+"\r\n":b.rtpSender&&b.rtpReceiver?c+="a=sendrecv\r\n":b.rtpSender?c+="a=sendonly\r\n":b.rtpReceiver?c+="a=recvonly\r\n":c+="a=inactive\r\n";if(b.rtpSender){d="msid:"+e.id+" "+b.rtpSender.track.id+"\r\n";c+="a="+d;c+="a=ssrc:"+b.sendEncodingParameters[0].ssrc+" "+d;b.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" "+d,c+="a=ssrc-group:FID "+b.sendEncodingParameters[0].ssrc+" "+b.sendEncodingParameters[0].rtx.ssrc+"\r\n")}c+="a=ssrc:"+b.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";b.rtpSender&&b.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return c};a.getDirection=function(b,c){b=a.splitLines(b);for(var d=0;d<b.length;d++)switch(b[d]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return b[d].substr(2);default:}return c?a.getDirection(c):"sendrecv"};a.getKind=function(b){b=a.splitLines(b);b=b[0].split(" ");return b[0].substr(2)};a.isRejected=function(a){return a.split(" ",2)[1]==="0"};a.parseMLine=function(b){b=a.splitLines(b);b=b[0].substr(2).split(" ");return{kind:b[0],port:parseInt(b[1],10),protocol:b[2],fmt:b.slice(3).join(" ")}};a.parseOLine=function(b){b=a.matchPrefix(b,"o=")[0];b=b.substr(2).split(" ");return{username:b[0],sessionId:b[1],sessionVersion:parseInt(b[2],10),netType:b[3],addressType:b[4],address:b[5]}};a.isValidSDP=function(b){if(typeof b!=="string"||b.length===0)return!1;b=a.splitLines(b);for(var c=0;c<b.length;c++)if(b[c].length<2||b[c].charAt(1)!=="=")return!1;return!0};typeof g==="object"&&(g.exports=a)}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/oyybAxN87_l/
 */
__d("rtcpeerconnection-shim-1.2.15",["sdp-2.9.0"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("sdp-2.9.0"));d={};var h={exports:d};function i(){var a=g();function b(a){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type}function c(b,c,d,e,f){c=a.writeRtpDescription(b.kind,c);c+=a.writeIceParameters(b.iceGatherer.getLocalParameters());c+=a.writeDtlsParameters(b.dtlsTransport.getLocalParameters(),d==="offer"?"actpass":f||"active");c+="a=mid:"+b.mid+"\r\n";b.rtpSender&&b.rtpReceiver?c+="a=sendrecv\r\n":b.rtpSender?c+="a=sendonly\r\n":b.rtpReceiver?c+="a=recvonly\r\n":c+="a=inactive\r\n";if(b.rtpSender){d=b.rtpSender._initialTrackId||b.rtpSender.track.id;b.rtpSender._initialTrackId=d;f="msid:"+(e?e.id:"-")+" "+d+"\r\n";c+="a="+f;c+="a=ssrc:"+b.sendEncodingParameters[0].ssrc+" "+f;b.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" "+f,c+="a=ssrc-group:FID "+b.sendEncodingParameters[0].ssrc+" "+b.sendEncodingParameters[0].rtx.ssrc+"\r\n")}c+="a=ssrc:"+b.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";b.rtpSender&&b.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return c}function d(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls;var e=typeof d==="string";e&&(d=[d]);d=d.filter(function(a){var d=a.indexOf("turn:")===0&&a.indexOf("transport=udp")!==-1&&a.indexOf("turn:[")===-1&&!c;if(d){c=!0;return!0}return a.indexOf("stun:")===0&&b>=14393&&a.indexOf("?transport=udp")===-1});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function e(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){a=d(a.parameters.apt,c);c=d(b.parameters.apt,e);return a&&c&&a.name.toLowerCase()===c.name.toLowerCase()};a.codecs.forEach(function(d){for(var f=0;f<b.codecs.length;f++){var g=b.codecs[f];if(d.name.toLowerCase()===g.name.toLowerCase()&&d.clockRate===g.clockRate){if(d.name.toLowerCase()==="rtx"&&d.parameters&&g.parameters.apt&&!e(d,g,a.codecs,b.codecs))continue;g=JSON.parse(JSON.stringify(g));g.numChannels=Math.min(d.numChannels,g.numChannels);c.codecs.push(g);g.rtcpFeedback=g.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}});return c}function f(a,b,c){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)!==-1}function i(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function j(a,b){b=new Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}h.exports=function(g,h){function k(a,b){b.addTrack(a),b.dispatchEvent(new g.MediaStreamTrackEvent("addtrack",{track:a}))}function l(a,b){b.removeTrack(a),b.dispatchEvent(new g.MediaStreamTrackEvent("removetrack",{track:a}))}function m(a,b,c,d){var e=new Event("track");e.track=b;e.receiver=c;e.transceiver={receiver:c};e.streams=d;g.setTimeout(function(){a._dispatchEvent("track",e)})}var n=function(b){var c=this,e=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){c[a]=e[a].bind(e)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._localDescription=null;this._remoteDescription=null;this.signalingState="stable";this.iceConnectionState="new";this.connectionState="new";this.iceGatheringState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle=b.bundlePolicy==="max-bundle";if(b.rtcpMuxPolicy==="negotiate")throw j("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");else b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case"all":case"relay":break;default:b.iceTransportPolicy="all";break}switch(b.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:b.bundlePolicy="balanced";break}b.iceServers=d(b.iceServers||[],h);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var f=b.iceCandidatePoolSize;f>0;f--)this._iceGatherers.push(new g.RTCIceGatherer({iceServers:b.iceServers,gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=a.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});n.prototype.onicecandidate=null;n.prototype.onaddstream=null;n.prototype.ontrack=null;n.prototype.onremovestream=null;n.prototype.onsignalingstatechange=null;n.prototype.oniceconnectionstatechange=null;n.prototype.onconnectionstatechange=null;n.prototype.onicegatheringstatechange=null;n.prototype.onnegotiationneeded=null;n.prototype.ondatachannel=null;n.prototype._dispatchEvent=function(a,b){if(this._isClosed)return;this.dispatchEvent(b);typeof this["on"+a]==="function"&&this["on"+a](b)};n.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)};n.prototype.getConfiguration=function(){return this._config};n.prototype.getLocalStreams=function(){return this.localStreams};n.prototype.getRemoteStreams=function(){return this.remoteStreams};n.prototype._createTransceiver=function(a,b){var c=this.transceivers.length>0;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&c)a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport;else{c=this._createIceAndDtlsTransports();a.iceTransport=c.iceTransport;a.dtlsTransport=c.dtlsTransport}b||this.transceivers.push(a);return a};n.prototype.addTrack=function(a,b){if(this._isClosed)throw j("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var c=this.transceivers.find(function(b){return b.track===a});if(c)throw j("InvalidAccessError","Track already exists.");var d;for(var c=0;c<this.transceivers.length;c++)!this.transceivers[c].track&&this.transceivers[c].kind===a.kind&&(d=this.transceivers[c]);d||(d=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();this.localStreams.indexOf(b)===-1&&this.localStreams.push(b);d.track=a;d.stream=b;d.rtpSender=new g.RTCRtpSender(a,d.dtlsTransport);return d.rtpSender};n.prototype.addStream=function(a){var b=this;if(h>=15025)a.getTracks().forEach(function(c){b.addTrack(c,a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};n.prototype.removeTrack=function(a){if(this._isClosed)throw j("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof g.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===a});if(!b)throw j("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;b=this.transceivers.map(function(a){return a.stream});b.indexOf(c)===-1&&this.localStreams.indexOf(c)>-1&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};n.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})};n.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};n.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};n.prototype._createIceGatherer=function(a,b){var c=this;if(b&&a>0)return this.transceivers[0].iceGatherer;else if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new g.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var e=!b.candidate||Object.keys(b.candidate).length===0;d.state=e?"completed":"gathering";c.transceivers[a].bufferedCandidateEvents!==null&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};n.prototype._gather=function(b,c){var d=this,e=this.transceivers[c].iceGatherer;if(e.onlocalcandidate)return;var f=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null;e.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates);e.onlocalcandidate=function(f){if(d.usingBundle&&c>0)return;var g=new Event("icecandidate");g.candidate={sdpMid:b,sdpMLineIndex:c};f=f.candidate;var h=!f||Object.keys(f).length===0;if(h)(e.state==="new"||e.state==="gathering")&&(e.state="completed");else{e.state==="new"&&(e.state="gathering");f.component=1;f.ufrag=e.getLocalParameters().usernameFragment;f=a.writeCandidate(f);g.candidate=Object.assign(g.candidate,a.parseCandidate(f));g.candidate.candidate=f;g.candidate.toJSON=function(){return{candidate:g.candidate.candidate,sdpMid:g.candidate.sdpMid,sdpMLineIndex:g.candidate.sdpMLineIndex,usernameFragment:g.candidate.usernameFragment}}}f=a.getMediaSections(d._localDescription.sdp);!h?f[g.candidate.sdpMLineIndex]+="a="+g.candidate.candidate+"\r\n":f[g.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n";d._localDescription.sdp=a.getDescription(d._localDescription.sdp)+f.join("");f=d.transceivers.every(function(a){return a.iceGatherer&&a.iceGatherer.state==="completed"});d.iceGatheringState!=="gathering"&&(d.iceGatheringState="gathering",d._emitGatheringStateChange());h||d._dispatchEvent("icecandidate",g);f&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())};g.setTimeout(function(){f.forEach(function(a){e.onlocalcandidate(a)})},0)};n.prototype._createIceAndDtlsTransports=function(){var a=this,b=new g.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState(),a._updateConnectionState()};var c=new g.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0}),a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};n.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);b=this.transceivers[a].iceTransport;b&&(delete b.onicestatechange,delete this.transceivers[a].iceTransport);b=this.transceivers[a].dtlsTransport;b&&(delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport)};n.prototype._transceive=function(b,c,d){var f=e(b.localCapabilities,b.remoteCapabilities);c&&b.rtpSender&&(f.encodings=b.sendEncodingParameters,f.rtcp={cname:a.localCName,compound:b.rtcpParameters.compound},b.recvEncodingParameters.length&&(f.rtcp.ssrc=b.recvEncodingParameters[0].ssrc),b.rtpSender.send(f));d&&b.rtpReceiver&&f.codecs.length>0&&(b.kind==="video"&&b.recvEncodingParameters&&h<15019&&b.recvEncodingParameters.forEach(function(a){delete a.rtx}),b.recvEncodingParameters.length?f.encodings=b.recvEncodingParameters:f.encodings=[{}],f.rtcp={compound:b.rtcpParameters.compound},b.rtcpParameters.cname&&(f.rtcp.cname=b.rtcpParameters.cname),b.sendEncodingParameters.length&&(f.rtcp.ssrc=b.sendEncodingParameters[0].ssrc),b.rtpReceiver.receive(f))};n.prototype.setLocalDescription=function(b){var c=this;if(["offer","answer"].indexOf(b.type)===-1)return Promise.reject(j("TypeError",'Unsupported type "'+b.type+'"'));if(!f("setLocalDescription",b.type,c.signalingState)||c._isClosed)return Promise.reject(j("InvalidStateError","Can not set local "+b.type+" in state "+c.signalingState));var d,g;if(b.type==="offer")d=a.splitSections(b.sdp),g=d.shift(),d.forEach(function(b,d){b=a.parseRtpParameters(b);c.transceivers[d].localCapabilities=b}),c.transceivers.forEach(function(a,b){c._gather(a.mid,b)});else if(b.type==="answer"){d=a.splitSections(c._remoteDescription.sdp);g=d.shift();var h=a.matchPrefix(g,"a=ice-lite").length>0;d.forEach(function(b,d){var f=c.transceivers[d],i=f.iceGatherer,j=f.iceTransport,k=f.dtlsTransport,l=f.localCapabilities,m=f.remoteCapabilities,n=a.isRejected(b)&&a.matchPrefix(b,"a=bundle-only").length===0;if(!n&&!f.rejected){n=a.getIceParameters(b,g);b=a.getDtlsParameters(b,g);h&&(b.role="server");(!c.usingBundle||d===0)&&(c._gather(f.mid,d),j.state==="new"&&j.start(i,n,h?"controlling":"controlled"),k.state==="new"&&k.start(b));d=e(l,m);c._transceive(f,d.codecs.length>0,!1)}})}c._localDescription={type:b.type,sdp:b.sdp};b.type==="offer"?c._updateSignalingState("have-local-offer"):c._updateSignalingState("stable");return Promise.resolve()};n.prototype.setRemoteDescription=function(b){var c=this;if(["offer","answer"].indexOf(b.type)===-1)return Promise.reject(j("TypeError",'Unsupported type "'+b.type+'"'));if(!f("setRemoteDescription",b.type,c.signalingState)||c._isClosed)return Promise.reject(j("InvalidStateError","Can not set remote "+b.type+" in state "+c.signalingState));var d={};c.remoteStreams.forEach(function(a){d[a.id]=a});var n=[],o=a.splitSections(b.sdp),p=o.shift(),q=a.matchPrefix(p,"a=ice-lite").length>0,r=a.matchPrefix(p,"a=group:BUNDLE ").length>0;c.usingBundle=r;var s=a.matchPrefix(p,"a=ice-options:")[0];s?c.canTrickleIceCandidates=s.substr(14).split(" ").indexOf("trickle")>=0:c.canTrickleIceCandidates=!1;o.forEach(function(f,j){var m=a.splitLines(f),o=a.getKind(f),s=a.isRejected(f)&&a.matchPrefix(f,"a=bundle-only").length===0;m=m[0].substr(2).split(" ")[2];var t=a.getDirection(f,p),u=a.parseMsid(f),v=a.getMid(f)||a.generateIdentifier();if(s||o==="application"&&(m==="DTLS/SCTP"||m==="UDP/DTLS/SCTP")){c.transceivers[j]={mid:v,kind:o,protocol:m,rejected:!0};return}!s&&c.transceivers[j]&&c.transceivers[j].rejected&&(c.transceivers[j]=c._createTransceiver(o,!0));var w,x,y,z,A;m=a.parseRtpParameters(f);var B,C;s||(B=a.getIceParameters(f,p),C=a.getDtlsParameters(f,p),C.role="client");A=a.parseRtpEncodingParameters(f);var D=a.parseRtcpParameters(f),E=a.matchPrefix(f,"a=end-of-candidates",p).length>0;f=a.matchPrefix(f,"a=candidate:").map(function(b){return a.parseCandidate(b)}).filter(function(a){return a.component===1});(b.type==="offer"||b.type==="answer")&&!s&&r&&j>0&&c.transceivers[j]&&(c._disposeIceAndDtlsTransports(j),c.transceivers[j].iceGatherer=c.transceivers[0].iceGatherer,c.transceivers[j].iceTransport=c.transceivers[0].iceTransport,c.transceivers[j].dtlsTransport=c.transceivers[0].dtlsTransport,c.transceivers[j].rtpSender&&c.transceivers[j].rtpSender.setTransport(c.transceivers[0].dtlsTransport),c.transceivers[j].rtpReceiver&&c.transceivers[j].rtpReceiver.setTransport(c.transceivers[0].dtlsTransport));if(b.type==="offer"&&!s){w=c.transceivers[j]||c._createTransceiver(o);w.mid=v;w.iceGatherer||(w.iceGatherer=c._createIceGatherer(j,r));f.length&&w.iceTransport.state==="new"&&(E&&(!r||j===0)?w.iceTransport.setRemoteCandidates(f):f.forEach(function(a){i(w.iceTransport,a)}));v=g.RTCRtpReceiver.getCapabilities(o);h<15019&&(v.codecs=v.codecs.filter(function(a){return a.name!=="rtx"}));z=w.sendEncodingParameters||[{ssrc:(2*j+2)*1001}];var F=!1;if(t==="sendrecv"||t==="sendonly"){F=!w.rtpReceiver;y=w.rtpReceiver||new g.RTCRtpReceiver(w.dtlsTransport,o);if(F){var G;o=y.track;u&&u.stream==="-"||(u?(d[u.stream]||(d[u.stream]=new g.MediaStream(),Object.defineProperty(d[u.stream],"id",{get:function(){return u.stream}})),Object.defineProperty(o,"id",{get:function(){return u.track}}),G=d[u.stream]):(d["default"]||(d["default"]=new g.MediaStream()),G=d["default"]));G&&(k(o,G),w.associatedRemoteMediaStreams.push(G));n.push([o,y,G])}}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===w.rtpReceiver.track.id});b&&l(b,a)}),w.associatedRemoteMediaStreams=[]);w.localCapabilities=v;w.remoteCapabilities=m;w.rtpReceiver=y;w.rtcpParameters=D;w.sendEncodingParameters=z;w.recvEncodingParameters=A;c._transceive(c.transceivers[j],!1,F)}else if(b.type==="answer"&&!s){w=c.transceivers[j];F=w.iceGatherer;s=w.iceTransport;x=w.dtlsTransport;y=w.rtpReceiver;z=w.sendEncodingParameters;v=w.localCapabilities;c.transceivers[j].recvEncodingParameters=A;c.transceivers[j].remoteCapabilities=m;c.transceivers[j].rtcpParameters=D;f.length&&s.state==="new"&&((q||E)&&(!r||j===0)?s.setRemoteCandidates(f):f.forEach(function(a){i(w.iceTransport,a)}));(!r||j===0)&&(s.state==="new"&&s.start(F,B,"controlling"),x.state==="new"&&x.start(C));z=e(w.localCapabilities,w.remoteCapabilities);v=z.codecs.filter(function(a){return a.name.toLowerCase()==="rtx"}).length;!v&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx;c._transceive(w,t==="sendrecv"||t==="recvonly",t==="sendrecv"||t==="sendonly");y&&(t==="sendrecv"||t==="sendonly")?(o=y.track,u?(d[u.stream]||(d[u.stream]=new g.MediaStream()),k(o,d[u.stream]),n.push([o,y,d[u.stream]])):(d["default"]||(d["default"]=new g.MediaStream()),k(o,d["default"]),n.push([o,y,d["default"]]))):delete w.rtpReceiver}});c._dtlsRole===void 0&&(c._dtlsRole=b.type==="offer"?"active":"passive");c._remoteDescription={type:b.type,sdp:b.sdp};b.type==="offer"?c._updateSignalingState("have-remote-offer"):c._updateSignalingState("stable");Object.keys(d).forEach(function(a){var b=d[a];if(b.getTracks().length){if(c.remoteStreams.indexOf(b)===-1){c.remoteStreams.push(b);var e=new Event("addstream");e.stream=b;g.setTimeout(function(){c._dispatchEvent("addstream",e)})}n.forEach(function(a){var d=a[0],e=a[1];if(b.id!==a[2].id)return;m(c,d,e,[b])})}});n.forEach(function(a){if(a[2])return;m(c,a[0],a[1],[])});g.setTimeout(function(){if(!(c&&c.transceivers))return;c.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.state==="new"&&a.iceTransport.getRemoteCandidates().length>0&&a.iceTransport.addRemoteCandidate({})})},4e3);return Promise.resolve()};n.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop(),a.dtlsTransport&&a.dtlsTransport.stop(),a.rtpSender&&a.rtpSender.stop(),a.rtpReceiver&&a.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")};n.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};n.prototype._maybeFireNegotiationNeeded=function(){var a=this;if(this.signalingState!=="stable"||this.needNegotiation===!0)return;this.needNegotiation=!0;g.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0)};n.prototype._updateIceConnectionState=function(){var a,b={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(a){a.iceTransport&&!a.rejected&&b[a.iceTransport.state]++});a="new";b.failed>0?a="failed":b.checking>0?a="checking":b.disconnected>0?a="disconnected":b["new"]>0?a="new":b.connected>0?a="connected":b.completed>0&&(a="completed");if(a!==this.iceConnectionState){this.iceConnectionState=a;a=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",a)}};n.prototype._updateConnectionState=function(){var a,b={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(a){a.iceTransport&&a.dtlsTransport&&!a.rejected&&(b[a.iceTransport.state]++,b[a.dtlsTransport.state]++)});b.connected+=b.completed;a="new";b.failed>0?a="failed":b.connecting>0?a="connecting":b.disconnected>0?a="disconnected":b["new"]>0?a="new":b.connected>0&&(a="connected");if(a!==this.connectionState){this.connectionState=a;a=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",a)}};n.prototype.createOffer=function(){var b=this;if(b._isClosed)return Promise.reject(j("InvalidStateError","Can not call createOffer after close"));var d=b.transceivers.filter(function(a){return a.kind==="audio"}).length,e=b.transceivers.filter(function(a){return a.kind==="video"}).length,f=arguments[0];if(f){if(f.mandatory||f.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");f.offerToReceiveAudio!==void 0&&(f.offerToReceiveAudio===!0?d=1:f.offerToReceiveAudio===!1?d=0:d=f.offerToReceiveAudio);f.offerToReceiveVideo!==void 0&&(f.offerToReceiveVideo===!0?e=1:f.offerToReceiveVideo===!1?e=0:e=f.offerToReceiveVideo)}b.transceivers.forEach(function(a){a.kind==="audio"?(d--,d<0&&(a.wantReceive=!1)):a.kind==="video"&&(e--,e<0&&(a.wantReceive=!1))});while(d>0||e>0)d>0&&(b._createTransceiver("audio"),d--),e>0&&(b._createTransceiver("video"),e--);var i=a.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.transceivers.forEach(function(c,d){var e=c.track,f=c.kind,i=c.mid||a.generateIdentifier();c.mid=i;c.iceGatherer||(c.iceGatherer=b._createIceGatherer(d,b.usingBundle));i=g.RTCRtpSender.getCapabilities(f);h<15019&&(i.codecs=i.codecs.filter(function(a){return a.name!=="rtx"}));i.codecs.forEach(function(a){a.name==="H264"&&a.parameters["level-asymmetry-allowed"]===void 0&&(a.parameters["level-asymmetry-allowed"]="1"),c.remoteCapabilities&&c.remoteCapabilities.codecs&&c.remoteCapabilities.codecs.forEach(function(b){a.name.toLowerCase()===b.name.toLowerCase()&&a.clockRate===b.clockRate&&(a.preferredPayloadType=b.payloadType)})});i.headerExtensions.forEach(function(a){var b=c.remoteCapabilities&&c.remoteCapabilities.headerExtensions||[];b.forEach(function(b){a.uri===b.uri&&(a.id=b.id)})});d=c.sendEncodingParameters||[{ssrc:(2*d+1)*1001}];e&&(h>=15019&&f==="video"&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}));c.wantReceive&&(c.rtpReceiver=new g.RTCRtpReceiver(c.dtlsTransport,f));c.localCapabilities=i;c.sendEncodingParameters=d});b._config.bundlePolicy!=="max-compat"&&(i+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");i+="a=ice-options:trickle\r\n";b.transceivers.forEach(function(d,e){i+=c(d,d.localCapabilities,"offer",d.stream,b._dtlsRole),i+="a=rtcp-rsize\r\n",d.iceGatherer&&b.iceGatheringState!=="new"&&(e===0||!b.usingBundle)&&(d.iceGatherer.getLocalCandidates().forEach(function(b){b.component=1,i+="a="+a.writeCandidate(b)+"\r\n"}),d.iceGatherer.state==="completed"&&(i+="a=end-of-candidates\r\n"))});var k=new g.RTCSessionDescription({type:"offer",sdp:i});return Promise.resolve(k)};n.prototype.createAnswer=function(){var b=this;if(b._isClosed)return Promise.reject(j("InvalidStateError","Can not call createAnswer after close"));if(!(b.signalingState==="have-remote-offer"||b.signalingState==="have-local-pranswer"))return Promise.reject(j("InvalidStateError","Can not call createAnswer in signalingState "+b.signalingState));var d=a.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.usingBundle&&(d+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");d+="a=ice-options:trickle\r\n";var f=a.getMediaSections(b._remoteDescription.sdp).length;b.transceivers.forEach(function(a,g){if(g+1>f)return;if(a.rejected){a.kind==="application"?a.protocol==="DTLS/SCTP"?d+="m=application 0 DTLS/SCTP 5000\r\n":d+="m=application 0 "+a.protocol+" webrtc-datachannel\r\n":a.kind==="audio"?d+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":a.kind==="video"&&(d+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n");d+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+a.mid+"\r\n";return}if(a.stream){var i;a.kind==="audio"?i=a.stream.getAudioTracks()[0]:a.kind==="video"&&(i=a.stream.getVideoTracks()[0]);i&&(h>=15019&&a.kind==="video"&&!a.sendEncodingParameters[0].rtx&&(a.sendEncodingParameters[0].rtx={ssrc:a.sendEncodingParameters[0].ssrc+1}))}g=e(a.localCapabilities,a.remoteCapabilities);var j=g.codecs.filter(function(a){return a.name.toLowerCase()==="rtx"}).length;!j&&a.sendEncodingParameters[0].rtx&&delete a.sendEncodingParameters[0].rtx;d+=c(a,g,"answer",a.stream,b._dtlsRole);a.rtcpParameters&&a.rtcpParameters.reducedSize&&(d+="a=rtcp-rsize\r\n")});var i=new g.RTCSessionDescription({type:"answer",sdp:d});return Promise.resolve(i)};n.prototype.addIceCandidate=function(b){var c=this,d;return b&&!(b.sdpMLineIndex!==void 0||b.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,f){if(!c._remoteDescription)return f(j("InvalidStateError","Can not add ICE candidate without a remote description"));else if(!b||b.candidate==="")for(var g=0;g<c.transceivers.length;g++){if(c.transceivers[g].rejected)continue;c.transceivers[g].iceTransport.addRemoteCandidate({});d=a.getMediaSections(c._remoteDescription.sdp);d[g]+="a=end-of-candidates\r\n";c._remoteDescription.sdp=a.getDescription(c._remoteDescription.sdp)+d.join("");if(c.usingBundle)break}else{g=b.sdpMLineIndex;if(b.sdpMid)for(var h=0;h<c.transceivers.length;h++)if(c.transceivers[h].mid===b.sdpMid){g=h;break}h=c.transceivers[g];if(h){if(h.rejected)return e();var k=Object.keys(b.candidate).length>0?a.parseCandidate(b.candidate):{};if(k.protocol==="tcp"&&(k.port===0||k.port===9))return e();if(k.component&&k.component!==1)return e();if((g===0||g>0&&h.iceTransport!==c.transceivers[0].iceTransport)&&!i(h.iceTransport,k))return f(j("OperationError","Can not add ICE candidate"));h=b.candidate.trim();h.indexOf("a=")===0&&(h=h.substr(2));d=a.getMediaSections(c._remoteDescription.sdp);d[g]+="a="+(k.type?h:"end-of-candidates")+"\r\n";c._remoteDescription.sdp=a.getDescription(c._remoteDescription.sdp)+d.join("")}else return f(j("OperationError","Can not add ICE candidate"))}e()})};n.prototype.getStats=function(a){if(a&&a instanceof g.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw j("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map();a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};var o=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];o.forEach(function(a){a=g[a];if(a&&a.prototype&&a.prototype.getStats){var c=a.prototype.getStats;a.prototype.getStats=function(){return c.apply(this).then(function(a){var c=new Map();Object.keys(a).forEach(function(d){a[d].type=b(a[d]),c.set(d,a[d])});return c})}}});o=["createOffer","createAnswer"];o.forEach(function(a){var b=n.prototype[a];n.prototype[a]=function(){var a=arguments;return typeof a[0]==="function"||typeof a[1]==="function"?b.apply(this,[arguments[2]]).then(function(b){typeof a[0]==="function"&&a[0].apply(null,[b])},function(b){typeof a[1]==="function"&&a[1].apply(null,[b])}):b.apply(this,arguments)}});o=["setLocalDescription","setRemoteDescription","addIceCandidate"];o.forEach(function(a){var b=n.prototype[a];n.prototype[a]=function(){var a=arguments;return typeof a[1]==="function"||typeof a[2]==="function"?b.apply(this,arguments).then(function(){typeof a[1]==="function"&&a[1].apply(null)},function(b){typeof a[2]==="function"&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=n.prototype[a];n.prototype[a]=function(){var a=arguments;return typeof a[1]==="function"?b.apply(this,arguments).then(function(){typeof a[1]==="function"&&a[1].apply(null)}):b.apply(this,arguments)}});return n}}var j=!1;function k(){j||(j=!0,i());return h.exports}function c(a){switch(a){case void 0:return k()}}e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/oyybAxN87_l/
 */
__d("webrtc-adapter-6.4.8",["rtcpeerconnection-shim-1.2.15","sdp-2.9.0"],(function(a,b,c,d,e,f){"use strict";function c(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=c(b("rtcpeerconnection-shim-1.2.15")),h=c(b("sdp-2.9.0"));f={};var i={exports:f};function j(){var a=!0,b=!0;function c(a,b,c){a=a.match(b);return a&&a.length>=c&&parseInt(a[c],10)}function d(a,b,c){if(!a.RTCPeerConnection)return;a=a.RTCPeerConnection.prototype;var d=a.addEventListener;a.addEventListener=function(a,e){if(a!==b)return d.apply(this,arguments);var f=function(a){a=c(a);a&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=f;return d.apply(this,[a,f])};var e=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return e.apply(this,arguments);var d=this._eventMap[c];delete this._eventMap[c];return e.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]),a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}i.exports={extractVersion:c,wrapPeerConnectionEvent:d,disableLog:function(b){if(typeof b!=="boolean")return new Error("Argument type: "+typeof b+". Please use a boolean.");a=b;return b?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(a){if(typeof a!=="boolean")return new Error("Argument type: "+typeof a+". Please use a boolean.");b=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")},log:function(){if(typeof window==="object"){if(a)return;typeof console!=="undefined"&&typeof emptyFunction==="function"&&emptyFunction.apply(console,arguments)}},deprecated:function(a,c){if(!b)return},detectBrowser:function(a){var b=a&&a.navigator,d={};d.browser=null;d.version=null;if(typeof a==="undefined"||!a.navigator){d.browser="Not a browser.";return d}if(b.mozGetUserMedia)d.browser="firefox",d.version=c(b.userAgent,/Firefox\/(\d+)\./,1);else if(b.webkitGetUserMedia)d.browser="chrome",d.version=c(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/))d.browser="edge",d.version=c(b.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(a.RTCPeerConnection&&b.userAgent.match(/AppleWebKit\/(\d+)\./))d.browser="safari",d.version=c(b.userAgent,/AppleWebKit\/(\d+)\./,1);else{d.browser="Not a supported browser.";return d}return d}}}var k=!1;function l(){k||(k=!0,j());return i.exports}c={};var m={exports:c};function n(){var a=l(),b=a.log;m.exports=function(c){var d=a.detectBrowser(c),e=c&&c.navigator,f=function(a){if(typeof a!=="object"||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(c){if(c==="require"||c==="advanced"||c==="mediaSource")return;var d=typeof a[c]==="object"?a[c]:{ideal:a[c]};d.exact!==void 0&&typeof d.exact==="number"&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b};if(d.ideal!==void 0){b.optional=b.optional||[];var f={};typeof d.ideal==="number"?(f[e("min",c)]=d.ideal,b.optional.push(f),f={},f[e("max",c)]=d.ideal,b.optional.push(f)):(f[e("",c)]=d.ideal,b.optional.push(f))}d.exact!==void 0&&typeof d.exact!=="number"?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){d[a]!==void 0&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},g=function(a,c){if(d.version>=61)return c(a);a=JSON.parse(JSON.stringify(a));if(a&&typeof a.audio==="object"){var g=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a));g(a.audio,"autoGainControl","googAutoGainControl");g(a.audio,"noiseSuppression","googNoiseSuppression");a.audio=f(a.audio)}if(a&&typeof a.video==="object"){var h=a.video.facingMode;h=h&&(typeof h==="object"?h:{ideal:h});g=d.version<66;if(h&&(h.exact==="user"||h.exact==="environment"||h.ideal==="user"||h.ideal==="environment")&&!(e.mediaDevices.getSupportedConstraints&&e.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete a.video.facingMode;var i;h.exact==="environment"||h.ideal==="environment"?i=["back","rear"]:(h.exact==="user"||h.ideal==="user")&&(i=["front"]);if(i)return e.mediaDevices.enumerateDevices().then(function(d){d=d.filter(function(a){return a.kind==="videoinput"});var e=d.find(function(a){return i.some(function(b){return a.label.toLowerCase().indexOf(b)!==-1})});!e&&d.length&&i.indexOf("back")!==-1&&(e=d[d.length-1]);e&&(a.video.deviceId=h.exact?{exact:e.deviceId}:{ideal:e.deviceId});a.video=f(a.video);b("chrome: "+JSON.stringify(a));return c(a)})}a.video=f(a.video)}b("chrome: "+JSON.stringify(a));return c(a)},h=function(a){return d.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(a,b,c){g(a,function(a){e.webkitGetUserMedia(a,b,function(a){c&&c(h(a))})})};e.getUserMedia=i;var j=function(a){return new Promise(function(b,c){e.getUserMedia(a,b,c)})};e.mediaDevices||(e.mediaDevices={getUserMedia:j,enumerateDevices:function(){return new Promise(function(a){var b={audio:"audioinput",video:"videoinput"};return c.MediaStreamTrack.getSources(function(c){a(c.map(function(a){return{label:a.label,kind:b[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}});if(!e.mediaDevices.getUserMedia)e.mediaDevices.getUserMedia=function(a){return j(a)};else{var k=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(a){return g(a,function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length){b.getTracks().forEach(function(a){a.stop()});throw new DOMException("","NotFoundError")}return b},function(a){return Promise.reject(h(a))})})}}typeof e.mediaDevices.addEventListener==="undefined"&&(e.mediaDevices.addEventListener=function(){b("Dummy mediaDevices.addEventListener called.")});typeof e.mediaDevices.removeEventListener==="undefined"&&(e.mediaDevices.removeEventListener=function(){b("Dummy mediaDevices.removeEventListener called.")})}}var o=!1;function p(){o||(o=!0,n());return m.exports}b={};var q={exports:b};function r(){var a=l(),b=a.log;function c(a,b,d){if(!b||d.has(b.id))return;d.set(b.id,b);Object.keys(b).forEach(function(e){e.endsWith("Id")?c(a,a.get(b[e]),d):e.endsWith("Ids")&&b[e].forEach(function(b){c(a,a.get(b),d)})})}function d(a,b,d){var e=d?"outbound-rtp":"inbound-rtp",f=new Map();if(b===null)return f;var g=[];a.forEach(function(a){a.type==="track"&&a.trackIdentifier===b.id&&g.push(a)});g.forEach(function(b){a.forEach(function(d){d.type===e&&d.trackId===b.id&&c(a,d,f)})});return f}q.exports={shimGetUserMedia:p(),shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(b){if(typeof b==="object"&&b.RTCPeerConnection&&!("ontrack"in b.RTCPeerConnection.prototype)){Object.defineProperty(b.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var c=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;a._ontrackpoly||(a._ontrackpoly=function(c){c.stream.addEventListener("addtrack",function(d){var e;b.RTCPeerConnection.prototype.getReceivers?e=a.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):e={track:d.track};var f=new Event("track");f.track=d.track;f.receiver=e;f.transceiver={receiver:e};f.streams=[c.stream];a.dispatchEvent(f)}),c.stream.getTracks().forEach(function(d){var e;b.RTCPeerConnection.prototype.getReceivers?e=a.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):e={track:d};var f=new Event("track");f.track=d;f.receiver=e;f.transceiver={receiver:e};f.streams=[c.stream];a.dispatchEvent(f)})},a.addEventListener("addstream",a._ontrackpoly));return c.apply(a,arguments)}}else a.wrapPeerConnectionEvent(b,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a})},shimGetSendersWithDtmf:function(a){if(typeof a==="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){this._dtmf===void 0&&(b.kind==="audio"?this._dtmf=a.createDTMFSender(b):this._dtmf=null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var e=this,f=c.apply(e,arguments);f||(f=b(e,a),e._senders.push(f));return f};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;d.apply(b,arguments);var c=b._senders.indexOf(a);c!==-1&&b._senders.splice(c,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;c._senders=c._senders||[];e.apply(c,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._senders=b._senders||[];f.apply(b,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if(typeof a==="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var g=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=g.apply(a,[]);b.forEach(function(b){b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null);return this._dtmf}})}},shimSenderReceiverGetStats:function(b){if(!(typeof b==="object"&&b.RTCPeerConnection&&b.RTCRtpSender&&b.RTCRtpReceiver))return;if(!("getStats"in b.RTCRtpSender.prototype)){var c=b.RTCPeerConnection.prototype.getSenders;c&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(a,[]);b.forEach(function(b){b._pc=a});return b});var e=b.RTCPeerConnection.prototype.addTrack;e&&(b.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d(b,a.track,!0)})}}if(!("getStats"in b.RTCRtpReceiver.prototype)){var f=b.RTCPeerConnection.prototype.getReceivers;f&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=f.apply(a,[]);b.forEach(function(b){b._pc=a});return b});a.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d(b,a.track,!1)})}}if(!("getStats"in b.RTCRtpSender.prototype&&"getStats"in b.RTCRtpReceiver.prototype))return;var g=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(){var a=this;if(arguments.length>0&&arguments[0]instanceof b.MediaStreamTrack){var c=arguments[0],d,e,f;a.getSenders().forEach(function(a){a.track===c&&(d?f=!0:d=a)});a.getReceivers().forEach(function(a){a.track===c&&(e?f=!0:e=a);return a.track===c});if(f||d&&e)return Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError"));else if(d)return d.getStats();else if(e)return e.getStats();return Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return g.apply(a,arguments)}},shimSourceObject:function(a){var b=a&&a.URL;typeof a==="object"&&(a.HTMLMediaElement&&!("srcObject"in a.HTMLMediaElement.prototype)&&Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;this._srcObject=a;this.src&&b.revokeObjectURL(this.src);if(!a){this.src="";return void 0}this.src=b.createObjectURL(a);a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src),c.src=b.createObjectURL(a)});a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src),c.src=b.createObjectURL(a)})}}))},shimAddTrackRemoveTrackWithNative:function(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);!this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id]=[c,d]:this._shimmedLocalStreams[c.id].indexOf(d)===-1&&this._shimmedLocalStreams[c.id].push(d);return d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});if(c)throw new DOMException("Track already exists.","InvalidAccessError")});var d=b.getSenders();c.apply(this,arguments);var e=b.getSenders().filter(function(a){return d.indexOf(a)===-1});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);d!==-1&&b._shimmedLocalStreams[c].splice(d,1);b._shimmedLocalStreams[c].length===1&&delete b._shimmedLocalStreams[c]});return e.apply(this,arguments)}},shimAddTrackRemoveTrack:function(b){if(!b.RTCPeerConnection)return;var c=a.detectBrowser(b);if(b.RTCPeerConnection.prototype.addTrack&&c.version>=65)return this.shimAddTrackRemoveTrackWithNative(b);var d=b.RTCPeerConnection.prototype.getLocalStreams;b.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=d.apply(this);a._reverseStreams=a._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};var e=b.RTCPeerConnection.prototype.addStream;b.RTCPeerConnection.prototype.addStream=function(a){var c=this;c._streams=c._streams||{};c._reverseStreams=c._reverseStreams||{};a.getTracks().forEach(function(a){var b=c.getSenders().find(function(b){return b.track===a});if(b)throw new DOMException("Track already exists.","InvalidAccessError")});if(!c._reverseStreams[a.id]){var d=new b.MediaStream(a.getTracks());c._streams[a.id]=d;c._reverseStreams[d.id]=a;a=d}e.apply(c,[a])};var f=b.RTCPeerConnection.prototype.removeStream;b.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._streams=b._streams||{};b._reverseStreams=b._reverseStreams||{};f.apply(b,[b._streams[a.id]||a]);delete b._reverseStreams[b._streams[a.id]?b._streams[a.id].id:a.id];delete b._streams[a.id]};b.RTCPeerConnection.prototype.addTrack=function(a,c){var d=this;if(d.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(e.length!==1||!e[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var f=d.getSenders().find(function(b){return b.track===a});if(f)throw new DOMException("Track already exists.","InvalidAccessError");d._streams=d._streams||{};d._reverseStreams=d._reverseStreams||{};var g=d._streams[c.id];if(g)g.addTrack(a),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))});else{var h=new b.MediaStream([a]);d._streams[c.id]=h;d._reverseStreams[h.id]=c;d.addStream(h)}return d.getSenders().find(function(b){return b.track===a})};function g(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];var d=a._streams[b.id];c=c.replace(new RegExp(d.id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function h(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];var d=a._streams[b.id];c=c.replace(new RegExp(b.id,"g"),d.id)});return new RTCSessionDescription({type:b.type,sdp:c})}["createOffer","createAnswer"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){var a=this,b=arguments,d=arguments.length&&typeof arguments[0]==="function";return d?c.apply(a,[function(c){c=g(a,c);b[0].apply(null,[c])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):c.apply(a,arguments).then(function(b){return g(a,b)})}});var i=b.RTCPeerConnection.prototype.setLocalDescription;b.RTCPeerConnection.prototype.setLocalDescription=function(){var a=this;if(!arguments.length||!arguments[0].type)return i.apply(a,arguments);arguments[0]=h(a,arguments[0]);return i.apply(a,arguments)};var j=Object.getOwnPropertyDescriptor(b.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(b.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=this,b=j.get.apply(this);return b.type===""?b:g(a,b)}});b.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if(b.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var c=a._pc===b;if(!c)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");b._streams=b._streams||{};var d;Object.keys(b._streams).forEach(function(c){var e=b._streams[c].getTracks().find(function(b){return a.track===b});e&&(d=b._streams[c])});d&&(d.getTracks().length===1?b.removeStream(b._reverseStreams[d.id]):d.removeTrack(a.track),b.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(c){var d=a.detectBrowser(c);!c.RTCPeerConnection&&c.webkitRTCPeerConnection&&(c.RTCPeerConnection=function(a,d){b("PeerConnection");a&&a.iceTransportPolicy&&(a.iceTransports=a.iceTransportPolicy);return new c.webkitRTCPeerConnection(a,d)},c.RTCPeerConnection.prototype=c.webkitRTCPeerConnection.prototype,c.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(c.RTCPeerConnection,"generateCertificate",{get:function(){return c.webkitRTCPeerConnection.generateCertificate}}));if(!c.RTCPeerConnection)return;var e=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(a,b,c){var d=this,f=arguments;if(arguments.length>0&&typeof a==="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof arguments[0]!=="function"))return e.apply(this,[]);var g=function(a){var b={};a=a.result();a.forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},h=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};if(arguments.length>=2){var i=function(a){f[1](h(g(a)))};return e.apply(this,[i,arguments[0]])}return new Promise(function(a,b){e.apply(d,[function(b){a(h(g(b)))},b])}).then(b,c)};d.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a];c.RTCPeerConnection.prototype[a]=function(){var a=arguments,c=this,d=new Promise(function(d,e){b.apply(c,[a[0],d,e])});return a.length<2?d:d.then(function(){a[1].apply(null,[])},function(b){a.length>=3&&a[2].apply(null,[b])})}});d.version<52&&["createOffer","createAnswer"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a];c.RTCPeerConnection.prototype[a]=function(){var a=this;if(arguments.length<1||arguments.length===1&&typeof arguments[0]==="object"){var c=arguments.length===1?arguments[0]:void 0;return new Promise(function(d,e){b.apply(a,[d,e,c])})}return b.apply(this,arguments)}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a];c.RTCPeerConnection.prototype[a]=function(){arguments[0]=new(a==="addIceCandidate"?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]);return b.apply(this,arguments)}});var f=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){arguments[1]&&arguments[1].apply(null);return Promise.resolve()}return f.apply(this,arguments)}},fixNegotiationNeeded:function(b){a.wrapPeerConnectionEvent(b,"negotiationneeded",function(a){var b=a.target;if(b.signalingState!=="stable")return;return a})},shimGetDisplayMedia:function(b,c){if(!b.navigator||!b.navigator.mediaDevices||"getDisplayMedia"in b.navigator.mediaDevices)return;if(typeof c!=="function")return;b.navigator.mediaDevices.getDisplayMedia=function(a){return c(a).then(function(c){var d=a.video&&a.video.width,e=a.video&&a.video.height,f=a.video&&a.video.frameRate;a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c,maxFrameRate:f||3}};d&&(a.video.mandatory.maxWidth=d);e&&(a.video.mandatory.maxHeight=e);return b.navigator.mediaDevices.getUserMedia(a)})};b.navigator.getDisplayMedia=function(c){a.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia");return b.navigator.mediaDevices.getDisplayMedia(c)}}}}var s=!1;function t(){s||(s=!0,r());return q.exports}f={};var u={exports:f};function v(){var a=l();u.exports=function(b,c){var d=!1;b=JSON.parse(JSON.stringify(b));return b.filter(function(b){if(b&&(b.urls||b.url)){var e=b.urls||b.url;b.url&&!b.urls&&a.deprecated("RTCIceServer.url","RTCIceServer.urls");var f=typeof e==="string";f&&(e=[e]);e=e.filter(function(a){var b=a.indexOf("turn:")===0&&a.indexOf("transport=udp")!==-1&&a.indexOf("turn:[")===-1&&!d;if(b){d=!0;return!0}return a.indexOf("stun:")===0&&c>=14393&&a.indexOf("?transport=udp")===-1});delete b.url;b.urls=f?e[0]:e;return!!e.length}})}}var w=!1;function x(){w||(w=!0,v());return u.exports}c={};var y={exports:c};function z(){y.exports=function(a){a=a&&a.navigator;var b=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},c=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(a){return c(a)["catch"](function(a){return Promise.reject(b(a))})}}}var A=!1;function B(){A||(A=!0,z());return y.exports}b={};var C={exports:b};function D(){var a=l(),b=x(),c=g();C.exports={shimGetUserMedia:B(),shimPeerConnection:function(d){var e=a.detectBrowser(d);if(d.RTCIceGatherer){d.RTCIceCandidate||(d.RTCIceCandidate=function(a){return a});d.RTCSessionDescription||(d.RTCSessionDescription=function(a){return a});if(e.version<15025){var f=Object.getOwnPropertyDescriptor(d.MediaStreamTrack.prototype,"enabled");Object.defineProperty(d.MediaStreamTrack.prototype,"enabled",{set:function(a){f.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}}d.RTCRtpSender&&!("dtmf"in d.RTCRtpSender.prototype)&&Object.defineProperty(d.RTCRtpSender.prototype,"dtmf",{get:function(){this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new d.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null));return this._dtmf}});d.RTCDtmfSender&&!d.RTCDTMFSender&&(d.RTCDTMFSender=d.RTCDtmfSender);var g=c(d,e.version);d.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=b(a.iceServers));return new g(a)};d.RTCPeerConnection.prototype=g.prototype},shimReplaceTrack:function(a){a.RTCRtpSender&&!("replaceTrack"in a.RTCRtpSender.prototype)&&(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(b,c){if(!("getDisplayMedia"in b.navigator)||!b.navigator.mediaDevices||"getDisplayMedia"in b.navigator.mediaDevices)return;var d=b.navigator.getDisplayMedia;b.navigator.mediaDevices.getDisplayMedia=function(a){return d.call(b.navigator,a)};b.navigator.getDisplayMedia=function(c){a.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia");return d.call(b.navigator,c)}}}}var E=!1;function F(){E||(E=!0,D());return C.exports}f={};var G={exports:f};function H(){var a=l(),c=a.log;G.exports=function(d){var e=a.detectBrowser(d),f=d&&d.navigator;d=d&&d.MediaStreamTrack;var g=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},h=function(a,d,h){var i=function(c){if(typeof c!=="object"||c.require)return c;var a=[];Object.keys(c).forEach(function(b){if(b==="require"||b==="advanced"||b==="mediaSource")return;var d=c[b]=typeof c[b]==="object"?c[b]:{ideal:c[b]};(d.min!==void 0||d.max!==void 0||d.exact!==void 0)&&a.push(b);d.exact!==void 0&&(typeof d.exact==="number"?d.min=d.max=d.exact:c[b]=d.exact,delete d.exact);if(d.ideal!==void 0){c.advanced=c.advanced||[];var e={};typeof d.ideal==="number"?e[b]={min:d.ideal,max:d.ideal}:e[b]=d.ideal;c.advanced.push(e);delete d.ideal;Object.keys(d).length||delete c[b]}});a.length&&(c.require=a);return c};a=JSON.parse(JSON.stringify(a));e.version<38&&(c("spec: "+JSON.stringify(a)),a.audio&&(a.audio=i(a.audio)),a.video&&(a.video=i(a.video)),c("ff37: "+JSON.stringify(a)));return f.mozGetUserMedia(a,d,function(a){h(g(a))})},i=function(a){return new Promise(function(b,c){h(a,b,c)})};f.mediaDevices||(f.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}});f.mediaDevices.enumerateDevices=f.mediaDevices.enumerateDevices||function(){return new Promise(function(a){var b=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];a(b)})};if(e.version<41){var j=f.mediaDevices.enumerateDevices.bind(f.mediaDevices);f.mediaDevices.enumerateDevices=function(){return j().then(void 0,function(a){if(a.name==="NotFoundError")return[];throw a})}}if(e.version<49){var k=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length){b.getTracks().forEach(function(a){a.stop()});throw new DOMException("The object can not be found here.","NotFoundError")}return b},function(a){return Promise.reject(g(a))})}}if(!(e.version>55&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var l=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},m=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){typeof a==="object"&&typeof a.audio==="object"&&(a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","mozAutoGainControl"),l(a.audio,"noiseSuppression","mozNoiseSuppression"));return m(a)};if(d&&d.prototype.getSettings){var n=d.prototype.getSettings;d.prototype.getSettings=function(){var a=n.apply(this,arguments);l(a,"mozAutoGainControl","autoGainControl");l(a,"mozNoiseSuppression","noiseSuppression");return a}}if(d&&d.prototype.applyConstraints){var o=d.prototype.applyConstraints;d.prototype.applyConstraints=function(a){this.kind==="audio"&&typeof a==="object"&&(a=JSON.parse(JSON.stringify(a)),l(a,"autoGainControl","mozAutoGainControl"),l(a,"noiseSuppression","mozNoiseSuppression"));return o.apply(this,[a])}}}f.getUserMedia=function(b,c,d){if(e.version<44)return h(b,c,d);a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");f.mediaDevices.getUserMedia(b).then(c,d)}}}var I=!1;function J(){I||(I=!0,H());return G.exports}c={};var K={exports:c};function L(){var a=l();K.exports={shimGetUserMedia:J(),shimOnTrack:function(a){typeof a==="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)&&Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=a),this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b;c.receiver={track:b};c.transceiver={receiver:c.receiver};c.streams=[a.stream];this.dispatchEvent(c)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),typeof a==="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(a){typeof a==="object"&&(a.HTMLMediaElement&&!("srcObject"in a.HTMLMediaElement.prototype)&&Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(b){var c=a.detectBrowser(b);if(typeof b!=="object"||!(b.RTCPeerConnection||b.mozRTCPeerConnection))return;b.RTCPeerConnection||(b.RTCPeerConnection=function(a,d){if(c.version<38&&(a&&a.iceServers)){var e=[];for(var f=0;f<a.iceServers.length;f++){var g=a.iceServers[f];if(g.hasOwnProperty("urls"))for(var h=0;h<g.urls.length;h++){var i={url:g.urls[h]};g.urls[h].indexOf("turn")===0&&(i.username=g.username,i.credential=g.credential);e.push(i)}else e.push(a.iceServers[f])}a.iceServers=e}return new b.mozRTCPeerConnection(a,d)},b.RTCPeerConnection.prototype=b.mozRTCPeerConnection.prototype,b.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return b.mozRTCPeerConnection.generateCertificate}}),b.RTCSessionDescription=b.mozRTCSessionDescription,b.RTCIceCandidate=b.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){arguments[0]=new(a==="addIceCandidate"?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)}});var d=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){arguments[1]&&arguments[1].apply(null);return Promise.resolve()}return d.apply(this,arguments)};var e=function(a){var b=new Map();Object.keys(a).forEach(function(c){b.set(c,a[c]),b[c]=a[c]});return b},f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(a,b,d){return g.apply(this,[a||null]).then(function(a){c.version<48&&(a=e(a));if(c.version<53&&!b)try{a.forEach(function(a){a.type=f[a.type]||a.type})}catch(b){if(b.name!=="TypeError")throw b;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:f[b.type]||b.type}))})}return a}).then(b,d)}},shimSenderGetStats:function(a){if(!(typeof a==="object"&&a.RTCPeerConnection&&a.RTCRtpSender))return;if(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=b.apply(a,[]);c.forEach(function(b){b._pc=a});return c});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map())}},shimReceiverGetStats:function(b){if(!(typeof b==="object"&&b.RTCPeerConnection&&b.RTCRtpSender))return;if(b.RTCRtpSender&&"getStats"in b.RTCRtpReceiver.prototype)return;var c=b.RTCPeerConnection.prototype.getReceivers;c&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=c.apply(a,[]);b.forEach(function(b){b._pc=a});return b});a.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},shimRemoveStream:function(b){if(!b.RTCPeerConnection||"removeStream"in b.RTCPeerConnection.prototype)return;b.RTCPeerConnection.prototype.removeStream=function(b){var c=this;a.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(a){a.track&&b.getTracks().indexOf(a.track)!==-1&&c.removeTrack(a)})}},shimRTCDataChannel:function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)},shimGetDisplayMedia:function(b,c){if(!b.navigator||!b.navigator.mediaDevices||"getDisplayMedia"in b.navigator.mediaDevices)return;b.navigator.mediaDevices.getDisplayMedia=function(a){if(!(a&&a.video)){var d=new DOMException("getDisplayMedia without video constraints is undefined");d.name="NotFoundError";d.code=8;return Promise.reject(d)}a.video===!0?a.video={mediaSource:c}:a.video.mediaSource=c;return b.navigator.mediaDevices.getUserMedia(a)};b.navigator.getDisplayMedia=function(c){a.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia");return b.navigator.mediaDevices.getDisplayMedia(c)}}}}var M=!1;function N(){M||(M=!0,L());return K.exports}b={};var O={exports:b};function P(){var a=l();O.exports={shimLocalStreamsAPI:function(a){if(typeof a!=="object"||!a.RTCPeerConnection)return;"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=function(a){var b=null;this._localStreams&&this._localStreams.forEach(function(c){c.id===a&&(b=c)});this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)});return b});if(!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]);this._localStreams.indexOf(a)===-1&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(d){b.call(c,d,a)})};a.RTCPeerConnection.prototype.addTrack=function(a,c){c&&(!this._localStreams?this._localStreams=[c]:this._localStreams.indexOf(c)===-1&&this._localStreams.push(c));return b.call(this,a,c)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(b===-1)return;this._localStreams.splice(b,1);var c=this,d=a.getTracks();this.getSenders().forEach(function(a){d.indexOf(a.track)!==-1&&c.removeTrack(a)})})},shimRemoteStreamsAPI:function(a){if(typeof a!=="object"||!a.RTCPeerConnection)return;"getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream),this.addEventListener("addstream",this._onaddstream=a)}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(a._remoteStreams.indexOf(b)>=0)return;a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)})});return b.apply(a,arguments)}}},shimCallbacksAPI:function(a){if(typeof a!=="object"||!a.RTCPeerConnection)return;a=a.RTCPeerConnection.prototype;var b=a.createOffer,c=a.createAnswer,d=a.setLocalDescription,e=a.setRemoteDescription,f=a.addIceCandidate;a.createOffer=function(a,c){var d=arguments.length>=2?arguments[2]:arguments[0],e=b.apply(this,[d]);if(!c)return e;e.then(a,c);return Promise.resolve()};a.createAnswer=function(a,b){var d=arguments.length>=2?arguments[2]:arguments[0],e=c.apply(this,[d]);if(!b)return e;e.then(a,b);return Promise.resolve()};var g=function(a,b,c){a=d.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setLocalDescription=g;g=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setRemoteDescription=g;g=function(a,b,c){a=f.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=g},shimGetUserMedia:function(a){var b=a&&a.navigator;b.getUserMedia||(b.webkitGetUserMedia?b.getUserMedia=b.webkitGetUserMedia.bind(b):b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,c,d){b.mediaDevices.getUserMedia(a).then(c,d)}.bind(b)))},shimRTCIceServerUrls:function(b){var c=b.RTCPeerConnection;b.RTCPeerConnection=function(b,d){if(b&&b.iceServers){var e=[];for(var f=0;f<b.iceServers.length;f++){var g=b.iceServers[f];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(a.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,e.push(g)):e.push(b.iceServers[f])}b.iceServers=e}return new c(b,d)};b.RTCPeerConnection.prototype=c.prototype;"generateCertificate"in b.RTCPeerConnection&&Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return c.generateCertificate}})},shimTrackEventTransceiver:function(a){typeof a==="object"&&a.RTCPeerConnection&&"receiver"in a.RTCTrackEvent.prototype&&!a.RTCTransceiver&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){var c=this;if(a){typeof a.offerToReceiveAudio!=="undefined"&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=c.getTransceivers().find(function(a){return a.sender.track&&a.sender.track.kind==="audio"});a.offerToReceiveAudio===!1&&d?d.direction==="sendrecv"?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":d.direction==="recvonly"&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):a.offerToReceiveAudio===!0&&!d&&c.addTransceiver("audio");typeof a.offerToReceiveVideo!=="undefined"&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);var e=c.getTransceivers().find(function(a){return a.sender.track&&a.sender.track.kind==="video"});a.offerToReceiveVideo===!1&&e?e.direction==="sendrecv"?e.setDirection("sendonly"):e.direction==="recvonly"&&e.setDirection("inactive"):a.offerToReceiveVideo===!0&&!e&&c.addTransceiver("video")}return b.apply(c,arguments)}}}}var Q=!1;function R(){Q||(Q=!0,P());return O.exports}f={};var S={exports:f};function T(){var a=h(),b=l();S.exports={shimRTCIceCandidate:function(c){if(!c.RTCIceCandidate||c.RTCIceCandidate&&"foundation"in c.RTCIceCandidate.prototype)return;var d=c.RTCIceCandidate;c.RTCIceCandidate=function(b){typeof b==="object"&&b.candidate&&b.candidate.indexOf("a=")===0&&(b=JSON.parse(JSON.stringify(b)),b.candidate=b.candidate.substr(2));if(b.candidate&&b.candidate.length){var c=new d(b),e=a.parseCandidate(b.candidate),f=Object.assign(c,e);f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}};return f}return new d(b)};c.RTCIceCandidate.prototype=d.prototype;b.wrapPeerConnectionEvent(c,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new c.RTCIceCandidate(a.candidate),writable:"false"});return a})},shimCreateObjectURL:function(a){var c=a&&a.URL;if(!(typeof a==="object"&&a.HTMLMediaElement&&"srcObject"in a.HTMLMediaElement.prototype&&c.createObjectURL&&c.revokeObjectURL))return void 0;var d=c.createObjectURL.bind(c),e=c.revokeObjectURL.bind(c),f=new Map(),g=0;c.createObjectURL=function(a){if("getTracks"in a){var c="polyblob:"+ ++g;f.set(c,a);b.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return c}return d(a)};c.revokeObjectURL=function(a){e(a),f["delete"](a)};var h=Object.getOwnPropertyDescriptor(a.HTMLMediaElement.prototype,"src");Object.defineProperty(a.HTMLMediaElement.prototype,"src",{get:function(){return h.get.apply(this)},set:function(a){this.srcObject=f.get(a)||null;return h.set.apply(this,[a])}});var i=a.HTMLMediaElement.prototype.setAttribute;a.HTMLMediaElement.prototype.setAttribute=function(){arguments.length===2&&(""+arguments[0]).toLowerCase()==="src"&&(this.srcObject=f.get(arguments[1])||null);return i.apply(this,arguments)}},shimMaxMessageSize:function(c){if(c.RTCSctpTransport||!c.RTCPeerConnection)return;var d=b.detectBrowser(c);"sctp"in c.RTCPeerConnection.prototype||Object.defineProperty(c.RTCPeerConnection.prototype,"sctp",{get:function(){return typeof this._sctp==="undefined"?null:this._sctp}});var e=function(b){b=a.splitSections(b.sdp);b.shift();return b.some(function(b){b=a.parseMLine(b);return b&&b.kind==="application"&&b.protocol.indexOf("SCTP")!==-1})},f=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(a===null||a.length<2)return-1;a=parseInt(a[1],10);return a!==a?-1:a},g=function(a){var b=65536;d.browser==="firefox"&&(d.version<57?a===-1?b=16384:b=2147483637:d.version<60?b=d.version===57?65535:65536:b=2147483637);return b},h=function(b,c){var e=65536;d.browser==="firefox"&&d.version===57&&(e=65535);b=a.matchPrefix(b.sdp,"a=max-message-size:");b.length>0?e=parseInt(b[0].substr(19),10):d.browser==="firefox"&&c!==-1&&(e=2147483637);return e},i=c.RTCPeerConnection.prototype.setRemoteDescription;c.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;a._sctp=null;if(e(arguments[0])){var b=f(arguments[0]),c=g(b),d=h(arguments[0],b),j;c===0&&d===0?j=Number.POSITIVE_INFINITY:c===0||d===0?j=Math.max(c,d):j=Math.min(c,d);var k={};Object.defineProperty(k,"maxMessageSize",{get:function(){return j}});a._sctp=k}return i.apply(a,arguments)}},shimSendThrowTypeError:function(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function c(a,b){var c=a.send;a.send=function(){var d=arguments[0],e=d.length||d.size||d.byteLength;if(a.readyState==="open"&&b.sctp&&e>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}var d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=this,b=d.apply(a,arguments);c(b,a);return b};b.wrapPeerConnectionEvent(a,"datachannel",function(a){c(a.channel,a.target);return a})}}}var U=!1;function V(){U||(U=!0,T());return S.exports}c={};var W={exports:c};function X(){var a=l();W.exports=function(b,c){b=b&&b.window;var d={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var e in c)hasOwnProperty.call(c,e)&&(d[e]=c[e]);c=a.log;var f=a.detectBrowser(b),g=t()||null,h=F()||null,i=N()||null,j=R()||null,k=V()||null,l={browserDetails:f,commonShim:k,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(f.browser){case"chrome":if(!g||!g.shimPeerConnection||!d.shimChrome){c("Chrome shim is not included in this adapter release.");return l}c("adapter.js shimming chrome.");l.browserShim=g;k.shimCreateObjectURL(b);g.shimGetUserMedia(b);g.shimMediaStream(b);g.shimSourceObject(b);g.shimPeerConnection(b);g.shimOnTrack(b);g.shimAddTrackRemoveTrack(b);g.shimGetSendersWithDtmf(b);g.shimSenderReceiverGetStats(b);g.fixNegotiationNeeded(b);k.shimRTCIceCandidate(b);k.shimMaxMessageSize(b);k.shimSendThrowTypeError(b);break;case"firefox":if(!i||!i.shimPeerConnection||!d.shimFirefox){c("Firefox shim is not included in this adapter release.");return l}c("adapter.js shimming firefox.");l.browserShim=i;k.shimCreateObjectURL(b);i.shimGetUserMedia(b);i.shimSourceObject(b);i.shimPeerConnection(b);i.shimOnTrack(b);i.shimRemoveStream(b);i.shimSenderGetStats(b);i.shimReceiverGetStats(b);i.shimRTCDataChannel(b);k.shimRTCIceCandidate(b);k.shimMaxMessageSize(b);k.shimSendThrowTypeError(b);break;case"edge":if(!h||!h.shimPeerConnection||!d.shimEdge){c("MS edge shim is not included in this adapter release.");return l}c("adapter.js shimming edge.");l.browserShim=h;k.shimCreateObjectURL(b);h.shimGetUserMedia(b);h.shimPeerConnection(b);h.shimReplaceTrack(b);h.shimGetDisplayMedia(b);k.shimMaxMessageSize(b);k.shimSendThrowTypeError(b);break;case"safari":if(!j||!d.shimSafari){c("Safari shim is not included in this adapter release.");return l}c("adapter.js shimming safari.");l.browserShim=j;k.shimCreateObjectURL(b);j.shimRTCIceServerUrls(b);j.shimCreateOfferLegacy(b);j.shimCallbacksAPI(b);j.shimLocalStreamsAPI(b);j.shimRemoteStreamsAPI(b);j.shimTrackEventTransceiver(b);j.shimGetUserMedia(b);k.shimRTCIceCandidate(b);k.shimMaxMessageSize(b);k.shimSendThrowTypeError(b);break;default:c("Unsupported browser!");break}return l}}var Y=!1;function aa(){Y||(Y=!0,X());return W.exports}b={};var Z={exports:b};function ba(){var b=aa();Z.exports=b({window:a.window})}var $=!1;function ca(){$||($=!0,ba());return Z.exports}function d(a){switch(a){case void 0:return ca()}}e.exports=d}),null);
__d("webrtc-adapter",["webrtc-adapter-6.4.8"],(function(a,b,c,d,e,f){e.exports=b("webrtc-adapter-6.4.8")()}),null);
__d("ScotchRTCMediaDevices",["invariant","Promise","FBLogger","ScotchRTCOnDeviceChangePoller","webrtc-adapter"],(function(a,b,c,d,e,f,g){"use strict";var h=1e3,i;a={addEventListener:function(a,c){if(a==="devicechange"&&b("ScotchRTCOnDeviceChangePoller").isNeeded()){i||(i=new(b("ScotchRTCOnDeviceChangePoller"))(h));i.add(c);return}var d=navigator;d=d.mediaDevices;d&&"addEventListener"in d&&d.addEventListener(a,c)},removeEventListener:function(a,c){if(a==="devicechange"&&b("ScotchRTCOnDeviceChangePoller").isNeeded()){i&&i.remove(c);return}var d=navigator;d=d.mediaDevices;d&&"removeEventListener"in d&&d.removeEventListener(a,c)},isSupported:function(a){return!0},enumerateDevices:function(){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");if(k()){navigator.mediaDevices||g(0,4492);return b("Promise").resolve(navigator.mediaDevices.enumerateDevices())}else if(l())return new(b("Promise"))(function(a){return window.MediaStreamTrack.getSources(a)}).then(j);return b("Promise").reject(new Error("enumerateDevices() not supported"))},filterDevicesOfKind:function(a,b){return a.filter(function(a){return a.kind===b})}};function j(a){return a.map(function(a){var b=a.id,c=a.kind;a=a.label;return{deviceId:b,groupId:"",kind:c==="video"?"videoinput":"audioinput",label:a}})}function k(){return navigator.mediaDevices!=null&&typeof navigator.mediaDevices.enumerateDevices==="function"}function l(){return window.MediaStreamTrack!=null&&typeof window.MediaStreamTrack.getSources==="function"}e.exports=a}),null);
__d("ScotchRTCOnDeviceChangePoller",["Promise","FBRTCLogger","ScotchRTCMediaDevices"],(function(a,b,c,d,e,f){a=function(){"use strict";a.isNeeded=function(){var a=navigator;a=a.mediaDevices;return!b("ScotchRTCMediaDevices").isSupported("enumerateDevices")||a&&"ondevicechange"in a?!1:!0};function a(a){var c=this;this.$1=[];this.$2="";this.$4=null;this.$7=function(){b("ScotchRTCMediaDevices").enumerateDevices().then(function(a){a=a.map(function(a){return a.deviceId+":"+a.label+":"+a.groupId}).sort().join("~");if(a===c.$2)return;c.$2=a;for(var a=c.$1,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;try{e()}catch(a){}}})["catch"](function(a){return b("Promise").resolve()}).then(function(){c.$4=window.setTimeout(c.$7,c.$3)})["catch"](function(a){})};this.$3=a}var c=a.prototype;c.add=function(a){this.$1.push(a),this.$5()};c.remove=function(a){this.$1=this.$1.filter(function(b){return b!==a}),this.$6()};c.$5=function(){if(this.$4!==null)return;this.$4=window.setTimeout(this.$7,0)};c.$6=function(){if(this.$1.length>0)return;this.$4!==null&&(window.clearTimeout(this.$4),this.$4=null)};return a}();e.exports=a}),null);
__d("ScotchRTCVideoTrackActivityDetector",["invariant","Promise","MediaStream","assignMediaStream"],(function(a,b,c,d,e,f,g){"use strict";var h="video track playback timeout",i="unexpected video track ready state",j='wrong track type, expected "video"';a={PLAYBACK_TIMEOUT_ERROR:h,WRONG_READY_STATE_ERROR:i,WRONG_TRACK_TYPE_ERROR:j,detect:function(a,c){if("kind"in a&&a.kind!=="video")return b("Promise").reject(new Error(j));var d=document.createElement("video");d.muted=!0;var e=new(b("MediaStream"))();e.addTrack(a);var f,k=null,l=function(){window.clearInterval(k),d&&(d.pause(),b("assignMediaStream")(d,null),d.removeEventListener("timeupdate",f),d=null),e&&(e.removeTrack(a),e=null)};return b("Promise").race([new(b("Promise"))(function(c,h){d!=null||g(0,5995),b("assignMediaStream")(d,e),f=function(b){d!=null||g(0,5995),d.currentTime>0&&(a.readyState==="live"?(c(),l()):h(new Error(i)))},b("Promise").resolve(d.pause()).then(function(){d!=null||g(0,5995);return d.play()}).then(function(){f(),d!=null||g(0,5995),d.addEventListener("timeupdate",f),k=window.setInterval(f,50)})["catch"](function(a){return h(a)})}),new(b("Promise"))(function(a){return window.setTimeout(a,c)}).then(function(){throw new Error(h)})])["catch"](function(a){l();throw a})}};e.exports=a}),null);
__d("ScotchRTCMediaStreamValidator",["Promise","ScotchRTCAudioTrackNoiseDetector","ScotchRTCVideoTrackActivityDetector"],(function(a,b,c,d,e,f){"use strict";var g="no audio tracks",h="no video tracks",i="too many audio tracks",j="too many video tracks",k="unexpected audio track(s)",l="unexpected video track(s)";a={NO_AUDIO_TRACKS_ERROR:g,NO_VIDEO_TRACKS_ERROR:h,TOO_MANY_AUDIO_TRACKS_ERROR:i,TOO_MANY_VIDEO_TRACKS_ERROR:j,UNEXPECTED_AUDIO_TRACKS_ERROR:k,UNEXPECTED_VIDEO_TRACKS_ERROR:l,validate:function(a,c,d,e){d===void 0&&(d={});e===void 0&&(e={});d=d;var f=d.audio;f=f===void 0?!0:f;d=d.video;d=d===void 0?!0:d;e=e;var g=e.audio;g=g===void 0?1e3:g;e=e.video;e=e===void 0?1e3:e;return b("Promise").all([m(a,c,f,g),n(a,c,d,e)]).then(function(){return a})}};function m(a,c,d,e){var f=a.getAudioTracks();if(!c.audio)return f.length>0?b("Promise").reject(new Error(k)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(g));else if(f.length>1)return b("Promise").reject(new Error(i));return d?b("ScotchRTCAudioTrackNoiseDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}function n(a,c,d,e){var f=a.getVideoTracks();if(!c.video)return f.length>0?b("Promise").reject(new Error(l)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(h));else if(f.length>1)return b("Promise").reject(new Error(j));return d?b("ScotchRTCVideoTrackActivityDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}e.exports=a}),null);
__d("ScotchRTCUserMediaConstraints",["FBRTCConstants","FBRTCSupport","RTCConfig"],(function(a,b,c,d,e,f){"use strict";a=b("FBRTCConstants").RTCConstraints;var g=b("FBRTCConstants").VideoQuality,h={width:a.FHD_WIDTH,height:a.FHD_HEIGHT,frameRate:a.FRAME_RATE},i={width:a.HD_WIDTH,height:a.HD_HEIGHT,frameRate:a.FRAME_RATE},j={width:a.SD_WIDTH,height:a.SD_HEIGHT,frameRate:a.FRAME_RATE},k={width:a.LQ_WIDTH,height:a.LQ_HEIGHT,frameRate:a.LQ_FRAME_RATE},l={audio:function(a){return a?{deviceId:{exact:a}}:!0},video:function(a,c,d){d===void 0&&(d=b("RTCConfig").CollaborationCallQuality.videoToRoom);c=c?{deviceId:{exact:c}}:null;if(a===g.CUSTOM_VIDEO)return babelHelpers["extends"]({},d,c);if(b("FBRTCSupport").isMobileDevice())return{facingMode:{ideal:"user"}};d=n(a);a=m(a)?k:p(d);return babelHelpers["extends"]({width:o(d,"width",a),height:o(d,"height",a),frameRate:o(d,"frameRate",{frameRate:10})},c)},chromeMediaSource:function(a,b){a=a.video;a=l.chromify(a);if(typeof a!=="object")return{audio:!1,video:Boolean(a)};var c=a.mandatory;a=a.optional;a=a===void 0?[]:a;return{audio:!1,video:{mandatory:babelHelpers["extends"]({},c,{chromeMediaSource:"desktop",chromeMediaSourceId:b}),optional:[{googTemporalLayeredScreencast:!0}].concat(a)}}},chromify:function(a,b){if(!a||typeof a!=="object")return Boolean(a);if(!s(a))return a;b=b?b.optionalConstraintsOnly:!1;var c=a.mandatory;c=c===void 0?{}:c;var d=a.optional;d=d===void 0?[]:d;var e=Object.entries(a);for(var f=0;f<e.length;f++){var g=e[f],h=g[0];g=g[1];if(h==="require"||h==="advanced"||h==="mediaSource")continue;g=g&&typeof g==="object"?g:{ideal:g};Number.isFinite(g.exact)&&(g.min=g.exact,g.max=g.exact);var i=g.ideal,j=g.exact;if(i!==void 0)if(Number.isFinite(i)){var k;d.push((k={},k[r(h,"min")]=i,k),(k={},k[r(h,"max")]=i,k))}else{d.push((k={},k[r(h)]=i,k))}if(!b)if(j!==void 0&&!Number.isFinite(j))c[r(h)]=j;else{i=["min","max"];for(var k=0;k<i.length;k++){j=i[k];Number.isFinite(g[j])&&(c[r(h,j)]=g[j])}}}a.advanced&&d.push.apply(d,a.advanced);j={};Object.keys(c).length>0?j.mandatory=c:b&&(j.mandatory={});d.length>0&&(j.optional=d);return j}};function m(a){return a===g.HD_IDEAL_LQ_REQUIRED_VIDEO||a===g.FHD_IDEAL_LQ_REQUIRED_VIDEO}function n(a){switch(a){case g.FHD_VIDEO:case g.FHD_IDEAL_LQ_REQUIRED_VIDEO:return h;case g.HD_VIDEO:case g.HD_IDEAL_LQ_REQUIRED_VIDEO:return i;case g.LQ_VIDEO:return k;case g.SD_VIDEO:return j;default:return i}}function o(a,b,c){c===void 0&&(c=p(a));var d=a[b];return{min:Math.min(c[b],d),max:Math.max(q(a)[b],d),ideal:d}}function p(a){switch(a){case h:return i;case i:return j;case j:case k:default:return k}}function q(a){switch(a){case k:return j;case j:return i;case i:case h:default:return h}}function r(b,a){return a?""+a+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b}function s(a){return Object.keys(a).some(function(a){return a!=="mandatory"&&a!=="optional"})}e.exports=l}),null);
__d("ScotchgenerateRTCTransactionID",["randomInt"],(function(a,b,c,d,e,f){"use strict";function a(){return String(b("randomInt")(0,4294967294)+1)}e.exports=a}),null);
__d("ZenonWebRTCWrapper",["invariant","regeneratorRuntime","requireCond","FBLogger","cr:1284813","performanceNow","webrtc-adapter"],(function(a,b,c,d,e,f,g){"use strict";var h;a={getUserMedia:function(a){var c,d,e,f;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");c=navigator,d=c.mediaDevices;d!=null||g(0,14422);e=(h||(h=b("performanceNow")))();i.next=6;return b("regeneratorRuntime").awrap(d.getUserMedia(a));case 6:f=i.sent;b("cr:1284813")&&b("cr:1284813").measureModern("getUserMedia",{end:(h||(h=b("performanceNow")))(),start:e});return i.abrupt("return",f);case 9:case"end":return i.stop()}},null,this)}};e.exports=a}),null);
__d("ScotchRTCUtils",["invariant","Promise","CurrentUser","FBLogger","FBRTCConfig","FBRTCLogger","RTCConfig","RTCUser","ScotchFBRTCUtils","ScotchgenerateRTCTransactionID","ScotchRTCAudioTrackNoiseDetector","ScotchRTCEndCallReason","ScotchRTCMediaDevices","ScotchRTCMediaStreamValidator","ScotchRTCScreenSharing","ScotchRTCUserMediaConstraints","ScotchRTCVideoTrackActivityDetector","ScotchRTWebClientFeatureGating","ScotchRTWebUserActionLogger","URI","UserAgent","ZenonWebRTCWrapper","webrtc-adapter"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("ScotchRTCAudioTrackNoiseDetector").DATA_TIMEOUT_ERROR,j=b("ScotchRTCVideoTrackActivityDetector").PLAYBACK_TIMEOUT_ERROR,k=0,l={isGroupCall:function(a){return a.split(":")[0]==="GROUP"},isMessengerCall:function(a){return a.split(":")[0]==="MESSENGER"},isRoomCall:function(a){return a.split(":")[0]==="ROOM"},isPeerCall:function(a){return a.split(":")[0]==="PEER"},isAlohaCall:function(a){return a.split(":")[0]==="ALOHA"},isWatchPartyCall:function(a){return a.split(":")[0]==="WATCH"},isSupportedMWCall:function(a){return l.isGroupCall(a)||l.isMessengerCall(a)||l.isRoomCall(a)||l.isAlohaCall(a)||l.isWatchPartyCall(a)},getPeerID:function(a){if(l.isGroupCall(a))throw new Error("Not a P2P call: "+a);a=a.split(":");a=a.slice(1);return a[0]===b("CurrentUser").getID()?a[1]:a[0]},getMessengerCallID:function(a){if(!l.isMessengerCall(a))throw new Error("Not a Messenger call: "+a);return Number(a.split(":")[1])},getThreadID:function(a){return!l.isGroupCall(a)?null:Number(a.split(":")[1])},getSandboxingTierFromURIOrEmpty:function(a,b){b=b+"=";a=a.split(b);if(a[1]){b=a.pop().split("&").shift();return b}return""},_addDevTierOverridesToHeaderExtensions:function(a){if(!b("ScotchRTWebClientFeatureGating").canUseMultiwaySandbox())return a;var c=window.location.href,d=l.getSandboxingTierFromURIOrEmpty(c,"multiway_www_tier");c=l.getSandboxingTierFromURIOrEmpty(c,"multiway_core_tier");d&&(a.multiwayWwwTier=d);c&&(a.multiwayCoreTier=c);return a},createRequestHeader:function(a,c,d,e,f){a={type:a,transactionId:b("ScotchgenerateRTCTransactionID")(),retryCount:0,conferenceName:c,clientSessionId:e?e:"",sequenceNumber:k++};c={};d&&(a.serverInfoData=d);f&&(c.esc_p2p_call_id=f);c=l._addDevTierOverridesToHeaderExtensions(c);a.extensions=c;return a},createClientContextMessage:function(a,b){a={num_participants:a,trigger:b};b={header:{topic_DEPRECATED:"client_context",shouldSendToAllUsers:!1},body:{genericMessage:{topic:"client_context",data:JSON.stringify(a)}}};return b},createResponseHeader:function(a,c,d){c={type:a.type,transactionId:a.transactionId,retryCount:0,conferenceName:a.conferenceName,responseStatusCode:c,clientSessionId:d?d:""};a.serverInfoData&&(c.serverInfoData=a.serverInfoData);b("ScotchRTWebClientFeatureGating").canUseMultiwaySandbox()&&(c.extensions=l._addDevTierOverridesToHeaderExtensions({}));return c},maybeRemoveVideoConstraint:function(a){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");return b("ScotchRTCMediaDevices").enumerateDevices().then(function(c){if(c.some(function(a){return a.kind==="videoinput"})){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[maybeRemoveVideoConstraint] At least one device has videoinput.  Keeping constraints "+JSON.stringify(a)});return a}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[maybeRemoveVideoConstraint] No devices capable of videoinput.",errorDomain:"GetUserMedia",errorType:"Removing video stream by setting video constraint to false."});return babelHelpers["extends"]({},a,{video:!1})})["catch"](function(){return b("Promise").resolve(a)})},getUserMediaWithAudioFallback:function(a,c){return a.video?l.maybeRemoveVideoConstraint(a).then(function(a){return l.getUserMedia(a,c)})["catch"](function(c){if(a.video){if(c.name==="NotFoundError"||c.name==="StreamFailedToStart"){var d="Audio Fallback Error Recovery: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Retrying getUserMedia with no video stream",errorDomain:"GetUserMedia",errorType:d});return l.getUserMedia({video:!1,audio:a.audio})}if(c.name==="OverconstrainedError"){d="Video Constraints Error Recovery: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Retrying getUserMedia with no video constraints",errorDomain:"GetUserMedia",errorType:d});return l.getUserMedia({video:!0,audio:a.audio})}}d="Error: "+JSON.stringify(c)+" constraints: "+JSON.stringify(a);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithAudioFallback] Throwing other error",errorDomain:"GetUserMedia",errorType:d});throw c}):l.getUserMedia(a,c)},getUserMediaWithFallbackToEmptyVideoConstraints:function(a,c){return l.getUserMedia(a,c)["catch"](function(c){if(a.video&&c.name==="OverconstrainedError"){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[getUserMediaWithFallbackToEmptyVideoConstraints] Fallback getUserMedia with no video constraints",errorDomain:"GetUserMedia",errorType:"Original Constraints: "+JSON.stringify(a)});return l.getUserMedia(babelHelpers["extends"]({},a,{video:!0}))}throw c})},getUserScreenMedia:function(a,c,d){return b("ScotchRTCScreenSharing").getUserMedia(a,c,d)},getUserMedia:function(a,c){return b("ZenonWebRTCWrapper").getUserMedia(a)},parseConstraints:function(a,c){if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera")){var d=a.audio,e=a.video,f={};d!==void 0&&(f.audio=b("ScotchRTCUserMediaConstraints").chromify(d));e!==void 0&&(f.video=b("ScotchRTCUserMediaConstraints").chromify(e,c));return f}return a},maybeSupportFilteredStreams:function(a,b){return a},getUserMediaWithValidation:function(a,c,d,e){c===void 0&&(c={audio:!0,video:!0});d===void 0&&(d=5);e===void 0&&(e={audio:1e3,video:1e3});return new(b("Promise"))(function(f,g){var h=function d(h){l.getUserMedia(a).then(function(d){return b("ScotchRTCMediaStreamValidator").validate(d,a,c,e).then(function(a){return f({stream:a})})["catch"](function(a){if(a.message===i||a.message===j)f({stream:d,err:a});else{l.stopMediaStream(d);throw a}})},g)["catch"](function(a){h>0?d(h-1):g(a)})};h(d)})},isFullScreen:function(){return Boolean(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullScreen:function(a){a===void 0&&(a=document.documentElement),typeof a.requestFullscreen==="function"?a.requestFullscreen():typeof a.msRequestFullscreen==="function"?a.msRequestFullscreen():typeof a.mozRequestFullScreen==="function"?a.mozRequestFullScreen():typeof a.webkitRequestFullscreen==="function"&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},exitFullScreen:function(){typeof document.exitFullscreen==="function"?document.exitFullscreen():typeof document.msExitFullscreen==="function"?document.msExitFullscreen():typeof document.mozCancelFullScreen==="function"?document.mozCancelFullScreen():typeof document.webkitExitFullscreen==="function"&&document.webkitExitFullscreen()},toggleFullScreen:function(){l.isFullScreen()?l.exitFullScreen():l.requestFullScreen()},endCallReasonFromHangupReason:function(a){return b("ScotchRTCEndCallReason").fromHangupReason(a).getReasonID()},endCallReasonFromDismissRequest:function(a){return b("ScotchRTCEndCallReason").fromDismissRequest(a).getReasonID()},endCallSubreasonFromDismissRequest:function(a){return b("ScotchRTCEndCallReason").subreasonFromDismissRequest(a)},endCallReasonFromResponseStatusCode:function(a){return b("ScotchRTCEndCallReason").fromResponseStatusCode(a).getReasonID()},stopMediaStream:function(a){if(!a.active&&"active"in a)return;a.getTracks().forEach(function(a){a.readyState!=="ended"&&a.stop()})},transferAudioTracks:function(a,b){for(var c=b.getAudioTracks(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;a.addTrack(f);b.removeTrack(f)}},payloadParticipantsToRTCUsers:function(a){return a.map(function(a){var c=a.big_image_src||a.image_src;a.fbid||g(0,1174);return new(b("RTCUser"))({FBID:a.fbid,profileUrl:new(h||(h=b("URI")))(a.href),profilePictureUrl:c,isMessengerUser:!!a.is_messenger_user,isPartiesUser:!!a.is_parties_user,userName:a.name,userShortName:a.short_name,vanity:a.vanity||""})})},getStreamVideoResolution:function(a){return new(b("Promise"))(function(c,d){var e=document.createElement("video");b("ScotchFBRTCUtils").attachMediaStream(e,a);var f=function(){e.removeEventListener("loadedmetadata",g),e.removeEventListener("error",h),b("ScotchFBRTCUtils").attachMediaStream(e,null)},g=function(){c({height:e.videoHeight,width:e.videoWidth}),f()},h=function(){d(e.error),f()};e.addEventListener("loadedmetadata",g);e.addEventListener("error",h)})},isScreenSharingSupported:function(){return b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||this.isVCScreenSharingSupported()},isVCScreenSharingSupported:function(){return b("FBRTCConfig").isVCEndpointCall()&&b("RTCConfig").CollabWhitelistedBrowserGK},filterDevicesByKind:function(a,b){return a?a.filter(function(a){return a.kind===b}):[]},isDevicePresent:function(a,b){return a==null?!1:a.some(function(a){return a.deviceId===b})}};e.exports=l}),null);
__d("ScotchRTCScreenSharing",["Promise","CollabRTCChromeScreenSharing","ScotchRTCUserMediaConstraints","ScotchRTCUtils","UserAgent","WorkplaceChatHelper"],(function(a,b,c,d,e,f){"use strict";var g="SCREEN_SHARING_NOT_SUPPORTED",h="UNEXPECTED_ERROR",i={SCREEN_SHARING_NOT_SUPPORTED:g,getUserMedia:function(a,c,d){if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")){var e;b("WorkplaceChatHelper").isDesktopChatApp()?e=b("WorkplaceChatHelper").getScreenSharingSourceID():e=b("CollabRTCChromeScreenSharing").getSourceID(d,c);return e.then(function(c){return b("ScotchRTCUtils").getUserMedia(b("ScotchRTCUserMediaConstraints").chromeMediaSource(a,c))}).then(function(a){for(var b=a.getTracks(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.addEventListener("ended",function(b){return window.setTimeout(function(){a.active||i.stop()})})}return a})}else if(b("ScotchRTCUtils").isVCScreenSharingSupported()&&navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia==="function")return b("Promise").resolve(navigator.mediaDevices.getUserMedia(a)["catch"](function(a){if(a.name==="NotAllowedError")throw new Error(g)}));return b("Promise").reject(new Error(g))},stop:function(){return b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")?b("WorkplaceChatHelper").isDesktopChatApp()?b("WorkplaceChatHelper").stopScreenSharing():b("CollabRTCChromeScreenSharing").stop():b("Promise").reject(new Error(h))}};e.exports=i}),null);
__d("ScotchRTWebBrowserFeatureSupport",["RTCPeerConnection"],(function(a,b,c,d,e,f){"use strict";a={isCanvasStreamSupported:function(){return typeof window.HTMLCanvasElement==="function"&&typeof window.HTMLCanvasElement.prototype.captureStream==="function"},isGetSendersSupported:function(){return g("getSenders")},isReplaceTrackSupported:function(){return typeof window.RTCRtpSender==="function"&&typeof window.RTCRtpSender.prototype.replaceTrack==="function"}};function g(a){return typeof b("RTCPeerConnection").prototype[a]==="function"}e.exports=a}),null);
__d("ScotchFBRTCScreenSharingUtils",["FBRTCSupport","ScotchFBRTCVersionDetection","ScotchRTCUtils","ScotchRTWebBrowserFeatureSupport","ScotchRTWebExperiments"],(function(a,b,c,d,e,f){"use strict";var g=b("ScotchRTWebBrowserFeatureSupport").isReplaceTrackSupported;a={isSupportedBrowser:function(){return(b("ScotchFBRTCVersionDetection").isChrome()||b("ScotchFBRTCVersionDetection").isChromiumBasedEdge())&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=34},canUserReceiveScreenSharing:function(){return!b("FBRTCSupport").isMobileDevice()&&(b("ScotchFBRTCVersionDetection").isChromium()&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=34||b("ScotchRTCUtils").isVCScreenSharingSupported())},canPeerReceiveScreenSharing:function(a){if(b("ScotchRTWebExperiments").shouldUseSingleMediaStream()&&g())return!0;return a.remoteSupport("screen_sharing")?!0:!1}};e.exports=a}),null);
__d("ScotchFBRTCUserCapabilities",["FBRTCSupport","MessengerCowatchConfig","ScotchFBRTCScreenSharingUtils","ScotchFBRTCVersionDetection","ScotchRTWebExperiments","UserAgent"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(b){this.$2=new Set(),this.$1=new Set(a.getLocal()),b&&(this.$2=new Set(b))}var c=a.prototype;c.getLocal=function(){return Array.from(this.$1)};c.setRemote=function(b){return!b?this:new a(b)};c.getRemote=function(){return Array.from(this.$2)};c.support=function(a){return this.localSupport(a)&&this.remoteSupport(a)};c.localSupport=function(a){return this.$1.has(a)};c.remoteSupport=function(a){return this.$2.has(a)};a.getLocal=function(){var a=[];(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera")||b("UserAgent").isBrowser("Firefox >= 38"))&&a.push("sdp_update");g()&&a.push("multiple_streams_plan_b");b("ScotchFBRTCScreenSharingUtils").canUserReceiveScreenSharing()&&a.push("screen_sharing");h()&&a.push("multiple_streams_unified");b("FBRTCSupport").isMobileDevice()?a.push("mweb"):a.push("www");b("FBRTCSupport").videoEscalationByUnmuteWorkaround()&&a.push("video_escalation_by_unmute");b("MessengerCowatchConfig").hasZenonCowatchCapability()&&a.push("cowatch");b("MessengerCowatchConfig").hasZenonGroupCowatchCapability()&&a.push("GROUP_COWATCH");return a};return a}();function g(){return b("ScotchRTWebExperiments").shouldUseSingleMediaStream()?!1:(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Opera"))&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=34}function h(){return b("ScotchRTWebExperiments").shouldUseSingleMediaStream()?!1:b("UserAgent").isBrowser("Firefox")&&b("ScotchFBRTCVersionDetection").webrtcVersion()>=40}e.exports=a}),null);
__d("ScotchRTCAppData",["FacebookAppIDs","WorkplaceChatHelper"],(function(a,b,c,d,e,f){"use strict";var g={getAppID:function(){return b("WorkplaceChatHelper").isDesktopChatApp()?this._getWorkplaceChatDesktopAppID():b("FacebookAppIDs").WWW},getChannelManagerAppName:function(){switch(g.getMWAppID()){case b("FacebookAppIDs").MESSENGERDOTCOM.toString():return"messenger_dot_com";case b("FacebookAppIDs").WWW.toString():return"www";case b("FacebookAppIDs").WORKPLACE_DESKTOP.toString():return"workplace";case b("FacebookAppIDs").MESSENGER_DESKTOP_ARCHON_MACOS.toString():return"desktop_video_chat";case b("FacebookAppIDs").MESSENGER_DESKTOP_ARCHON_WINDOWS.toString():return"desktop_video_chat_for_windows";default:return"desktop"}},_getWorkplaceChatDesktopAppID:function(){return b("WorkplaceChatHelper").getAppID()||b("FacebookAppIDs").WORKPLACE_DESKTOP},getMWAppID:function(){return b("FacebookAppIDs").MQTT_WEB.toString()}};e.exports=g}),null);
__d("ScotchRTCAppDispatcher",["ExplicitRegistrationDispatcher","objectValues"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}var d=c.prototype;d.explicitlyRegisterStoresInMap=function(a){this.explicitlyRegisterStores(b("objectValues")(a))};return c}(b("ExplicitRegistrationDispatcher"));e.exports=new a({strict:!0})}),null);
__d("ScotchRTCOneVCStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({meetingID:null,meetingPassword:null,participants:[]}));e.exports=a}),null);
__d("ScotchRTCOneVCStore",["invariant","FBRTCConfig","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCOneVCStoreState"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.call(this,b("ScotchRTCAppDispatcher"))||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCOneVCStoreState"))()};d.reduce=function(a,b){switch(b.type){case"SET_MEETING_ID":return a.set("meetingID",b.meetingID);case"SET_MEETING_PASSWORD":return a.set("meetingPassword",b.meetingPassword);case"STORE_PARTICIPANTS":b=h(b.participants);return a.set("participants",b);default:return a}};d.getParticipantsSummary=function(){var a=this.getState().participants;return a.length===0?{audioParticipants:0,videoParticipants:0}:a.reduce(function(a,b){b=b.video_mute.some(function(a){return a!==!1});return b?{audioParticipants:a.audioParticipants+1,videoParticipants:a.videoParticipants}:{audioParticipants:a.audioParticipants,videoParticipants:a.videoParticipants+1}},{audioParticipants:0,videoParticipants:0})};d.getParticipants=function(){return this.getState().participants};return c}(b("FluxReduceStore"));a.__moduleID=e.id;function h(a){var c=b("FBRTCConfig").getMeetingID();c!=null||g(0,11961);var d="Facebook (Meeting ID: "+c+")";return a.filter(function(a){return!a.peer_name.includes(d)})}e.exports=new a()}),null);
__d("ScotchgenerateRTCSignalingMessageID",["randomInt"],(function(a,b,c,d,e,f){"use strict";function a(){return b("randomInt")(0,4294967294)+1}e.exports=a}),null);
__d("ScotchFBRTCMessageSender",["errorCode","ChannelClientID","CurrentUser","FBRTCConstants","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCSupport","PresenceProperties","ScotchFBRTCUserCapabilities","ScotchFBRTCUtils","ScotchgenerateRTCSignalingMessageID","ScotchRTCAppData","ScotchRTCOneVCStore","SiteData","XCollabCallSendMessageController","XVideoCallSendMessageController"],(function(a,b,c,d,e,f,g){var h=0;a=function(){"use strict";function a(){this.onSendFailure=null,this.$1=b("FBRTCLogger").getInstance()}var c=a.prototype;c.sendOffer=function(a,c,d,e,f,g){return this.$2(b("FBRTCConstants").PayloadType.OFFER,a,c,d,e,f,null,g)};c.sendAnswer=function(a,c,d,e,f,g){return this.$2(b("FBRTCConstants").PayloadType.ANSWER,a,c,d,e,f,g)};c.sendPCRestartOffer=function(a,c,d,e,f){return this.$2(b("FBRTCConstants").PayloadType.PCRESTART_OFFER,a,c,d,e,f)};c.sendSdpUpdate=function(a,c,d,e,f){return this.$2(b("FBRTCConstants").PayloadType.SDP_UPDATE,a,c,d,e,f)};c.resendSdpMessage=function(a,b){b.flag=1,this.$3(a,b)};c.resendPayload=function(a,b){b.flag=1,this.$4(a,b)};c.$2=function(a,c,d,e,f,g,h,i){d=this.$5(d,a);d.sdp=e;a===b("FBRTCConstants").PayloadType.OFFER&&(d.browser_supports_escalation=b("FBRTCSupport").isGroupCallWebtrcSupported(),d.handlescollision=!0,d.pranswer=!1,i&&(d.call_trigger=i));a===b("FBRTCConstants").PayloadType.ANSWER&&h&&(d.escalation_conference_name=h.escalationConferenceName,d.negotiated_escalation_support=h.negotiatedEscalationSupport);(a===b("FBRTCConstants").PayloadType.OFFER||a===b("FBRTCConstants").PayloadType.ANSWER||a===b("FBRTCConstants").PayloadType.PCRESTART_OFFER)&&(d.icerestart=!1,d.experiments=b("ScotchFBRTCUserCapabilities").getLocal());d.videoon=f;d.attributes=g;d.ull=b("FBRTCConstants").convertFromUploadLogLevel(b("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel());this.$3(c,d);return d};c.sendIceCandidate=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.ICE_CANDIDATE);c.sdp_mid=d.sdpMid;c.label=d.sdpMLineIndex;c.sdp=d.candidate;this.$4(a,c)};c.sendHangup=function(a,c,d,e,f){c=this.$5(c,b("FBRTCConstants").PayloadType.HANGUP);c.reason=b("FBRTCConstants").callEndReasonString(d);c.subreason=f||"";this.$4(a,c,e,!0)};c.sendOtherDismiss=function(a){a=this.$5(a,b("FBRTCConstants").PayloadType.OTHER_DISMISS);this.$4(b("CurrentUser").getID(),a)};c.sendOfferAck=function(a,c,d,e){e===void 0&&(e=new Map()),this.$6(a,c,d,b("FBRTCConstants").PayloadType.OFFER_ACK,e)};c.sendOfferNack=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.OFFER_NACK,new Map([["error_code",1356043]]))};c.sendAnswerAck=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.ANSWER_ACK)};c.sendAck=function(a,c,d){this.$6(a,c,d,b("FBRTCConstants").PayloadType.ACK,new Map([["ack_type",d.type]]))};c.sendMuteStateUpdate=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.SET_VIDEO);c.videoon=d;this.$4(a,c)};c.sendClientReportedEvent=function(a,c,d){c=this.$5(c,b("FBRTCConstants").PayloadType.CLIENT_REPORTED_EVENT);c.event_type=d;this.$4(a,c)};c.sendVideoEscalationRequest=function(a,b,c){return this.sendVideoRequestResponse(a,b,0,c)};c.sendVideoRequestResponse=function(a,c,d,e){c=this.$5(c,b("FBRTCConstants").PayloadType.VIDEO_REQUEST);c.ack_id=d;c.videoon=e;c.capability=b("PresenceProperties").getProperties();this.$4(a,c);return c};c.sendMsgAck=function(){};c.sendOk=function(){};c.sendPranswer=function(){};c.sendIcerestartAnswer=function(){};c.$5=function(a,c){var d=b("ScotchgenerateRTCSignalingMessageID")();a={version:h,type:c,call_id:a,msg_id:d};this.$7(c)&&(a.supports_video_interop=!0);return a};c.$7=function(a){return a===b("FBRTCConstants").PayloadType.OFFER||a===b("FBRTCConstants").PayloadType.ANSWER||a===b("FBRTCConstants").PayloadType.PRANSWER||a===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||a===b("FBRTCConstants").PayloadType.ICERESTART_ANSWER||a===b("FBRTCConstants").PayloadType.PCRESTART_OFFER||a===b("FBRTCConstants").PayloadType.PCRESTART_ANSWER||a===b("FBRTCConstants").PayloadType.SDP_UPDATE||a===b("FBRTCConstants").PayloadType.SET_VIDEO||a===b("FBRTCConstants").PayloadType.VIDEO_REQUEST};c.$3=function(a,b){this.$4(a,b,!1,!0,!0)};c.$6=function(a,c,d,e){var f=(arguments.length<=4?void 0:arguments[4])||new Map(),g=this.$5(c,e);g.ack_id=d.msg_id;d.flag===1&&(g.flag=1);g.ull=b("FBRTCConstants").convertFromUploadLogLevel(b("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel());f.forEach(function(a,b,c){g[b]=a});this.$4(a,g)};c.$4=function(a,c,d,e,f){var g=c.msg_id,h={peer_id:a,call_id:c.call_id,msg_id:g,msg_type:c.type},i=b("ScotchFBRTCUtils").isPeerVCEndpoint(a);if(i){var j=b("ScotchRTCOneVCStore").getState(),k=j.meetingID;j=j.meetingPassword;k!=null&&(c.meeting_id=k);j!=null&&(c.meeting_pass=j)}k=(i?b("XCollabCallSendMessageController"):b("XVideoCallSendMessageController")).getURIBuilder().setInt("recipient_id",a).setInt("msg_id",g).setString("message_info",JSON.stringify(c)).setString("device_id",b("ChannelClientID").getID()).getURI();j=null;e&&(j=this.$4.bind(this,a,c,d,!1,f));i=this.$8.bind(this,h);g=this.$9.bind(this,h,j,f);b("ScotchFBRTCUtils").sendServerRequest(k,i,g,d);this.onMessageSent&&this.onMessageSent(a,c);this.$1.logSentMessage(a,c.call_id,c)};c.$8=function(a){this.$1.logSentMessageSuccess(a.peer_id,a.call_id,a.msg_type,a.msg_id)};c.$9=function(a,c,d,e){var f="UNKNOWN_ERROR";e&&(f=e.getError?e.getError():e);this.$1.logSentMessageFailure(a.peer_id,a.call_id,a.msg_type,a.msg_id,f);e=null;f===1356001||f===1356049?e=b("FBRTCConstants").CallEndReason.NO_PERMISSION:f===1356046?e=b("FBRTCConstants").CallEndReason.CALLER_NOT_VISIBLE:(f===1356003||f===1356002||f===1356044)&&(e=b("FBRTCConstants").CallEndReason.OTHER_NOT_CAPABLE);if(!e&&c){c();return}d&&this.onSendFailure&&(e||(e=b("FBRTCConstants").CallEndReason.SIGNALING_MESSAGE_FAILED),this.onSendFailure(e,f,a.msg_type))};return a}();e.exports=a}),null);
__d("ScotchFBRTCPeerConnectionHelper",["regeneratorRuntime","Promise","MediaStream","ScotchRTCP2PProtocolHandler","flatMapArray","gkx"],(function(a,b,c,d,e,f){"use strict";a={resetLocalStreams:function(a,c){var d=!1,e=a.getLocalStreams(),f=e.filter(function(a){return!c.includes(a)}),g=c.filter(function(a){return!e.includes(a)});(f.length>0||g.length>0)&&(d=!0);f.forEach(function(b){return a.removeStream(b)});g.forEach(function(b){return a.addStream(b)});if(b("gkx")("1344456")&&b("ScotchRTCP2PProtocolHandler").supportMultipleStreams()===!1){g=e.filter(function(a){return!f.includes(a)});g=b("flatMapArray")(g,function(b){return a.addStream(b)});g.length>0&&(d=!0)}return d},resetLocalStreamWithTrackAPI:function(a,b,c){var d=!1,e=b.getVideoTracks().length>0?b.getVideoTracks()[0]:null,f=b.getAudioTracks().length>0?b.getAudioTracks()[0]:null,g=a.getSenders(),h=g.filter(function(a){return a.track&&a.track.kind==="video"}),i=g.filter(function(a){return a.track&&a.track.kind==="audio"});h=h.length===(e===null?0:1)&&i.length===(f===null?0:1);if(c||!h){g.filter(function(a){return a.track!==e&&a.track!==e}).forEach(function(b){d=!0,a.removeTrack(b)});f&&!g.some(function(a){return a.track===f})&&(d=!0,a.addTrack(f,b));e&&!g.some(function(a){return a.track===e})&&(d=!0,a.addTrack(e,b));return d}a.getSenders().forEach(function(a){a.track&&a.track.kind==="video"&&e!==a.track?a.replaceTrack(e):a.track&&a.track.kind==="audio"&&f!==a.track&&a.replaceTrack(f)});return d},resetLocalStreamsByTrack:function(a,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:i=a.getSenders();j=(e=a.getLocalStreams()[0])!=null?e:new(b("MediaStream"))();k=(f=d==null?void 0:d.getAudioTracks()[0])!=null?f:c.getAudioTracks()[0];l=(h=d==null?void 0:d.getVideoTracks()[0])!=null?h:c.getVideoTracks()[0];m=[];k!=null&&m.push(k);l!=null&&m.push(l);j.getTracks().forEach(function(a){m.includes(a)===!1&&j.removeTrack(a)});m.forEach(function(a){j.addTrack(a)});n=i.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="audio"})[0];o=i.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"})[0];t.next=13;return b("regeneratorRuntime").awrap(b("Promise").all([g(a,k,n),g(a,l,o)]));case 13:p=t.sent;q=p[0];r=p[1];s=a.addStream(j);return t.abrupt("return",q||r||s.length>0);case 18:case"end":return t.stop()}},null,this)}};function g(a,c,d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=!1;if(!(c!=null)){f.next=8;break}if(!(d!=null&&d.track!==null)){f.next=6;break}if(!(c!==d.track)){f.next=6;break}f.next=6;return b("regeneratorRuntime").awrap(d.replaceTrack(c));case 6:f.next=9;break;case 8:d!=null&&d.track!==null&&(a.removeTrack(d),e=!0);case 9:return f.abrupt("return",e);case 10:case"end":return f.stop()}},null,this)}e.exports=a}),null);
__d("ZenonScreenSharingConstants",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a="kMNScreenShareDataKeyUserId";c=b("$InternalEnum")({End:"kMNScreenShareDataEndScreenSharing",Start:"kMNScreenShareDataStartScreenSharing"});e.exports={SCREEN_SHARE_DATA_USER_ID_KEY:a,ZenonScreenSharingDataMessageTopic:c}}),null);
__d("ScotchFBRTCMultiwayMessage",["ChannelManager","CurrentUser","FBRTCMessageType","ScotchRTCAppData","ScotchRTCUtils","ZenonScreenSharingConstants"],(function(a,b,c,d,e,f){var g=b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY,h=b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic;a=function(){"use strict";function a(a){this.$1=a}var c=a.prototype;c.isRequest=function(){return this.$1.jsonPayload.header.responseStatusCode==null};c.isType=function(a){return this.type()==a};c.transactionId=function(){return this.$1.jsonPayload.header.transactionId};c.conferenceName=function(){return this.$1.jsonPayload.header.conferenceName};c.serverInfoData=function(){return this.$1.jsonPayload.header.serverInfoData};c.message=function(){return this.$1};c.type=function(){return this.header().type};c.endpoint=function(){return this.$1.endpoint};c.header=function(){return this.$1.jsonPayload.header};c.body=function(){return this.$1.jsonPayload.body};c.incrementRetryCount=function(){this.$1.jsonPayload.header.retryCount++};c.ringRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").RING)?this.body().ringRequest:null};c.dismissRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").DISMISS)?this.body().dismissRequest:null};c.serverMediaUpdateRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null};c.conferenceStateRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").CONFERENCE_STATE)?this.body().conferenceStateRequest:null};c.notifyRequest=function(){return this.isRequest()&&this.isType(b("FBRTCMessageType").NOTIFY)?this.body().notifyRequest:null};c.startScreenSharingRequest=function(){var a=this.genericDataMessage();if(a!=null&&a.topic===h.Start){a=JSON.parse(atob(a.data));return a[g]}return null};c.endScreenSharingRequest=function(){var a=this.genericDataMessage();if(a!=null&&a.topic===h.End){a=JSON.parse(atob(a.data));return a[g]}return null};c.genericDataMessage=function(){var a;return this.isRequest()&&this.isType(b("FBRTCMessageType").DATA_MESSAGE)?(a=this.body().dataMessageRequest)==null?void 0:(a=a.message)==null?void 0:(a=a.body)==null?void 0:a.genericMessage:null};c.createResponse=function(c,d){var e=d.body;d=d.callID;c={endpoint:{appId:b("ScotchRTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()},jsonPayload:{header:b("ScotchRTCUtils").createResponseHeader(this.header(),c,d?d:""),body:e||{}}};return new a(c)};return a}();e.exports=a}),null);
__d("ScotchRTCMessageSender",["Promise","AsyncRequest","FBRTCLogger","ScotchFBRTCMultiwayMessage","XGroupCallSendMessageController"],(function(a,b,c,d,e,f){var g=6e3;a=function(){"use strict";function a(){}var c=a.prototype;c.send=function(a){return new(b("Promise"))(function(c,d){a.jsonPayload.header.conferenceName;var e=new(b("ScotchFBRTCMultiwayMessage"))(a);b("FBRTCLogger").getInstance().logSendingMultiwayMessage(e);e=b("XGroupCallSendMessageController").getURIBuilder().getURI();e=new(b("AsyncRequest"))(e).setMethod("POST").setData({message:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){c(a)}).setErrorHandler(function(a){a=a.getErrorDescription();a=Error(a!=null?a.toString():"AsyncRequest error");d(a)}).setTimeoutHandler(g,function(){d("Timeout")});e.send()})};return a}();e.exports=a}),null);
__d("ScotchFBRTCTransactions",["Promise","FBRTCConsoleLogger","ScotchRTCMessageSender","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";var g=6e4,h=Object.freeze({INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3});a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.findTransaction=function(a){return this.$1.get(a)};b.addTransaction=function(a){this.$1.set(a.id,a)};b.removeTransaction=function(a){this.$1["delete"](a.id)};b.getTransaction=function(a){return this.findTransaction(a.transactionId())||new i(this,a)};return a}();var i=function(){function a(a,c){this.id=c.transactionId(),this.$1=h.INIT,this.$2=c,this.$3=null,this.$4=a,this.$5=new Error("Unknown"),this.$6=null,this.$7=new(b("ScotchRTCMessageSender"))(),this.$8(),this.$4.addTransaction(this)}var c=a.prototype;c.start=function(){if(this.$1==h.INIT){this.$9(h.PROCESSING);return b("Promise").resolve(this.$2)}else if(this.$1==h.PROCESSING)return b("Promise").resolve(null);else if(this.$1==h.COMPLETED){this.$10();return b("Promise").resolve(null)}return b("Promise").reject(this.$5)};c.sendResponse=function(a){var b=this;this.$3=a;this.$9(h.COMPLETED);return this.$7.send(a.message()).then(function(a){},function(a){b.$5=a,b.$9(h.TERMINATED)})};c.$10=function(){if(this.$3!=null){var a=this.$3;a.incrementRetryCount();this.sendResponse(a)}};c.$9=function(a){a!=this.$1&&(this.$1=a,this.$1!=h.TERMINATED&&this.$8(),this.$1==h.TERMINATED&&(this.$5=new Error("Terminated"),this.$4.removeTransaction(this)))};c.$8=function(){var a=this;this.$6&&(b("clearTimeout")(this.$6),this.$6=null);this.$6=b("setTimeout")(function(){a.$9(h.TERMINATED)},g)};return a}();e.exports={FBRTCTransactionOwner:a,FBRTCServerTransaction:i}}),null);
__d("ScotchRTCCallActions",["invariant","ScotchRTCAppDispatcher","ScotchRTCUtils","ScotchRTWebUserActionLogger","emptyFunction","mixInEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";var h={addListener:b("emptyFunction"),emit:b("emptyFunction"),initialize:function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallActions_initialize",callID:String(a.callID),conferenceName:a.conferenceName,callType:a.protocol==="p2p"?"p2p":"mw"}),b("ScotchRTCAppDispatcher").dispatch(babelHelpers["extends"]({type:"INIT"},a))},reset:function(){b("ScotchRTCAppDispatcher").dispatch({type:"RESET"})},resetForRedial:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"RESET_FOR_REDIAL",conferenceName:a,callID:c})},callCollision:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL_COLLISION",conferenceName:a,peerID:c})},setCallSummary:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CALL_SUMMARY",callSummary:a})},call:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL",usersToRing:a,peerConnection:c})},callSuccess:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"CALL_SUCCESS",connected:a})},incomingCallSuccess:function(){b("ScotchRTCAppDispatcher").dispatch({type:"INCOMING_CALL_SUCCESS"})},callError:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"CALL_ERROR",endCallReason:b("ScotchRTCUtils").endCallReasonFromResponseStatusCode(a),endCallSubreason:"Call error: "+(a||0),responseSubCode:c})},completeTransitionToMultiway:function(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_CLEAR_P2P_CONNECTION"})},hangupSuccess:function(){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP_SUCCESS"})},hangupError:function(){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP_ERROR"})},join:function(a){h.call([],a)},hangup:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"HANGUP",hangupReason:a,endCallReason:a,endCallSubreason:c})},initLocalUser:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_LOCAL_USER",localUser:a})},initRemoteUsers:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_REMOTE_USERS",remoteUsers:a})},updateRemoteUsers:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"UPDATE_REMOTE_USERS",remoteUsers:a})},addLocalStream:function(a){a!=null||g(0,11208),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_LOCAL_STREAM",stream:a})},removeLocalStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_LOCAL_STREAM",stream:a})},replaceLocalStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REPLACE_LOCAL_STREAM",oldStream:a,newStream:c})},removeAllLocalStreams:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_LOCAL_STREAMS",stopStreams:a})},removeAllLocalScreenStreams:function(a){a===void 0&&(a=!1),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_LOCAL_SCREEN_STREAMS",stopStreams:a})},addRemoteStream:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_addRemoteStream. Stream="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_STREAM",stream:a,userID:c})},removeRemoteStream:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeRemoteStream. Stream="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_STREAM",stream:a,userID:c})},removeAllRemoteStreams:function(a){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeAllRemoteStreams"}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_ALL_REMOTE_STREAMS",userID:a})},addRemoteTrack:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_addRemoteTrack. Track id ="+c.id+";stream id ="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_TRACK",stream:a,track:c})},removeRemoteTrack:function(a,c){b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ScotchRTCCallActions_removeRemoteTrack. Track id ="+c.id+";stream id ="+a.id}),b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_TRACK",stream:a,track:c})},addLocalScreenStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_LOCAL_SCREEN_STREAM",stream:a})},removeLocalScreenStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_LOCAL_SCREEN_STREAM",stream:a})},replaceLocalScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REPLACE_LOCAL_SCREEN_STREAM",oldStream:a,newStream:c})},addRemoteScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_SCREEN_STREAM",stream:a,userID:c})},removeRemoteScreenStream:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_SCREEN_STREAM",stream:a,userID:c})},endCall:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"END_CALL",endCallReason:a,endCallSubreason:c})},waitForUserInput:function(){b("ScotchRTCAppDispatcher").dispatch({type:"WAIT_FOR_USER_INPUT"})},toggleMuteAudio:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"AUDIO_UNMUTED":"AUDIO_MUTED"})},toggleMuteVideo:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"VIDEO_UNMUTED":"VIDEO_MUTED"})},stopLocalVideo:function(){b("ScotchRTCAppDispatcher").dispatch({type:"STOP_LOCAL_STREAM"})},toggleMuteRemoteVideo:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:a?"REMOTE_VIDEO_MUTED":"REMOTE_VIDEO_UNMUTED",userID:c})},toggleSelfView:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"SELF_VIEW_COLLAPSED":"SELF_VIEW_UNCOLLAPSED"})},submitRating:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_RATING",rating:a})},submitFeedback:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_FEEDBACK",feedback:a})},submitFeedbackOptions:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_FEEDBACK_OPTIONS",feedbackOptions:a})},submitSurveyChoice:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SUBMIT_SURVEY_CHOICE",surveyChoice:a})},ratingShown:function(){b("ScotchRTCAppDispatcher").dispatch({type:"RATING_SHOWN"})},feedbackShown:function(){b("ScotchRTCAppDispatcher").dispatch({type:"FEEDBACK_SHOWN"})},setEndCallReason:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_END_CALL_REASON",endCallReason:a})},setConferenceState:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CONFERENCE_STATE",conferenceState:a})}};b("mixInEventEmitter")(h,{onIceConnectionStateChange:!0});e.exports=h}),null);
__d("ScotchRTCGroupCallActions",["ScotchRTCAppDispatcher","ScotchRTCUtils","ScotchRTWebUserActionLogger","gkx"],(function(a,b,c,d,e,f){"use strict";a={setLayout:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_LAYOUT",layout:a})},setDominantSpeaker:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_DOMINANT_SPEAKER",dominantSpeakerFBID:a})},setPinnedSpeaker:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PINNED_SPEAKER",pinnedSpeakerFBID:a})},initThread:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"INIT_THREAD",thread:a,participants:c})},onParticipantLeft:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ON_PARTICIPANT_LEFT",participantFBID:a})},onParticipantsAdded:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_PARTICIPANTS_ADDED",participants:a,images:c})},addParticipantsToRing:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_PARTICIPANTS_TO_RING",participantFBIDs:a})},toggleRemoteStream:function(a,c){if(b("gkx")("1439080")&&a!=null){var d=Object.keys(a).reduce(function(b,c){return""+b+c+":"+String(a[c])+";"},"");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_toggleRemoteStream mediaStatus:"+d,callID:c})}b("ScotchRTCAppDispatcher").dispatch({type:"TOGGLE_REMOTE_STREAM",mediaStatus:a})},addRemoteScreenSharingUserID:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ADD_REMOTE_SCREEN_SHARING_USER_ID",userID:a})},removeRemoteScreenSharingUserID:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"REMOVE_REMOTE_SCREEN_SHARING_USER_ID",userID:a})},handleDismissRequest:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"DISMISS",transaction:a,request:c,endCallReason:b("ScotchRTCUtils").endCallReasonFromDismissRequest(c.dismissRequest()),endCallSubreason:b("ScotchRTCUtils").endCallSubreasonFromDismissRequest(c.dismissRequest())})},handleConferenceStateRequest:function(a,c,d,e){b("ScotchRTCAppDispatcher").dispatch({type:"ON_CONFERENCE_STATE",transaction:a,request:c,conferenceStateVersion:d,resolve:e})},onJoinRequestSent:function(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_JOIN_REQUEST_SENT"})},onReceivedJoinResponse:function(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_RECEIVED_JOIN_RESPONSE"})},onJoinResponse:function(a){b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_onJoinResponse"}),b("ScotchRTCAppDispatcher").dispatch({type:"ON_JOIN_RESPONSE",serverInfoData:a})},onProcessedJoinResponse:function(a){b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCGroupCallActions_onProcessedJoinResponse:",callID:a}),b("ScotchRTCAppDispatcher").dispatch({type:"ON_PROCESSED_JOIN_RESPONSE"})},onServerMediaUpdateSuccess:function(){b("ScotchRTCAppDispatcher").dispatch({type:"ON_SERVER_MEDIA_UPDATE_SUCCESS"})},setLocalClientVersion:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_LOCAL_CLIENT_VERSION",version:a})},onClientMediaUpdateResponse:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_CLIENT_MEDIA_UPDATE_RESPONSE",responseStatusCode:a,currentVersion:c})},setStateSyncInput:function(a,c,d){b("ScotchRTCAppDispatcher").dispatch({type:"SET_INPUT_SYNC_STATE",topic:a,version:c,inputData:d})},setStateSyncOutput:function(a,c,d){b("ScotchRTCAppDispatcher").dispatch({type:"SET_OUTPUT_SYNC_STATE",topic:a,version:c,outputData:d})},setStateSyncSubscribe:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"STATE_SYNC_SUBSCRIBE",topic:a})},setStateSyncUnsubscribe:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"STATE_SYNC_UNSUBSCRIBE",topic:a})},onPendingApproval:function(){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PENDING_APPROVAL"})},forceEncodingEnabled:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"FORCE_ENCODING_ENABLED",enabled:a})},videoEscalationStarted:function(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_STARTED"})},videoEscalationCompleted:function(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_COMPLETED"})},resetVideoEscalation:function(){b("ScotchRTCAppDispatcher").dispatch({type:"MW_VIDEO_ESCALATION_RESET"})},onLocalTrackReplaced:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"ON_LOCAL_TRACK_REPLACED",newTrack:a,oldTrack:c})}};e.exports=a}),null);
__d("ScotchRTCSessionDescription",["invariant","FBRTCConfig","FBRTCConstants","FBRTCMediaType","ScotchFBRTCSdpUtils","ScotchRTCSignalingExperiments","ScotchRTWebUserActionLogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=b("FBRTCConstants").SignalingProtocol,i=window.RTCSessionDescription||window.mozRTCSessionDescription,j=2,k="o",l="m",m="a",n="rtpmap",o="ssrc-group",p="ssrc",q="cname",r="msid",s="mslabel",t="label",u="sendonly",v="recvonly",w="sendrecv",x="inactive",y="offer",z="answer",A="=",B=" ",C=":",D="\r\n",E="audio",F="video",G="application",H="http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",I="http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",J=function(a,b){return a.startsWith(b+A)},K=function(a){return a.substr(j)},L=function(a,b){return a.startsWith(b+D)||a.startsWith(b+C)},M=function(a,b){return a.substr(b.length+1)},N=function(){function a(a){var b=this;this.$1=[];this.$2="-";this.$3="multiway";this.$4=1;this.$5="IN";this.$6="IP4";this.$7="127.0.0.1";a.forEach(function(a){if(J(a,k)){var c=K(a).split(B);c.length==6&&(b.$2=c[0],b.$3=c[1],b.$4=parseInt(c[2],10),b.$5=c[3],b.$6=c[4],b.$7=c[5])}b.$1.push(a)})}var b=a.prototype;b.setVersion=function(a){this.$4=a};b.getVersion=function(){return this.$4};b.toSdp=function(){var a=this;return this.$1.map(function(b){if(J(b,k))return k+A+a.$2+B+a.$3+B+a.$4+B+a.$5+B+a.$6+B+a.$7;else return b}).join(D)};return a}(),O=function(){function a(a,b,c){var d=this;c===void 0&&(c={});this.$1=[];var e={},f=[],g=[];a.forEach(function(a){var b=K(a);J(a,l)&&(d.$4=b.split(B)[0]);if(J(a,m)&&L(b,n)){var c=M(b,n);c=c.split(B);var h=c[0];c=c[1];e[c]=h}J(a,m)&&L(b,p)?d.$6(b,f):J(a,m)&&L(b,o)?d.$7(b,g):J(a,m)&&(b===u||b===v||b===w||b===x)?d.$5=b:d.$1.push(a)});Object.keys(c).forEach(function(a){if(e[a]){var b=Object.keys(c[a]).map(function(b){return b+"="+c[a][b]}).join(";");d.$1.push("a=fmtp:"+e[a]+" "+b)}});this.$3={};this.$2={};f.forEach(function(a){if(Object.prototype.hasOwnProperty.call(a,q)){var b=a.cname;!d.$3[b]?d.$3[b]=[a]:d.$3[b].push(a);a=d.findSsrcGroupForSsrc(g,a.ssrc);a&&(!d.$2[b]?d.$2[b]=[a]:d.$2[b].push(a),d.removeSsrcGroup(a,g))}});this.$4!==G&&(b===y?f.length===0?this.$5=v:this.$5=w:b===z&&(this.$5=w))}var b=a.prototype;b.getMediaType=function(){return this.$4};b.getEndpointCount=function(){return Object.keys(this.$3).length};b.findSsrcGroupForSsrc=function(a,b){return a.find(function(a){a=a.ssrcs;return a.some(function(a){return a===b})})};b.addStreamsForEndpoint=function(a,b){this.$3[a]=b};b.addSsrcGroupsForEndpoint=function(a,b){var c=this;this.$3[a].forEach(function(d){d=d.ssrc;d=c.findSsrcGroupForSsrc(b,d);d&&(!c.$2[a]?c.$2[a]=[d]:c.$2[a].push(d),c.removeSsrcGroup(d,b))})};b.removeSsrcGroup=function(a,b){a=b.indexOf(a);a!==-1&&b.splice(a,1)};b.$7=function(a,b){a=M(a,o);if(a){a=a.split(B);var c=a[0];a=a.slice(1);b.push({semantics:c,ssrcs:a.map(function(a){return parseInt(a,10)})})}};b.$6=function(a,b){var c=a.indexOf(B),d=a.substr(0,c),e=parseInt(M(d,p),10);d=a.substr(c+1);a=b.find(function(a){return a.ssrc===e});a||(a={},a.ssrc=e,b.push(a));if(L(d,q))a.cname=M(d,q);else if(L(d,r)){c=M(d,r).split(B);a.msid={id:c[0],appdata:c[1]}}else L(d,s)?a.mslabel=M(d,s):L(d,t)&&(a.label=M(d,t))};b.toSdp=function(){var a=[];this.$1.forEach(function(b){a.push(b)});for(var b in this.$2)this.$2[b].forEach(function(b){a.push(m+A+o+C+b.semantics+B+b.ssrcs.join(B))});a.push(m+A+this.$5);for(var c in this.$3)this.$3[c].forEach(function(b){b.cname&&a.push(m+A+p+C+b.ssrc+B+q+C+b.cname),b.msid&&a.push(m+A+p+C+b.ssrc+B+r+C+b.msid.id+(b.msid.appdata?B+b.msid.appdata:"")),b.mslabel&&a.push(m+A+p+C+b.ssrc+B+s+C+b.mslabel),b.label&&a.push(m+A+p+C+b.ssrc+B+t+C+b.label)});return a.join(D)};return a}();a=function(){function a(a,b,c){b===void 0&&(b={});c===void 0&&(c={});b=b;var d=b.type;d=d===void 0?"offer":d;b=b.sdp;b=b===void 0?"":b;this.$2=a;this.type=d;switch(a){case h.CUSTOM:this.$1=b;return;case h.MULTIWAY:this.$3(b,c);return;case h.P2P:this.$4(b,c);return}}var c=a.prototype;c.$3=function(a,c){if(this.type==="offer"){var d=b("ScotchRTCSignalingExperiments").shouldEnablePlayoutDelayRtpHeaderExtensionForMw()?[H]:null;b("ScotchRTCSignalingExperiments").shouldAllowContentTypeRtpHeaderExtensionForMw()&&(d=d==null?[I]:[I].concat(d));a=b("ScotchFBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a,d);c.OFFER_SDP_TRANSFORM&&(a=c.OFFER_SDP_TRANSFORM.reduce(function(a,b){return b(a)},a))}if(this.type=="offer"||this.type=="answer"){d=b("ScotchRTCSignalingExperiments").shouldPreferOpusMultiway();d&&(a=b("ScotchFBRTCSdpUtils").preferCodec(a,"opus",!1));d=b("ScotchRTCSignalingExperiments").shouldPreferVp9Multiway();d?a=b("ScotchFBRTCSdpUtils").preferCodec(a,"VP9",!0):b("ScotchRTCSignalingExperiments").shouldPreferH264Multiway()&&(b("ScotchRTCSignalingExperiments").shouldPreferHWH264Multiway()?a=b("ScotchFBRTCSdpUtils").preferCodec(a,"H264",!0):a=b("ScotchFBRTCSdpUtils").promoteSpecificH264ProfileIfExists(a,{levelAsymmetryAllowed:!0,packetizationMode:!0,profileLevelId:"42e01f"}))}c.DISABLE_OPUS_STEREO&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","stereo","0"));b("ScotchRTCSignalingExperiments").isOpusPtimeMungeEnabled()&&(a=b("ScotchFBRTCSdpUtils").maybeAddPtimeForOpusOnly(a,b("ScotchRTCSignalingExperiments").getOpusPtimeMungeValue()));b("ScotchRTCSignalingExperiments").shouldMungeUseDtxForOpus()&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","usedtx","1"));d=a.trim().split(D);a=[];var e=0;while(e<d.length&&!J(d[e],l))a.push(d[e]),e++;this.sessionDescription=new N(a);this.mediaDescriptions=[];while(e<d.length){a=[];a.push(d[e]);e++;while(e<d.length&&!J(d[e],l))a.push(d[e]),e++;this.mediaDescriptions.push(new O(a,this.type,c.FORMAT_PARAMETERS))}};c.$4=function(a,c){var d=[function(a){return b("ScotchFBRTCSdpUtils").addIceOptionToSdp(a,"fb-force-5245")},function(a){return b("ScotchFBRTCSdpUtils").useDTLSOverCrypto(a)}];if(this.type=="offer"||this.type=="answer"){var e=b("ScotchRTCSignalingExperiments").shouldPreferOpus();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferCodec(a,"opus",!1)});e=b("ScotchRTCSignalingExperiments").shouldPreferVp9();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferCodec(a,"VP9",!0)})}if(this.type==="offer"){c.DISABLE_VIDEO&&d.push(function(a){return b("ScotchFBRTCSdpUtils").disableVideo(a)});e=b("ScotchRTCSignalingExperiments").shouldPreferIsac();e&&d.push(function(a){return b("ScotchFBRTCSdpUtils").preferIsac(a)});d.push(function(a){return b("ScotchFBRTCSdpUtils").replaceRTPSAVPFProfile(a)},function(a){return b("ScotchFBRTCSdpUtils").addSetup(a)},function(a){return b("ScotchFBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a)});b("FBRTCConfig").isVCEndpointCall()||d.push(function(a){return b("ScotchFBRTCSdpUtils").removeSdparta(a)});if(c.FORMAT_PARAMETERS){var f=Object.entries(c.FORMAT_PARAMETERS);e=function(){var a=f[h],c=a[0];a=a[1];var e=Object.entries(a);a=function(){var a=e[i],f=a[0],h=a[1];typeof h==="string"||g(0,4169);d.push(function(a){return b("ScotchFBRTCSdpUtils").addFmtp(a,c,f,h)})};for(var i=0;i<e.length;i++)a()};for(var h=0;h<f.length;h++)e()}d.push(function(a){return b("ScotchFBRTCSdpUtils").clearFirefoxInactiveDataChannelBlock(a)})}c.ADD_FB_FEATURES!=null&&d.push(function(a){Array.isArray(c.ADD_FB_FEATURES)||g(0,4170);return b("ScotchFBRTCSdpUtils").addFBFeatures.apply(b("ScotchFBRTCSdpUtils"),[a].concat(c.ADD_FB_FEATURES))});c.ADD_AUDIO_NACK&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addAudioNack(a)});c.DISABLE_OPUS_STEREO&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","stereo","0")});var i=c.SSRC_CONTENT_TYPE;i&&d.push(function(a){return b("ScotchFBRTCSdpUtils").addSSRCContentType(a,i)});this.$1=d.reduce(function(a,b){return b(a)},a)};c.processServerMediaUpdate=function(a,c){var d=a.sourceKey,e=a.media,f=a.ssrcGroups,g=[],h=[],i="",j="";e.forEach(function(a){a.ssrcs.forEach(function(c){if(c===0)return;var e={ssrc:c,cname:d,msid:{id:d,appdata:a.id},label:a.id,mslabel:d};b("FBRTCMediaType").AUDIO===a.type?(g.push(e),i+=JSON.stringify({ssrc:c,label:e.label,enabled:a.enabled,owner:a.owner})+";"):b("FBRTCMediaType").VIDEO===a.type&&(h.push(e),j+=JSON.stringify({ssrc:c,label:e.label,enabled:a.enabled,owner:a.owner})+";")})});b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"SessionDescription_processServerMediaUpdate.key="+d+"audio="+i+"video="+j+"ssrgroupsCount="+f.length,callID:c==null?void 0:c.callID,conferenceName:c==null?void 0:c.conferenceName});this.mediaDescriptions.forEach(function(a){a.getMediaType()===E?(a.addStreamsForEndpoint(d,g),a.addSsrcGroupsForEndpoint(d,f)):a.getMediaType()===F&&(a.addStreamsForEndpoint(d,h),a.addSsrcGroupsForEndpoint(d,f))})};c.toDesc=function(){return new i({type:this.type,sdp:this.toSdp()})};c.$5=function(){var a=[this.sessionDescription.toSdp(),this.mediaDescriptions.map(function(a){return a.toSdp()}).join(D),""].join(D);if(this.type==="answer"){var c=Math.max.apply(null,this.mediaDescriptions.map(function(a){return a.getEndpointCount()}));c>b("ScotchRTCSignalingExperiments").mungeMinParticipantsForEnablingDtx()&&(a=b("ScotchFBRTCSdpUtils").addFmtp(a,"opus","usedtx","1"))}return a};c.toSdp=function(){var a=this.$2;switch(a){case h.MULTIWAY:return this.$5();case h.CUSTOM:case h.P2P:default:return this.$1}};c.strongDiff=function(a){var b=this.toSdp();a=a.toSdp();return b!==a&&this.$6(b)!==this.$6(a)};c.$6=function(a){return this.$7(a).split("\r\n").filter(function(a){return!/^a=(candidate|setup):/.test(a)}).join("\r\n")};c.$7=function(a){return a.replace(/(o=\S+\s\S+)\s\S+\s/,"$1 - ")};return a}();e.exports=a}),null);
__d("ScotchRTCMWSessionDescription",["regeneratorRuntime","Promise","FBLogger","FBRTCConsoleLogger","FBRTCConstants","FBRTCMediaType","ScotchFBRTCTransactions","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCSessionDescription","ScotchRTCSignalingExperiments","ScotchRTWebUserActionLogger","ZenonMWMessageTypes","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").SignalingProtocol;b("ScotchFBRTCTransactions").FBRTCServerTransaction;var h=b("ZenonMWMessageTypes").ZenonMWMediaPauseStatus;a={_videoEnabled:{},serverMediaUpdate:function(a,c,d,e){var f=this,h,i,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:h=a.fromVersion,i=a.toVersion,j=a.mediaUpdates,k=a.offer;l=b("ScotchRTCCallStore").getConnection(g.MULTIWAY);m=e==null?void 0:e.id;if(l){s.next=6;break}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate no connection: "+JSON.stringify({transactionId:m}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});return s.abrupt("return");case 6:n=l.getLocalDescription();o=l.getRemoteDescriptionForSMU();p=o.sessionDescription.getVersion();b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate: "+JSON.stringify({fromVersion:h,toVersion:i,currentVersion:p,transactionId:m}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});if(!(p!==h)){s.next=14;break}b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate version mismatch: "+JSON.stringify({transactionId:m}),callID:d==null?void 0:d.callID,conferenceName:d==null?void 0:d.conferenceName,callType:"mw"});c(p,!1,null);return s.abrupt("return");case 14:j.forEach(function(a){f.maybeUpdatePausedDownlink(a,d),o.processServerMediaUpdate(a,d)});o.sessionDescription.setVersion(i);q=null;s.prev=17;if(!(b("ScotchRTCSignalingExperiments").enableSDPRenegotiation()&&k)){s.next=28;break}s.next=21;return b("regeneratorRuntime").awrap(l.setRemoteDescription(new(b("ScotchRTCSessionDescription"))(g.MULTIWAY,{type:"offer",sdp:k.sdpString})));case 21:s.next=23;return b("regeneratorRuntime").awrap(l.createAnswer());case 23:q=s.sent;s.next=26;return b("regeneratorRuntime").awrap(l.setLocalDescription(q));case 26:s.next=30;break;case 28:s.next=30;return b("regeneratorRuntime").awrap(b("Promise").all([l.setLocalDescription(n),l.setRemoteDescription(o)]));case 30:b("ScotchRTCGroupCallActions").toggleRemoteStream((r=[]).concat.apply(r,j.map(function(a){a=a.media;return a})).reduce(function(a,b){var c=b.id;b=b.enabled;c=l.getWebrtcTrackIdFromMWTrackId(c);a[c]=b;return a},{}));c(i,!0,q);s.next=39;break;case 34:s.prev=34,s.t0=s["catch"](17),b("FBLogger")("rtc_www").catching(s.t0).warn("Failed to apply SMU"),c(p,!1,null);case 39:case"end":return s.stop()}},null,this,[[17,34]])},maybeUpdatePausedDownlink:function(a,c){var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers;d=a.media;d.forEach(function(a){if(a.type===b("FBRTCMediaType").VIDEO){var d=e.find(function(b){return b.streams.find(function(b){return b.id.split(":")[0]==a.owner})}),f=a.pausedDownlink===h.Paused;d!=null&&d.pausedDownlink!==f&&(b("ScotchRTCCallActions").updateRemoteUsers(e.map(function(a){return a===d?a.setPausedDownlink(f):a})),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"pausedDownlink changed to "+f.toString()+" for user: "+d.FBID,callID:c==null?void 0:c.callID,conferenceName:c==null?void 0:c.conferenceName,callType:"mw"}))}})}};e.exports=a}),null);
__d("ScotchRTCMWThreadDeltaHandler",["Arbiter","ChannelConstants","CurrentUser","MercuryIDs","MercurySyncDeltaTypes","MessengerParticipants.bs","ScotchRTCCallInitUtils","ScotchRTCGroupCallActions"],(function(a,b,c,d,e,f){"use strict";a={initHandler:function(a){b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("delta"),function(c,d){c=d&&d.obj&&d.obj.queue;if(c&&c.toString()!==b("CurrentUser").getID())return;d=(c=d)!=null?(c=c.obj)!=null?c.delta:c:c;c=(c=d)!=null?(c=c.messageMetadata)!=null?(c=c.threadKey)!=null?c.threadFbId:c:c:c;if(!d||c!==a)return;switch(d["class"]){case b("MercurySyncDeltaTypes").ParticipantLeftGroupThread:b("ScotchRTCGroupCallActions").onParticipantLeft(d.leftParticipantFbId);break;case b("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:b("MessengerParticipants.bs").getMulti(d.addedParticipants.map(function(a){a=a.userFbId;return b("MercuryIDs").getParticipantIDFromUserID(a)}),b("ScotchRTCGroupCallActions").onParticipantsAdded);break}})},processThreadUpdateFromSignaling:function(a){var c=null;a=a.appMessages;a&&a.forEach(function(a){var b;b=(b=a)!=null?(b=b.body)!=null?(b=b.genericMessage)!=null?b.topic:b:b:b;a=(a=a)!=null?(a=a.body)!=null?(a=a.genericMessage)!=null?a.data:a:a:a;if(b==="thread_id_payload"&&a!=null){b=JSON.parse(a);if(b.thread_id!==null){c=b.thread_id;return}}});c&&b("ScotchRTCCallInitUtils").initializeThreadFromCollisionContext({groupThreadID:String(c),peerID:null})}};e.exports=a}),null);
__d("ScotchMWDeviceCapabilities",["FBRTCCapability","ScotchRTCSignalingExperiments"],(function(a,b,c,d,e,f){"use strict";a={getDeviceCapabilities:function(){if(b("ScotchRTCSignalingExperiments").enableSDPRenegotiation())return[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED,b("FBRTCCapability").SUPPORT_SDP_RENEGOTIATION];else return[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED]}};e.exports=a}),null);
__d("ScotchRTCProxyUserActions",["ScotchRTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";a={setProxyUsers:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"SET_PROXY_USER_MAP",proxyUserID:a,proxyingAsUserID:c})}};e.exports=a}),null);
__d("ScotchRTCProxyUserReducer",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){switch(b.type){case"SET_PROXY_USER_MAP":var c=b.proxyUserID;b=b.proxyingAsUserID;if(!a.proxyUserToProxyingAs.has(c))return a.set("proxyingAsToProxyUser",a.proxyingAsToProxyUser.set(b,c)).set("proxyUserToProxyingAs",a.proxyUserToProxyingAs.set(c,b))}return a}e.exports={setProxyUsers:a}}),null);
__d("ScotchRTCProxyUserStoreState",["immutable"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({proxyingAsToProxyUser:b("immutable").Map(),proxyUserToProxyingAs:b("immutable").Map()}));e.exports=a}),null);
__d("ScotchRTCProxyUserStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCProxyUserReducer","ScotchRTCProxyUserStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCProxyUserReducer").setProxyUsers];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCProxyUserStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCProxyUserUtils",["ImmutableObject","MercuryIDs","ScotchRTCProxyUserActions","ScotchRTCProxyUserStore","ScotchRTWebUserActionLogger","immutable"],(function(a,b,c,d,e,f){"use strict";a={setProxyingAsUsersFromMessage:function(a){a=a.appMessages;if(a){var c=new Map();a.forEach(function(a){var d;d=(d=a)!=null?(d=d.body)!=null?(d=d.genericMessage)!=null?d.topic:d:d:d;a=(a=a)!=null?(a=a.body)!=null?(a=a.genericMessage)!=null?a.data:a:a:a;if(d==="aloha_proxying_as_users"&&a!=null){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Initializing_AlohaProxyingAsUsers"});d=JSON.parse(a);for(var e in d){a=d[e][0].id.toString();a&&(b("ScotchRTCProxyUserActions").setProxyUsers(e,a),c.set(e,a))}}});return c}return null},transformProxyUserParticipantsToProxyingAs:function(a,c){for(var d in a){var e=a[d].fbid;if(c.has(e)){var f=a[d];e=c.get(e);var g=b("MercuryIDs").getParticipantIDFromUserID(e);f=b("ImmutableObject").setProperty(f,"fbid",e);f=b("ImmutableObject").setProperty(f,"id",g);a[g]=f}}return a},getUserIDToFetch:function(a){var c=b("ScotchRTCProxyUserStore").getState();c=c.proxyUserToProxyingAs;return c.has(a)?c.get(a):a}};e.exports=a}),null);
__d("ScotchMultiwayParticipantFetcher",["Promise","regeneratorRuntime","ImmutableObject","MercuryIDs","MercuryParticipantsConstants","MessengerParticipants.bs","MessengerParticipantsImages.re","ScotchRTCProxyUserUtils","immutable"],(function(a,b,c,d,e,f){"use strict";b("immutable").Map;b("immutable").Set;function g(a,c){var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){try{b("MessengerParticipantsImages.re").getBigImageMultiWithSize({ids:d.toArray(),callback:function(c){a(b("immutable").fromJS(c))},size:c})}catch(a){e(a)}})}function h(a,c){var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){try{b("MessengerParticipants.bs").getMulti(d.toArray(),function(d){c&&c.proxyingAsToProxyUser!=null&&c.proxyingAsToProxyUser!==void 0&&c.proxyingAsToProxyUser.size>0&&(d=b("ScotchRTCProxyUserUtils").transformProxyUserParticipantsToProxyingAs(d,c.proxyingAsToProxyUser)),a(b("immutable").fromJS(d))})}catch(a){e(a)}})}function i(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(h(a,c));case 2:d=f.sent;if(!c.profileImageSize){f.next=8;break}f.next=6;return b("regeneratorRuntime").awrap(g(a,c.profileImageSize));case 6:e=f.sent;return f.abrupt("return",d.withMutations(function(a){e.forEach(function(c,d){var e=a.get(d);if(e){e=b("ImmutableObject").setProperty(e,"big_image_src",c);a.set(d,e)}})}));case 8:return f.abrupt("return",d);case 9:case"end":return f.stop()}},null,this)}function j(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=b("immutable").Set([a]);d=b("MercuryIDs").getParticipantIDFromUserID(a);f.next=4;return b("regeneratorRuntime").awrap(i(c,{profileImageSize:b("MercuryParticipantsConstants").WWW_INCALL_THUMBNAIL_SIZE}));case 4:e=f.sent;return f.abrupt("return",e.get(d));case 6:case"end":return f.stop()}},null,this)}a={fetchParticipant:function(a,c){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(j(c));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},null,this)},fetchAllParticipants:function(a,c,d){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:d===void 0&&(d={});a.next=3;return b("regeneratorRuntime").awrap(i(c,d));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},null,this)}};e.exports=a}),null);
__d("ScotchgenerateRTCCallID",["randomInt"],(function(a,b,c,d,e,f){"use strict";function a(){return b("randomInt")(0,4294967294)+1}e.exports=a}),null);
__d("ScotchRTCMultiwayMessageHandler",["Promise","requireCond","CurrentUser","FBMqttChannel","FBRTCConstants","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCLogger","FBRTCRtcResponseStatusCode","Run","ScotchFBRTCMultiwayMessage","ScotchFBRTCTransactions","ScotchgenerateRTCCallID","ScotchMultiwayParticipantFetcher","ScotchMWDeviceCapabilities","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCMWProtocolHandler","ScotchRTCMWSessionDescription","ScotchRTCMWThreadDeltaHandler","ScotchRTCProxyUserStore","ScotchRTCProxyUserUtils","cr:1420073","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","ZenonPlatformExperiments","gkx","immutable","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").SignalingProtocol;b("ScotchFBRTCTransactions").FBRTCServerTransaction;var h=b("ScotchFBRTCTransactions").FBRTCTransactionOwner,i=15e3;a=function(){function a(){this.$3=-1,this.$6=[],this.$7=!1,this.$8=new h(),this.$9(),b("Run").onUnload(function(){b("FBMqttChannel").unsubscribeAll("/rtc_multi")})}var c=a.prototype;c.initialize=function(a,b,c,d){this.$1=a,this.$2=b,this.$4=c,this.$5=d};c.setShouldDeferServerRequests=function(a){this.$7=a;if(this.$7===!1)while(this.$6.length>0)this.$10(this.$6.shift())};c.waitForSignalingConnected=function(){var a=this;return new(b("Promise"))(function(c,d){if(b("FBMqttChannel").getConnectionState()==="Connected")c();else{b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"MQTT not connected, deferring JOIN request",conferenceName:a.$1});b("ScotchRTWebUserActionLogger").startTimer("MQTT not connected");var e={onMQTTStateChanged:function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"onMQTTStateChanged: "+a}),a==="Connected"&&(b("ScotchRTWebUserActionLogger").logStopTimer({checkpointName:"MQTT connected after deferring JOIN request",timerName:"MQTT not connected"}),b("FBMqttChannel").unsubscribeChannelEvents(e),window.clearTimeout(f),c())}},f=window.setTimeout(function(){b("FBMqttChannel").unsubscribeChannelEvents(e),b("ScotchRTWebUserActionLogger").logStopTimer({checkpointName:"MQTT never connected. Current status: "+b("FBMqttChannel").getConnectionState(),timerName:"MQTT not connected"}),d("timeout")},i);b("FBMqttChannel").subscribeChannelEvents(e)}})};c.$9=function(){var a=this;b("FBMqttChannel").subscribe("/rtc_multi",function(b){b=JSON.parse(b);a.$11(b)})};c.$11=function(a){var c=this,d=new(b("ScotchFBRTCMultiwayMessage"))(a);a=b("ScotchRTCCallStore").getState().callID;var e=b("ScotchRTCCallStore").getState().callInfo.conferenceState;b("FBRTCLogger").getInstance().logMultiwayMessageReceived(d,a);if(!d.isRequest())return;if(this.$1===d.conferenceName())this.$7===!0?this.$6.push(d):this.$10(d);else if(d.ringRequest()&&!this.$4&&e!=="TERMINATED"&&e!=="TERMINATING"){var f=this.$8.getTransaction(d);b("promiseDone")(f.start(),function(a){var e=b("ScotchgenerateRTCCallID")();b("promiseDone")(f.sendResponse(c.$12(a,e)),function(){return b("ScotchRTCMWProtocolHandler").otherUserInAnotherCall(d.conferenceName(),d.serverInfoData(),b("FBRTCHangupReason").IN_ANOTHER_CALL,e.toString(),"InAnotherCall")})})}};c.$12=function(a,c){var d=a.ringRequest(),e=a.serverInfoData();if(d==null||e==null)return a.createResponse(b("FBRTCRtcResponseStatusCode").BAD_REQUEST,{});d={deviceCapabilities:b("ScotchMWDeviceCapabilities").getDeviceCapabilities(),deviceStatus:b("FBRTCDeviceStatus").OK};return a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ringResponse:d},callID:c.toString()})};c.$13=function(a,c){b("promiseDone")(a.sendResponse(c.createResponse(b("FBRTCRtcResponseStatusCode").OK,{})))};c.$10=function(a){var c=this,d=this.$8.getTransaction(a);b("promiseDone")(d.start().then(function(a){if(a!=null){var e=b("ScotchRTCCallStore").getState(),f=e.callInfo;if(a.dismissRequest()!=null)a.serverInfoData()===f.serverInfoData&&(b("ScotchRTCGroupCallActions").handleDismissRequest(d,a),e.connections.forEach(function(a){return a.close()}),c.$5||b("ScotchRTCCallActions").removeAllLocalStreams(!0));else if(a.serverMediaUpdateRequest()!=null){e=a.serverMediaUpdateRequest();b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(e);if(e.renegotiationRequested){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){b("recoverableViolation")("[WR] SMU with renegotiation requested set to true but lobby mode disabled","rtc_www");return}b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Received SMU with renegotiation requested, sending CMU with offer",conferenceName:c.$1});var h=b("ScotchRTCCallStore").getConnection(g.MULTIWAY);if(h==null){b("recoverableViolation")("Peer connection should not be null when receiving SMU","rtc_www");return}var i=h.getLocalDescription(),j=i.sessionDescription.getVersion(),k=j+1;i.sessionDescription.setVersion(k);h.setLocalDescription(i);var l={},m=[];h=h.getLocalStreams();h.forEach(function(a){m=m.concat(a.getTracks())});m.forEach(function(a){l[a.id]=a.enabled});b("ScotchRTCMWProtocolHandler").clientMediaUpdate(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,j,k,[{mediaStatus:l}],i);return}b("ScotchRTCMWSessionDescription").serverMediaUpdate(a.serverMediaUpdateRequest(),function(c,e,g){b("ScotchRTCGroupCallActions").onServerMediaUpdateSuccess();e=e?b("FBRTCRtcResponseStatusCode").OK:b("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED;var h=d.id;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_serverMediaUpdate response: "+JSON.stringify({statusCode:e,currentVersion:c,answer:g==null?void 0:g.toSdp(),transactionId:h}),callID:f.callID,conferenceName:f.conferenceName,callType:"mw"});d.sendResponse(a.createResponse(e,{body:{serverMediaUpdateResponse:{currentVersion:c,answer:g}},callID:f.callID}))},f,d);if(b("cr:1420073")!=null&&e.stateStore!=null&&Object.keys(e.stateStore).length>0){h=Object.keys(e.stateStore);for(var j=0;j<h.length;j++){k=h[j];b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] SMU request with ss payload for topic: "+k+" was received",conferenceName:c.$1});i=e.stateStore[k];b("cr:1420073").setOutputState(k,i)}}}else if(a.notifyRequest()!=null){if(b("cr:1420073")==null)return;k=a.notifyRequest();i=k.topic;h=k.version;j=k.data;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] Notify request for topic: "+i+" was received",conferenceName:c.$1});if(b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&i.localeCompare("simple_external")==0){b("FBRTCLogger").getInstance().logCallAction(null,c.$1,"STATE_SYNC_OUTPUT_NOTIFY_REQUEST","received output state: "+((e=j)!=null?e:"")+" on join response for topic simple_external",null)}b("cr:1420073").setOutputState(i,{version:h,data:j});d.sendResponse(a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{notifyResponse:{topic:i,version:h}},callID:f.callID}))}else if(a.conferenceStateRequest()!=null){k=a.conferenceStateRequest();b("gkx")("1509739")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_CSU received version "+String(k.version),callID:f==null?void 0:f.callID,conferenceName:f==null?void 0:f.conferenceName,callType:"mw"});e=b("ScotchRTCCallStore").getState();j=e.remoteUsers;var n=j.map(function(a){return a.FBID});i=Object.keys(k.participantStates);h=i.filter(function(a){return a!==b("CurrentUser").getID()&&!n.has(a)});b("ScotchRTCMWThreadDeltaHandler").processThreadUpdateFromSignaling(k);if(h.length>0){e=b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(k);var o=new Set(h);e!=null&&e.forEach(function(a,b){o["delete"](b),a!==null&&!o.has(a)&&o.add(a)});j=b("ScotchRTCProxyUserStore").getState();i=j.proxyingAsToProxyUser;b("promiseDone")(b("ScotchMultiwayParticipantFetcher").fetchAllParticipants(c.$1,b("immutable").Set(o),{profileImageSize:100,proxyingAsToProxyUser:i}),function(e){b("ScotchRTCGroupCallActions").onParticipantsAdded(e.toJS()),b("ScotchRTCGroupCallActions").handleConferenceStateRequest(d,a,c.$3,function(a){c.$3=a})},function(a){b("gkx")("1509739")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSessionDescription_CSU fetchAllParticipants failed "+a,callID:f==null?void 0:f.callID,conferenceName:f==null?void 0:f.conferenceName,callType:"mw"})})}else b("ScotchRTCGroupCallActions").handleConferenceStateRequest(d,a,c.$3,function(a){c.$3=a})}else if(a.startScreenSharingRequest()!=null){k=a.startScreenSharingRequest();b("ScotchRTCGroupCallActions").addRemoteScreenSharingUserID(k);c.$13(d,a)}else if(a.endScreenSharingRequest()!=null){h=a.endScreenSharingRequest();b("ScotchRTCGroupCallActions").removeRemoteScreenSharingUserID(h);c.$13(d,a)}}}))};return a}();e.exports=a}),null);
__d("ScotchRTCP2PCallWindowHandler",["ScotchRTCCallStore","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger","setTimeout"],(function(a,b,c,d,e,f){"use strict";var g;a={init:function(a){this._isWindowOpened()&&this.close(),g=a,this.updateCallInProgressIndicator(),this._monitorOpenerForChanges()},updateCallInProgressIndicator:function(a){if(!this._isWindowOpened())return;var c=b("ScotchRTCCallStore").getState();c=c.remoteUsers;a=a?a:b("ScotchRTCP2PCallStore").getState().connectionStatus;!c.count()||a==="DISCONNECTED"?g.rtcCallInProgessWith=null:g.rtcCallInProgessWith=c.first().FBID.toString()},reload:function(){this._isWindowOpened()&&g.location.reload()},close:function(){this._isWindowOpened()&&g.close()},_monitorOpenerForChanges:function(){var a=this;if(g.opener)try{g.opener.addEventListener("unload",function(b){a._passWindowToOpener()})}catch(a){}},_passWindowToOpener:function(a){var c=this;a===void 0&&(a=10);b("setTimeout")(function(){if(!c._isWindowOpened()||a<=1)return;try{if(g.opener&&!g.opener.closed){g.opener.rtcCallChildWindow=g;return}}catch(a){b("ScotchRTWebUserActionLogger").logErrorOnceforDomain("RTCP2PCallWindowHandler__passWindowToOpener",a)}c._passWindowToOpener(a-1)},1e3)},_isWindowOpened:function(){return!!(g&&!g.closed)}};e.exports=a}),null);
__d("ScotchRTCScreenSharingWindowHandler",["ScotchRTCP2PCallActions","ScotchRTCUtils","SecurePostMessage","XScreenSharingController","promiseDone"],(function(a,b,c,d,e,f){var g=540,h=960,i;a={open:function(a,c,d){var e=this;i=window.open("about:blank","Screen Sharing",this._getWindowFeatures());window.callInfo=d;b("promiseDone")(b("ScotchRTCUtils").getStreamVideoResolution(c)["catch"](function(b){e._setupScreenSharingWindow(a,c,null)}),function(b){e._setupScreenSharingWindow(a,c,b)})},_setupScreenSharingWindow:function(a,b,c){var d=this;window.getRemoteMediaStream=function(){return b};window.closeScreenSharingWindow=this._onUnload;if(c){c=this._getConstrainedSize(c.width,c.height);var e=c.width,f=c.height;i.resizeTo(e,f);window.setTimeout(function(){d._adjustScreenSize({width:e,height:f})},200)}i.location=this._getUnsignedUri(a);window.focus&&this.isWindowOpened()&&i.focus()},_adjustScreenSize:function(a){if(!i)return;i.resizeTo(a.width,a.height+(a.height-i.innerHeight))},close:function(){if(i){var a=null;i.opener&&!i.opener.closed&&(a=i.opener);i.close();i=null;a&&b("SecurePostMessage").sendMessageAllowAnyOrigin_UNSAFE(a,{recipient:"SC_CONTENT_SCRIPT",type:"SC_RESET_PORT",text:"reset comm port"})}},isWindowOpened:function(){return!!(i&&!i.closed)},_onUnload:function(){b("ScotchRTCP2PCallActions").togglePopOutScreenContent()},_getWindowFeatures:function(){var a=screen.availLeft,b=screen.availTop,c=this._getConstrainedSize(Math.min(h,screen.width-a),Math.min(g,screen.height-b)),d=c.width;c=c.height;c={height:"height="+c.toString(),width:"width="+d.toString(),top:"top="+b.toString(),left:"left="+a.toString()};return["menubar=no","location=no","scrollbars=no","status=no","personalbar=no",c.height,c.width,c.top,c.left].join(",")},_getConstrainedSize:function(a,b){var c;a>h&&(c=h/a,b*=c,a*=c);b>g&&(c=g/b,a*=c,b*=c);return{width:a,height:b}},_getUnsignedUri:function(a){return b("XScreenSharingController").getURIBuilder().setFBID("peer_id",a).setInt("version",2).getURI()}};e.exports=a}),null);
__d("ScotchRTCP2PCallActions",["ScotchRTCAppDispatcher","ScotchRTCP2PCallWindowHandler"],(function(a,b,c,d,e,f){"use strict";a={reload:function(){b("ScotchRTCP2PCallWindowHandler").reload()},setCallType:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CALL_TYPE",callType:a})},setConnectionStatus:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_CONNECTION_STATUS",connectionStatus:a})},setMultiwayEscalationSupport:function(a,c){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MULTIWAY_ESCALATION_SUPPORT",offerEscalationSupport:a,escalationConferenceName:c})},setRemoteSignalingExperiments:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_REMOTE_SIGNALING_EXPERIMENTS",remoteSignalingExperiments:a})},togglePopOutScreenContent:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"POP_OUT_SCREEN_CONTENT":"POP_IN_SCREEN_CONTENT",stream:a})},processMessage:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_PROCESS_MESSAGE",message:a})},setIsCaller:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_SET_IS_CALLER",isCaller:a})},togglePoorNetworkQualityIndicator:function(a){b("ScotchRTCAppDispatcher").dispatch({type:a?"SHOW_POOR_NETWORK_QUALITY":"DISMISS_POOR_NETWORK_QUALITY"})},starRatingDone:function(a){a===void 0&&(a=!0),b("ScotchRTCAppDispatcher").dispatch({type:"P2P_STAR_RATING_DONE",done:a})}};e.exports=a}),null);
__d("ScotchFBRTCCallSummaryReducer",["FBRTCCallSummaryPageVisibilityObserver","FBRTCCallSummaryStore","FBRTCLogger","ScotchFBRTCMediaMetricParser","ScotchRTCCallStore"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCLogger").Key;a={setCallSummary:function(a,b){switch(b.type){case"SET_CALL_SUMMARY":return a.set("callSummary",b.callSummary)}return a},onCallStarted:function(a,c){switch(c.type){case"INCOMING_CALL_SUCCESS":case"CALL_SUCCESS":c=function c(){var d=b("ScotchRTCCallStore").getState().callInfo,e=d.conferenceState;d=d.callID;e!=="TERMINATED"&&a.callInfo.callID===d&&(a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()),window.setTimeout(c,1e4))};c();b("FBRTCCallSummaryPageVisibilityObserver").onCallStart(a.callSummary);b("ScotchFBRTCMediaMetricParser").startCollectingMediaStats();return a}return a},onMessageSignaling:function(a,c){switch(c.type){case"ON_JOIN_REQUEST_SENT":a.callSummary.setJoinRequestSent();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_RECEIVED_JOIN_RESPONSE":a.callSummary.setJoinResponseReceived();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_JOIN_RESPONSE":a.callSummary.setServerInfoData(c.serverInfoData);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"ON_PROCESSED_JOIN_RESPONSE":a.callSummary.setJoinResponseProcessed();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a},onCallEnded:function(a,c){switch(c.type){case"CALL_ERROR":case"HANGUP":case"END_CALL":a.callSummary.onCallEnded(c.endCallReason,!1,!1,c.endCallSubreason);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());b("FBRTCCallSummaryPageVisibilityObserver").onCallEnd(a.callSummary);return a;case"DISMISS":a.callSummary.onCallEnded(c.endCallReason,!0,!1,c.endCallSubreason);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());b("FBRTCCallSummaryPageVisibilityObserver").onCallEnd(a.callSummary);return a}return a},onSurveyResult:function(a,c){switch(c.type){case"RATING_SHOWN":a.callSummary.addExtraInfo(g.RATING_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"FEEDBACK_SHOWN":a.callSummary.addExtraInfo(g.SURVEY_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_RATING":a.callSummary.addExtraInfo(g.RATING,c.rating);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_FEEDBACK":a.callSummary.addExtraInfo(g.SURVEY_DETAILS,c.feedback);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case"SUBMIT_SURVEY_CHOICE":a.callSummary.addExtraInfo(g.SURVEY_CHOICE,c.surveyChoice);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}};e.exports=a}),null);
__d("ScotchFBRTCClientMediaUpdateReducer",["FBRTCConstants","FBRTCRtcResponseStatusCode","ScotchFBRTCMWProtocolStore","ScotchRTCCallStore","ScotchRTCMWProtocolHandler","flatMapArray"],(function(a,b,c,d,e,f){"use strict";a={reset:function(a,c){switch(c.type){case"RESET":return b("ScotchFBRTCMWProtocolStore").getInitialState()}return a},configureAudio:function(a,b){switch(b.type){case"AUDIO_MUTED":return g(a,"audio",!1);case"AUDIO_UNMUTED":return g(a,"audio",!0)}return a},configureScreenSharing:function(a,c){switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":return g(a,"video",!0);case"REMOVE_LOCAL_SCREEN_STREAM":return g(a,"video",!b("ScotchRTCCallStore").getState().localUser.isVideoDisabled())}return a},configureVideo:function(a,c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(d&&d.hasScreenStream())return a;switch(c.type){case"VIDEO_MUTED":return g(a,"video",!1);case"VIDEO_UNMUTED":return g(a,"video",!0)}return a},onClientMediaUpdateResponse:function(a,c){switch(c.type){case"ON_CLIENT_MEDIA_UPDATE_RESPONSE":if(c.responseStatusCode!==b("FBRTCRtcResponseStatusCode").OK)return a;a=a.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],c.currentVersion);if(a.clientMediaUpdateInfo.pendingResponse){a=a.setIn(["clientMediaUpdateInfo","pendingResponse"],!1);if(a.clientMediaUpdateInfo.pendingUpdate)return h(a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!1))}return a}return a},setLocalClientVersion:function(a,b){switch(b.type){case"SET_LOCAL_CLIENT_VERSION":return a.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],b.version).setIn(["clientMediaUpdateInfo","localMediaUpdates"],a.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:{}}))}return a},onLocalTrackReplaced:function(a,b){switch(b.type){case"ON_LOCAL_TRACK_REPLACED":var c=b.newTrack;b=b.oldTrack;if(b==null)return a;var d=a.clientMediaUpdateInfo.localToMWSTrackIDMap.get(b.id);d!=null?a=a.setIn(["clientMediaUpdateInfo","localToMWSTrackIDMap"],a.clientMediaUpdateInfo.localToMWSTrackIDMap["delete"](b.id)):d=b.id;return a.setIn(["clientMediaUpdateInfo","localToMWSTrackIDMap"],a.clientMediaUpdateInfo.localToMWSTrackIDMap.set(c.id,d))}return a}};function g(a,c,d){var e=b("ScotchRTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!e)return a;var f={};e=b("ScotchRTCCallStore").getState();e=e.localUser;var g=a.clientMediaUpdateInfo.localToMWSTrackIDMap;b("flatMapArray")([e.getScreenStream(),e.getStream()],function(a){return a!=null?a.getTracks():[]}).forEach(function(a){var b=g.get(a.id)||a.id;f[b]==null&&(f[b]=a.kind===c?d:a.enabled)});return h(a.setIn(["clientMediaUpdateInfo","localMediaUpdates"],a.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:f})))}function h(a){if(a.clientMediaUpdateInfo.pendingResponse)return a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!0);var c=a.clientMediaUpdateInfo.localMediaUpdates.reduce(function(b,c,d){d>=a.clientMediaUpdateInfo.lastSyncedClientVersion&&b.push(c);return b},[]);if(c.length===0)return a;b("ScotchRTCMWProtocolHandler").clientMediaUpdate(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,a.clientMediaUpdateInfo.lastSyncedClientVersion,a.clientMediaUpdateInfo.localMediaUpdates.size,c);return a.setIn(["clientMediaUpdateInfo","pendingResponse"],!0)}e.exports=a}),null);
__d("ScotchFBRTCGroupCallParticipantsReducer",["MercuryIDs","ScotchRTCCallStore","ScotchRTCMWProtocolHandler","immutable"],(function(a,b,c,d,e,f){"use strict";var g={_participantsToRing:new Set(),initThread:function(a,b){var c;switch(b.type){case"INIT_THREAD":return a.merge({participants:(c=b.participants)!=null?c:a.participants,thread:b.thread})}return a},onParticipantsChanged:function(a,c){switch(c.type){case"ON_PARTICIPANT_LEFT":return a.set("participants",a.participants["delete"](b("MercuryIDs").getParticipantIDFromUserID(c.participantFBID)));case"ON_PARTICIPANTS_ADDED":var d=Object.keys(c.participants).map(function(a){return c.participants[a].fbid}).filter(function(a){return g._participantsToRing.has(a)});d.length!==0&&(d.forEach(function(a){return g._participantsToRing["delete"](a)}),b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,d));return a.set("participants",a.participants.merge(b("immutable").Map(c.participants)))}return a},addParticipantsToRing:function(a,b){switch(b.type){case"ADD_PARTICIPANTS_TO_RING":b.participantFBIDs.forEach(function(a){return g._participantsToRing.add(a)});return a}return a}};e.exports=g}),null);
__d("ScotchRTCStreamDurationTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(a){var c=this;a===void 0&&(a="mixed");this.$3=0;this.$4=0;this.$5=!1;this.update=function(){if(!c.$5)return;c.$6()?c.$4===0&&(c.$4=(g||(g=b("performanceNow")))()):c.pause(c.$2)};this.$1=a}var c=a.prototype;c.isStarted=function(){return this.$5};c.track=function(a){if(a===this.$2){this.update();return}if(this.$2&&this.$5){var b=this.$2;b.removeEventListener("addtrack",this.update);b.removeEventListener("removetrack",this.update)}a?(this.$5&&this.$6()&&(this.$3=this.getDuration()),this.$2=a,this.$5&&this.start()):this.stop()};c.$6=function(){return!this.$2?!1:this.$7().some(function(a){return a.enabled&&a.readyState!=="ended"})};c.$7=function(){if(!this.$2)return[];switch(this.$1){case"audio":return this.$2.getAudioTracks();case"video":return this.$2.getVideoTracks();case"screen":return this.$2.getVideoTracks();default:return this.$2.getTracks()}};c.pause=function(a){if(!this.$5)return;if(this.$2!==a)return;this.$3=this.getDuration();this.$4=0};c.getDuration=function(){return this.$4===0?this.$3:this.$3+(g||(g=b("performanceNow")))()-this.$4};c.start=function(){this.$5=!0;this.$6()&&(this.$4=(g||(g=b("performanceNow")))());if(this.$2){var a=this.$2;a.addEventListener("addtrack",this.update);a.addEventListener("removetrack",this.update)}};c.stop=function(){if(!this.$5)return;this.$3=this.getDuration();this.$5=!1;this.$4=0;if(this.$2){var a=this.$2;a.removeEventListener("addtrack",this.update);a.removeEventListener("removetrack",this.update)}};return a}();e.exports=a}),null);
__d("ScotchFBRTCGroupCallStoreState",["ScotchRTCStreamDurationTracker","immutable"],(function(a,b,c,d,e,f){"use strict";a={localVideoDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("video"),remoteVideoDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("video"),localScreenDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("screen")};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));d={dominantSpeakerFBID:null,endCallReason:null,responseSubCode:null,layout:null,participants:b("immutable").Map(),pinnedSpeakerFBID:null,thread:null,videoDurationTrackerInfo:new c(),forceEncodingEnabled:!1,videoEscalateState:"initial"};f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(d));e.exports=f}),null);
__d("ScotchFBRTCGroupCallReducer",["FBRTCConstants","FBRTCParticipantCallState","ScotchFBRTCGroupCallStoreState","ScotchRTCCallStore","ScotchRTCEndCallReason","ScotchRTCMWProtocolHandler"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").SignalingProtocol;a={setDominantSpeaker:function(a,c){switch(c.type){case"SET_DOMINANT_SPEAKER":return a.set("dominantSpeakerFBID",c.dominantSpeakerFBID);case"SET_PINNED_SPEAKER":var d=b("ScotchRTCCallStore").getState();d=d.callInfo;var e=b("ScotchRTCCallStore").getConnection(g.MULTIWAY);if(!e)return a;b("ScotchRTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),a.layout,c.pinnedSpeakerFBID);return a.set("pinnedSpeakerFBID",c.pinnedSpeakerFBID);case"ON_CONFERENCE_STATE":d=c.request.conferenceStateRequest();e=d.participantStates;c=e[a.pinnedSpeakerFBID];return c&&c.state!==b("FBRTCParticipantCallState").CONNECTED?a.set("pinnedSpeakerFBID",null):a}return a},setLayout:function(a,c){switch(c.type){case"SET_LAYOUT":var d=b("ScotchRTCCallStore").getState();d=d.callInfo;var e=b("ScotchRTCCallStore").getConnection(g.MULTIWAY);e&&b("ScotchRTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),c.layout,a.pinnedSpeakerFBID);return a.set("layout",c.layout)}return a},processEndCallReason:function(a,c){switch(c.type){case"CALL_ERROR":case"HANGUP":case"END_CALL":case"DISMISS":return a.set("endCallReason",c.endCallReason!=null?new(b("ScotchRTCEndCallReason"))(c.endCallReason):a.endCallReason)}return a},onForceEncodingChanged:function(a,c){switch(c.type){case"FORCE_ENCODING_ENABLED":var d=b("ScotchRTCCallStore").getConnection(g.MULTIWAY);d&&b("ScotchRTCMWProtocolHandler").updateLocalEncodingActive(d,c.enabled);return a.set("forceEncodingEnabled",c.enabled)}return a},onVideoEscalationStarted:function(a,b){switch(b.type){case"MW_VIDEO_ESCALATION_STARTED":return a.set("videoEscalateState","inProgress")}return a},onVideoEscalationCompleted:function(a,b){switch(b.type){case"MW_VIDEO_ESCALATION_COMPLETED":return a.set("videoEscalateState","escalated")}return a},onReset:function(a,c){switch(c.type){case"RESET":case"RESET_FOR_REDIAL":return new(b("ScotchFBRTCGroupCallStoreState"))();case"MW_VIDEO_ESCALATION_RESET":return a.set("videoEscalateState","initial")}return a}};e.exports=a}),null);
__d("ScotchFBRTCVideoDurationTrackerReducer",["FBRTCCallSummaryStore","ScotchRTCCallStore"],(function(a,b,c,d,e,f){"use strict";a={track:function(a,c){var d=a.videoDurationTrackerInfo,e=d.localVideoDurationTracker,f=d.remoteVideoDurationTracker;d=d.localScreenDurationTracker;switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":d.track(c.stream),d.isStarted()||d.start();case"ADD_LOCAL_STREAM":e.track(c.stream);e.isStarted()||e.start();return a;case"REMOVE_LOCAL_SCREEN_STREAM":d.pause(c.stream);return a;case"REPLACE_LOCAL_SCREEN_STREAM":d.track(c.newStream);e.track(c.newStream);return a;case"ADD_REMOTE_STREAM":case"TOGGLE_REMOTE_STREAM":d=b("ScotchRTCCallStore").getState().remoteUsers.find(function(a){return!a.isVideoDisabled()});f.stop();f.start();f.track(d&&d.streams.first());return a}return a},update:function(a,b){switch(b.type){case"VIDEO_MUTED":case"VIDEO_UNMUTED":a.videoDurationTrackerInfo.localVideoDurationTracker.update()}return a},stop:function(a,c){switch(c.type){case"DISMISS":case"END_CALL":case"HANGUP":c=a.videoDurationTrackerInfo;var d=b("ScotchRTCCallStore").getState();d=d.callSummary;c.localVideoDurationTracker.stop();c.remoteVideoDurationTracker.stop();c.localScreenDurationTracker.stop();d.setVideoDurations(c.localVideoDurationTracker.getDuration(),c.remoteVideoDurationTracker.getDuration());d.setScreenDuration(c.localScreenDurationTracker.getDuration());d.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}};e.exports=a}),null);
__d("ScotchRTCNotificationUtils",["fbt","immutable","intlList"],(function(a,b,c,d,e,f,g){"use strict";a={addingUsersToCallText:function(a,c){if(c&&c.size>0){c=c.toArray().map(function(a){return a.short_name});c=a?g._("Adding {names of users being added to call} to your call...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))]):g._("Adding {names of users being added to call} to your video chat...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))])}else c=a?g._("Adding someone to your call..."):g._("Adding someone to your video chat...");return c},unableToAddUsersToCallText:function(a,c){if(c&&c.size>0){c=c.toArray().map(function(a){return a.short_name});return g._("Unable to add {names of users being added to call}",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.OR))])}return a?g._("Unable to add person to your call"):g._("Unable to add person to your video chat")}};e.exports=a}),null);
__d("ScotchRTCCallNotificationReducer",["RTCCallActionTypes","RTCGroupCallEscalationActionTypes","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCGroupCallEscalationStore","ScotchRTCNotificationUtils"],(function(a,b,c,d,e,f){"use strict";function a(a,c){switch(c.type){case"GROUP_ESCALATION_START":c=!b("ScotchRTCCallStore").hasRemoteVideo()&&!b("ScotchRTCCallStore").hasLocalVideo();c=b("ScotchRTCNotificationUtils").addingUsersToCallText(c,b("ScotchRTCGroupCallEscalationStore").getState().usersToRing);return a.set("notificationText",c).set("useTimeout",!1)}return a}function c(a,c){switch(c.type){case"ON_CONFERENCE_STATE":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCGroupCallEscalationStore").getDispatchToken()]);return b("ScotchRTCGroupCallEscalationStore").getState().readyToTransition?a.set("notificationText",null).set("useTimeout",!1):a}return a}function d(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":c=!b("ScotchRTCCallStore").hasRemoteVideo()&&!b("ScotchRTCCallStore").hasLocalVideo();c=b("ScotchRTCNotificationUtils").unableToAddUsersToCallText(c,b("ScotchRTCGroupCallEscalationStore").getState().usersToRing);return a.set("notificationText",c).set("useTimeout",!0)}return a}function f(a,b){switch(b.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.withMutations(function(a){a.set("notificationText",null).set("useTimeout",!0)})}return a}e.exports={clearStore:f,onEscalationStarted:a,onEscalationCompletion:c,onAbortedEscalation:d}}),null);
__d("ZenonRenderedView",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({THUMBNAIL:1,GRID:2,PINNED:3});e.exports=a}),null);
__d("ZenonMediaStatsConfig",["ZenonRenderedView"],(function(a,b,c,d,e,f){"use strict";a="globalStatsTrackId";c="audio";d=b("ZenonRenderedView").GRID;f="pinnedAudioStatsTrackId";b="pinnedVideoStatsTrackId";var g="outboundAudioStatsTrackId",h="outboundScreenStatsTrackId",i="outboundVideoStatsTrackId",j=0,k=6e4,l={AUDIO_DEV_IS_STALLED:"audioDevIsStalled",AUDIO_DEV_REC_STALLS:"audioDevRecStalls",AUDIO_DEV_STALL_DURATION:"audioDevStallDuration",AUDIO_DEV_TOTAL_STALLS:"audioDevTotalStalls",AV_SYNC:"avSync",AV_SYNC_ABS:"avSyncAbs",AV_SYNC_COUNT:"avSyncCount",AV_SYNC_OOB:"avSyncOob",E2E_LATENCY:"e2eLatency",FRAME_RATE_MEAN:"framerateMean",PACKETS_LOST_CORRECTED:"packetsLostCorrected",RENDERED_VIEW:"renderedView",SIMULCAST_LAYER_CHANGES:"simulcast_layer_changes",VIDEO_CAPTURE_FRAME_COUNT:"captureFrameCount",VIDEO_CONVERTED_QP_SUM:"videoConvertedQpSum",VIDEO_DECODE_TIME:"videoDecodeTime",VIDEO_DECODED_BYTES:"videoDecodedBytes",VIDEO_FREEZE_COUNT:"videoFreezeCount",VIDEO_FREEZE_DURATION:"videoFreezeDuration",VIDEO_PAUSE_COUNT:"videoPauseCount",VIDEO_PAUSE_DURATION:"videoPauseDuration",VIDEO_QP:"qp",VIDEO_SUM_CAPTURE_PIXEL:"videoSumCapturePixel",VIDEO_SUM_PIXEL:"videoSumPixel"},m={AUDIO_NETEQ_WAIT_TIME:"audioNeteqWaitTime",AUDIO_PACKET_LOSS_RATE:"audioPacketLossRate",AUDIO_PLC_CNG_RATE:"audioPlcCngRate",AUDIO_PLC_RATE:"audioPlcRate",GLOBAL_AUDIO_BITRATE:"globalAudioBitrate",GLOBAL_BATTERY_USAGE:"globalBatteryUsage",GLOBAL_CPU_USAGE:"globalCpuUsage",GLOBAL_VIDEO_BITRATE:"globalVideoBitrate",ROUND_TRIP_TIME:"roundTripTime",VIDEO_AV_SYNC_ABS:"videoAvSyncAbs",VIDEO_AV_SYNC_OOB:"videoAvSyncOob",VIDEO_CROPPING_RATIO:"videoCroppingRatio",VIDEO_ENCODED_FRAME_RATE:"encodedFrameRate",VIDEO_FRAME_RATE:"videoFrameRate",VIDEO_FREEZE_COUNT_PER_MIN:"videoFreezeCountPerMin",VIDEO_FREEZE_DURATION_PER_MIN:"videoFreezeDurationPerMin",VIDEO_NETEQ_WAIT_TIME:"videoNeteqWaitTime",VIDEO_PACKET_LOSS_RATE:"videoPacketLossRate",VIDEO_QP:"videoQP",VIDEO_QUALITY:"videoQuality",VIDEO_RENDER_SCALE_RATIO:"videoRenderScaleRatio"},n=["bytesReceived","bytesSent","consentRequestsSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","firCount","framesDecoded","framesEncoded","framesReceived","framesSent","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","jitterBufferDelay","jitterBufferEmittedCount","keyFramesEncoded","packetsLost","packetsReceived","packetsSent","pliCount","qpSum","requestsReceived","requestsSent","responsesReceived","responsesSent","totalAudioEnergy","totalDecodeTime","totalEncodeTime","totalInterFrameDelay","totalPacketSendDelay","totalSquaredInterFrameDelay",l.AUDIO_DEV_REC_STALLS,l.AUDIO_DEV_STALL_DURATION,l.AUDIO_DEV_TOTAL_STALLS,l.AV_SYNC_COUNT,l.AV_SYNC_OOB,l.PACKETS_LOST_CORRECTED,l.SIMULCAST_LAYER_CHANGES,l.VIDEO_CAPTURE_FRAME_COUNT,l.VIDEO_FREEZE_COUNT,l.VIDEO_FREEZE_DURATION,l.VIDEO_PAUSE_COUNT,l.VIDEO_PAUSE_DURATION,l.VIDEO_SUM_CAPTURE_PIXEL,l.VIDEO_SUM_PIXEL,l.VIDEO_CONVERTED_QP_SUM,l.VIDEO_DECODED_BYTES,l.VIDEO_DECODE_TIME],o=["audioLevel","availableOutgoingBitrate","frameHeight","frameWidth","framesPerSecond","googAccelerateRate","googCurrentDelayMs","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","googSecondaryDiscardedRate","height","jitter","roundTripTime","width",l.AUDIO_DEV_IS_STALLED,l.RENDERED_VIEW,l.FRAME_RATE_MEAN,l.E2E_LATENCY,l.AV_SYNC,l.AV_SYNC_ABS,l.VIDEO_QP],p=["availableOutgoingBitrate","bytesReceived","bytesSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","firCount","frameHeight","framesDecoded","framesEncoded","framesPerSecond","framesReceived","framesSent","frameWidth","googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googRtt","googSecondaryDiscardedRate","height","jitter","jitterBufferDelay","jitterBufferEmittedCount","packetsLost","packetsReceived","packetsSent","pliCount","qpSum","roundTripTime","totalAudioEnergy","totalDecodeTime","totalEncodeTime","totalInterFrameDelay","totalPacketSendDelay","totalSquaredInterFrameDelay","width",l.AUDIO_DEV_REC_STALLS,l.AUDIO_DEV_STALL_DURATION,l.AUDIO_DEV_TOTAL_STALLS,l.PACKETS_LOST_CORRECTED,l.VIDEO_CAPTURE_FRAME_COUNT,l.VIDEO_FREEZE_COUNT,l.VIDEO_FREEZE_DURATION,l.VIDEO_PAUSE_COUNT,l.VIDEO_PAUSE_DURATION,l.VIDEO_SUM_CAPTURE_PIXEL,l.VIDEO_SUM_PIXEL,l.VIDEO_CONVERTED_QP_SUM,l.VIDEO_DECODED_BYTES,l.VIDEO_DECODE_TIME,l.SIMULCAST_LAYER_CHANGES,l.AUDIO_DEV_IS_STALLED,l.FRAME_RATE_MEAN,l.E2E_LATENCY,l.AV_SYNC,l.AV_SYNC_ABS],q=["availableOutgoingBitrate","consentRequestsSent","requestsReceived","requestsSent","responsesReceived","responsesSent"],r=["audioLevel","framesPerSecond","height","timestamp","totalAudioEnergy","totalSamplesDuration","width"],s=["googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","googSecondaryDiscardedRate","packetsLost"],t=["audioLevel","concealedSamples","concealmentEvents","delayedPacketOutageSamples","frameHeight","framesDropped","framesReceived","framesSent","frameWidth","insertedSamplesForDeceleration","interruptionCount","jitterBufferDelay","jitterBufferEmittedCount","jitterBufferTargetDelay","relativePacketArrivalDelay","removedSamplesForAcceleration","sumOfSquaredFramesDuration","timestamp","totalAudioEnergy","totalFramesDuration","totalInterruptionDuration","totalSamplesDuration","totalSamplesReceived"],u=["firCount","nackCount","packetsLost","pliCount","qpSum","sliCount","timestamp"],v=["bytesSent","framesEncoded","headerBytesSent","hugeFramesSent","keyFramesEncoded","packetsSent","qualityLimitationResolutionChanges","retransmittedBytesSent","retransmittedPacketsSent","targetBitrate","totalEncodedBytesTarget","totalEncodeTime","totalPacketSendDelay"],w=["burstDiscardCount","burstDiscardRate","burstLossCount","burstPacketsDiscarded","burstPacketsLost","bytesReceived","decoderImplementation","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","framesDecoded","gapDiscardRate","gapLossRate","headerBytesReceived","jitter","keyFramesDecoded","lastPacketReceivedTimestamp","packetsDiscarded","packetsReceived","packetsRepaired","roundTripTime","totalDecodeTime","totalInterFrameDelay","totalSquaredInterFrameDelay"],x=["audioLevel","availableOutgoingBitrate","bytesReceived","bytesSent","estimatedPlayoutTimestamp","fecPacketsDiscarded","fecPacketsReceived","frameHeight","framerateMean","framesDecoded","framesEncoded","framesPerSecond","framesReceived","framesSent","frameWidth","googAccelerateRate","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterReceived","googPreemptiveExpandRate","googPreferredJitterBufferMs","googRtt","height","jitter","jitterBufferDelay","jitterBufferEmittedCount","keyFramesEncoded","packetsLost","packetsReceived","packetsSent","qpSum","roundTripTime","totalAudioEnergy","totalDecodeTime","totalEncodeTime","width",l.E2E_LATENCY,l.VIDEO_QP],y=["consentRequestsSent","estimatedPlayoutTimestamp","estimatedPlayoutTimestamp_delta","fecPacketsDiscarded","fecPacketsReceived","googDecodingCNG","googDecodingCTN","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","jitterBufferDelay_delta","jitterBufferDelay","jitterBufferEmittedCount_delta","jitterBufferEmittedCount","keyFramesEncoded","packetsLost","packetsReceived","packetsSent","qpSum_delta","qpSum","requestsReceived","requestsSent","responsesReceived","responsesSent","totalAudioEnergy"],z={audioLevel:1e4,jitter:1e3,totalAudioEnergy:1e4,totalDecodeTime:1e3,totalEncodeTime:1e3},A=["consentRequestsSent","requestsReceived","requestsSent","responsesReceived","responsesSent"],B=["audioLevel","packetsLost","totalAudioEnergy"],C=[5,50,95];k={AV_SYNC_CUTOFF:k,CANDIDATE_PAIR_STATS:q,CUMULATIVE_STATS:n,DELTA_STATS:o,DERIVED_METRICS:l,GLOBAL_STATS_CONTENT_TYPE:c,GLOBAL_STATS_RENDERED_VIEW:d,GLOBAL_STATS_TRACKID:a,INBOUND_RTP_STATS:w,MEDIA_SOURCE_STATS:r,OUTBOUND_AUDIO_STATS_TRACKID:g,OUTBOUND_RTP_STATS:v,OUTBOUND_SCREEN_STATS_TRACKID:h,OUTBOUND_VIDEO_STATS_TRACKID:i,PER_STREAM_AGG_METRICS:m,PERCENTILES_REQUESTED:C,PINNED_AUDIO_STATS_TRACKID:f,PINNED_VIDEO_STATS_TRACKID:b,RTP_STATS:u,RULE_VIOLATION_WHITELIST:B,SSRC_STATS:s,STATS_REQUESTED:p,TRACK_STATS:t,TSLOG_METRIC_SCALE:z,TSLOG_STATS_REQUESTED:x,TSLOG_STATS_REQUESTED_FROM_CANDIDATE_PAIR:A,TSLOG_STATS_TO_SUPPRESS:y,VOICE_ENERGY_THRESHOLD:j};e.exports=k}),null);
__d("ZenonCumulativeMediaStat",["performanceNow"],(function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(a){this.$3=this.$5=this.$1=a,this.$7=this.$8=a,this.$9=!1,this.$4=this.$6=this.$2=(g||(g=b("performanceNow")))()}var c=a.prototype;c.$10=function(a){this.$5=this.$1,this.$6=this.$2,this.$1=a,this.$2=(g||(g=b("performanceNow")))()};c.update=function(a){this.$7=this.$8;this.$8=a;a=this.$8-this.$7;a<0?(a=this.$8,this.$9=!0):this.$9=!1;this.$10(this.$1+a)};c.updateNonStrictCumulative=function(a){this.$7=this.$8,this.$8=a,this.$9=!1,this.$10(a)};c.isReset=function(){return this.$9};c.getCurrentValue=function(){return this.$1};c.getDeltaValue=function(){return this.$1-this.$3};c.getDeltaFromLastUpdate=function(){return this.$1-this.$5};c.getTimeSinceLastUpdate=function(){return this.$2-this.$6};c.getElapsedTime=function(){return this.$2-this.$4};c.getPreviousTime=function(){return this.$6};c.getCurrentTime=function(){return this.$2};c.getAverageOverTime=function(){return this.getDeltaValue()/this.getElapsedTime()};c.getCurrentTimeSinceLastUpdate=function(){return(g||(g=b("performanceNow")))()-this.$2};return a}();e.exports=a}),null);
__d("percentile",[],(function(a,b,c,d,e,f){function g(a,b){return(a||0)-(b||0)}function a(a,b){return h(a.slice().sort(g),b)}function h(a,b){b=(a.length-1)*b;var c=Math.floor(b),d=Math.ceil(b);if(c===d)return a[b];var e=a[c]*(d-b);a=a[d]*(b-c);return e+a}e.exports=a;e.exports.fromSorted=h}),null);
__d("median",["percentile"],(function(a,b,c,d,e,f){function a(a){return b("percentile")(a,.5)}e.exports=a}),null);
__d("ZenonDeltaMediaStat",["median"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[],this.$2=0,this.$3=null}var c=a.prototype;c.add=function(a){this.$1.push(a),this.$2++,this.$3=a};c.getLastAddedValue=function(){return this.$3};c.getTotal=function(){var a=this.$1.reduce(function(a,b){return a+b},0);return a};c.getCount=function(){return this.$1.length};c.getAverage=function(){return this.getTotal()/this.getCount()};c.getMin=function(){return Math.min.apply(Math,this.$1)};c.getMax=function(){return Math.max.apply(Math,this.$1)};c.getMedian=function(){return b("median")(this.$1)};return a}();e.exports=a}),null);
__d("ZenonSimulcastStats",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=0,this.$2=new Map(),this.$3=new Map()}var b=a.prototype;b.update=function(a){a=g(a,this.$2,this.$3);var b=0;for(var c=a,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f[0];f=f[1];f&&b++}if(this.$3.size===0)b>0&&this.$1++;else{f=!1;for(var e=a,d=Array.isArray(e),c=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(c>=e.length)break;b=e[c++]}else{c=e.next();if(c.done)break;b=c.value}b=b;var h=b[0];b=b[1];(!this.$3.has(h)||this.$3.get(h)!==b)&&(f=!0)}f&&this.$1++}this.$3=a};b.getNumLayerChanges=function(){return this.isSimulcastCall()?this.$1:0};b.isSimulcastCall=function(){return this.$3.size>1};return a}();function g(a,b,c){var d=new Map();for(var a=a.values(),e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;if(g.ssrc===void 0||g.framesSent===void 0)continue;var h=String(g.ssrc);g=Number(g.framesSent);if(b.has(h)){var i=b.get(h);i!==void 0&&d.set(h,g>i)}else d.set(h,g>0);b.set(h,g)}for(var i=c,h=Array.isArray(i),g=0,i=h?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(h){if(g>=i.length)break;f=i[g++]}else{g=i.next();if(g.done)break;f=g.value}e=f;a=e[0];e[1];d.has(a)||d.set(a,!1)}return d}e.exports=a}),null);
__d("ZenonVideoScaleHistogram",[],(function(a,b,c,d,e,f){"use strict";var g={getBinFromScale:function(a){if(a>=.765625)return 0;else if(a>=.390625)return 1;else if(a>=.19140625)return 2;else if(a>=.09765625)return 3;return 4},updateTrackerWithScaleHistogram:function(a,b){var c=["video","screen"];a.filter(function(a){return c.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=b.get(a.trackId);if(!a||!a.cumulativeStat||!a.histResScale)return;var c=a.cumulativeStat,d=c.framesEncoded;c=c.tracktimestamp;var e=a.deltaStat,f=e.frameHeight,h=e.frameWidth,i=e.height;e=e.width;if(d!=null&&e!=null&&i!=null&&h!=null&&f!=null&&d.getDeltaFromLastUpdate()>0&&c.getCurrentValue()>a.lastUpdate){c=d.getDeltaFromLastUpdate();d=((d=e.getLastAddedValue())!=null?d:0)*((e=i.getLastAddedValue())!=null?e:0);h=((i=h.getLastAddedValue())!=null?i:0)*((e=f.getLastAddedValue())!=null?e:0);if(d>0){i=h/d;f=g.getBinFromScale(i);a.histResScale[f]+=c}}})}};e.exports=g}),null);
__d("ZenonMediaStatsParser",["ScotchRTWebUserActionLogger","ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonSimulcastStats","ZenonVideoScaleHistogram","isTruthy","performanceNow"],(function(a,b,c,d,e,f){"use strict";var g,h=["inbound-rtp","outbound-rtp","track","media-source","candidate-pair"],i={filterLegacyMediaReports:function(a,b){var c=new Map();b.forEach(function(b,d){b.type==="ssrc"&&b.googTrackId!=null&&b.googTrackId===a.trackId&&c.set(d,b)});return c},filterMediaReports:function(a){var b=new Map();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];h.includes(e.type)&&b.set(f,e)}return b},getMediaTrackDirection:function(a){var c=["recv","inbound"],d=["send","outbound"];if(c.some(function(b){return a.toLowerCase().includes(b)}))return"inbound";if(d.some(function(b){return a.toLowerCase().includes(b)}))return"outbound";b("ScotchRTWebUserActionLogger").logError({errorDomain:"ZenonMediaStatsParser",errorType:"CANNOT_DETERMINE_STREAM_DIRECTION"});return"inbound"},getOrCreateTrackerFromMap:function(a,c){var d=a.get(c);d==null&&(d={codec:null,cumulativeStat:{},deltaStat:{},duration:0,histResScale:new Array(b("ZenonVideoScaleHistogram").getBinFromScale(0)+1).fill(0),lastUpdate:0,maxTotalDecodeTime:0,percentStat:{},startTime:(g||(g=b("performanceNow")))()},a.set(c,d));return d},isCumulativeStat:function(a){return b("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(a)},isDeltaStat:function(a){return b("ZenonMediaStatsConfig").DELTA_STATS.includes(a)},makeStatsReportMap:function(a){if(a instanceof Map)return a;var b=new Map();if(a.result)for(var c=a.result(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g={id:f.id,timestamp:f.timestamp,type:f.type};for(var h=f.names(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{j=h.next();if(j.done)break;k=j.value}k=k;g[k]==null&&(g[k]=f.stat(k))}b.set(g.id,g)}else for(var k=a.values(),j=Array.isArray(k),i=0,k=j?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(j){if(i>=k.length)break;h=k[i++]}else{i=k.next();if(i.done)break;h=i.value}f=h;b.set(f.id,f)}return b},updateTrackStatsWithChromiumLegacyReport:function(a,b,c){c=i.filterLegacyMediaReports(a,c);for(var c=c.values(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=i.getOrCreateTrackerFromMap(b,a.trackId);l(a,g,f);g.codec=j(f)}},updateTrackStatsWithReport:function(a,c,d){var e=null,f=[];for(var d=d.values(),g=Array.isArray(d),h=0,d=g?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(h>=d.length)break;j=d[h++]}else{h=d.next();if(h.done)break;j=h.value}j=j;j.type==="outbound-rtp"&&j.trackId&&(e=i.getOrCreateTrackerFromMap(c,a.trackId),typeof j.trackId==="string"&&(e.sender=j.trackId),j.kind==="video"&&f.push(j));switch(j.type){case"inbound-rtp":e=i.getOrCreateTrackerFromMap(c,a.trackId);m(e,j,b("ZenonMediaStatsConfig").INBOUND_RTP_STATS.concat(b("ZenonMediaStatsConfig").RTP_STATS));break;case"outbound-rtp":e=i.getOrCreateTrackerFromMap(c,a.trackId);m(e,j,b("ZenonMediaStatsConfig").OUTBOUND_RTP_STATS.concat(b("ZenonMediaStatsConfig").RTP_STATS));break;case"media-source":e=i.getOrCreateTrackerFromMap(c,a.trackId);m(e,j,b("ZenonMediaStatsConfig").MEDIA_SOURCE_STATS);break;case"track":e=i.getOrCreateTrackerFromMap(c,a.trackId);m(e,j,b("ZenonMediaStatsConfig").TRACK_STATS);break;case"candidate-pair":e=i.getOrCreateTrackerFromMap(c,a.trackId);m(e,j,b("ZenonMediaStatsConfig").CANDIDATE_PAIR_STATS);break;case"codec":var l=String(j.mimeType).split("/")[1];l!=null&&l!==""&&(e=i.getOrCreateTrackerFromMap(c,a.trackId),k(e,l));break;case"local-candidate":e=i.getOrCreateTrackerFromMap(c,a.trackId);e.localIceCandidateStats=o(j);break;case"remote-candidate":e=i.getOrCreateTrackerFromMap(c,a.trackId);e.remoteIceCandidateStats=o(j);break;default:break}}e!=null&&f.length>0&&n(e,f)}};function j(a){var b=null;a.googCodecName!=null&&a.googCodecName!==""&&(b=String(a.googCodecName),a.codecImplementationName!=null&&(b+=String(a.codecImplementationName)));return b}function k(a,c){a.startTime==null&&(a.startTime=(g||(g=b("performanceNow")))());var d=a.startTime;a.codecHistory==null&&(a.codecHistory=[]);c.length>0&&(a.codecHistory.length===0||a.codecHistory[a.codecHistory.length-1].codec!==c)&&a.codecHistory.push({codec:c,updateTime:(g||(g=b("performanceNow")))()-d});a.codec=c}function l(a,c,d){Object.entries(d).forEach(function(d){var e=d[0];d=Number(d[1]);if(b("ZenonMediaStatsConfig").STATS_REQUESTED.includes(e)&&b("ZenonMediaStatsConfig").SSRC_STATS.includes(e))if(b("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(e)){if(e==="packetsLost"&&a.remote)return;c.cumulativeStat[e]!=null?e==="packetsLost"?c.cumulativeStat[e].updateNonStrictCumulative(d):c.cumulativeStat[e].update(d):c.cumulativeStat[e]=new(b("ZenonCumulativeMediaStat"))(d)}else b("ZenonMediaStatsConfig").DELTA_STATS.includes(e)&&(c.deltaStat[e]==null&&(c.deltaStat[e]=new(b("ZenonDeltaMediaStat"))()),c.deltaStat[e].add(d))})}function m(a,c,d){Object.entries(c).forEach(function(e){var f=e[0];e=Number(e[1]);if(!d||d.includes(f))if(i.isCumulativeStat(f))a.cumulativeStat[f]!=null?f==="packetsLost"?a.cumulativeStat[f].updateNonStrictCumulative(e):a.cumulativeStat[f].update(e):a.cumulativeStat[f]=new(b("ZenonCumulativeMediaStat"))(e);else if(f==="timestamp"){var g=c.type+f;a.cumulativeStat[g]!=null?a.cumulativeStat[g].update(e):a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e)}else if(f===b("ZenonMediaStatsConfig").DERIVED_METRICS.FRAME_RATE_MEAN){g=null;c.framesEncoded!=null?g=Number(c.framesEncoded):c.framesDecoded!=null&&(g=Number(c.framesDecoded));b("isTruthy")(g)&&(a.deltaStat[f]==null&&(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))()),a.deltaStat[f].add(e))}else i.isDeltaStat(f)&&(a.deltaStat[f]==null&&(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))()),a.deltaStat[f].add(e))})}function n(a,c){var d;a.simulcastStats===void 0&&(a.simulcastStats=new(b("ZenonSimulcastStats"))());(d=a.simulcastStats)==null?void 0:d.update(c);c=(d=a.simulcastStats)==null?void 0:d.getNumLayerChanges();if(c!=null){d=b("ZenonMediaStatsConfig").DERIVED_METRICS.SIMULCAST_LAYER_CHANGES;a.cumulativeStat[d]!=null?a.cumulativeStat[d].update(c):a.cumulativeStat[d]=new(b("ZenonCumulativeMediaStat"))(c)}}function o(a){var b=a.candidateType,c=a.networkType;a=a.protocol;var d={};b&&typeof b==="string"&&(d.candidateType=b);c&&typeof c==="string"&&(d.networkType=c);a&&typeof a==="string"&&(d.protocol=a);return d}e.exports=i}),null);
__d("ZenonVideoQpConversion",[],(function(a,b,c,d,e,f){"use strict";var g=[0,1,2,3,4,5,7,8,9,10,12,13,15,17,18,19,20,21,23,24,25,26,27,28,29,30,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,64,67,70,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124,127];a={convertQp:function(a,b,c){var d;a===0?d=0:d=b/a;b=d;c||(b=g.findIndex(function(a){return a>=d}));return b==-1?g.length-1:Math.round(b)}};e.exports=a}),null);
__d("ZenonTSLogDataHelper",["ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonVideoQpConversion"],(function(a,b,c,d,e,f){"use strict";var g={"new":1,checking:2,connected:3,completed:4,failed:5,disconnected:6,closed:7},h={iceConnectionState:0},i=1073741824,j={_addDataQp:function(a,c,d,e){if(e.includes("qp")&&c.counters.qpSum!=null&&(c.counters.framesDecoded!=null||c.counters.framesEncoded!=null)){c.counters.qp==null&&(c.counters.qp=Array(a.shared_idx-c.bucket_start).fill(0));e=0;var f=0;a=a.shared_idx-c.bucket_start;a>0?(c.counters.framesEncoded!=null?e=c.counters.framesEncoded[a]-c.counters.framesEncoded[a-1]:c.counters.framesDecoded!=null&&(e=c.counters.framesDecoded[a]-c.counters.framesDecoded[a-1]),f=c.counters.qpSum[a]-c.counters.qpSum[a-1]):(c.counters.framesEncoded!=null?e=c.counters.framesEncoded[a]:c.counters.framesDecoded!=null&&(e=c.counters.framesDecoded[a]),f=c.counters.qpSum[a]);c.counters.qp[a]=b("ZenonVideoQpConversion").convertQp(e,f,d)}},_addExtraStats:function(a,c,d,e,f){var g=function(e,g){for(var h=0;h<e.length;h++){var i=e[h];if(d.includes(i))for(var j=c.values(),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;if(m.type===g&&m[i]!==void 0){var n;f.counters[i]==null&&(f.counters[i]=Array(a.shared_idx-f.bucket_start).fill(0));n=(n=b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[i])!=null?n:1;f.counters[i][a.shared_idx-f.bucket_start]=Math.round(Number(m[i])*n)}}}};g(b("ZenonMediaStatsConfig").TRACK_STATS,"track");g(b("ZenonMediaStatsConfig").MEDIA_SOURCE_STATS,"media-source");g(b("ZenonMediaStatsConfig").CANDIDATE_PAIR_STATS,"candidate-pair");if(e==="video"&&d.includes("qp")){g=!1;for(var e=c.values(),h=Array.isArray(e),i=0,e=h?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(h){if(i>=e.length)break;k=e[i++]}else{i=e.next();if(i.done)break;k=i.value}k=k;k.encoderImplementation!==void 0&&(g=String(k.encoderImplementation).includes("264"))}j._addDataQp(a,f,g,d)}},_cumulativeToDelta:function(a){return a.map(function(b,c){return c===0?0:b-a[c-1]})},_getTslogStreamName:function(a){if(a.type==="candidate-pair")return a.id;var b="unknown",c=["recv","inbound"],d=["send","outbound"];c.some(function(b){return a.id.toLowerCase().includes(b)})&&(b="inbound");d.some(function(b){return a.id.toLowerCase().includes(b)})&&(b="outbound");c=a.mediaType===void 0?"unknown":a.mediaType.toString();d=a.ssrc===void 0?"unknown":a.ssrc.toString();return b+"_"+c+"_"+d},_normalizeStreamName:function(a,b,c){return a+"_rtp_"+b+"_"+c},_serializeAvsync:function(a,b,c){if(c&&Object.prototype.hasOwnProperty.call(c.counters,"estimatedPlayoutTimestamp")&&Object.prototype.hasOwnProperty.call(a.counters,"estimatedPlayoutTimestamp")){var d=Math.min(a.counters.estimatedPlayoutTimestamp.length,c.counters.estimatedPlayoutTimestamp.length),e=new Array(d).fill(0),f=new Array(d).fill(0);for(var g=0;g<d;g++){var h=c.counters.estimatedPlayoutTimestamp[g],j=a.counters.estimatedPlayoutTimestamp[g];h>0&&j>0?h>=j?(f[g]=2,e[g]=Math.min(h-j,i)):(f[g]=1,e[g]=Math.min(j-h,i)):(f[g]=0,e[g]=0)}b.push({data:e,name:"avSync"});b.push({data:f,name:"avSyncSign"})}},_serializeCounters:function(a,c,d){var e=[];for(var f in a.counters)c.includes(f)||e.push({data:a.counters[f],name:f}),b("ZenonMediaStatsParser").isCumulativeStat(f)&&!c.includes(f+"_delta")&&e.push({data:j._cumulativeToDelta(a.counters[f]),name:f+"_delta"});c=a.counters;var g=c.fecPacketsDiscarded;c=c.fecPacketsReceived;if(g!=null&&c!=null){var h=Math.min(g.length,c.length),i=[];for(var k=0;k<h;k++)i.push(c[k]-g[k]);e.push({data:j._cumulativeToDelta(i),name:"fecPacketsUsed_delta"})}j._serializeNeteqMeanWaitTime(a,e);j._serializeAvsync(a,e,d);return e},_serializeNeteqMeanWaitTime:function(a,b){if(Object.prototype.hasOwnProperty.call(a.counters,"jitterBufferDelay")&&Object.prototype.hasOwnProperty.call(a.counters,"jitterBufferEmittedCount")){var c=Math.min(a.counters.jitterBufferDelay.length,a.counters.jitterBufferEmittedCount.length),d=new Array(c).fill(0);for(var e=1;e<c;e++){var f=a.counters.jitterBufferDelay[e]-a.counters.jitterBufferDelay[e-1],g=a.counters.jitterBufferEmittedCount[e]-a.counters.jitterBufferEmittedCount[e-1];g===0?d[e]=0:d[e]=Math.round(f*1e3/g)}b.push({data:d,name:"neteqMeanWaitTime"})}},addCandidatePairStats:function(a,c){if(c.size===0)return;c.forEach(function(c){if(c.type==="candidate-pair"){var d=j._getTslogStreamName(c),e=a.streams[d];e==null&&(e={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"candidate-pair",counters:{},owner:""},a.streams[d]=e);(a.start_time_ms==null||c.timestamp<a.start_time_ms)&&(a.start_time_ms=c.timestamp);for(var f in c)b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED_FROM_CANDIDATE_PAIR.includes(f)&&k(a,e,f,c[f],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[f]);e.bucket_end=a.shared_idx;(a.end_time_ms==null||c.timestamp>a.end_time_ms)&&(a.end_time_ms=c.timestamp)}})},addData:function(a,c,d,e,f){if(c.size===0)return;c.forEach(function(g){if(g.type==="track"||g.type==="media-source"||g.type==="candidate-pair")return;var h=j._getTslogStreamName(g),i=a.streams[h];if(g.type==="ssrc"){if(i==null)return;for(var l in g)d.includes(l)&&b("ZenonMediaStatsConfig").SSRC_STATS.includes(l)&&k(a,i,l,g[l],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[l])}else{i==null&&(i={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:e,counters:{},owner:f?f.id:""},a.streams[h]=i);(a.start_time_ms==null||g.timestamp<a.start_time_ms)&&(a.start_time_ms=g.timestamp);for(var m in g){d.includes(m)&&k(a,i,m,g[m],b("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[m]);if(m==="estimatedPlayoutTimestamp"&&d.includes(b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY)){h=new Date(Date.UTC(0,0));h=Date.now()-h-Number(g[m]);i.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY]==null&&(i.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY]=Array(a.shared_idx-i.bucket_start).fill(0));i.counters[b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY][a.shared_idx-i.bucket_start]=h}}j._addExtraStats(a,c,d,e,i)}i.bucket_end=a.shared_idx;(a.end_time_ms==null||g.timestamp>a.end_time_ms)&&(a.end_time_ms=g.timestamp)})},addNonMediaStates:function(a){a.streams.nonMediaState==null&&(a.streams.nonMediaState={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"non-media-state",counters:{},owner:""});var b=a.streams.nonMediaState;Object.keys(h).forEach(function(c){k(a,b,c,h[c])});b.bucket_end=a.shared_idx},advance:function(a){var b;a.streams["."]==null&&(a.streams["."]={bucket_end:a.shared_idx,bucket_start:a.shared_idx,contentType:"time",counters:{btime:[],ctime:[]}});b=(b=a.end_time_ms)!=null?b:0;var c=a.streams["."].counters,d=c.btime;c=c.ctime;c.push(Math.round(b-((b=a.start_time_ms)!=null?b:0)));d.push(Math.round(c[a.shared_idx]-((b=c[a.shared_idx-1])!=null?b:0)));a.streams["."].bucket_end=a.shared_idx;a.shared_idx++},emptyTSLogDataHolder:function(){return{end_time_ms:null,shared_idx:0,source:"rtc_www",start_time_ms:null,streams:{}}},onIceConnectionStateChange:function(a){h.iceConnectionState=(a=g[a])!=null?a:0},serialize:function(a,c){c=(c=c)!=null?c:b("ZenonMediaStatsConfig").TSLOG_STATS_TO_SUPPRESS;var d={source:a.source,start_time_ms:Number(a.start_time_ms),streams:[]},e=new Map(),f=["audio","video"];for(var g in a.streams){var h=a.streams[g];if(f.includes(h.contentType)){h=h.owner+h.contentType;e.set(h,g)}}h={};for(var i in a.streams){var k=a.streams[i],l=void 0,m=i;if(f.includes(k.contentType)){var n=b("ZenonMediaStatsParser").getMediaTrackDirection(i);h[n+k.contentType]=h[n+k.contentType]+1||0;m=j._normalizeStreamName(n,k.contentType,h[n+k.contentType])}else k.contentType==="candidate-pair"&&(m="cp");n=e.get(k.owner+"audio");k.contentType==="video"&&n!=null&&(l=a.streams[n]);n={bucket_end:k.bucket_end,bucket_start:k.bucket_start,counters:j._serializeCounters(a.streams[i],c,l),name:m};d.streams.push(n)}return d}};function k(a,b,c,d,e){a=Math.max(a.shared_idx-b.bucket_start,0);b.counters[c]==null&&(b.counters[c]=Array(a).fill(0));e=Math.round(Number(d)*((d=e)!=null?d:1));b.counters[c][a]=e}e.exports=j}),null);
__d("ScotchRTCCallStoreState",["CurrentUser","FBRTCCallSummary","RTCUser","ZenonTSLogDataHelper","immutable"],(function(a,b,c,d,e,f){"use strict";a={debugID:0,callID:"",collisionContext:{groupThreadID:null,peerID:null,serverInfoData:null},conferenceState:"NEW",conferenceName:"",responseSubCode:null,protocol:"",serverInfoData:"",tsLogData:b("ZenonTSLogDataHelper").emptyTSLogDataHolder()};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.isInCall=function(){return this.conferenceState==="CONNECTING"||this.conferenceState==="CONNECTED"};return b}((c=b("immutable")).Record(a));f={connections:c.Set(),localUser:new(b("RTCUser"))({FBID:b("CurrentUser").getID()}),remoteUsers:c.Set(),remoteScreenSharingUserIDs:c.OrderedSet(),callInfo:new d(),callSummary:b("FBRTCCallSummary").nullSummary(),mediaStatus:c.Map()};a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c.Record(f));e.exports=a}),null);
__d("ScotchRTCCallReducer",["invariant","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCParticipantCallState","FBRTCRtcResponseStatusCode","RTCUser","ScotchRTCCallStore","ScotchRTCCallStoreState","ScotchRTCUtils","ScotchRTWebUserActionLogger","URI","ZenonMWTranslatorUtils","gkx","immutable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("FBRTCConstants").SignalingProtocol;function a(a,c){switch(c.type){case"INIT":return a.set("callInfo",a.callInfo.set("callID",c.callID).set("conferenceName",c.conferenceName).set("serverInfoData",c.serverInfoData).set("protocol",c.protocol).set("collisionContext",{serverInfoData:c.serverInfoData,peerID:null,groupThreadID:null})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet());case"RESET":return new(b("ScotchRTCCallStoreState"))();case"RESET_FOR_REDIAL":return a.set("callInfo",a.callInfo.set("conferenceState","NEW").set("callID",c.callID).set("conferenceName",c.conferenceName)).set("callSummary",b("FBRTCCallSummary").nullSummary()).set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet());case"CALL_COLLISION":return a.set("callInfo",a.callInfo.set("conferenceState","NEW").set("callID",c.conferenceName).set("conferenceName",c.conferenceName)).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()})).set("remoteScreenSharingUserIDs",b("immutable").OrderedSet())}return a}function c(a,b){switch(b.type){case"CALL":return a.setIn(["callInfo","conferenceState"],"CONNECTING").set("connections",a.connections.add(b.peerConnection));case"CALL_ERROR":return a.setIn(["callInfo","conferenceState"],"TERMINATED").setIn(["callInfo","responseSubCode"],b.responseSubCode);case"CALL_SUCCESS":return b.connected?a.setIn(["callInfo","conferenceState"],"CONNECTED"):a}return a}function d(a,b){switch(b.type){case"SET_PENDING_APPROVAL":return a.setIn(["callInfo","conferenceState"],"PENDING_APPROVAL")}return a}function f(a,b){switch(b.type){case"INCOMING_CALL_SUCCESS":return a.setIn(["callInfo","conferenceState"],"CONNECTED")}return a}function j(a,c){switch(c.type){case"HANGUP":a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],"TERMINATING").set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case"DISMISS":c.transaction.sendResponse(c.request.createResponse(b("FBRTCRtcResponseStatusCode").OK,{callID:a.callInfo.callID}));case"END_CALL":a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],"TERMINATED").set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.setIn(["callInfo","conferenceState"],"TERMINATED")}return a}function k(a,c){switch(c.type){case"GROUP_ESCALATION_CLEAR_P2P_CONNECTION":var d=b("ScotchRTCCallStore").getConnection(i.P2P);if(d){c=d.getRemoteStreams();var e=c[0];d.close();var f=a.localUser;c=f.getScreenStream();if(c){var g=f.getStream();g&&b("ScotchRTCUtils").transferAudioTracks(g,c);b("ScotchRTCUtils").stopMediaStream(c);f=f.removeScreenStream(c)}return a.withMutations(function(a){a.set("connections",a.connections.remove(d)).set("localUser",f).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(e)}))})}}return a}function l(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":var d=b("ScotchRTCCallStore").getConnection(i.MULTIWAY);if(d){var e=d.getRemoteStreams(),f=e[0],g=a.callSummary;c.p2pCallSummary&&(g=c.p2pCallSummary,b("FBRTCCallSummaryStore").getInstance().removeCallSummary(a.callSummary.peerID,a.callSummary.callID));d.close();return a.withMutations(function(a){a.set("callInfo",a.callInfo.set("conferenceState","CONNECTED").set("conferenceName",g.callID).set("protocol","p2p").set("serverInfoData","")).set("callSummary",g).set("connections",a.connections.remove(d)).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(f)}))})}}return a}function m(a,c){var d=function(){switch(c.type){case"ON_PARTICIPANTS_ADDED":var d=a.remoteUsers.map(function(a){return a.FBID});return a.set("remoteUsers",a.remoteUsers.union(Object.keys(c.participants).filter(function(a){return!d.has(c.participants[a].fbid)}).map(function(a){var d=c.participants[a],e=d.big_image_src||d.image_src;c.images&&c.images[a]&&(e=c.images[a]);d.fbid||g(0,1174);return new(b("RTCUser"))({FBID:d.fbid,profileUrl:new(h||(h=b("URI")))(d.href),profilePictureUrl:e,isGuestUser:d.user_type==="guest",isMessengerUser:!!d.is_messenger_user,isPartiesUser:!!d.is_parties_user,streams:(a=d.streams)!=null?a:b("immutable").Set(),userName:d.name,userShortName:d.short_name,vanity:d.vanity})})))}return a};d=d();return d}function n(a,c){var d=function(){switch(c.type){case"ON_CONFERENCE_STATE":if(a.callInfo.conferenceState==="TERMINATING"||a.callInfo.conferenceState==="TERMINATED")return a;var d=c.transaction,e=c.request,f=c.request.conferenceStateRequest();b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_processConferenceState: "+JSON.stringify(f)});var g={currentVersion:c.conferenceStateVersion};if(c.conferenceStateVersion>=f.version){d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{conferenceStateResponse:g},callID:a.callInfo.callID}));return a}c.resolve(f.version);var h=a.remoteUsers.map(function(a){var c=f.participantStates[a.FBID];c&&c.state===b("FBRTCParticipantCallState").DISCONNECTED&&(a=a.removeAllStreams());return c?a.setParticipantState(c):a}),i=h.some(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED});i=i&&a.callInfo.conferenceState!="PENDING_APPROVAL"?"CONNECTED":a.callInfo.conferenceState;var j=f.appMessages;j=(j=b("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(j))!=null?j:a.callInfo.collisionContext;d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{conferenceStateResponse:g},callID:a.callInfo.callID}));return a.setIn(["remoteUsers"],h).setIn(["callInfo","conferenceState"],i).setIn(["callInfo","collisionContext"],j)}return a};d=d();return d}function o(a,b){switch(b.type){case"ON_JOIN_RESPONSE":return a.setIn(["callInfo","serverInfoData"],b.serverInfoData).setIn(["callInfo","collisionContext"],{serverInfoData:b.serverInfoData})}return a}function p(a,b){var c=function(){switch(b.type){case"INIT_LOCAL_USER":return a.set("localUser",b.localUser);case"INIT_REMOTE_USERS":case"UPDATE_REMOTE_USERS":return a.set("remoteUsers",b.remoteUsers)}return a};c=c();return c}function q(a,b){switch(b.type){case"ADD_REMOTE_SCREEN_SHARING_USER_ID":return a.set("remoteScreenSharingUserIDs",a.remoteScreenSharingUserIDs.add(b.userID));case"REMOVE_REMOTE_SCREEN_SHARING_USER_ID":return a.set("remoteScreenSharingUserIDs",a.remoteScreenSharingUserIDs.remove(b.userID))}return a}function r(a,b){switch(b.type){case"AUDIO_MUTED":case"AUDIO_UNMUTED":return a.set("localUser",a.localUser.toggleDisableAudio());case"VIDEO_MUTED":return a.set("localUser",a.localUser.toggleDisableVideo(!0));case"VIDEO_UNMUTED":return a.set("localUser",a.localUser.toggleDisableVideo(!1));default:return a}}function s(a,c){switch(c.type){case"ADD_LOCAL_STREAM":return a.set("localUser",a.localUser.addStream(c.stream));case"REMOVE_LOCAL_STREAM":return a.set("localUser",a.localUser.removeStream(c.stream));case"REPLACE_LOCAL_STREAM":var d=c.oldStream.getAudioTracks();d=d[0];var e=c.oldStream.getVideoTracks();e=e[0];if(d!=null)for(var f=c.newStream.getAudioTracks(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;i.enabled=d.enabled}if(e!=null)for(var i=c.newStream.getVideoTracks(),h=Array.isArray(i),g=0,i=h?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(h){if(g>=i.length)break;f=i[g++]}else{g=i.next();if(g.done)break;f=g.value}d=f;d.enabled=e.enabled}return a.set("localUser",a.localUser.replaceStream(c.oldStream,c.newStream));case"STOP_LOCAL_STREAM":return a.set("localUser",a.localUser.stopVideo());case"REMOVE_ALL_LOCAL_STREAMS":if(c.stopStreams)for(var f=a.localUser.streams,d=Array.isArray(f),g=0,f=d?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(g>=f.length)break;h=f[g++]}else{g=f.next();if(g.done)break;h=g.value}i=h;b("ScotchRTCUtils").stopMediaStream(i)}return a.set("localUser",a.localUser.removeAllStreams())}return a}function t(a,c){switch(c.type){case"ADD_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.addScreenStream(c.stream));case"REMOVE_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.removeScreenStream(c.stream));case"REMOVE_ALL_LOCAL_SCREEN_STREAMS":if(c.stopStreams)for(var d=a.localUser.screenStreams,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b("ScotchRTCUtils").stopMediaStream(g)}return a.set("localUser",a.localUser.removeAllScreenStreams());case"REPLACE_LOCAL_SCREEN_STREAM":return a.set("localUser",a.localUser.replaceScreenStream(c.oldStream,c.newStream))}return a}function u(a,c){var d,e=function(){switch(c.type){case"ADD_REMOTE_STREAM":var e="";a.mediaStatus.forEach(function(a,b){e+="track: "+b+" status: "+(a?"true":"false")+","});var f=c.stream.getTracks().reduce(function(a,b){return a.concat(b.kind+": "+b.id+",")},"");b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_AddRemoteStream.\n            New stream: "+c.stream.id+":{"+f+"} .\n            Current media status: "+e});d=y(a,c);if(!d)return a;f=d;a.callInfo.protocol==="multiway"&&(f=f.removeAllStreams());f=a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(f.addStream(c.stream)));return x(f,{type:"TOGGLE_REMOTE_STREAM",mediaStatus:f.mediaStatus.toJS()});case"REMOVE_REMOTE_STREAM":d=y(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeStream(c.stream)));case"REMOVE_ALL_REMOTE_STREAMS":d=y(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeAllStreams().removeAllScreenStreams()))}return a};e=e();return e}function v(a,b){var c,d=function(){switch(b.type){case"ADD_REMOTE_TRACK":c=y(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.clone()));case"REMOVE_REMOTE_TRACK":c=y(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.clone()))}return a};d=d();return d}function w(a,b){var c,d=function(){switch(b.type){case"ADD_REMOTE_SCREEN_STREAM":c=y(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.addScreenStream(b.stream)));case"REMOVE_REMOTE_SCREEN_STREAM":c=y(a,b);return!c?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](c).add(c.removeScreenStream(b.stream)))}return a};d=d();return d}function x(a,c){var d,e=function(){switch(c.type){case"TOGGLE_REMOTE_STREAM":if(b("gkx")("1439080")&&c.mediaStatus!=null){var e=Object.keys(c.mediaStatus).reduce(function(a,b){return""+a+b+":"+String(c.mediaStatus[b])+";"},"");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream.\n            Action type: "+c.type+" mediaStatus: "+e})}var f=new Map(),g=a.remoteUsers;a.mediaStatus.forEach(function(a,c){var d=g.reduce(function(b,a){var d=a.streams.map(function(a){return a.getTracks().find(function(a){return a.id===c})}).find(Boolean);return d?{user:a,track:d}:b},{}),b=d.user;d=d.track;if(b&&d){var e=Boolean(b.audioStreamMuteStates.get(d.id));d.kind==="video"&&b.isVideoDisabled()===a?g=g["delete"](b).add(b.toggleDisableVideo(!b.isVideoDisabled())):d.kind==="audio"&&e===a&&(g=g["delete"](b).add(b.toggleAudioTrackMutedByUser(d.id,!e)))}else f.set(c,a)});Object.entries(c.mediaStatus).forEach(function(b){var c=b[0];b=b[1];var d=g.reduce(function(b,a){var d=a.streams.map(function(a){return a.getTracks().find(function(a){return a.id===c})}).find(Boolean);return d?{user:a,track:d}:b},{}),a=d.user;d=d.track;if(a&&d){var e=Boolean(a.audioStreamMuteStates.get(d.id));d.kind==="video"&&a.isVideoDisabled()===b?g=g["delete"](a).add(a.toggleDisableVideo(!a.isVideoDisabled())):d.kind==="audio"&&e===b&&(g=g["delete"](a).add(a.toggleAudioTrackMutedByUser(d.id,!e)))}else f.set(c,!!b)});return a.set("remoteUsers",g).set("mediaStatus",b("immutable").Map(f));case"REMOTE_VIDEO_MUTED":d=y(a,c);if(!d)return a;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream. REMOTE_VIDEO_MUTED. mute user"+d.FBID});return a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleDisableVideo(!0)));case"REMOTE_VIDEO_UNMUTED":d=y(a,c);if(!d)return a;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallReducer_toggleRemoteStream. REMOTE_VIDEO_UNMUTED. unmute user"+d.FBID});return a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleDisableVideo(!1)))}return a};e=e();return e}function y(a,b){return a.remoteUsers.find(function(a){return b.userID?a.FBID==b.userID:a.FBID===b.stream.id.split(":")[0]})}function z(a,b){switch(b.type){case"WAIT_FOR_USER_INPUT":return a.callInfo.conferenceState==="NEW"?a.setIn(["callInfo","conferenceState"],"AWAITING_USER_START"):a}return a}e.exports={abortMultiwayEscalationProcess:l,callInit:a,callStart:c,callEnd:j,completeTransitionToMultiway:k,onParticipantsChanged:m,incomingCallStart:f,processUsers:p,processRemoteScreenSharingUserID:q,toggleLocalStream:r,processLocalStream:s,processLocalScreenStream:t,processRemoteStream:u,processRemoteScreenStream:w,processRemoteTrack:v,toggleRemoteStream:x,processConferenceState:n,processJoinResponse:o,setPendingApproval:d,waitForUserInput:z}}),null);
__d("RTCCoExperienceActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TOGGLE_CHAT_WINDOW:"TOGGLE_CHAT_WINDOW",SET_FILTER:"SET_FILTER"})}),null);
__d("RtcExpressionWWWTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:RtcExpressionWWWLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAuthFlag=function(a){this.$1.auth_flag=a;return this};c.setBundleID=function(a){this.$1.bundle_id=a;return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setConferenceName=function(a){this.$1.conference_name=a;return this};c.setOsBuildNumber=function(a){this.$1.os_build_number=a;return this};c.setPeerID=function(a){this.$1.peer_id=a;return this};c.setRadioType=function(a){this.$1.radio_type=a;return this};c.setRawClientTime=function(a){this.$1.raw_client_time=a;return this};c.setRtcExpressionAction=function(a){this.$1.rtc_expression_action=a;return this};c.setRtcExpressionDuration=function(a){this.$1.rtc_expression_duration=a;return this};c.setRtcExpressionID=function(a){this.$1.rtc_expression_id=a;return this};c.setRtcExpressionIntent=function(a){this.$1.rtc_expression_intent=a;return this};c.setRtcExpressionName=function(a){this.$1.rtc_expression_name=a;return this};c.setRtcExpressionParticipantCount=function(a){this.$1.rtc_expression_participant_count=a;return this};c.setRtcExpressionType=function(a){this.$1.rtc_expression_type=a;return this};c.setSamplingFrequency=function(a){this.$1.sampling_frequency=a;return this};return a}();c={auth_flag:!0,bundle_id:!0,call_id:!0,conference_name:!0,os_build_number:!0,peer_id:!0,radio_type:!0,raw_client_time:!0,rtc_expression_action:!0,rtc_expression_duration:!0,rtc_expression_id:!0,rtc_expression_intent:!0,rtc_expression_name:!0,rtc_expression_participant_count:!0,rtc_expression_type:!0,sampling_frequency:!0};e.exports=a}),null);
__d("ScotchRTCExpressionWWWLogger",["invariant","FBRTCConsoleLogger","FBRTCParticipantCallState","RtcExpressionWWWTypedLogger","immutable","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("immutable").Map;a=function(){function a(){this.$1=i()}var c=a.prototype;c.logStartTimer=function(a){var c=(h||(h=b("performanceNow")))(),d=a.rtcExpressionIntent;this.$1=this.$1.set(d,c);a.rtcExpressionAction="enabled";this.logEvent(a);this.$2(d,{startTime:c})};c.$3=function(a){var c=this.$1.get(a);c||g(0,2586);this.$1=this.$1.remove(a);return parseInt((h||(h=b("performanceNow")))()-c,10)};c.logStopTimer=function(a){var b=a.rtcExpressionIntent;b=this.$3(b);a.rtcExpressionDuration=b;a.rtcExpressionAction="disabled";this.logEvent(a);return b};c.logEvent=function(a){var c=new(b("RtcExpressionWWWTypedLogger"))().setCallID(a.callID||123).setConferenceName(a.conferenceName).setPeerID(a.peerID).setRawClientTime((h||(h=b("performanceNow")))()).setRtcExpressionAction(a.rtcExpressionAction).setRtcExpressionDuration(a.rtcExpressionDuration).setRtcExpressionID(a.rtcExpressionId).setRtcExpressionIntent(a.rtcExpressionIntent).setRtcExpressionName(a.rtcExpressionName).setRtcExpressionParticipantCount(a.rtcExpressionParticipantCount).setRtcExpressionType(a.rtcExpressionType),d=c.getData();this.$2(a.rtcExpressionName,d);c.log()};c.getExpressionLoggerInfoFromStore=function(a){var c=a.callInfo,d=c.callID;c=c.conferenceName;a=a.remoteUsers;a=a.filter(function(a){return a.getParticipantState()===b("FBRTCParticipantCallState").CONNECTED}).size+1;return{callID:d,conferenceName:c,rtcExpressionParticipantCount:a}};c.$2=function(a,b){};return a}();e.exports=new a()}),null);
__d("ScotchRTCCoExperienceReducer",["RTCCallActionTypes","RTCCoExperienceActionTypes","ScotchRTCCallStore","ScotchRTCCoExperienceStore","ScotchRTCExpressionWWWLogger"],(function(a,b,c,d,e,f){"use strict";function a(a,c){switch(c.type){case"TOGGLE_CHAT_WINDOW":c=b("ScotchRTCExpressionWWWLogger").getExpressionLoggerInfoFromStore(b("ScotchRTCCallStore").getState());a.chatWindowVisible?b("ScotchRTCExpressionWWWLogger").logStopTimer(babelHelpers["extends"]({},c,{rtcExpressionName:"chat",rtcExpressionIntent:"chat"})):b("ScotchRTCExpressionWWWLogger").logStartTimer(babelHelpers["extends"]({},c,{rtcExpressionName:"chat",rtcExpressionIntent:"chat"}));return a.set("chatWindowVisible",!a.chatWindowVisible);default:return a}}function c(a,c){switch(c.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":case"SET_FILTER":var d=b("ScotchRTCExpressionWWWLogger").getExpressionLoggerInfoFromStore(b("ScotchRTCCallStore").getState()),e=a.currentVideoFilter,f=a.videoFilterHistory;if(e){var g=b("ScotchRTCExpressionWWWLogger").logStopTimer(babelHelpers["extends"]({},d,{rtcExpressionName:e,rtcExpressionIntent:"effect"})),h=f.get(e)||0;f=f.set(e,h+g);b("ScotchRTCCoExperienceStore").logCoExperienceDurationToSummary(f)}c.filter&&b("ScotchRTCExpressionWWWLogger").logStartTimer(babelHelpers["extends"]({},d,{rtcExpressionName:c.filter,rtcExpressionIntent:"effect"}));return a.set("currentVideoFilter",c.filter).set("videoFilterHistory",f);default:return a}}e.exports={processChatWindowToggle:a,processSetVideoFilter:c}}),null);
__d("ScotchRTCGroupCallEscalationStoreState",["immutable"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({aborted:!1,inProgress:!1,toRing:!1,p2pCallSummary:null,readyToTransition:!1,usersToRing:null}));e.exports=a}),null);
__d("ScotchRTCGroupCallEscalationStoreReducer",["FBRTCParticipantCallState","ScotchRTCCallStore","RTCGroupCallEscalationActionTypes","ScotchRTCGroupCallEscalationStore","ScotchRTCGroupCallEscalationStoreState","ScotchRTCMWProtocolHandler","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger","immutable"],(function(a,b,c,d,e,f){"use strict";var g,h=new Set([(g=b("FBRTCParticipantCallState")).UNKNOWN,g.DISCONNECTED,g.NO_ANSWER,g.REJECTED,g.UNREACHABLE,g.CONNECTION_DROPPED,g.PARTICIPANT_LIMIT_REACHED,g.IN_ANOTHER_CALL,g.RING_TYPE_UNSUPPORTED]);function a(a,c){switch(c.type){case"GROUP_ESCALATION_CANCEL":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_cancel"});return a.withMutations(function(a){a.set("aborted",!0).set("inProgress",!1).set("toRing",!1).set("readyToTransition",!1).set("usersToRing",null)})}return a}function c(a,c){switch(c.type){case"HANGUP":case"END_CALL":case"HANGUP_ERROR":case"HANGUP_SUCCESS":return a.withMutations(function(a){a.set("aborted",!1).set("inProgress",!1).set("toRing",!1).set("usersToRing",null)});case"RESET":return new(b("ScotchRTCGroupCallEscalationStoreState"))()}return a}function d(a,b){switch(b.type){case"GROUP_ESCALATION_SET_P2P_CALLSUMMARY":var c=b.p2pCallSummary;if(c)return a.withMutations(function(a){a.set("p2pCallSummary",c)})}return a}function f(a,c){switch(c.type){case"GROUP_ESCALATION_START":b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_start"});return a.set("inProgress",!0).set("readyToTransition",!1)}return a}function i(a,c){if(!a.readyToTransition&&a.inProgress)switch(c.type){case"ON_JOIN_REQUEST_SENT":b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setEscalationConnectingToMultiway()});break;case"ON_JOIN_RESPONSE":b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationConnectedToMultiway(),c.serverInfoData&&a.setServerInfoData(c.serverInfoData)});break}return a}function j(a,c){if(!a.readyToTransition&&a.inProgress)switch(c.type){case"ON_CONFERENCE_STATE":c=c.request.conferenceStateRequest();if(c){var d=c.participantStates;c=a.toRing;var e=!1,f=Object.keys(d).every(function(a){return d[a].state===b("FBRTCParticipantCallState").CONNECTED});if(f){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"group_escalation_success"});b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationPeerConnectedToMultiway(),a.setEscalationConnectedToMultiway(),a.setReadyToEscalate()});var g=b("ScotchRTCP2PCallStore").getState();g=g.protocolHandler;g.shutDownP2PListenersForMultiwayEscalation();if(a.usersToRing&&c){g=a.usersToRing.valueSeq().map(function(a){return a.fbid}).filter(Boolean).toArray();b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,g);c=!1}}else e=Object.keys(d).some(function(a){return h.has(d[a].state)}),e&&b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setInvalidP2PEscalationState()});return a.set("aborted",e).set("readyToTransition",f).set("inProgress",!(f||e)).set("toRing",c)}}return a}function k(a,b){switch(b.type){case"GROUP_ESCALATION_SET_USERS_TO_RING":if(b.usersToRing)return a.set("usersToRing",b.usersToRing).set("toRing",!0)}return a}e.exports={abortEscalation:a,callStart:f,clearStore:c,onMultiwayConnectionSignaling:i,onParticipantsConnected:j,setP2PCallSummary:d,setUsersToRing:k}}),null);
__d("ScotchRTCCallType",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({AUDIO_ONLY:"AUDIO_ONLY",VIDEO_ONLY:"VIDEO_ONLY",AUDIO_VIDEO:"AUDIO_VIDEO",NO_AUDIO_VIDEO:"NO_AUDIO_VIDEO"});e.exports=a}),null);
__d("ScotchRTCP2PCallAdminMessageReducers",["FBRTCCallConstants","ScotchFBRTCAdminMessage","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCCallConstants").FBRTCCallType;function a(a,c){switch(c.type){case"SET_CALL_SUMMARY":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);c=b("ScotchRTCCallStore").getState();c=c.callSummary;return a.set("adminMessage",new(b("ScotchFBRTCAdminMessage"))(c.peerID,c.callID));default:return a}}function c(a,b){switch(b.type){case"SET_CONNECTION_STATUS":var c=a.adminMessage;c&&b.connectionStatus==="CONNECTED"&&c.onCallConnected();return a;default:return a}}function d(a,c){switch(c.type){case"SET_END_CALL_REASON":var d=a.adminMessage,e=a.escalationConferenceName;d&&(d.onCallEnded(),a.isCaller&&d.submit(a.callType===b("ScotchRTCCallType").AUDIO_ONLY?g.VOICE_CALL:g.VIDEO_CALL,c.endCallReason.getReasonID(),e));return a;default:return a}}e.exports={processCallInit:a,processCallStart:c,processCallEnd:d}}),null);
__d("ScotchRTCP2PCallEscalationStoreState",["FBRTCConstants","immutable"],(function(a,b,c,d,e,f){a=b("FBRTCConstants").CallType;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({awaitingACK:!1,callType:a.VOIP,escalated:!1,escalateMediaStream:null,failureReason:null,initiatedEscalation:!1,inProgress:!1,request:null,response:null,token:null}));e.exports=c}),null);
__d("ScotchRTCP2PCallEscalationStoreReducers",["FBRTCConstants","ScotchRTCCallType","ScotchRTCP2PCallEscalationStoreState","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTWebUserActionLogger"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").CallType;a=function(a,c){switch(c.type){case"P2P_CALL_ESCALATION_START":if(a.inProgress)return a;if(a.escalated||!b("ScotchRTCP2PCallStore").isAudioOnly())return a;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_start"});return a.withMutations(function(a){a.set("awaitingACK",!0).set("initiatedEscalation",!0).set("failureReason",null).set("inProgress",!0).set("token",b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!0))});case"P2P_CALL_ESCALATION_SUCCESS":if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;b("ScotchRTCP2PCallEscalator").onEscalationSucceeded();b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_success"});return a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",g.ESCALATED).set("escalated",!0).set("inProgress",!1).set("request",null).set("response",!0).set("token",null)});case"P2P_CALL_ESCALATION_FAILURE":if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;b("ScotchRTCP2PCallEscalator").onEscalationFailed();if(c.reason==="denied"){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_denied"});return a.withMutations(function(a){a.set("awaitingACK",!1).set("initiatedEscalation",!1).set("callType",g.ESCALATION_DECLINED).set("escalated",!1).set("failureReason",c.reason||null).set("inProgress",!1).set("request",null).set("response",c.response||null).set("token",null).set("escalateMediaStream",null)})}else c.reason==="cancelled"?b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_cancelled"}):c.reason==="timeout"?b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_timeout"}):b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"video_escalation_failed"});b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!1);return a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("initiatedEscalation",!1).set("callType",g.ESCALATION_DECLINED).set("escalated",!1).set("failureReason",c.reason).set("token",null).set("escalateMediaStream",null)});case"SET_P2P_CALL_ESCALATION_MEDIA":return a.set("escalateMediaStream",c.stream);default:return a}};c=function(a,c){switch(c.type){case"P2P_CALL_ESCALATION_SET_REQUEST":var d=c.request;if(d==null)return a;return!b("ScotchRTCP2PCallEscalator").requestVideoOn(d.msg)?a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("request",null).set("response",null).set("token",null)}):a.withMutations(function(a){a.set("inProgress",!0).set("request",c.request).set("response",null).set("token",null)});case"P2P_CALL_ESCALATION_SET_RESPONSE":if(c.response==null)return a;else if(a.request==null)return a;return a.withMutations(function(a){a.set("awaitingACK",!0).set("callType",c.response?g.ESCALATED:g.ESCALATION_DECLINED).set("response",c.response).set("token",b("ScotchRTCP2PCallStore").getState().protocolHandler.generateEscalationResponseToken(a.request,c.response))});case"P2P_CALL_ESCALATION_ACK":if(c.token==null)return a;return a.response==null||a.request==null||c.token!==a.token||!a.awaitingACK?a:a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",a.response?g.ESCALATED:g.ESCALATION_DECLINED).set("escalated",a.response).set("inProgress",!1).set("request",null).set("response",null).set("token",null)});default:return a}};d=function(a,c){switch(c.type){case"RESET":return new(b("ScotchRTCP2PCallEscalationStoreState"))();case"SET_CALL_TYPE":switch(c.callType){case b("ScotchRTCCallType").AUDIO_VIDEO:case b("ScotchRTCCallType").VIDEO_ONLY:return a.set("callType",g.DIRECT_VIDEO)}return a;case"P2P_CALL_ESCALATION_ACK":if(c.token==null)return a;if(!a.awaitingACK)return a;else if(c.token!==a.token)return a;return a.set("awaitingACK",!1);default:return a}};e.exports={Alice:a,Bob:c,common:d}}),null);
__d("ScotchRTCP2PCallReducer",["FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStoreState","ScotchRTCP2PCallWindowHandler","ScotchRTCP2PProtocolHandler","ScotchRTCScreenSharingWindowHandler","ScotchFBRTCUserCapabilities","ScotchRTWebClientFeatureGating"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").SignalingProtocol;function a(a,c){switch(c.type){case"INIT":var d=c.callType,e=c.isCaller,f=c.protocol;return f===g.P2P&&d&&e!=null?a.set("protocolHandler",a.protocolHandler||new(b("ScotchRTCP2PProtocolHandler"))()).set("isCaller",e).set("callType",d):a;case"RESET":return new(b("ScotchRTCP2PCallStoreState"))();case"RESET_FOR_REDIAL":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);f=b("ScotchRTCCallStore").getState().remoteUsers.first();if(f==null)return a;a.protocolHandler.destroy();return a.set("connectionStatus","INIT").set("endCallReason",null).set("protocolHandler",new(b("ScotchRTCP2PProtocolHandler"))().init(f.FBID,Number(c.conferenceName))).set("signalingExperiments",new(b("ScotchFBRTCUserCapabilities"))());case"CALL_COLLISION":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCCallStore").getDispatchToken()]);a.protocolHandler.init(c.peerID,Number(c.conferenceName));return a.set("connectionStatus","INIT").set("endCallReason",null).set("signalingExperiments",new(b("ScotchFBRTCUserCapabilities"))());default:return a}}function c(a,c){switch(c.type){case"HANGUP":case"DISMISS":case"HANGUP_ERROR":case"HANGUP_SUCCESS":case"END_CALL":case"REMOVE_REMOTE_SCREEN_STREAM":case"RESET_FOR_REDIAL":b("ScotchRTCScreenSharingWindowHandler").close();return a.withMutations(function(a){return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened()).set("isRedialFooterButtonShown",(b("ScotchRTWebClientFeatureGating").shouldAlwaysShowRedial()||b("ScotchRTCP2PProtocolHandler").showRedialButton())&&!b("FBRTCConfig").isVCEndpointCall()).set("isStarRatingShown",b("ScotchRTCP2PProtocolHandler").showStarRating())});default:return a}}function d(a,c){switch(c.type){case"SET_CALL_TYPE":return a.set("callType",c.callType);case"P2P_CALL_ESCALATION_SET_RESPONSE":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCP2PCallEscalationStore").getDispatchToken()]);return a.set("callType",c.response?b("ScotchRTCCallType").AUDIO_VIDEO:b("ScotchRTCCallType").AUDIO_ONLY);case"P2P_CALL_ESCALATION_FAILURE":return a.set("callType",b("ScotchRTCCallType").AUDIO_ONLY);case"P2P_CALL_ESCALATION_SUCCESS":b("ScotchRTCAppDispatcher").waitFor([b("ScotchRTCP2PCallEscalationStore").getDispatchToken()]);return b("ScotchRTCP2PCallEscalationStore").isEscalated()?a.set("callType",b("ScotchRTCCallType").AUDIO_VIDEO):a;default:return a}}function f(a,c){switch(c.type){case"SET_CONNECTION_STATUS":if(a.connectionStatus!==c.connectionStatus){b("ScotchRTCP2PCallWindowHandler").updateCallInProgressIndicator(c.connectionStatus);return a.set("connectionStatus",c.connectionStatus)}default:return a}}function h(a,b){switch(b.type){case"SET_END_CALL_REASON":return a.set("endCallReason",b.endCallReason);default:return a}}function i(a,b){switch(b.type){case"SET_MULTIWAY_ESCALATION_SUPPORT":a=a.set("offerEscalationSupport",b.offerEscalationSupport);b.escalationConferenceName&&(a=a.set("escalationConferenceName",b.escalationConferenceName));return a;default:return a}}function j(a,c){switch(c.type){case"POP_IN_SCREEN_CONTENT":b("ScotchRTCScreenSharingWindowHandler").close();return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened());case"POP_OUT_SCREEN_CONTENT":var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers.first().FBID;d=d.callInfo;b("ScotchRTCScreenSharingWindowHandler").open(e,c.stream,d);return a.set("isScreenContentPoppedOut",b("ScotchRTCScreenSharingWindowHandler").isWindowOpened());default:return a}}function k(a,b){switch(b.type){case"SET_REMOTE_SIGNALING_EXPERIMENTS":return a.set("signalingExperiments",a.signalingExperiments.setRemote(b.remoteSignalingExperiments));default:return a}}function l(a,b){switch(b.type){case"P2P_PROCESS_MESSAGE":return a.set("isRemoteVideoSupported",b.message.isRemoteVideoSupported()).set("isPeerOnMobile",b.message.isFromMobile());default:return a}}function m(a,b){switch(b.type){case"P2P_SET_IS_CALLER":return a.set("isCaller",b.isCaller);case"CALL_COLLISION":return a.set("isCaller",!0);default:return a}}function n(a,b){switch(b.type){case"SET_CONNECTION_STATUS":return b.connectionStatus==="CONNECTED"?a.set("wasConnected",!0):a;case"RESET_FOR_REDIAL":return a.set("wasConnected",!1);case"CALL_COLLISION":return a.set("wasConnected",!1);default:return a}}function o(a,b){switch(b.type){case"P2P_STAR_RATING_DONE":return a.set("isStarRatingShown",!1).set("wasStarRatingDone",b.done);case"RESET_FOR_REDIAL":return a.set("isStarRatingShown",!1).set("wasStarRatingDone",!1);default:return a}}function p(a,b){switch(b.type){case"SHOW_POOR_NETWORK_QUALITY":return a.set("isPoorNetworkQualityShown",!0);case"DISMISS_POOR_NETWORK_QUALITY":return a.set("isPoorNetworkQualityShown",!1);default:return a}}e.exports={callInit:a,callEnd:c,processCallType:d,processConnectionStatus:f,processEndCallReason:h,processIsCaller:m,processMessage:l,processMultiwayEscalationSupport:i,processPoorNetworkQuality:p,processPoppedOutScreenContent:j,processSignalingExperiments:k,processWasConnected:n,processWasStarRatingDone:o}}),null);
__d("ScotchFBRTCGroupCallStore",["FluxReduceStore","ScotchFBRTCGroupCallParticipantsReducer","ScotchFBRTCGroupCallReducer","ScotchFBRTCGroupCallStoreState","ScotchFBRTCVideoDurationTrackerReducer","ScotchRTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchFBRTCGroupCallParticipantsReducer").addParticipantsToRing,b("ScotchFBRTCGroupCallParticipantsReducer").initThread,b("ScotchFBRTCGroupCallParticipantsReducer").onParticipantsChanged,(a=b("ScotchFBRTCGroupCallReducer")).processEndCallReason,a.setDominantSpeaker,a.setLayout,a.onForceEncodingChanged,a.onVideoEscalationStarted,a.onVideoEscalationCompleted,a.onReset,b("ScotchFBRTCVideoDurationTrackerReducer").track,b("ScotchFBRTCVideoDurationTrackerReducer").update,b("ScotchFBRTCVideoDurationTrackerReducer").stop];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchFBRTCGroupCallStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.hadVideoDuration=function(){var a=this.getState().videoDurationTrackerInfo,b=a.localVideoDurationTracker;a=a.remoteVideoDurationTracker;return b.getDuration()>0||a.getDuration()>0};return c}(b("FluxReduceStore"));c.__moduleID=e.id;e.exports=new c(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchFBRTCMWProtocolStoreState",["ScotchRTCStreamDurationTracker","immutable"],(function(a,b,c,d,e,f){"use strict";c={pendingResponse:!1,pendingUpdate:!1,lastSyncedClientVersion:1,localToMWSTrackIDMap:(a=b("immutable")).Map(),localMediaUpdates:a.List([{mediaStatus:{}}])};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(c));f={clientMediaUpdateInfo:new d(),localScreenDurationTracker:new(b("ScotchRTCStreamDurationTracker"))("screen")};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(f));e.exports=c}),null);
__d("ScotchFBRTCMWProtocolStore",["FluxReduceStore","ScotchFBRTCClientMediaUpdateReducer","ScotchFBRTCMWProtocolStoreState","ScotchRTCAppDispatcher","ScotchRTWebUserActionLogger","gkx"],(function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchFBRTCClientMediaUpdateReducer")).configureAudio,a.configureVideo,a.configureScreenSharing,a.onClientMediaUpdateResponse,a.setLocalClientVersion,a.reset,a.onLocalTrackReplaced];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ScotchFBRTCMWProtocolStore1="",b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchFBRTCMWProtocolStoreState"))()};d.reduce=function(a,c){var d=g.reduce(function(a,b){return b(a,c)},a);if(b("gkx")("1439080")){a=a.clientMediaUpdateInfo.localMediaUpdates;var e=d.clientMediaUpdateInfo,f=e.pendingResponse,h=e.pendingUpdate,i=e.lastSyncedClientVersion,j=e.localToMWSTrackIDMap;e=e.localMediaUpdates;var k=[];for(var a=a.size;a<e.size;a++)k.push(e.get(a));a=JSON.stringify({pendingResponse:f,pendingUpdate:h,lastSyncedClientVersion:i,localToMWSTrackIDMap:j.toJS(),localMediaUpdatesChange:k,localMediaUpdateSize:e.size});this.$ScotchFBRTCMWProtocolStore1!==a&&(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCMWProtocolStore.reduce: "+JSON.stringify({beforeCMUInfo:this.$ScotchFBRTCMWProtocolStore1,afterCMUInfo:a,action:c})}),this.$ScotchFBRTCMWProtocolStore1=a)}return d};return c}(b("FluxReduceStore"));c.__moduleID=e.id;e.exports=new c(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCCallNotificationStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";a={useTimeout:!0,notificationText:null};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c}),null);
__d("ScotchRTCCallNotificationStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallNotificationReducer","ScotchRTCCallNotificationStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCCallNotificationReducer")).clearStore,a.onEscalationStarted,a.onEscalationCompletion,a.onAbortedEscalation];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallNotificationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));c.__moduleID=e.id;e.exports=new c(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCCallStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchFBRTCCallSummaryReducer","ScotchRTCAppDispatcher","ScotchRTCCallReducer","ScotchRTCCallStoreState","ScotchRTWebUserActionLogger","gkx"],(function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchFBRTCCallSummaryReducer")).onCallEnded,a.onCallStarted,a.onMessageSignaling,a.onSurveyResult,a.setCallSummary,(c=b("ScotchRTCCallReducer")).abortMultiwayEscalationProcess,c.callEnd,c.callInit,c.callStart,c.completeTransitionToMultiway,c.incomingCallStart,c.onParticipantsChanged,c.processConferenceState,c.processJoinResponse,c.processLocalScreenStream,c.processLocalStream,c.processRemoteScreenStream,c.processRemoteStream,c.processRemoteTrack,c.processUsers,c.processRemoteScreenSharingUserID,c.setPendingApproval,c.toggleLocalStream,c.toggleRemoteStream,c.waitForUserInput],h=function(a){return a.map(function(a){return a.streams.map(function(b){return{state:a.getParticipantState(),active:b.active,streamID:b.id,tracks:b.getTracks().map(function(a){return{trackID:a.id,kind:a.kind,enabled:a.enabled,muted:a.muted,readyState:a.readyState}})}})})};d=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallStoreState"))()};d.reduce=function(a,c){var d=g.reduce(function(a,b){return b(a,c)},a);if(b("gkx")("1439080")&&a.remoteUsers!==d.remoteUsers){a=h(a.remoteUsers);var e=h(d.remoteUsers);JSON.stringify(a)!==JSON.stringify(e)&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCCallStore.reduce: "+JSON.stringify({beforeStreams:a,afterStreams:e,action:c.type})})}return d};d.hasRemoteVideo=function(){return this.getState().remoteUsers.some(function(a){return a.hasStream()&&!a.areAllTracksDisabled(a.streams.first().getVideoTracks())})};d.hasLocalVideo=function(){var a=this.getState();a=a.localUser;return a.hasStream()&&!a.areAllTracksDisabled(a.streams.first().getVideoTracks())};d.getConnection=function(a){var b=this.getState();b=b.connections;a&&(b=b.filter(function(b){return b.getSignalingProtocol()===a}));return b.first()};d.mutateCallSummary=function(a){var c=this.getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())};d.getSortedRemoteUsers=function(){return this.getState().remoteUsers.toList().sort(function(a,b){return a.lastConnectedAt===b.lastConnectedAt?a.FBID>b.FBID?1:-1:a.lastConnectedAt-b.lastConnectedAt})};return c}(b("FluxReduceStore"));d.__moduleID=e.id;e.exports=new d(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCCoExperienceStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";a={chatWindowVisible:!1,currentVideoFilter:null,videoFilterHistory:b("immutable").Map()};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c}),null);
__d("ScotchRTCCoExperienceStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCoExperienceReducer","ScotchRTCCoExperienceStoreState","immutable"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCCoExperienceReducer").processChatWindowToggle,b("ScotchRTCCoExperienceReducer").processSetVideoFilter];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCoExperienceStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.logCoExperienceDurationToSummary=function(a){var c=b("ScotchRTCCallStore").getState();c=c.callSummary;c.setEffectCount(a.size);var d=0;a.reduce(function(a,b){d+=b},0);c.setTotalVideoFilterDuration(d);c.setCoExperienceEffectDuration(d);c.save(b("FBRTCCallSummaryStore").getInstance())};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCGroupCallEscalationStore",["FBRTCCallSummaryStore","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCGroupCallEscalationStoreReducer","ScotchRTCGroupCallEscalationStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCGroupCallEscalationStoreReducer")).abortEscalation,a.callStart,a.clearStore,a.onMultiwayConnectionSignaling,a.onParticipantsConnected,a.setP2PCallSummary,a.setUsersToRing];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCGroupCallEscalationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.isInProgress=function(){return this.getState().inProgress};d.isEscalated=function(){return this.getState().readyToTransition};d.logToP2PCallSummary=function(a){var c=this.getState();c=c.p2pCallSummary;c&&(a(c),c.save(b("FBRTCCallSummaryStore").getInstance()))};return c}(b("FluxReduceStore"));c.__moduleID=e.id;e.exports=new c(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCP2PCallEscalationStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCP2PCallEscalationStoreReducers","ScotchRTCP2PCallEscalationStoreState","ScotchRTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCP2PCallEscalationStoreReducers").Alice,b("ScotchRTCP2PCallEscalationStoreReducers").Bob,b("ScotchRTCP2PCallEscalationStoreReducers").common];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCP2PCallEscalationStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.didCurrentUserInitiate=function(){return this.getState().initiatedEscalation};d.isInProgress=function(){return this.getState().inProgress};d.isEscalated=function(){return this.getState().escalated};d.getEscalateMediaStream=function(){return this.getState().escalateMediaStream};d.remoteWillNotInitSDPUpdate=function(){return b("ScotchRTCP2PCallStore").getState().isPeerOnMobile||b("ScotchRTCP2PCallStore").getState().signalingExperiments.remoteSupport("video_escalation_by_unmute")};d.isNegotiationAllowed=function(){var a=this.getState();return this.remoteWillNotInitSDPUpdate()||!a.request};d.isStarted=function(){var a=this.getState();return a.inProgress&&a.token!==null};d.getToken=function(){return this.getState().token};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCP2PCallStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallType","ScotchRTCP2PCallAdminMessageReducers","ScotchRTCP2PCallReducer","ScotchRTCP2PCallStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[(a=b("ScotchRTCP2PCallReducer")).callEnd,a.callInit,a.processCallType,a.processConnectionStatus,a.processEndCallReason,a.processPoppedOutScreenContent,a.processMultiwayEscalationSupport,a.processSignalingExperiments,a.processMessage,a.processIsCaller,a.processWasConnected,a.processWasStarRatingDone,a.processPoorNetworkQuality,b("ScotchRTCP2PCallAdminMessageReducers").processCallInit,b("ScotchRTCP2PCallAdminMessageReducers").processCallStart,b("ScotchRTCP2PCallAdminMessageReducers").processCallEnd];c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCP2PCallStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.isAudioOnly=function(){return this.getState().callType===b("ScotchRTCCallType").AUDIO_ONLY};d.isCaller=function(){return this.getState().isCaller};return c}(b("FluxReduceStore"));c.__moduleID=e.id;e.exports=new c(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCP2PCallStoreState",["ScotchFBRTCUserCapabilities","ScotchRTCCallType","ScotchRTCP2PProtocolHandler","immutable"],(function(a,b,c,d,e,f){"use strict";a={adminMessage:null,callType:b("ScotchRTCCallType").AUDIO_ONLY,connectionStatus:"INIT",endCallReason:null,escalationConferenceName:null,isCaller:!1,isPeerOnMobile:!1,isPoorNetworkQualityShown:!1,isRedialFooterButtonShown:!1,isRemoteVideoSupported:!0,isScreenContentPoppedOut:!1,isStarRatingShown:!1,offerEscalationSupport:!1,protocolHandler:new(b("ScotchRTCP2PProtocolHandler"))(),signalingExperiments:new(b("ScotchFBRTCUserCapabilities"))(),wasConnected:!1,wasStarRatingDone:!1};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c}),null);
__d("ScotchRTCP2PLoggerStore",["Bootloader","FBRTCConfig","FBRTCLogger","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallStore"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){var d=b("ScotchRTCCallStore").getState(),e=d.remoteUsers;d=d.callInfo;if(!e.count())return a;var f=b("FBRTCLogger").getInstance();e=e.first().FBID;switch(c.type){case"AUDIO_MUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!0);break;case"AUDIO_UNMUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!1);break;case"VIDEO_MUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!1);break;case"VIDEO_UNMUTED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!0);break;case"SELF_VIEW_COLLAPSED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!1);break;case"SELF_VIEW_UNCOLLAPSED":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!0);break;case"ADD_LOCAL_STREAM":this.$ScotchRTCP2PLoggerStore1("local stream: set",c.stream,e,Number(d.conferenceName));break;case"USER_SETTINGS_SAVE":case"USER_SETTINGS_SET_AUDIO_INPUT":case"USER_SETTINGS_SET_AUDIO_OUTPUT":case"USER_SETTINGS_SET_VIDEO_INPUT":f.logCallAction(e,d.conferenceName,b("FBRTCLogger").CallAction.USER_SETTINGS_CHANGED),this.$ScotchRTCP2PLoggerStore1("user settings change",c,e,Number(d.conferenceName))}return a};d.$ScotchRTCP2PLoggerStore1=function(a,b,c,d){g(function(e){return e.log(a,{peerID:c,callID:d,eventDetails:b})})};return c}(b("FluxReduceStore"));a.__moduleID=e.id;function g(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["ScotchCollabMessengerLogger"],a,"ScotchRTCP2PLoggerStore")}e.exports=new a(b("ScotchRTCAppDispatcher"))}),null);
__d("ScotchRTCCallInitUtils",["invariant","CurrentUser","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","MercuryIDs","MessengerParticipants.bs","MessengerParticipantsImages.re","MessengerState.bs","RTCUser","ScotchFBRTCGroupCallStore","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCMWThreadDeltaHandler","URI","immutable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("FBRTCConstants").CallType,j=b("FBRTCConstants").SignalingProtocol;a={initializeCallSummary:function(a){var c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),a.peerID,a.callID,a.isCaller);b("ScotchRTCCallActions").setCallSummary(c);b("ScotchRTCCallStore").mutateCallSummary(function(b){b.onPopupOpened(),b.setCallType(a.protocol===j.P2P?a.isAudio?i.VOIP:i.DIRECT_VIDEO:"mws"),b.setActiveConnection(a.protocol===j.P2P?"p2p":"mws")})},initializeRTCUsers:function(a,c){var d=this;a=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.bs").getMulti(a,function(a){a=b("immutable").Map(a);d.initializeParticipantsAndStartCall(a,!0,c)})},initializeParticipantsAndStartCall:function(a,c,d){var e=this,f=a.keySeq().toArray();b("MessengerParticipantsImages.re").getBigImageMultiWithSize({ids:f,callback:function(f){c&&b("ScotchRTCCallActions").initRemoteUsers(a.filter(function(a){a=a.fbid;return a!==b("CurrentUser").getID()}).map(function(a){return e._createRTCUser(a,f)}).toSet());var g=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("ScotchRTCCallActions").initLocalUser(e._createRTCUser(a.get(g),f));d()},size:100})},initializeThreadFromCollisionContext:function(a){var c=a.peerID;a=a.groupThreadID;var d=c!=null?c:a;if(d==null)return;a=c!=null?b("MercuryIDs").getThreadIDFromUserID(d):b("MercuryIDs").getThreadIDFromThreadFBID(d);if(a===null)return;c=(c=b("ScotchFBRTCGroupCallStore").getState().thread)==null?void 0:c.thread_fbid;a!==c&&b("MessengerState.bs").getThreadMeta(b("CurrentUser").getID(),a,function(a){b("ScotchRTCGroupCallActions").initThread(a,null),b("ScotchRTCMWThreadDeltaHandler").initHandler(d)})},_createRTCUser:function(a,c){var d=a.big_image_src,e=a.fbid,f=a.user_type,i=a.href,j=a.image_src,k=a.is_messenger_user,l=a.name,m=a.room_location,n=a.short_name;a=a.vanity;e||g(0,1174);if(c){var o=b("MercuryIDs").getParticipantIDFromUserID(e);d=c[o]}return new(b("RTCUser"))({FBID:e,isGuestUser:f==="guest",isMessengerUser:!!k,profileUrl:new(h||(h=b("URI")))(i),profilePictureUrl:d||j,roomLocation:m,userName:l,userShortName:n,vanity:a?a:""})}};e.exports=a}),null);
__d("ScotchRTCGroupCallEscalationActions",["ScotchRTCAppDispatcher","immutable"],(function(a,b,c,d,e,f){"use strict";a={start:function(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_START"})},cancel:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_CANCEL",p2pCallSummary:a})},approve:function(){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SUCCESS"})},setUsersToRing:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SET_USERS_TO_RING",usersToRing:a})},setP2PCallSummary:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"GROUP_ESCALATION_SET_P2P_CALLSUMMARY",p2pCallSummary:a})}};e.exports=a}),null);
__d("ScotchRTCGroupCallEscalator",["CurrentUser","FBRTCConsoleLogger","FBRTCConstants","MercuryIDs","MessengerParticipants.bs","ScotchFBRTCGroupCallStore","ScotchFBRTCMWProtocolStore","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMWProtocolHandler","immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").GroupVideoViewLayout,h=45e3;a=function(){function a(a,c,d,e){this.$3=a,this.$4=c,this.$5=d,this.$1=String(e),b("ScotchRTCGroupCallEscalationActions").setP2PCallSummary(b("ScotchRTCCallStore").getState().callSummary),this.$6=[d],this.$8=null}var c=a.prototype;c.getParticipants=function(){return this.$8};c.$9=function(){var a=this.$3,c=this.$1;return window.setTimeout(function(){var d=b("ScotchRTCGroupCallEscalationStore").isEscalated(),e=b("ScotchRTCCallStore").getState();e=e.callInfo;!d&&(e.callID===c||e.conferenceName===a)&&(i("Group Escalation timed out"),b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationTimedOut(),b("ScotchRTCGroupCallEscalationActions").cancel(a)}))},h)};c.startEscalationToMultiway=function(){var a=this;i("Escalating P2P call to Multiway call %o",this.$3);var c=b("ScotchRTCGroupCallEscalationStore").getState().inProgress;if(c)return;b("ScotchRTCGroupCallEscalationActions").start();this.$2=this.$9();this.$7=new(b("ScotchRTCMWProtocolHandler"))();b("ScotchRTCAppDispatcher").explicitlyRegisterStores([b("ScotchFBRTCGroupCallStore"),b("ScotchFBRTCMWProtocolStore")]);b("ScotchRTCGroupCallActions").setLayout(g.GRID);var d=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("MessengerParticipants.bs").get(d,function(c){var e={};e[d]=c;c=b("immutable").Map(e);a.$8=c;b("ScotchRTCGroupCallActions").initThread(null,c);a.$10()})};c.$10=function(){var a=b("ScotchRTCCallStore").getState().localUser.getStream();a=a;a&&this.$7.onStreamReady(a,this.$6,this.$3,!0,{callTrigger:"multiway_escalation",p2pCallID:this.$1})};return a}();a.ESCALATION_TIMEOUT=h;function i(){}e.exports=a}),null);
__d("ScotchFBRTCPeerConnection",["requireCond","cr:1429706"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:1429706")}),null);
__d("ScotchRTCP2PCallEscalationActions",["ScotchRTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";a={start:function(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_START"})},setRequest:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SET_REQUEST",request:a})},cancel:function(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"cancelled"})},timeout:function(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"timeout"})},handleACK:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_ACK",token:a})},approve:function(){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SUCCESS"})},decline:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"denied",token:a,response:!1})},setResponse:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SET_RESPONSE",response:a})},parseResponse:function(a,c){a?b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_SUCCESS",token:c}):b("ScotchRTCAppDispatcher").dispatch({type:"P2P_CALL_ESCALATION_FAILURE",reason:"denied",token:c,response:!1})},muteRemoteVideo:function(){b("ScotchRTCAppDispatcher").dispatch({type:"REMOTE_VIDEO_MUTED"})},setEscalateToMediaStream:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_P2P_CALL_ESCALATION_MEDIA",stream:a})}};e.exports=a}),null);
__d("ScotchRTCP2PCallEscalator",["Promise","FBRTCCallSummaryStore","FBRTCConsoleLogger","FBRTCConstants","FBRTCSupport","ScotchFBRTCPeerConnection","ScotchRTCCallStore","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStore","ScotchRTCP2PProtocolHandler","ScotchRTCUtils","dangerouslyBypassDispatchError"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").PayloadType,h=25e3;a=function(){a.initVideoInAudioCall=function(){return b("FBRTCSupport").videoEscalationByUnmuteWorkaround()};a.isEscalated=function(){return b("ScotchRTCP2PCallEscalationStore").isEscalated()};a.isNegotiationAllowed=function(){return b("ScotchRTCP2PCallEscalationStore").isNegotiationAllowed()};function a(a,b,c){this.$3=a,this.$1=b,this.$2=c,this.$6()}var c=a.prototype;c.$6=function(){var a=this,c=b("ScotchRTCP2PCallEscalationStore").getState();this.$4=b("ScotchRTCP2PCallEscalationStore").addListener(function(){var d=b("ScotchRTCP2PCallEscalationStore").getState();if(d===c)return;!d.awaitingACK&&d.awaitingACK!==c.awaitingACK&&!d.inProgress&&window.clearTimeout(a.$5);if(d.callType!==c.callType&&d.inProgress){var e=b("ScotchRTCCallStore").getState();e=e.callSummary;e.setCallType(d.callType);e.save(b("FBRTCCallSummaryStore").getInstance())}c=d})};c.destroy=function(){i("P2P Escalator %o","destroy"),this.$4.remove(),window.clearTimeout(this.$5)};c.generateRequestToken=function(a){var c=b("ScotchRTCP2PCallEscalationStore").getState();c=c.token;if(c!=null&&a){i("P2P Escalator %o","request token","reuse");return c}i("P2P Escalator %o","request token");c=this.$2.sendVideoEscalationRequest(this.$3,this.$1,a);window.clearTimeout(this.$5);this.$5=this.$7();return c.msg_id.toString()};c.generateResponseToken=function(a,c){var d=b("ScotchRTCP2PCallEscalationStore").getState();d=d.token;if(d!=null){i("P2P Escalator %o","response token","reuse");return d}i("P2P Escalator %o %o %o","response token",c,a);d=a.peerID;var e=a.callID;a=a.msgID;d=this.$2.sendVideoRequestResponse(d,e,a,c);window.clearTimeout(this.$5);var f=d.msg_id.toString();!c?b("dangerouslyBypassDispatchError")(function(){return b("ScotchRTCP2PCallEscalationActions").decline(f)}):this.$5=this.$7();return f};c.$7=function(){return window.setTimeout(b("ScotchRTCP2PCallEscalationActions").timeout,h)};c.parseMessage=function(a){i("P2P Escalator %o","parse message",this.$3,a.msgType);switch(a.msgType){case g.VIDEO_REQUEST:a.ackID?this.$8(a):this.$9(a);break;case g.ACK:a.msg.ack_type===g.VIDEO_REQUEST&&b("ScotchRTCP2PCallEscalationActions").handleACK(a.ackID.toString());break}};c.$8=function(c){i("P2P Escalator %o","parse response",c);var d=c.ackID.toString();b("ScotchRTCP2PCallEscalationStore").getToken()===d&&this.$10(c);b("ScotchRTCP2PCallEscalationActions").parseResponse(a.requestVideoOn(c.msg),d);window.clearTimeout(this.$5)};c.$9=function(c){i("P2P Escalator %o","parse request",c);if(b("ScotchRTCP2PCallEscalationStore").isInProgress()&&!a.requestVideoOn(c.msg)){b("ScotchRTCP2PCallEscalationStore").didCurrentUserInitiate()?b("ScotchRTCP2PCallEscalationActions").cancel():(this.$10(c),b("ScotchRTCP2PCallEscalationActions").setRequest(c));return}if(b("ScotchRTCP2PCallEscalationStore").isInProgress()&&b("ScotchRTCP2PCallEscalationStore").didCurrentUserInitiate()){i("P2P Escalator %o","auto-approve","mutual consent");b("ScotchRTCP2PCallEscalationActions").approve();this.$10(c);this.generateResponseToken(c,!0);return}if(b("ScotchRTCP2PCallEscalationStore").isEscalated()){a.requestVideoOn(c.msg)?(i("P2P Escalator %o","auto-approve"),this.$10(c),this.generateResponseToken(c,!0),window.clearTimeout(this.$5)):(i("P2P Escalator %o","mute remote video"),b("ScotchRTCP2PCallEscalationActions").muteRemoteVideo());return}i("P2P Escalator %o %o","request",c);this.$10(c);b("ScotchRTCP2PCallEscalationActions").setRequest(c)};c.$10=function(a){var b=a.peerID,c=a.callID;a=a.msg;i("P2P Escalator %o","ACK","sent");this.$2.sendAck(b,c,a)};a.requestVideoOn=function(a){var b=a.reqVideoOn;a=a.videoon;return Boolean(b||a)};a.initEscalation=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.protocolHandler;a=b("ScotchRTCCallStore").getState();a=a.localUser;var d=a.getStream();a=a.hasVideo();return(d&&a?b("Promise").resolve(d).then(function(a){c.updateLocalVideoTracker();return a}):b("ScotchRTCP2PProtocolHandler").initStream(!0).then(function(a){c.startLocalVideoTracker(a);return a})).then(function(a){b("ScotchRTCP2PCallEscalationActions").setEscalateToMediaStream(a);b("ScotchRTCP2PCallEscalationActions").start();return a})};a.onEscalationSucceeded=function(){var c=b("ScotchRTCP2PCallEscalationStore").getEscalateMediaStream(),d=b("ScotchRTCCallStore").getState();d=d.localUser;if(d.getStream()===c){var e=b("ScotchRTCCallStore").getState();e=e.remoteUsers;d.toggleDisableVideo(!1);e.first()&&e.first().toggleDisableVideo(!1)}else c&&b("dangerouslyBypassDispatchError")(function(){a.updateEscalationStream(c)})};a.onEscalationFailed=function(){var a=b("ScotchRTCP2PCallEscalationStore").getEscalateMediaStream(),c=b("ScotchRTCCallStore").getState();c=c.localUser;if(c.getStream()===a){var d=b("ScotchRTCCallStore").getState();d=d.remoteUsers;c.toggleDisableVideo(!0);d.first()&&d.first().toggleDisableVideo(!0)}else if(a){b("ScotchRTCUtils").stopMediaStream(a);c=b("ScotchRTCP2PCallStore").getState();d=c.protocolHandler;d.updateLocalVideoTracker()}};a.acceptEscalation=function(c){var d=b("ScotchRTCCallStore").getState(),e=d.localUser;d=d.remoteUsers;c=Boolean(c==null?void 0:c.muteVideo);if(e.hasVideo()){e.toggleDisableVideo(c);d.first()&&d.first().toggleDisableVideo(!1);d=b("ScotchRTCP2PCallStore").getState();d=d.protocolHandler;d.updateLocalVideoTracker();b("ScotchRTCP2PCallEscalationActions").setResponse(!0);return b("Promise").resolve(e.streams.first())}else return b("ScotchRTCP2PProtocolHandler").initStream(!c).then(function(c){b("ScotchRTCP2PCallEscalationActions").setResponse(!0);a.updateEscalationStream(c);return c})};a.declineEscalation=function(){b("ScotchRTCP2PCallEscalationActions").setResponse(!1)};a.updateEscalationStream=function(a){var c=b("ScotchRTCCallStore").getState().localUser.getStream();if(b("ScotchFBRTCPeerConnection").shouldUseAddTrackForUnifiedPlan()&&c){for(var d=a.getVideoTracks(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.addTrack(g)}g=b("ScotchRTCP2PCallStore").getState();f=g.protocolHandler;f.updateStreamForUnifiedPlan(c)}else b("ScotchRTCP2PProtocolHandler").replaceLocalStream(a)};return a}();a.ACK_TIMEOUT=h;function i(){}e.exports=a}),null);
__d("ScotchFBRTCStatsHelpers",["Promise"],(function(a,b,c,d,e,f){var g=!1,h=function(a){if(a==="host"||a==="local")return"local";if(a==="serverreflexive"||a==="srflx")return"srflx";if(a==="peerreflexive"||a==="prflx")return"prflx";return a==="relayed"||a==="relay"?"relay":"unknown_"+a},i={UNKNOWN_CONNECTION:"l:unknown-unknown;r:unknown-unknown",connectionType:function(a,b,c,d){return a!==null&&a!==void 0&&b!==null&&c!==null&&c!==void 0&&d!==null?["l:",h(a),"-",b,";","r:",h(c),"-",d].join(""):null},getVideoCapabilitiesInfo:function(a){a=a.getVideoTracks();a=a[0];if(a==null)return null;if(typeof a.getCapabilities!=="function")return null;a=a.getCapabilities();var b=a.aspectRatio,c=a.facingMode,d=a.frameRate,e=a.height;a=a.width;return{facing_mode:(c=c)!=null?c:null,max_aspect_ratio:(c=b==null?void 0:b.max)!=null?c:null,max_frame_rate:(c=d==null?void 0:d.max)!=null?c:null,max_height:(d=e==null?void 0:e.max)!=null?d:null,max_width:(c=a==null?void 0:a.max)!=null?c:null,min_aspect_ratio:(e=b==null?void 0:b.min)!=null?e:null}},getMediaInputs:function(a){var b={audio_inputs:[],video_inputs:[]};a.forEach(function(a){switch(a.kind){case"videoinput":b.video_inputs.push(a.label);break;case"audioinput":b.audio_inputs.push(a.label);break}});return b},logCapabilities:function(a,b,c){a.setVideoCapabilities(i.getVideoCapabilitiesInfo(b)),a.setMediaInputs(i.getMediaInputs(c))},internalGetWindow:function(){return window},getBatteryStats:function(){return new(b("Promise"))(function(a,b){var c=i.internalGetWindow().navigator.getBattery;typeof c==="function"?a(c.call(navigator)):b()}).then(function(a){a.charging?g=!0:a.onchargingchange=function(a){a.target.charging&&(g=!0),a.target.onchargingchange=null};return{level:a.level*100,wasCharged:g}})["catch"](function(){return{placeholder:!0,level:-1,wasCharged:!1}})}};e.exports=i}),null);
__d("ScotchMessengerChatLinksFunnelLogger",["UserAgentData","WebFunnelLogger"],(function(a,b,c,d,e,f){"use strict";var g="MessengerVideoChatLinksFunnelDefinition",h="defaultSessionKey",i="marker",j="link_hash:",k,l;function a(a){var b=n(),c=m();a&&(l=c=[].concat(c,a));b.setFunnelTags(c);b.markStart().setAction(i).log()}function m(){var a={bn:b("UserAgentData").browserName,bv:b("UserAgentData").browserVersion,os:b("UserAgentData").platformName},c=Object.keys(a).map(function(b){return b+":"+((b=a[b])!=null?b:"unknown")});return c}function c(a){return j+a}function d(a,b){var c=n();c.setAction(a);b&&b.actionTag&&c.setActionTag(b.actionTag);b&&b.funnelTags&&(l=(l||[]).concat(b.funnelTags),c.setFunnelTags(l));c.log()}function f(a){k=(a=a)!=null?a:h}function n(){return new(b("WebFunnelLogger"))(g).setSessionKey(k)}a={startFunnel:a,appendAction:d,setSessionKey:f,getLinkHashTag:c};e.exports=a}),null);
__d("ScotchMultiwayRequests",["Promise","AsyncRequest","FBRTCEndpointServiceType","FBRTCLogger","FBRTCMessageType","ScotchFBRTCMultiwayMessage","ScotchFBRTCUserCapabilities","ScotchMWDeviceCapabilities","ScotchRTCUtils","ScotchRTWebUserActionLogger","XGroupCallSendRequestController","ZenonScreenSharingConstants"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonScreenSharingConstants").SCREEN_SHARE_DATA_USER_ID_KEY,h=b("ZenonScreenSharingConstants").ZenonScreenSharingDataMessageTopic,i=15e3;a=function(){function a(){}var c=a.prototype;c.sendJoinRequest=function(a,c,d,e,f,g,h,i,j){var k=h.callID,l=h.numParticipants;h=h.callTrigger;var m=i.userToEscalate,n=i.isEscalator;i=i.escP2PCallID;c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").JOIN,c,d,k,i);d={offer:{sdpString:e.toSdp()},deviceCapabilities:b("ScotchMWDeviceCapabilities").getDeviceCapabilities()};j!=null&&(d.syncPayload={stateStore:j});k=b("ScotchRTCUtils").createClientContextMessage(l,h?h:"");d.appMessages=[k];f&&f.length>0&&!m&&(d.usersToCall=f);m&&n&&(d.userToEscalate=m);g&&(d.mediaStatus=g);i=b("ScotchFBRTCUserCapabilities").getLocal();if(i.length>0){var o={};i.forEach(function(a){return o[a]=!0});d.userCapabilities=JSON.stringify(o)}e={joinRequest:d};j=this.$1(a,c,e);return this.$2(j)};c.sendHangupRequest=function(a,c,d,e,f,g){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").HANGUP,c,d,g);d={reason:e,detailedReasonString:f};g={hangupRequest:d};e=this.$1(a,c,g);e.jsonPayload.header.conferenceName||b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"groupcallsendrequest no conf name:"+JSON.stringify(e.jsonPayload)});return this.$2(e)};c.sendAddParticipantsRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").ADD_PARTICIPANTS,c,d,f);d={usersToInvite:e};f={addParticipantsRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendRemoveParticipantsRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").REMOVE_PARTICIPANTS,c,d,f);d={usersToRemove:e};f={removeParticipantsRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendStartScreenSharingRequest=function(a,b,c,d,e,f){return this.sendGenericDataMessageRequest(a,b,c,d,e,f,[],h.Start,JSON.stringify((a={},a[g]=e,a)))};c.sendEndScreenSharingRequest=function(a,b,c,d,e,f){return this.sendGenericDataMessageRequest(a,b,c,d,e,f,[],h.End,JSON.stringify((a={},a[g]=e,a)))};c.sendCompositingServiceDataMessageRequest=function(a,c,d,e,f,g,h){return this.sendGenericDataMessageRequest(a,c,d,e,f,[],[b("FBRTCEndpointServiceType").COMPOSITING_SERVICE],g,JSON.stringify(h))};c.sendGenericDataMessageRequest=function(a,c,d,e,f,g,h,i,j){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").DATA_MESSAGE,c,d,e);d={message:{body:{genericMessage:{data:j,topic:i}},header:{recipients:g,sender:f,serviceRecipients:h,topic_DEPRECATED:""}}};e={dataMessageRequest:d};j=this.$1(a,c,e);return this.$2(j)};c.sendSubscriptionRequest=function(a,c,d,e,f){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").SUBSCRIPTION,c,d,f);d={subscriptions:e};f={subscriptionRequest:d};e=this.$1(a,c,f);return this.$2(e)};c.sendClientMediaUpdateRequest=function(a,c,d,e,f,g,h,i){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").CLIENT_MEDIA_UPDATE,c,d,h);d={fromVersion:e,toVersion:f,mediaUpdates:g};i!=null&&(d.offer={sdpString:i.toSdp()});h={clientMediaUpdateRequest:d};e=this.$1(a,c,h);return this.$2(e)};c.sendUpdateRequest=function(a,c,d,e,f,g,h){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").UPDATE,c,d,e);d={topic:f,version:g};h!=null&&(d.data=h);e={updateRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.sendUnsubscribeRequest=function(a,c,d,e,f,g){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").UNSUBSCRIBE,c,d,e);d={topic:f,version:g};e={unsubscribeRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.sendApprovalRequest=function(a,c,d,e,f,g){c=b("ScotchRTCUtils").createRequestHeader(b("FBRTCMessageType").APPROVAL,c,d,e);d={targetUsers:f,approvalStatus:g};e={approvalRequest:d};f=this.$1(a,c,e);return this.$2(f)};c.$2=function(a){return new(b("Promise"))(function(c,d){var e=b("XGroupCallSendRequestController").getURIBuilder().getURI(),f=new(b("ScotchFBRTCMultiwayMessage"))(a);b("FBRTCLogger").getInstance().logSendingMultiwayMessage(f);e=new(b("AsyncRequest"))(e).setMethod("POST").setData({request:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){b("FBRTCLogger").getInstance().logMultiwayResponseReceived(a.payload,f.header().clientSessionId),c(a.payload)}).setErrorHandler(function(a){a=a.getErrorDescription();a=a!=null?a.toString():"AsyncRequest error";b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchMultiwayRequests._sendMessage error: "+a});a=Error(a);d(a)}).setTimeoutHandler(i,function(){d("timeout")});e.send()})};c.$1=function(a,b,c){return{endpoint:a,jsonPayload:{header:b,body:c}}};return a}();e.exports=new a()}),null);
__d("ZenonGetDisplayMediaUtils",["Promise","CollabRTCChromeScreenSharing","CollabRTCChromeScreenSharingExtension","RTCChromeScreenSharingUtils","ScotchRTWebUserActionLogger","UserAgent","err","webrtc-adapter"],(function(a,b,c,d,e,f){"use strict";var g=b("RTCChromeScreenSharingUtils").getMediaRequestSourceAppId,h=/\{\s*\[native code\]\s*\}/;function i(){return b("UserAgent").isBrowser("Edge >= 17")||b("UserAgent").isBrowser("Firefox >= 33")||b("UserAgent").isBrowser("Opera >= 60")||b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")||b("UserAgent").isBrowser("Safari >= 13")}function j(){var a;a=(a=navigator)==null?void 0:(a=a.mediaDevices)==null?void 0:a.getDisplayMedia;return typeof a==="function"&&h.test(a.toString())}function k(){var a;a=(a=navigator)==null?void 0:(a=a.mediaDevices)==null?void 0:a.getSupportedConstraints==null?void 0:a.getSupportedConstraints();return a!=null&&typeof a==="object"&&a.mediaSource===!0}function l(){return b("UserAgent").isBrowser("Chrome < 72")}a={getUserScreenMedia:function(a){if(l()&&!b("CollabRTCChromeScreenSharingExtension").isInstalled()){var c=b("err")("EXTENSION_NOT_FOUND");b("ScotchRTWebUserActionLogger").logError({errorDomain:"GetDisplayMedia",errorType:c.message});return b("Promise").reject(c)}if(!i()){c=b("err")("SCREEN_SHARING_NOT_SUPPORTED");b("ScotchRTWebUserActionLogger").logError({errorDomain:"GetDisplayMedia",errorType:c.message});return b("Promise").reject(c)}c=navigator.mediaDevices;if(c==null||typeof c.getDisplayMedia!=="function"){var d=b("err")("GET_DISPLAY_MEDIA_NOT_FOUND");b("ScotchRTWebUserActionLogger").logError({errorDomain:"GetDisplayMedia",errorType:d.message});return b("Promise").reject(d)}return c.getDisplayMedia(a)},isNativeScreenSharingSupported:function(){return j()||k()},shimGetDisplayMedia:function(){var a;if(typeof (b("webrtc-adapter")==null?void 0:(a=b("webrtc-adapter").browserShim)==null?void 0:a.shimGetDisplayMedia)==="function"){if(b("UserAgent").isBrowser("Firefox")){b("webrtc-adapter").browserShim.shimGetDisplayMedia(window,"screen");return}if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Edge (Chromium Based)")){b("webrtc-adapter").browserShim.shimGetDisplayMedia(window,function(){return b("CollabRTCChromeScreenSharing").getSourceID(void 0,g())});return}b("webrtc-adapter").browserShim.shimGetDisplayMedia(window)}}};e.exports=a}),null);
__d("ZenonMediaDevicesUtils",["Promise","err"],(function(a,b,c,d,e,f){"use strict";var g="default";a={enumerateDevices:function(){if(navigator.mediaDevices!=null&&typeof navigator.mediaDevices.enumerateDevices==="function")return b("Promise").resolve(navigator.mediaDevices.enumerateDevices());return window.MediaStreamTrack!=null&&typeof window.MediaStreamTrack.getSources==="function"?new(b("Promise"))(function(a){return window.MediaStreamTrack.getSources(a)}).then(function(a){return a.map(function(a){var b=a.id,c=a.kind;a=a.label;return{deviceId:b,groupId:"",kind:c==="video"?"videoinput":"audioinput",label:a}})}):b("Promise").reject(b("err")("enumerateDevices() not supported"))},filterDuplicateDefaultDevices:function(a){var b=a.find(function(a){return a.id===g}),c=b!=null&&b.groupId!==""&&b.label!=="";return c?a.filter(function(a){return!((b==null?void 0:b.groupId)===a.groupId&&(b==null?void 0:b.id)!==a.id&&(b==null?void 0:b.label.includes(a.label)))}):a}};e.exports=a}),null);
__d("ZenonImmutableMediaTrack",["immutable"],(function(a,b,c,d,e,f){"use strict";a=b("immutable").Record({contentHint:"",contentType:void 0,enabled:!1,label:"",pausedDownlink:!1,remote:!1,trackId:void 0,userMuted:!1,webrtcStream:void 0,webrtcTrack:void 0});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);e.exports=c}),null);
__d("ZenonMediaUtils",["ZenonImmutableMediaTrack"],(function(a,b,c,d,e,f){"use strict";var g={convertToZenonImmutableMediaTrack:function(a,c){var d=c.contentHint,e=c.isRemote,f=c.isUserMuted,h=c.stream;c=c.trackType;h=(h=h)!=null?h:g.createStreamWithTrack(a);c=(c=c)!=null?c:a.kind==="audio"?"audio":"video";return new(b("ZenonImmutableMediaTrack"))({contentHint:(d=(d=d)!=null?d:a.contentHint)!=null?d:"",contentType:c,enabled:a.enabled,label:a.label,remote:e,trackId:a.id,userMuted:f,webrtcStream:h,webrtcTrack:a})},createStreamWithTrack:function(a){var b=new MediaStream();b.addTrack(a);return b}};e.exports=g}),null);
__d("ZenonLocalMediaManager",["regeneratorRuntime","Promise","FBLogger","ScotchRTWebUserActionLogger","ZenonGetDisplayMediaUtils","ZenonMediaDevicesUtils","ZenonMediaUtils","ZenonWebRTCWrapper","uuid"],(function(a,b,c,d,e,f){"use strict";var g={adaptAudioConstraints:j,adaptVideoConstraints:k,getDevices:function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(b("ZenonMediaDevicesUtils").enumerateDevices());case 2:c=e.sent;d=c.map(function(a){return{groupId:a.groupId,id:a.deviceId,kind:a.kind,label:a.label}});b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"enumerateDevices: "+JSON.stringify(d)});if(!(a!=null)){e.next=7;break}return e.abrupt("return",d.filter(function(b){return b.kind===a}));case 7:return e.abrupt("return",d);case 8:case"end":return e.stop()}},null,this)},getDisplayMedia:function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"GetDisplayMedia audioConstraints: "+JSON.stringify(a)+" videoConstraints: "+JSON.stringify(c)});e.next=3;return b("regeneratorRuntime").awrap(b("ZenonGetDisplayMediaUtils").getUserScreenMedia(i(a,c)));case 3:d=e.sent;return e.abrupt("return",l(d,a,c,!0));case 5:case"end":return e.stop()}},null,this)},getUserMedia:function(a,c){var d,e,f,g,h,j,k,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:d=i(a,c);e=a.requestAudio;f=c.requestVideo;g="GetUserMedia: "+JSON.stringify({audioConstraints:d.audio,tx:b("uuid")(),videoConstraints:d.video});b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:g});o.prev=5;o.next=8;return b("regeneratorRuntime").awrap(b("ZenonWebRTCWrapper").getUserMedia(d));case 8:h=o.sent;return o.abrupt("return",l(h,a,c));case 12:o.prev=12;o.t0=o["catch"](5);b("ScotchRTWebUserActionLogger").logError({checkpoint:g,errorDomain:"GetUserMedia",errorType:String(o.t0)});typeof o.t0==="object"&&((o.t0==null?void 0:o.t0.name)==="Error"||(o.t0==null?void 0:o.t0.name)==="TypeError")&&b("FBLogger")("rtc_www").catching(o.t0).mustfix("TypeError in getUserMedia");if(!(e===!0&&f===!0)){o.next=33;break}o.prev=17;o.next=20;return b("regeneratorRuntime").awrap(b("Promise").allSettled([b("ZenonWebRTCWrapper").getUserMedia({audio:d.audio,video:!1}),b("ZenonWebRTCWrapper").getUserMedia({audio:!1,video:d.video})]));case 20:j=o.sent;k=j[0];m=j[1];k.status==="fulfilled"?k.value.getTracks().forEach(function(a){a.stop()}):b("ScotchRTWebUserActionLogger").logError({checkpoint:g,errorDomain:"GetUserMedia_Audio_Error",errorType:String(k.reason)});m.status==="fulfilled"?m.value.getTracks().forEach(function(a){a.stop()}):b("ScotchRTWebUserActionLogger").logError({checkpoint:g,errorDomain:"GetUserMedia_Video_Error",errorType:String(m.reason)});o.next=31;break;case 27:o.prev=27;o.t1=o["catch"](17);b("FBLogger")("rtc_www").catching(o.t1).mustfix("Error diagnosing getUserMedia errors in local media manager");throw o.t0;case 31:o.next=35;break;case 33:n=e===!0?"GetUserMedia_Audio_Error":f===!0?"GetUserMedia_Video_Error":"GetUserMedia_No_Media_Error",b("ScotchRTWebUserActionLogger").logError({checkpoint:g,errorDomain:n,errorType:String(o.t0)});case 35:throw o.t0;case 36:case"end":return o.stop()}},null,this,[[5,12],[17,27]])},getUserMediaWithFallback:function(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.prev=0;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"GetUserMediaWithFallback audioConstraints: "+JSON.stringify(a)+" videoConstraints: "+JSON.stringify(c)});d.next=4;return b("regeneratorRuntime").awrap(g.getUserMedia(a,c));case 4:return d.abrupt("return",d.sent);case 7:d.prev=7;d.t0=d["catch"](0);return d.abrupt("return",h(a,c,d.t0));case 10:case"end":return d.stop()}},null,this,[[0,7]])}};function h(a,c,d){if(c.requestVideo)if(d.name==="OverconstrainedError"&&Object.keys(c).length>1){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Removing video constraints: "+JSON.stringify(c),errorDomain:"GetUserMedia",errorType:d.toString()});return g.getUserMediaWithFallback(a,{requestVideo:!0})}else if(d.name==="NotFoundError"||d.name==="StreamFailedToStart"){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Fallback to audio-only",errorDomain:"GetUserMedia",errorType:d.toString()});return g.getUserMedia(a,{requestVideo:!1})}throw d}function i(a,b){return{audio:j(a),video:k(b)}}function j(a){var b=a.requestAudio;a=babelHelpers.objectWithoutPropertiesLoose(a,["requestAudio"]);return b===!1?!1:Object.keys(a).length>0?a:!0}function k(a){var b=a.requestVideo;a=babelHelpers.objectWithoutPropertiesLoose(a,["requestVideo"]);if(b===!1)return!1;if(Object.keys(a).length===0)return!0;b=a.facingMode;a=babelHelpers.objectWithoutPropertiesLoose(a,["facingMode"]);a=babelHelpers["extends"]({},a);b!=null&&(a.facingMode={ideal:b});return a}function l(a,c,d,e){e===void 0&&(e=!1);return a.getTracks().map(function(f){var g={contentHint:f.kind==="audio"?c.contentHint:d.contentHint,isRemote:!1,isUserMuted:!1,stream:a,trackType:e?"screen":void 0};return b("ZenonMediaUtils").convertToZenonImmutableMediaTrack(f,g)})}b("ZenonGetDisplayMediaUtils").shimGetDisplayMedia();e.exports=g}),null);
__d("ZenonLocalMediaSDK",["ZenonLocalMediaManager"],(function(a,b,c,d,e,f){"use strict";a={getDisplayMedia:function(a,c){return b("ZenonLocalMediaManager").getDisplayMedia(a,c)},getUserMedia:function(a,c){return b("ZenonLocalMediaManager").getUserMedia(a,c)},getUserMediaWithFallback:function(a,c){return b("ZenonLocalMediaManager").getUserMediaWithFallback(a,c)},getDevices:function(a){return b("ZenonLocalMediaManager").getDevices(a)}};e.exports=a}),null);
__d("ZenonRTCVideoResolutionHelper",["ZenonExperiments"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}a.getMaxEncResolution=function(a){var c=b("ZenonExperiments").maxParticipants720(),d=b("ZenonExperiments").maxParticipants360(),e=b("ZenonExperiments").maxParticipants180(),f={height:720,width:1280},g={height:360,width:640},h={height:180,width:320};if(c>0&&a<=c)return f;if(d>0&&a<=d)return g;if(e>0&&a<=e)return h;if(e>0)return h;if(d>0)return g;return c>0?f:null};a.getScalingFactor=function(a,b,c,d){if(a.width==null||a.width<=0||a.height==null||a.height<=0||b.width==null||b.width<=0||b.height==null||b.height<=0)return null;b=Math.sqrt(b.width*b.height/(a.width*a.height));if(b<1+d)return 1;return c?Math.floor(b+d):b};a.encoderScalingEnabled=function(){return b("ZenonExperiments").limitEncodeResolutionEnabled()};a.maybeLimitEncodingResolutionByParticipantCountHelper=function(c,d,e,f){if(!a.encoderScalingEnabled()||f)return;f=d.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});d=f.length;f=d+1;d=a.getMaxEncResolution(f);if(!d)return;f=[d];a.maybeLimitEncodingResolution(c,f,b("ZenonExperiments").integerScaling(),b("ZenonExperiments").minThresholdScalingPct()/100,e)};a.maybeLimitEncodingResolution=function(b,c,d,e,f){b=b.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});if(b.length>0){var g;b=b[0];var h=b.getParameters();g=(g=b.track)==null?void 0:g.getSettings();if(!g)return;if(c.length!==h.encodings.length)return;for(var c=c.entries(),i=Array.isArray(c),j=0,c=i?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=c.length)break;k=c[j++]}else{j=c.next();if(j.done)break;k=j.value}k=k;var l=k[0];k=k[1];k=f?1:a.getScalingFactor(k,{height:g.height,width:g.width},d,e);if(k==null)continue;k===1?delete h.encodings[l].scaleResolutionDownBy:h.encodings[l].scaleResolutionDownBy=k}b.setParameters(h)}};a.maybeLimitEncodingResolutionByParticipantCount=function(b,c,d){return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};a.handleStartScreenSharing=function(b,c,d){a.$1++;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};a.handleStopScreenSharing=function(b,c,d){a.$1--;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,a.$1>0,d)};return a}();a.$1=0;e.exports=a}),null);
__d("ZenonSimulcastManager",["recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=25e5;function a(a,b,c){c=h(b.perSsrcTargetBitrateBpsMap,c);var d=0,e=[],f=[];for(var k=0;k<a.encodings.length;k++)if(j(k,b.qualityMask)){d++;e.push(i(k,a.encodings.length-1));var l=c.get(k);l!=null?f.push(l):f.push(g)}for(var l=0;l<a.encodings.length;l++)l<d?(a.encodings[l].active=!0,a.encodings[l].scaleResolutionDownBy=e[l],a.encodings[l].maxBitrate=f[l]):a.encodings[l].active=!1;return a}function h(a,b){var c=new Map();if(a==null||b==null)return c;for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];g=a.get(g);g!=null&&c.set(f,g)}return c}function i(a,c){if(a<=c&&c<=2&&a>=0){if(a===c)return 1;if(a===c-1)return 2;if(a===c-2)return 4}b("recoverableViolation")("Unsupported simulcast parameters passed to getResolutionScalingParameter","rtc_www");return 1}function j(a,b){return(1<<a&b)!==0}function c(a){var b=new Map(),c="\r\n";a=a.split(c).filter(function(a){return a.startsWith("a=ssrc-group:SIM")});if(a.length===0)return b;c=a[0].split(" ").slice(1);for(var a=0;a<c.length;a++)b.set(c[a],a);return b}e.exports={getSimulcastEncodingParameters:a,getSimulcastLayerToTargetBitrateMap:h,getSimulcastSsrcToLayerMap:c}}),null);
__d("ScotchRTCMWProtocolHandler",["invariant","Promise","regeneratorRuntime","requireCond","ChannelManager","CurrentUser","DateConsts","FBLogger","FBRTCAppMessageDataAppCommandAction","FBRTCAppMessageDataAppCommandLayoutType","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCRtcResponseStatusCode","FBRTCVideoQuality","MercuryIDs","ScotchFBRTCGroupCallStore","ScotchFBRTCMWProtocolStore","ScotchFBRTCPeerConnection","ScotchFBRTCSdpUtils","ScotchFBRTCStatsHelpers","ScotchgenerateRTCCallID","ScotchMessengerChatLinksFunnelLogger","ScotchMultiwayParticipantFetcher","ScotchMultiwayRequests","ScotchRTCAppData","ScotchRTCCallActions","ScotchRTCCallStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMultiwayMessageHandler","ScotchRTCProxyUserStore","ScotchRTCProxyUserUtils","ScotchRTCSessionDescription","ScotchRTCSignalingExperiments","cr:1420073","ScotchRTCUtils","ScotchRTWebBrowserFeatureSupport","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","ZenonLocalMediaSDK","ZenonPlatformExperiments","ZenonRTCVideoResolutionHelper","ZenonSimulcastManager","ZenonTSLogDataHelper","emptyFunction","gkx","immutable","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=(a=b("FBRTCConstants")).CallEndReason,i=a.GroupVideoViewLayout,j=a.RTCConstraints,k=a.SDPSemantics,l=a.SignalingProtocol,m=b("ScotchRTWebBrowserFeatureSupport").isReplaceTrackSupported,n=30*b("DateConsts").MS_PER_SEC,o={appId:b("ScotchRTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()},p=250,q=null,r=function(){function a(a){var c=this;this.$7=!1;this.$8=!1;this.$9=!1;this.$10=b("FBRTCLogger").getInstance();this.$15=function(a){a=a.target;a=a.iceConnectionState;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"RTCMWProtocolHandler_PC_iceconnectionstatechange: "+a});b("ScotchRTCCallActions").emit("onIceConnectionStateChange",a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d==null?void 0:d.setPCIsConnected(a==="completed"||a==="connected");b("gkx")("965758")&&b("ZenonTSLogDataHelper").onIceConnectionStateChange(a);switch(a){case"completed":case"connected":window.clearTimeout(c.$5);c.$5=null;b("FBRTCLogger").getInstance().logMultiwayRelayConnected(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,c.$3);d==null?void 0:d.onNetworkReady();break;case"disconnected":case"failed":c.$5||(c.$5=window.setTimeout(function(){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Ending call due to iceConnectionState disconnection timeout"}),b("ScotchRTCCallActions").endCall(h.CONNECTION_DROPPED,"ConnectionDropped"),c.$23()},n));break}d==null?void 0:d.save(b("FBRTCCallSummaryStore").getInstance())};this.$3=(a=a)!=null?a:b("ScotchgenerateRTCCallID")();this.$4="MW_PEER_ID"}var c=a.prototype;c.setKeepLocalStreamsOnClose=function(a){this.$8=a;return this};c.setAllowIncomingCalls=function(a){this.$9=a;return this};c.startCall=function(c,d,e,f){var g=this,h=f.addStreamCallback;h=h===void 0?b("emptyFunction"):h;var i=f.callTrigger,j=f.formatParameters;j=j===void 0?{}:j;var m=f.preferredCodecs;m=m===void 0?{}:m;var n=f.offerSdpTransform,o=f.serverInfoData,p=f.shouldSetDescriptions;p=p===void 0?!0:p;var q=f.isEscalatedCall;q=q===void 0?!1:q;var r=f.connectedOnJoin;r=r===void 0?!1:r;var s=f.escP2PCallID;s=s===void 0?"":s;f=f.initialSyncStates;f=f===void 0?null:f;b("ScotchRTCCallActions").initialize({protocol:l.MULTIWAY,conferenceName:e,serverInfoData:o,callID:this.$3.toString(),callTrigger:i});b("ScotchMessengerChatLinksFunnelLogger").appendAction("init_mw_call",{funnelTags:["conf_name:"+e,"call_id:"+this.$3]});var t=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$4,this.$3,!1);i&&t.onCallStarted(i);t.setJoinWithSID(o!=null);t.setActiveConnection("mws");t.setCallType("mws");t.onPopupOpened();t.setConferenceName(e);t.setServerInfoData(o);if(q){var u=b("ScotchRTCCallStore").getState().callSummary;t.setEscalationP2PCallID(u.callID)}this.$11(t);t.save(b("FBRTCCallSummaryStore").getInstance());b("ScotchRTCCallActions").setCallSummary(t);u={mandatory:{},optional:[{DtlsSrtpKeyAgreement:!1},{googNumUnsignalledRecvStreams:10},{RtpDataChannels:!0}]};var v=new(b("ScotchFBRTCPeerConnection"))(l.MULTIWAY,{iceServers:[]},u);if(e.split(":")[0]!=="LIVE"&&!(b("UserAgent").isBrowser("Safari")||b("UserAgent").isBrowser("Mobile Safari"))){u=v.createDataChannel("data");u&&(u.onmessage=function(a){a=a.data;try{a=JSON.parse(a);a=a.body;g.$12(a)}catch(a){g.$10.logError(g.$4,g.$3,a)}})}v.getSdpSemantics()===k.UNIFIED_PLAN?v.addEventListener("track",function(b){g.$13(e,v,b),a.maybeLimitEncodingResolutionByParticipantCount(v)}):v.addEventListener("addstream",function(c){g.$14(e,c.stream),a.maybeLimitEncodingResolutionByParticipantCount(v),a.updateLocalEncodingActive(v,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled)});v.addEventListener("removestream",function(c){b("ScotchRTCCallActions").removeRemoteStream(c.stream),a.maybeLimitEncodingResolutionByParticipantCount(v),a.updateLocalEncodingActive(v,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled)});v.addEventListener("iceconnectionstatechange",this.$15);this.$16(v,d,e,o,c,h,j,m,p,q,r,s,i?i:t.getCallTrigger(),n,f);!o?b("ScotchRTCCallActions").call(c,v):b("ScotchRTCCallActions").join(v);return v};c.$11=function(a){b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(c){a.addExtraInfo(b("FBRTCLogger").Key.BATTERY_START,c.level)})};c.$13=function(a,c,d){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$3.toString(),checkpoint:"ScotchRTCMWProtocolHandler_onAddTrack",conferenceName:a});if(c.getSdpSemantics()===k.UNIFIED_PLAN){var e,f;f=(f=d)!=null?(f=f.track)!=null?f.id:f:f;e=(e=d)!=null?(e=e.transceiver)!=null?e.mid:e:e;if(e===void 0){var g;e=(g=d.target.getTransceivers().find(function(a){return a.receiver===d.transceiver.receiver}))==null?void 0:g.mid}c.processUnifiedTrackIdTranslation(f,e)}d.streams.length>0&&this.$14(a,d.streams[0])};c.$14=function(a,c){var d=this;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$3.toString(),checkpoint:"ScotchRTCMWProtocolHandler_onAddStream. Stream id="+c.id,conferenceName:a});var e=c.id.split(":")[0],f=b("MercuryIDs").getParticipantIDFromUserID(e);if(e!==b("CurrentUser").getID()){e=b("ScotchRTCProxyUserUtils").getUserIDToFetch(e);var g=b("ScotchRTCProxyUserStore").getState();g=g.proxyingAsToProxyUser;b("promiseDone")(b("ScotchMultiwayParticipantFetcher").fetchAllParticipants(a,b("immutable").Set([e]),{proxyingAsToProxyUser:g}),function(a){a=a.get(f);d.$17(f,a,c)})}};c.$17=function(c,d,e){var f={};f[c]=d;b("ScotchRTCGroupCallActions").onParticipantsAdded(f);b("ScotchRTCCallActions").addRemoteStream(e);c=b("ScotchRTCCallStore").getState();d=c.callInfo;f=b("ScotchFBRTCGroupCallStore").getState();e=f.layout;c=f.pinnedSpeakerFBID;f=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);f&&a.subscription(d.conferenceName,d.serverInfoData,f.getRemoteStreams(),e,c)};c.$18=function(a){var c=new Map();Object.keys(a).forEach(function(d){var e=parseInt(a[d],10);if(isNaN(e)){b("recoverableViolation")("Simulcast bitrate string could not be parsed as int","rtc_www");return}c.set(d,e)});return c};c.$12=function(a){a.dominantSpeakerNotification&&this.$19(a.dominantSpeakerNotification);if(a.videoUploadRequest){var b=null;a.videoUploadRequest.perSsrcTargetBitrateBpsMap&&(b=this.$18(a.videoUploadRequest.perSsrcTargetBitrateBpsMap));b={perSsrcTargetBitrateBpsMap:b,qualityMask:a.videoUploadRequest.qualityMask};this.$20(b)}};c.setDescriptions=function(){this.$7=!0;var a=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);this.$6&&a&&a.setRemoteDescription(this.$6)};a.maybeLimitEncodingResolutionByParticipantCount=function(a){b("ZenonRTCVideoResolutionHelper").maybeLimitEncodingResolutionByParticipantCount(a.getSenders(),a.getReceivers(),a.supportsSimulcast())};a.escalateLocalStream=function(c){c===void 0&&(c=!0);var d=b("ScotchFBRTCGroupCallStore").getState();d=d.videoEscalateState;if(c&&d!=="initial")return b("Promise").resolve();b("ScotchRTCGroupCallActions").videoEscalationStarted();return a.initStream(c).then(function(a){var d=b("ScotchRTCCallStore").getState(),e=d.callInfo,f=e.conferenceName;e=e.serverInfoData;var g=d.localUser;d=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);if(!d)return;var h=null;c&&(a.getTracks().forEach(function(a){a.kind==="audio"&&(a.enabled=!g.isAudioDisabled())}),h=g.streams.first(),d.removeStream(h));return t(d,[a],f,e,[]).then(function(){h&&b("ScotchRTCCallActions").removeLocalStream(h),b("ScotchRTCCallActions").addLocalStream(a),b("ScotchRTCGroupCallActions").videoEscalationCompleted()})})["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_escalateLocalStream",errorType:a.toString()}),b("ScotchRTCGroupCallActions").resetVideoEscalation()})};c.onStreamReady=function(a,c,d,e,f){var g={};e||b("ScotchRTCCallActions").addLocalStream(a);g.isEscalatedCall=e;f.p2pCallID&&(g.escP2PCallID=f.p2pCallID);f.serverInfoData&&(g.serverInfoData=f.serverInfoData);f.callTrigger&&(g.callTrigger=f.callTrigger);b("ScotchRTWebClientFeatureGating").preferIsacForGroupCalls()&&(g.preferredCodecs={audio:"ISAC/16000"});this.startCall(c,[a],d,g)};a.initStream=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c===void 0&&(c=!0);e.next=3;return b("regeneratorRuntime").awrap(s(a,c));case 3:d=e.sent;return e.abrupt("return",d);case 5:case"end":return e.stop()}},null,this)};a.updateLocalStream=function(c,d){d===void 0&&(d=!1);var e=b("ScotchRTCCallStore").getState(),f=e.callInfo,g=f.callID,h=f.conferenceName;f=f.serverInfoData;e=e.localUser;var i=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);if(!i)return b("Promise").resolve();if(m()&&b("gkx")("1507314")){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"ScotchRTCMWProtocolHandler_updateLocalStream: use replaceTrack to swap media tracks",conferenceName:h});var j=d?e.getStream():e.getActiveStream();if(j!=null){var k=[],n=j.getAudioTracks(),o=n[0];n=j.getVideoTracks();var p=n[0];j=c.getAudioTracks();var q=j[0];n=c.getVideoTracks();var r=n[0];q!=null&&o!=null&&k.push(i.replaceTrack(q,o).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(q,o)}));r!=null&&p!=null&&e.hasVideo()&&!e.hasScreenStream()&&k.push(i.replaceTrack(r,p).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(r,p),a.maybeLimitEncodingResolutionByParticipantCount(i)}));return b("Promise").all(k).then(function(){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"ScotchRTCMWProtocolHandler_updateLocalStream: dispatch actions to Flux store",conferenceName:h}),b("ScotchRTCCallActions").removeAllLocalStreams(d===!1),b("ScotchRTCCallActions").addLocalStream(c)})["catch"](function(a){b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchRTCMWProtocolHandler_updateLocalStream",errorType:a.message})})}}return t(i,[c],h,f,[]).then(function(){b("ScotchRTCCallActions").removeAllLocalStreams(!0),b("ScotchRTCCallActions").addLocalStream(c)})};a.updateLocalEncodingActive=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(b("gkx")("1478914")){f.next=2;break}return f.abrupt("return");case 2:d=a.getRemoteStreams().length;e=d>0||c;f.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(a.getSenders().map(function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.prev=0;c=a.getParameters();c.encodings.forEach(function(a){a.active=e});d.next=5;return b("regeneratorRuntime").awrap(a.setParameters(c));case 5:d.next=10;break;case 7:d.prev=7,d.t0=d["catch"](0),b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error while trying to toggle encoding");case 10:case"end":return d.stop()}},null,this,[[0,7]])})));case 6:case"end":return f.stop()}},null,this)};a.startScreenStream=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo,e=d.callID,f=d.conferenceName;d=d.serverInfoData;var h=c.localUser;c=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);var i=b("ScotchFBRTCMWProtocolStore").getState(),j=i.localScreenDurationTracker;if(!c)return;m()||g(0,21463);b("ZenonRTCVideoResolutionHelper").handleStartScreenSharing(c.getSenders(),c.getReceivers(),c.supportsSimulcast());i=c.getSenders().find(function(a){return a.track&&a.track.kind==="video"});var k=i==null?void 0:i.track;if(i===void 0||!k){var n=h.getStream();n!=null&&b("ScotchRTCUtils").transferAudioTracks(a,n);n=t(c,[a],f,d,[])}else n=b("Promise").resolve(i.replaceTrack(a.getVideoTracks()[0])).then(function(){b("ScotchRTCGroupCallActions").onLocalTrackReplaced(a.getVideoTracks()[0],k)});b("promiseDone")(n,function(){for(var c=h.screenStreams,d=Array.isArray(c),g=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(d){if(g>=c.length)break;i=c[g++]}else{g=c.next();if(g.done)break;i=g.value}i=i;i!==a&&(b("ScotchRTCCallActions").removeLocalScreenStream(i),b("ScotchRTCUtils").stopMediaStream(i))}j.track(a);!j.isStarted()?j.start():j.update();b("ScotchRTCCallActions").addLocalScreenStream(a);b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"screen_sharing_started",conferenceName:f})})};a.updateScreenStream=function(b,c){a.startScreenStream(c)};a.replaceScreenTrackWithVideo=function(a,c,d){if(!b("ZenonRTCVideoResolutionHelper").encoderScalingEnabled())a.replaceTrack(c);else{a=b("Promise").resolve(a.replaceTrack(c));b("promiseDone")(a,function(){b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(d.getSenders(),d.getReceivers(),d.supportsSimulcast())},function(a){b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(d.getSenders(),d.getReceivers(),d.supportsSimulcast())})}};a.stopScreenStream=function(c){var d,e=b("ScotchRTCCallStore").getState(),f=e.callInfo;e=e.localUser;var h=b("ScotchRTCCallStore").getConnection(l.MULTIWAY),i=b("ScotchFBRTCMWProtocolStore").getState();i=i.localScreenDurationTracker;if(!h)return;m()||g(0,21463);d=(d=e.getStream())==null?void 0:d.getVideoTracks();if(d&&d.length>0){var j=h.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});a.replaceScreenTrackWithVideo(j[0],d[0],h);b("ScotchRTCGroupCallActions").onLocalTrackReplaced(d[0],(h=j[0])==null?void 0:h.track)}else{d=e.getStream();d!=null&&b("ScotchRTCUtils").transferAudioTracks(d,c)}b("ScotchRTCCallActions").removeLocalScreenStream(c);b("ScotchRTCUtils").stopMediaStream(c);i.update();b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f.callID,checkpoint:"screen_sharing_stopped",conferenceName:f.conferenceName})};a.endCall=function(c,d,e,f){f===void 0&&(f=""),b("promiseDone")(a.genEndCall(c,e,{serverInfoData:d,detailedReasonString:f,keepLocalStream:!1}))};a.genEndCall=function(a,c,d){var e=b("ScotchRTCCallStore").getState(),f=e.callSummary;e=e.callInfo;var g=b("ScotchFBRTCMWProtocolStore").getState();g=g.localScreenDurationTracker;d.keepLocalStream||b("ScotchRTCCallActions").removeAllLocalStreams(!0);b("ScotchRTCCallActions").removeAllLocalScreenStreams(!0);var h=d.detailedReasonString||"Hangup by user";b("ScotchRTCCallActions").hangup(b("ScotchRTCUtils").endCallReasonFromHangupReason(c),h);if(b("gkx")("965758")){e=b("ZenonTSLogDataHelper").serialize(e.tsLogData);b("FBRTCLogger").getInstance().logTsLogData(e,f.peerID,f.callID,a,d.serverInfoData)}g.stop();f.setScreenDuration(g.getDuration());return b("ScotchMultiwayRequests").sendHangupRequest(o,a,d.serverInfoData,c,h,b("ScotchRTCCallStore").getState().callInfo.callID).then(function(){b("ScotchRTCCallActions").hangupSuccess()})["catch"](function(a){b("ScotchRTCCallActions").hangupError();throw a})};a.otherUserInAnotherCall=function(a,c,d,e,f){f===void 0&&(f=""),b("promiseDone")(b("ScotchMultiwayRequests").sendHangupRequest(o,a,c,d,f||"User receiving this call is in another call",e))};c.iceRestart=function(a,c){var d=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);d&&t(d,[],a,c,[],{iceRestart:!0})};a.addParticipants=function(a,c,d){return b("ScotchMultiwayRequests").sendAddParticipantsRequest(o,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)};a.removeParticipants=function(a,c,d){return b("ScotchMultiwayRequests").sendRemoveParticipantsRequest(o,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)};a.notifyScreenShareStart=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo;c=c.localUser;var e=d.callID,f=d.conferenceName;d=d.serverInfoData;return b("ScotchMultiwayRequests").sendStartScreenSharingRequest(o,f,d,e,c.FBID,a)};a.notifyScreenShareEnd=function(a){var c=b("ScotchRTCCallStore").getState(),d=c.callInfo;c=c.localUser;var e=d.callID,f=d.conferenceName;d=d.serverInfoData;return b("ScotchMultiwayRequests").sendEndScreenSharingRequest(o,f,d,e,c.FBID,a)};a.sendCompositingServiceDataMessageRequest=function(a,c){var d=b("ScotchRTCCallStore").getState(),e=d.callInfo;d=d.localUser;var f=e.callID,g=e.conferenceName;e=e.serverInfoData;c={broadcastMetadata:{layoutMetadata:{type:b("FBRTCAppMessageDataAppCommandLayoutType").SIDE_BY_SIDE,compositingUserIds:c}},action:{type:b("FBRTCAppMessageDataAppCommandAction").PING}};return b("ScotchMultiwayRequests").sendCompositingServiceDataMessageRequest(o,g,e,f,d.FBID,a,c)};a.subscription=function(a,c,d,e,f){if(!b("gkx")("1390244")){var g=e===i.DOMINANT_SPEAKER?b("FBRTCVideoQuality").LOW:e===i.GRID?b("FBRTCVideoQuality").MEDIUM:b("FBRTCVideoQuality").HIGH;d=d.map(function(a){a=a.id;return{cname:a,options:{videoQuality:e===i.DOMINANT_SPEAKER&&f===a.split(":")[0]?b("FBRTCVideoQuality").HIGH:g}}});e===i.DOMINANT_SPEAKER&&!f&&d.push({cname:""});b("ScotchMultiwayRequests").sendSubscriptionRequest(o,a,c,d,b("ScotchRTCCallStore").getState().callInfo.callID)}};a.subscriptionV2=function(c,d){c=c.map(function(a){var b=a.stream;a=a.videoQuality;return{cname:b.id,options:{videoQuality:a}}});d&&c.push({cname:""});!b("gkx")("1414812")?a.$21(c):a.$1!=null?a.$2=c:(a.$21(c),a.$1=window.setTimeout(function(){a.$2!=null&&(a.$21(a.$2),a.$2=null),window.clearTimeout(a.$1),a.$1=null},p))};a.$21=function(a){var c=b("ScotchRTCCallStore").getState();c=c.callInfo;var d=c.conferenceName,e=c.serverInfoData,f=c.callID;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:c.callID,checkpoint:"SendingSubscriptionRequest:"+JSON.stringify(a),conferenceName:c.conferenceName});b("ScotchMultiwayRequests").sendSubscriptionRequest(o,d,e,a,f)};a.clientMediaUpdate=function(a,c,d,e,f,g){var h=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendClientMediaUpdateRequest(o,a,c,d,e,f,b("ScotchRTCCallStore").getState().callInfo.callID,g).then(function(c){var d,e,f,g,i,j,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:d=c.header,e=c.body.clientMediaUpdateResponse,f=e.currentVersion,g=e.answer,i=e.mediaStatus;j=d.responseStatusCode,m=d.transactionId;b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchRTCMWSProtocolHandler_clientMediaUpdate response: "+JSON.stringify({statusCode:j,currentVersion:f,answer:g==null?void 0:g.toSdp==null?void 0:g.toSdp(),transactionId:m}),callID:h,conferenceName:a,callType:"mw"});if(!(g!=null&&b("ZenonPlatformExperiments").shouldUseLobbyMode()&&j==b("FBRTCRtcResponseStatusCode").OK)){r.next=17;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:h,checkpoint:"[WR] Received answer SDP in CMU response and lobby mode is enabled: "+JSON.stringify({transactionId:m}),conferenceName:a});n=new(b("ScotchRTCSessionDescription"))(l.MULTIWAY,{type:"answer",sdp:g.sdpString});o=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);if(!(o==null)){r.next=10;break}b("recoverableViolation")("Peer Connection should not be null if renegotiation is requested","rtc_www");return r.abrupt("return");case 10:b("ScotchRTWebUserActionLogger").logCheckpoint({callID:h,checkpoint:"[WR] ScotchRTCMWProtocolHandler_onClientMediaUpdateResponse setting remote description: "+JSON.stringify({transactionId:m}),conferenceName:a});r.next=13;return b("regeneratorRuntime").awrap(o.setRemoteDescription(n));case 13:p=i,o.getSdpSemantics()===k.UNIFIED_PLAN&&(q={},Object.keys(p).forEach(function(a){var b=o.getWebrtcTrackIdFromMWTrackId(a);q[b]=p[a]}),p=q),b("ScotchRTCGroupCallActions").toggleRemoteStream(p,h),b("ScotchRTCCallActions").callSuccess(!0);case 17:b("FBRTCLogger").getInstance().logMultiwayResponseProcessed(d,h),b("ScotchRTCGroupCallActions").onClientMediaUpdateResponse(j,f);case 19:case"end":return r.stop()}},null,this)})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendUpdateRequest=function(a,c,d,e,f){var g=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"[SS] Update request for topic: "+d+" and version "+e+" is being sent",conferenceName:a});b("ScotchMultiwayRequests").sendUpdateRequest(o,a,c,b("ScotchRTCCallStore").getState().callInfo.callID,d,e,f).then(function(d){var f=d.header,h=f.responseStatusCode;f=f.responseSubCode;d=d.body.updateResponse;var c=d.topic;d=d.version;h!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"MW response status code "+h+" with subcode: "+f+" to update request",conferenceName:a});d!=e&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:g,checkpoint:"Update response for topic "+c+" had version "+d+" which did not match sent version "+e,conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendUnsubscribeRequest=function(a,c,d,e){var f=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendUnsubscribeRequest(o,a,c,f,d,e).then(function(d){var g=d.header,h=g.responseStatusCode;g=g.responseSubCode;d=d.body.updateResponse;var c=d.topic;d=d.version;h!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"MW response status code "+h+" with subcode: "+g+" to update request",conferenceName:a});d!=e&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"Unsubscribe response for topic "+c+" had version "+d+" which did not match sent version "+e,conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};a.sendApprovalRequest=function(a,c,d,e){var f=b("ScotchRTCCallStore").getState().callInfo.callID;b("ScotchMultiwayRequests").sendApprovalRequest(o,a,c,f,d,e).then(function(c){c=c.header;var d=c.responseStatusCode;c=c.responseSubCode;d!==b("FBRTCRtcResponseStatusCode").OK&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:f,checkpoint:"MW response status code "+d+" with subcode: "+c+" to approval request",conferenceName:a})})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("ScotchRTCCallStore").getState().callInfo.callID,a)})};c.$16=function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this;this.$22(d,e);b("promiseDone")(t(a,c,d,e,f,{},g,h,i,j,k,m,n,o,p),function(a){a!=null&&(q.$6=a,q.$7&&q.setDescriptions()),b("ScotchRTCCallActions").callSuccess(a==null?!1:l)},function(a){typeof a.toString==="function"&&b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchRTCMWProtocolHandler_initPeerConnection error: "+JSON.stringify(a)}),a==="timeout"?b("ScotchRTCCallActions").endCall(b("FBRTCConstants").CallEndReason.INCOMING_TIMEOUT):b("ScotchRTCCallActions").callError(a.responseStatusCode,a.responseSubCode),q.$23()})};c.$23=function(){var a=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);a&&a.close();this.$8||b("ScotchRTCCallActions").removeAllLocalStreams(!0)};c.$22=function(a,c){q==null&&(q=new(b("ScotchRTCMultiwayMessageHandler"))()),q.initialize(a,c,this.$9,this.$8)};c.$19=function(a){a=a.userId;if(b("ScotchFBRTCGroupCallStore").getState().dominantSpeakerFBID===a)return;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:this.$3.toString(),checkpoint:"newDominantSpeakerID: "+a});b("ScotchRTCGroupCallActions").setDominantSpeaker(a)};c.$20=function(a){var c=b("ScotchRTCCallStore").getConnection(l.MULTIWAY);if(c==null)return;if(!c.supportsSimulcast())return;var d=c.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(d.length==0)return;d=d[0];a=b("ZenonSimulcastManager").getSimulcastEncodingParameters(d.getParameters(),a,c.getSsrcToSimulcastLayerMap());d.setParameters(a)};a.maybeLimitBitrate=function(a){a=a.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(a.length>0&&b("ScotchRTCSignalingExperiments").shouldCapMWBitrate()){a=a[0];var c=a.getParameters();c.encodings[0].maxBitrate=72e4;b("Promise").resolve(a.setParameters(c))}};return a}();r.$1=null;r.$2=null;function s(a,c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d={requestAudio:c};e={requestVideo:a,width:{ideal:j.HD_WIDTH},height:{ideal:j.HD_HEIGHT},frameRate:{ideal:j.FRAME_RATE}};g.next=4;return b("regeneratorRuntime").awrap(b("ZenonLocalMediaSDK").getUserMedia(d,e));case 4:f=g.sent;return g.abrupt("return",f[0].webrtcStream);case 6:case"end":return g.stop()}},null,this)}function t(a,c,d,e,f,g,h,i,j,m,n,p,s,t,u){var v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,aa;return b("regeneratorRuntime").async(function($){while(1)switch($.prev=$.next){case 0:g===void 0&&(g={}),h===void 0&&(h=b("emptyFunction")),i===void 0&&(i={}),j===void 0&&(j={}),m===void 0&&(m=!0),n===void 0&&(n=!1),p===void 0&&(p=""),s===void 0&&(s=""),t===void 0&&(t=[]),x={},y=[],(z=a.getLocalStreams()||[],A=Array.isArray(z),B=0,z=A?z:z[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 12:if(!A){$.next=18;break}if(!(B>=z.length)){$.next=15;break}return $.abrupt("break",26);case 15:C=z[B++];$.next=22;break;case 18:B=z.next();if(!B.done){$.next=21;break}return $.abrupt("break",26);case 21:C=B.value;case 22:D=C,a.removeStream(D);case 24:$.next=12;break;case 26:c.forEach(function(b){y=y.concat(b.getTracks()),a.addStream(b,h)});y.forEach(function(a){x[a.id]=a.enabled});(v=q)==null?void 0:v.setShouldDeferServerRequests(!0);$.next=31;return b("regeneratorRuntime").awrap(a.createOffer(babelHelpers["extends"]({preserveH264:b("ScotchRTCUtils").isWatchPartyCall(d)||b("gkx")("1406693")},g),{DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),FORMAT_PARAMETERS:i,OFFER_SDP_TRANSFORM:t},j));case 31:E=$.sent;if(b("ScotchFBRTCSdpUtils").validateOfferSdp(d,E.toSdp())){$.next=34;break}throw b("FBRTCRtcResponseStatusCode").BAD_REQUEST;case 34:F=b("ScotchFBRTCMWProtocolStore").getState().clientMediaUpdateInfo.lastSyncedClientVersion+1;E.sessionDescription.setVersion(F);b("ScotchRTCGroupCallActions").setLocalClientVersion(F);$.next=39;return b("regeneratorRuntime").awrap(a.setLocalDescription(E));case 39:b("ScotchRTCGroupCallActions").onJoinRequestSent();(b("ScotchRTCUtils").isGroupCall(d)||b("ScotchRTCUtils").isMessengerCall(d))&&r.maybeLimitBitrate(a);$.next=43;return b("regeneratorRuntime").awrap(r.updateLocalEncodingActive(a,b("ScotchFBRTCGroupCallStore").getState().forceEncodingEnabled));case 43:G={};H=!1;I=b("ScotchRTCCallStore").getState().callInfo.callID;u!=null&&b("cr:1420073")!=null&&u.forEach(function(c,a){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"[SS] JOIN request with ss payload for topic: "+a+" is being sent",conferenceName:d}),a.localeCompare("simple_external")==0&&(H=!0),G[a]=b("cr:1420073").setUpdatedInputState(a,c),b("ScotchRTCGroupCallActions").setStateSyncSubscribe(a)});if(!(b("gkx")("1425364")&&q!=null)){$.next=50;break}$.next=50;return b("regeneratorRuntime").awrap(q.waitForSignalingConnected());case 50:b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(H&&b("FBRTCLogger").getInstance().logCallAction(null,d,"STATE_SYNC_SUBSCRIBE_ON_JOIN","sending subscription to topic simple_external on JOIN request",null));$.next=53;return b("regeneratorRuntime").awrap(b("ScotchMultiwayRequests").sendJoinRequest(o,d,e,E,f.length>0?f:null,y.length>0?x:null,{callID:I,callTrigger:s,numParticipants:b("ScotchRTCCallStore").getState().remoteUsers.size},{userToEscalate:n&&f.length>0?f[0]:null,isEscalator:b("ScotchRTCGroupCallEscalationStore").getState().toRing,escP2PCallID:p},G.size<=0?null:G));case 53:J=$.sent;K=Date.now();b("ScotchRTCGroupCallActions").onReceivedJoinResponse();b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"ScotchRTCMWProtocolHandler_initPeerConnection: JOIN response: "+JSON.stringify(J),conferenceName:d});L=J.header,M=L.responseStatusCode,N=L.responseSubCode;if(!(M!==b("FBRTCRtcResponseStatusCode").OK)){$.next=61;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"MW response status code "+M+" subcode "+N,conferenceName:d});return $.abrupt("return",new(b("Promise"))(function(a,b){b({responseStatusCode:M,responseSubCode:N})}));case 61:b("ScotchRTCGroupCallActions").onJoinResponse(J.header.serverInfoData);b("ScotchRTCProxyUserUtils").setProxyingAsUsersFromMessage(J.body.joinResponse);O=Date.now();if(!(J.body.joinResponse.isPendingApproval&&b("ZenonPlatformExperiments").shouldUseLobbyMode())){$.next=71;break}b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"[WR] Received isPendingApproval in JOIN response with lobby mode enabled, not connecting fully",conferenceName:d});b("ScotchRTCGroupCallActions").onPendingApproval();b("ScotchRTCGroupCallActions").onProcessedJoinResponse(I);b("FBRTCLogger").getInstance().logMultiwayResponseProcessedFromResponsePayload(J,I);(P=q)==null?void 0:P.setShouldDeferServerRequests(!1);return $.abrupt("return",null);case 71:Q=new(b("ScotchRTCSessionDescription"))(l.MULTIWAY,{type:"answer",sdp:J.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:i});b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"ScotchRTCMWProtocolHandler_initPeerConnection shouldSetDescriptions on answer : "+String(m),conferenceName:d});if(!m){$.next=76;break}$.next=76;return b("regeneratorRuntime").awrap(a.setRemoteDescription(Q));case 76:R=Date.now();if(J.body.joinResponse.stateStore!=null&&Object.keys(J.body.joinResponse.stateStore).length>0&&b("cr:1420073")!=null){S=Object.keys(J.body.joinResponse.stateStore);for(T=0;T<S.length;T++)U=S[T],b("ScotchRTWebUserActionLogger").logCheckpoint({callID:I,checkpoint:"[SS] JOIN response with ss payload for topic: "+U+" was received",conferenceName:d}),V=J.body.joinResponse.stateStore[U],b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(U.localeCompare("simple_external")==0&&b("FBRTCLogger").getInstance().logCallAction(null,d,"STATE_SYNC_OUTPUT_JOIN_RESPONSE","received output state: "+((W=V.data)!=null?W:"")+" on join response for topic simple_external",null)),b("cr:1420073").setOutputState(U,V)}X=Date.now();Y=J.body.joinResponse.mediaStatus;a.getSdpSemantics()===k.UNIFIED_PLAN&&(Z={},Object.keys(Y).forEach(function(b){var c=a.getWebrtcTrackIdFromMWTrackId(b);Z[c]=Y[b]}),Y=Z);aa=Date.now();b("ScotchRTCGroupCallActions").toggleRemoteStream(Y,I);b("ScotchRTCGroupCallActions").onProcessedJoinResponse(I);b("FBRTCLogger").getInstance().logMultiwayResponseProcessedFromResponsePayload(J,I,JSON.stringify({initial_logging_duration:O-K,set_remote_description_duration:R-O,state_sync_duration:X-R,unified_plan_duration:aa-X,is_meetup:b("gkx")("1369511")}));(w=q)==null?void 0:w.setShouldDeferServerRequests(!1);return $.abrupt("return",Q);case 87:case"end":return $.stop()}},null,this)}e.exports=r}),null);
__d("ScotchFBRTCRetriableMessage",["FBRTCConstants","clearTimeout","mixInEventEmitter","setTimeout"],(function(a,b,c,d,e,f){var g=1e4,h=7e3;a=function(){"use strict";function a(a){this.$1=a,this.$2=g,this.$3=2,this.$6=null}var c=a.prototype;c.sendMessage=function(a,c,d,e){var f=e.sdp,g=e.hasVideo,i=e.attributes,j=e.multiwayInfo;e=e.callTrigger;this.$4=c;switch(a){case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:this.$5=this.$1.sendPCRestartOffer(c,d,f,g,i);break;case b("FBRTCConstants").PayloadType.OFFER:this.$5=this.$1.sendOffer(c,d,f,g,i,e);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$2=h;this.$5=this.$1.sendAnswer(c,d,f,g,i,j);break}this.$7()};c.isAckMsg=function(a){return this.$5&&this.$5.msg_id===a.ack_id};c.stopRetrying=function(){this.$6&&(b("clearTimeout")(this.$6),this.$4=null,this.$5=null,this.$6=null)};c.$7=function(){this.$6=b("setTimeout")(this.$8.bind(this),this.$2)};c.$8=function(){this.$3<1?this.emit("timeoutFailure"):(this.emit("sendingRetry"),this.$1.resendSdpMessage(this.$4,this.$5),this.$7(),this.$3-=1)};return a}();b("mixInEventEmitter")(a,{sendingRetry:!0,timeoutFailure:!0});e.exports=a}),null);
__d("ScotchFBRTCUrlManager",["invariant","regeneratorRuntime","Promise","CurrentUser","FBRTCConfig","FBRTCLogger","ScotchFBRTCUtils","URI","XGroupCallController","XGroupCallSigningController","XVideoCallController"],(function(a,b,c,d,e,f,g){var h;function i(a){b("FBRTCLogger").getInstance().logCallAction(a,void 0,b("FBRTCLogger").CallAction.OLD_URI);return b("XVideoCallController").getURIBuilder().setFBID("peer_id",a).getURI()}function j(a){if(b("CurrentUser").isEmployee()){var c=a.setSubdomain(b("CurrentUser").hasWorkUser()||b("CurrentUser").isWorkUser()?"fb":"www"),d="/intern/";return(h||(h=b("URI"))).getRequestURI().getPath().substr(0,d.length)!==d?c:c.setDomain(c.getDomain().toString().replace(/\.(intern|internmc|cstools)\./,"."))}return a}function k(a){var c,d,e,f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:c=a.callContext,d=a.callID,e=a.usersToRing,f=a.hasVideo,g=a.initializeVideo,h=a.multiwayCoreTier,i=a.multiwayWwwTier,j=a.nonce,k=a.serverInfoData;l=b("XGroupCallSigningController").getURIBuilder().setString("call_context",c).setInt("call_id",d).setFBIDSet("users_to_ring",e).setBool("has_video",f).setBool("initialize_video",g).setString("server_info_data",k).setString("nonce",j).setString("multiway_www_tier",i).setString("multiway_core_tier",h).getURI();return m.abrupt("return",new(b("Promise"))(function(a,c){b("ScotchFBRTCUtils").sendServerRequest(l,function(b){a(b.payload.uri)},function(a){c(a)})}));case 3:case"end":return m.stop()}},null,this)}var l=function(a){if(b("FBRTCConfig").disableURLManager())return;window.history.replaceState({},"",a)};function m(a){var c=b("XVideoCallController").getURIBuilder().setFBID("peer_id","0").getURI().getPath();return a.getPath()===c}function n(a,b){a&&(b&&g(0,11934))}a={onCallStarted:function(a){m(new(h||(h=b("URI")))(window.location))&&l(i(a))},getGroupCallUri:function(a,c,d,e,f,g,h,i,j){var l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:n(!e,f),l=0;case 2:if(!(l<3)){m.next=15;break}m.prev=3;m.next=6;return b("regeneratorRuntime").awrap(k({callContext:a,callID:c,usersToRing:d,hasVideo:e,initializeVideo:f,multiwayCoreTier:g,multiwayWwwTier:h,nonce:i,serverInfoData:j}));case 6:return m.abrupt("return",m.sent);case 9:m.prev=9,m.t0=m["catch"](3),b("FBRTCLogger").getInstance().logToConsole(m.t0);case 12:l++;m.next=2;break;case 15:return m.abrupt("return",b("XGroupCallController").getURIBuilder().setString("call_context",a).setInt("call_id",c).setFBIDSet("users_to_ring",d).setBool("has_video",e).setBool("initialize_video",f).setString("server_info_data",j).setString("nonce",i).setString("multiway_www_tier",h).setString("multiway_core_tier",g).getURI());case 16:case"end":return m.stop()}},null,this,[[3,9]])},getP2PCallUriWithNonce:function(a,c,d,e,f,g,h){h===void 0&&(h="");n(e,g);c=b("XVideoCallController").getURIBuilder().setFBID("peer_id",a).setInt("call_id",c).setBool("is_caller",d).setBool("audio_only",e).setString("nonce",f).setBool("initialize_video",g).getURI();return b("ScotchFBRTCUtils").isPeerVCEndpoint(a)||b("ScotchFBRTCUtils").isCollabTrigger(h)?j(c):c}};e.exports=a}),null);
__d("ScotchFBRTCUserSettings",["Promise","ScotchRTCMediaDevices","emptyFunction","mixInEventEmitter"],(function(a,b,c,d,e,f){"use strict";a={audioInput:"",audioOutput:"default",videoInput:"",remoteStream:null,_audioInputLabel:null,_videoInputLabel:null,isEnabled:function(){return Boolean(b("ScotchRTCMediaDevices").isSupported("enumerateDevices"))},selectAudioInputByLabel:function(a){this.audioInput||(this.audioInput=this._selectByLabel(a,this._audioInputLabel));return this.audioInput},selectVideoInputByLabel:function(a){this.videoInput||(this.videoInput=this._selectByLabel(a,this._videoInputLabel));return this.videoInput},_selectByLabel:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(b&&b===d.label)return d.deviceId}return null},previewStart:function(){this.emit("previewStarted")},previewEnd:function(){this.emit("previewEnded")},save:function(a){var c=this,d=a.audioInput,e=a.audioOutput,f=a.videoInput;return new(b("Promise"))(function(a){var b=!!(d&&c.audioInput!==d||f&&c.videoInput!==f);c.audioInput=d;c.audioOutput=e;c.videoInput=f;c.emit("saved",b);a(b)})},updateForLocalStream:function(a){if(a.videoMediaSourceId)this.videoInput=a.videoMediaSourceId;else{var b=a.getVideoTracks();b=b[0];b&&(this._videoInputLabel=b.label)}if(a.audioMediaSourceId)this.audioInput=a.audioMediaSourceId;else{b=a.getAudioTracks();a=b[0];a&&(this._audioInputLabel=a.label)}},updateForRemoteStream:function(a){this.remoteStream=a,this.emit("remoteStreamChanged")},addListener:function(){},emit:b("emptyFunction")};b("mixInEventEmitter")(a,{previewStarted:!0,previewEnded:!0,remoteStreamChanged:!0,saved:!0});e.exports=a}),null);
__d("ScotchRTCCallNUXActions",["FBRTCLogger","ScotchFBRTCUtils","ScotchRTCAppDispatcher","XRTCCallNUXController","dangerouslyBypassDispatchError"],(function(a,b,c,d,e,f){"use strict";a={refreshNUXState:function(){b("ScotchFBRTCUtils").sendServerRequest(b("XRTCCallNUXController").getURIBuilder().getURI(),function(a){a=a.payload;b("ScotchRTCAppDispatcher").dispatch({type:"INIT_NUX_STATE",payload:a})},function(){})},markNUXViewed:function(a){try{b("ScotchRTCAppDispatcher").dispatch({type:"MARK_NUX_VIEWED",nuxID:a})}catch(c){b("dangerouslyBypassDispatchError")(function(){return b("ScotchRTCAppDispatcher").dispatch({type:"MARK_NUX_VIEWED",nuxID:a})})}},dismissNUX:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"DISMISS_NUX",nuxID:a})}};e.exports=a}),null);
__d("ScotchRTCOneVCActions",["ScotchRTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";a={storeParticipants:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"STORE_PARTICIPANTS",participants:a})},setMeetingID:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MEETING_ID",meetingID:a})},setMeetingPassword:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"SET_MEETING_PASSWORD",meetingPassword:a})}};e.exports=a}),null);
__d("ScotchRTCPeerConnectionQueue",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[],this.$2=[]}var b=a.prototype;b.push=function(a,b){switch(a){case"add":this.$1.push(b);break;case"remove":this.$2.push(b);break}};b.drain=function(){this.$3(this.$2),this.clear("remove"),this.$3(this.$1),this.clear("add")};b.$3=function(a){if(a.length<1)return;for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;try{d()}catch(a){}}};b.clear=function(a){switch(a){case"add":this.$1=[];break;case"remove":this.$2=[];break;default:this.$1=[],this.$2=[]}};return a}();e.exports=a}),null);
__d("XRtcFetchProvisionalRingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/provisionalring/",{user_id:{type:"Int",required:!0}})}),null);
__d("ZenonBrowsers",["UserAgent","UserAgentData"],(function(a,b,c,d,e,f){"use strict";var g={isChrome:function(){return b("UserAgent").isBrowser("Chrome")},isChromium:function(){return!!navigator.webkitGetUserMedia},isChromiumBasedEdge:function(){return b("UserAgent").isBrowser("Edge (Chromium Based)")},isDesktopSafari:function(){return b("UserAgent").isBrowser("Safari")},isFirefox:function(){return b("UserAgent").isBrowser("Firefox")},isMobileSafari:function(){return b("UserAgent").isBrowser("Mobile Safari")},isSamsung:function(){return b("UserAgent").isBrowser("Samsung Browser")},webrtcVersion:function(){if(g.isFirefox()||g.isChrome()||g.isChromiumBasedEdge())return b("UserAgentData").browserVersion||0;if(g.isChromium()){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a!=null?parseInt(a[2],10):999}return 0}};e.exports=g}),null);
__d("ZenonRTCPeerConnectionConfig",["FBRTCConfig","ZenonBrowsers"],(function(a,b,c,d,e,f){"use strict";var g="stun:stun.fbsbx.com:3478";function h(a,c,d){if((b("ZenonBrowsers").isChrome()||b("ZenonBrowsers").isChromiumBasedEdge())&&b("ZenonBrowsers").webrtcVersion()>=34){var e={urls:a};c!==void 0&&d!==void 0&&(e.username=c,e.credential=d);return[e]}e=[];for(var f=0;f<a.length;f++)c!==void 0&&d!==void 0?e.push({credential:d,url:a[f],username:c}):e.push({url:a[f]});return e}a=function(){function a(){this.sslPort="",this.tcpPort="",this.turnIP="",this.turnPassword="",this.turnUsername="",this.udpPort=""}var c=a.prototype;c.setTurnCredentials=function(a){this.turnIP=a.ip,this.udpPort=a.udp_port,this.tcpPort=a.tcp_port,this.sslPort=a.ssl_tcp_port,this.turnUsername=a.username,this.turnPassword=a.password};c.getConfig=function(){if(b("FBRTCConfig").isVCEndpointCall())return{iceServers:[]};var a=h([g]).concat(h(this.$1(),this.turnUsername,this.turnPassword));return{iceServers:a}};c.getConfigZenonPlatform=function(){if(b("FBRTCConfig").isVCEndpointCall())return{iceServers:[]};var a=h([g]).concat(h(this.$1(),this.turnUsername,this.turnPassword));a=a.map(function(a){return{credential:a.credential,credentialType:a.credentialType,urls:a.urls!=null?a.urls:"default_SHOULD_NOT_SEE_THIS",username:a.username}});return{iceServers:a}};c.getConstraints=function(a){a===void 0&&(a=!1);var c=!0;b("ZenonBrowsers").isChromium()&&b("ZenonBrowsers").webrtcVersion()<57&&a&&(c=!1);return{mandatory:{},optional:[{DtlsSrtpKeyAgreement:c}]}};c.$2=function(a){var b=this.turnIP,c,d=a;switch(a){case"tcp":c=this.tcpPort;break;case"udp":c=this.udpPort;break;case"ssl":c=this.sslPort;d="tcp";break;default:c=this.udpPort;d=null;break}return!((b==null?void 0:b.length)&&((a=c)==null?void 0:a.length))?null:d!=null&&d.length>0?"turn:"+b+":"+c+"?transport="+d:"turn:"+b+":"+c};c.$1=function(){if(b("ZenonBrowsers").isFirefox()&&b("ZenonBrowsers").webrtcVersion()<27)return[this.$2()].filter(Boolean);else return[this.$2("udp"),this.$2("tcp"),this.$2("ssl")].filter(Boolean)};return a}();e.exports=new a()}),null);
__d("ZenonRTCPeerConnectionHelper",["RTCPeerConnection"],(function(a,b,c,d,e,f){"use strict";a={closePeerConnection:function(a){a.signalingState!=="closed"&&a.close()},createPeerConnection:function(a,c,d){c===void 0&&(c={});d===void 0&&(d={});return new(b("RTCPeerConnection"))(babelHelpers["extends"]({sdpSemantics:"plan-b"},c),babelHelpers["extends"]({optional:[{DtlsSrtpKeyAgreement:a.getZenonPeerConnectionConfig().isDtlsSrtpKeyAgreement()},{RtpDataChannels:a.getZenonPeerConnectionConfig().isRtpDataChannels()}]},d))},isRTCPeerConnectionInstance:function(a){return a instanceof b("RTCPeerConnection")}};e.exports=a}),null);
__d("ZenonUtils",["AsyncRequest","AsyncResponse","emptyFunction"],(function(a,b,c,d,e,f){"use strict";var g=6e3;a={sendServerRequest:function(a,c,d,e,f,h){c===void 0&&(c=b("emptyFunction"));d===void 0&&(d=b("emptyFunction"));e===void 0&&(e=!1);f===void 0&&(f=g);h===void 0&&(h={});a=new(b("AsyncRequest"))().setURI(a).setData(h).setAllowCrossPageTransition(!0).setHandler(c).setErrorHandler(d).setTimeoutHandler(f,function(a){d(new(b("AsyncResponse"))(a,{}))});e&&a.setOption("asynchronous_DEPRECATED",!1);a.send()}};e.exports=a}),null);
__d("ZenonTurnDiscovery",["Promise","FBRTCLogger","XVideoCallTurnDiscoveryController","ZenonUtils"],(function(a,b,c,d,e,f){"use strict";var g=3,h=null;a={requestTurnCreds:function(a,c,d){d===void 0&&(d=g);if(h)return h;var e=1,f=b("XVideoCallTurnDiscoveryController").getURIBuilder().setInt("version",e).setString("call_id",a).getURI();h=new(b("Promise"))(function(e,g){h(d);function h(d){b("ZenonUtils").sendServerRequest(f,function(a){a=a.payload;return e(a)},function(){d>0?(b("FBRTCLogger").getInstance().logError(c,a,"Failed turn; going to retry"),h(d-1)):g(new Error("failed"))})}});return h}};e.exports=a}),null);
__d("ScotchRTCP2PProtocolHandler",["Promise","regeneratorRuntime","AsyncTypedRequest","Bootloader","CurrentUser","DateConsts","FBLogger","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","FBRTCExperiment","FBRTCLocalMessageQueue","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCMessageListener","FBRTCSupport","RTCConfig","ScotchFBRTCIceCache","ScotchFBRTCMessage","ScotchFBRTCMessageDedup","ScotchFBRTCMessageSender","ScotchFBRTCPeerConnection","ScotchFBRTCPeerConnectionHelper","ScotchFBRTCRetriableMessage","ScotchFBRTCSdpUtils","ScotchFBRTCStatsHelpers","ScotchFBRTCUrlManager","ScotchFBRTCUserSettings","ScotchRTCCallActions","ScotchRTCCallNUXActions","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCEndCallReason","ScotchRTCGroupCallEscalationStore","ScotchRTCGroupCallEscalator","ScotchRTCOneVCActions","ScotchRTCP2PCallActions","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTCP2PCallWindowHandler","ScotchRTCPeerConnectionQueue","ScotchRTCSessionDescription","ScotchRTCSignalingExperiments","ScotchRTCStreamDurationTracker","ScotchRTCUtils","ScotchRTWebBrowserFeatureSupport","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","XRtcFetchProvisionalRingController","ZenonImmutableMediaTrack","ZenonLocalMediaSDK","ZenonRTCPeerConnectionConfig","ZenonRTCPeerConnectionHelper","ZenonTSLogDataHelper","ZenonTurnDiscovery","clearTimeout","debounce","gkx","promiseDone","setTimeout"],(function(a,b,c,d,e,f){"use strict";a=b("DateConsts").MS_PER_MIN;c=b("DateConsts").MS_PER_SEC;var g=b("ScotchRTWebBrowserFeatureSupport").isReplaceTrackSupported,h=(d=b("FBRTCConstants")).CallEndReason,i=d.CallType,j=d.RTCConstraints,k=d.SignalingProtocol,l=d.VideoQuality,m=d.ClientReportedEventType,n=1*a,o=15*c,p=30*c,q=10*c;f=function(){function a(){var c=this;this.$5={streams:{}};this.$6=b("FBRTCLogger").getInstance();this.$7=!1;this.$8=!0;this.$9=!1;this.$10="passive";this.$11=new(b("ScotchFBRTCMessageSender"))();this.$16=new(b("ScotchFBRTCIceCache"))();this.$17=!1;this.$18=[];this.$19=!1;this.$22=null;this.$23=null;this.$24=null;this.$26=new(b("ScotchRTCStreamDurationTracker"))("video");this.$27=new(b("ScotchRTCStreamDurationTracker"))("video");this.$28=new(b("ScotchRTCStreamDurationTracker"))("screen");this.$29=!1;this.$30=new(b("ScotchRTCPeerConnectionQueue"))();this.$33=!1;this.$50=function(a){a=a.candidate;a&&c.$64(a)};this.$51=function(a){a=a.target;a=a.iceConnectionState;c.$35("RTCP2PProtocolHandler_PC_iceconnectionstatechange: "+a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d&&(d.setPCIsConnected(a==="completed"||a==="connected"),d.save(b("FBRTCCallSummaryStore").getInstance()));(c.$23==="disconnected"||c.$23==="failed")&&a==="connected"&&c.$34("connection recovery",c.$23);c.$34("ICE connection state change",a);b("clearTimeout")(c.$22);switch(a){case"checking":c.$9=!0;break;case"connected":case"completed":c.$65();c.$66();c.$67();break;case"failed":c.$22=b("setTimeout")(function(){if(b("RTCConfig").CollaborationBrowserConfig.ICE_recovery&&b("FBRTCConfig").isVCEndpointCall()){c.$68("ICE failure");return}c.$63(new Error("ICE failed"));b("ScotchRTCP2PCallActions").setConnectionStatus("DISCONNECTED")},b("RTCConfig").CollaborationBrowserConfig.ICE_failed_timeout);break;case"disconnected":c.$22=b("setTimeout")(function(){c.$38(h.CONNECTION_DROPPED,!1,!0,!1)},b("RTCConfig").CollaborationBrowserConfig.ICE_disconnected_timeout);break;case"closed":break}};this.$71=function(){var a=c.$4.getCreatedIceCandidates();for(var b=0;b<a.length;b++)c.$64(a[b])};this.$52=function(a){a=a.target;a=a.iceGatheringState;c.$35("RTCP2PProtocolHandler_PC_icegatheringstatechange: "+a);c.$34("ICE gathering state change",a)};this.$53=function(a){var b=a.errorCode,d=a.errorText,e=a.hostCandidate;a=a.url;c.$72("ScotchRTCP2PProtocolHandler: PC icecandidateerror "+b+": "+d+". candidate: "+e);c.$34("ICE candidate error",{errorCode:b,errorText:d,hostCandidate:e,url:a})};this.$73=function(){var a;c.$25?a=h.UNSUPPORTED_VERSION:a=h.OTHER_NOT_CAPABLE;c.$38(a,!1,!0,!1,"TimedOut")};this.$56=b("debounce")(function(d){var e=d.target,f=e.iceConnectionState,g=e.signalingState;if(!b("ZenonRTCPeerConnectionHelper").isRTCPeerConnectionInstance(e))f=c.$4.getIceConnectionState(),g=c.$4.getSignalingState();else if(f!==c.$4.getIceConnectionState()||g!==c.$4.getSignalingState()){e="onNegotiationNeeded. iceConnectionState="+f+", pc="+c.$4.getIceConnectionState()+", signalingState="+g+", pc="+c.$4.getSignalingState();c.$6.logInfo(c.$2,c.$3,e)}c.$34("offer renegotiation",{iceConnectionState:f,isNegotiationExpected:c.$8});if(f==="closed")return;else if(!c.$8){c.$34("offer renegotiation","ignore");return}else if(!b("ScotchRTCP2PCallEscalator").isNegotiationAllowed()){c.$34("offer renegotiation","not allowed - escalating");return}else if(c.$7){c.$34("offer renegotiation","retry");b("setTimeout")(function(){return c.$56(d)},100);return}c.$8=!1;var h=[];if(g==="stable"){if(c.$9){e=b("ScotchRTCP2PCallStore").getState();f=e.signalingExperiments;if(!f.support("sdp_update"))c.internalResetConnection(),h.push("new offer");else{g=a.supportMultipleStreams();h.push("SDP update",g?"plan B":null)}c.$10="passive"}c.$34("offer renegotiation","create offer");c.$69().then(function(a){if(a.strongDiff(c.$4.getLocalDescription())){c.$34("offer renegotiation",h);return a}return null}).then(function(a){a&&(c.$9&&b("ScotchRTCP2PCallActions").setConnectionStatus("RECONNECTING"),c.$70(a)),c.$10="active"})["catch"](function(a){c.$63(new Error("Failed to create offer onNegotiationNeeded: "+a.message))})}},50);this.$57=function(d){if(c.$29){c.$30.push("add",function(){return c.$57(d)});return}var e=d.stream,f=c.$74(e),g=c.$2;f===b("FBRTCConstants").StreamType.SCREEN_CONTENT?(b("ScotchRTCCallActions").addRemoteScreenStream(e,g),!a.supportMultipleStreams()&&e.getAudioTracks().length>0&&c.$27.track(e)):(b("ScotchFBRTCUserSettings").updateForRemoteStream(e),b("ScotchRTCCallActions").addRemoteStream(e,g),c.$27.track(e),b("ScotchRTCP2PCallStore").addListener(b("debounce")(function(){b("ScotchRTCP2PCallStore").getState().callType!==b("ScotchRTCCallType").AUDIO_ONLY&&c.$65()},50)));c.$19=!0;while(c.$18.length>0)c.$75(c.$18.shift());c.$34("remote stream: added",e)};this.$58=function(a){a=b("ScotchRTCCallStore").getState().remoteUsers.first();a&&!a.isVideoDisabled()&&(b("ScotchRTCCallActions").toggleMuteRemoteVideo(!1,a.FBID),c.$34("on media track event",{action:"toggleMuteRemoteVideo",muted:!1,remoteUserID:a.FBID}))};this.$59=function(a){if(c.$29){c.$30.push("remove",function(){return c.$59(a)});return}var d=a.stream,e=c.$74(d),f=c.$2;if(e===b("FBRTCConstants").StreamType.SCREEN_CONTENT){b("ScotchRTCCallActions").removeRemoteScreenStream(d,f);e=b("ScotchRTCCallStore").getState().remoteUsers.first();if(e){e=e.streams.first();e&&c.$27.track(e)}}else b("ScotchRTCCallActions").removeRemoteStream(d,f);c.$34("remote stream: removed",d)};this.$36=function(a){c.$35("RTCP2PProtocolHandler_Received_TURN_Creds");c.$34("TURN credentials received",a);b("ZenonRTCPeerConnectionConfig").setTurnCredentials(a);var d=b("ScotchRTCCallStore").getState();d=d.callSummary;d.isNull()||s(function(b){return b.setRelayIP(a.ip)})};this.$37=function(){c.$6.logError(c.$2,c.$3,"Failed to get turn creds"),c.$38(h.CLIENT_ERROR,!1,!b("ScotchRTCP2PCallStore").isCaller(),!1,"NoTurnCreds")};this.$44=function(a,b){c.$38(a,!1,!1,!1,b.toString())};this.$43=function(a,b){var d=b.call_id;if(c.$83()){c.$6.logError(c.$2,c.$3,"Message sent after call ended: "+b.type);return}if(c.$2!==a||c.$3!==d)return;s(function(a){return a.onMessageSent(b)});c.$34("message sent",b)};this.$34("call controller init");this.$35("RTCP2PProtocolHandler_constructed")}var c=a.prototype;c.init=function(a,c){this.$1=b("CurrentUser").getID();this.$2=a;this.$3=c;this.$35("RTCP2PProtocolHandler_init_call");if(!b("ScotchRTWebExperiments").passOfferWithWindowMessages()){a=b("FBRTCLocalMessageQueue").getPeerOfferFromStorage(this.$2);this.$34("local message queue updates",{action:"getOffer",cachedOffer:a,callID:this.$3});if(a){this.$34("call: try","not ready");c=new(b("ScotchFBRTCMessage"))(a);b("ScotchRTCP2PCallActions").processMessage(c)}}return this};c.setPreserveLocalStream=function(a){this.$32=a;return this};c.fetchTURNCredentials=function(){if(b("FBRTCConfig").isVCEndpointCall()){this.$35("RTCP2PProtocolHandler_skip_TURN_discovery");return b("Promise").resolve()}this.$34("call: try","not ready");return b("ZenonTurnDiscovery").requestTurnCreds(this.$3.toString(),this.$2).then(this.$36,this.$37)};c.endCall=function(a,c,d){a===void 0&&(a=h.HANGUP_CALL),c===void 0&&(c=""),d===void 0&&(d=!1),b("ScotchRTCCallActions").hangup(a,c),this.$38(a,!1,!0,d,c)};c.startCall=function(a,c){var d=this,e=b("ScotchRTCP2PCallStore").isCaller();this.$34("call: start process",{callTrigger:a,userCallType:this.$39(),isCaller:b("ScotchRTCP2PCallStore").isCaller()});this.$4=this.$40();this.$41();this.$30=new(b("ScotchRTCPeerConnectionQueue"))();this.$34("local message queue updates",{action:"getOffer",offer:c});var f=null;c?(this.$20=new(b("ScotchFBRTCMessage"))(c),b("ScotchFBRTCMessageDedup").check(this.$2,this.$20.callID,this.$20.msgID),f=!1):(f=!0,b("ScotchRTCP2PCallActions").setIsCaller(f));e&&!f&&this.handleCallCollision(this.$20,!1);f!==e&&(this.$34("caller mismatch",{initialValue:e,actualValue:f}),e?this.$35("RTCP2ProtocolHandler_offer_mismatch_caller_found_unexpected_cached_offer"):this.$35("RTCP2PProtocolHandler_offer_mismatch_callee_did_not_find_cached_offer"));this.$8=f;this.$20 instanceof b("ScotchFBRTCMessage")&&b("ScotchRTCP2PCallActions").processMessage(this.$20);this.$42(a,f);this.$11=new(b("ScotchFBRTCMessageSender"))();this.$11.onMessageSent=this.$43;this.$11.onSendFailure=this.$44;this.$31=new(b("ScotchRTCP2PCallEscalator"))(this.$2,this.$3,this.$11);b("FBRTCConfig").isVCEndpointCall()&&b("FBRTCMessageListener").setOneVCMessegeHandler(function(a){d.$45(a)});this.$46();b("ScotchRTCP2PCallActions").setConnectionStatus("CONTACTING");b("ScotchRTCCallActions").call([this.$2],this.$4);if(b("ScotchRTWebExperiments").shouldUseZenonSignaling()){c=b("ScotchRTCP2PCallStore").getState().signalingChild;c!=null&&c.addListener("messageReceived",function(a){d.$47(a)})}else b("FBRTCMessageListener").setMessageHandler(function(a){d.$47(a)});f&&(this.$24=b("setTimeout")(function(){d.__fetchProvisionalRing()},q))};c.__fetchProvisionalRing=function(){var a=this,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:c=b("XRtcFetchProvisionalRingController").getURIBuilder().setInt("user_id",this.$2).getURI();d.next=3;return b("regeneratorRuntime").awrap(new(b("AsyncTypedRequest"))(c).setPayloadHandler(function(b){a.__onFetchProvisionalRingResponse(b)}).send());case 3:case"end":return d.stop()}},null,this)};c.__onFetchProvisionalRingResponse=function(a){a&&b("ScotchRTCP2PCallStore").getState().connectionStatus==="CONTACTING"&&b("ScotchRTCP2PCallActions").setConnectionStatus("PROVISIONAL_RINGING")};c.$42=function(a,c){c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$2,this.$3,c,this.$20,a);c.onPopupOpened();c.setCallType(b("ScotchRTCP2PCallStore").getState().callType===b("ScotchRTCCallType").AUDIO_ONLY?i.VOIP:i.DIRECT_VIDEO);c.setActiveConnection("p2p");this.$48(c);b("ScotchRTCCallActions").setCallSummary(c)};c.$48=function(a){b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(c){a.addExtraInfo(b("FBRTCLogger").Key.BATTERY_START,c.level)})};c.startScreenStream=function(c){if(!a.supportMultipleStreams()){var d=b("ScotchRTCCallStore").getState();d=d.localUser;d=d.streams.first();b("ScotchRTCUtils").transferAudioTracks(c,d)}b("ScotchRTCCallActions").addLocalScreenStream(c);this.$35("screen_sharing_started")};c.stopScreenStream=function(c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(!d.screenStreams.includes(c))return;if(!a.supportMultipleStreams()){d=d.streams.first();b("ScotchRTCUtils").transferAudioTracks(d,c)}b("ScotchRTCCallActions").removeLocalScreenStream(c);b("ScotchRTCUtils").stopMediaStream(c);this.$35("screen_sharing_stopped")};c.updateScreenStream=function(a,c){b("ScotchRTCUtils").transferAudioTracks(c,a),b("ScotchRTCCallActions").replaceLocalScreenStream(a,c),b("ScotchRTCUtils").stopMediaStream(a)};c.$49=function(b){if(!a.supportMultipleStreams()&&b.hasScreenStream())return!0;else return!b.isVideoDisabled()};c.$40=function(){var a=this,c=b("ScotchRTCP2PCallStore").getState();c=c.isPeerOnMobile;c=new(b("ScotchFBRTCPeerConnection"))(k.P2P,b("ZenonRTCPeerConnectionConfig").getConfig(),b("ZenonRTCPeerConnectionConfig").getConstraints(c));var d,e=null,f,g;b("ScotchRTCCallStore").addListener(b("debounce")(function(){var c=b("ScotchRTCCallStore").getState();c=c.localUser;if(!c||c===d)return;d=c;var h=a.$49(c);e!==h&&e!==null&&a.$11&&a.$11.sendMuteStateUpdate(a.$2,a.$3,h);e=h;h=c.streams;c=c.screenStreams;var i=c!==g,j=h!==f;j||i?(f=h,g=c,a.$41(i)):a.$26.update()},50));b("FBRTCConfig").isVCEndpointCall()&&c.createDataChannel("noop");c.addEventListener("icecandidate",this.$50);c.addEventListener("iceconnectionstatechange",this.$51);c.addEventListener("icegatheringstatechange",this.$52);c.addEventListener("icecandidateerror",this.$53);c.addEventListener("connectionstatechange",this.$54);c.addEventListener("signalingstatechange",this.$55);c.addEventListener("negotiationneeded",this.$56);c.addEventListener("addstream",this.$57);c.addEventListener("track",this.$58);c.addEventListener("removestream",this.$59);c.addEventListener("datachannel",this.$60);this.$61(c);return c};a.supportMultipleStreams=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.signalingExperiments;return a.support("multiple_streams_plan_b")||a.support("multiple_streams_unified")};c.$62=function(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.getStream();d=a.getScreenStream();e=!1;if(!c){f.next=8;break}d!=null?(this.$28.track(d),this.$26.track(d)):(this.$28.update(),this.$26.track(c));f.next=7;return b("regeneratorRuntime").awrap(b("ScotchFBRTCPeerConnectionHelper").resetLocalStreamsByTrack(this.$4,c,d));case 7:e=f.sent;case 8:this.$8=this.$8||e;case 9:case"end":return f.stop()}},null,this)};c.$41=function(c){c===void 0&&(c=!1);if(this.$4.getSignalingState()==="closed")return;var d=b("ScotchRTCCallStore").getState();d=d.localUser;if(!d)return;if(b("ScotchRTWebExperiments").shouldUseSingleMediaStream()&&g()){b("promiseDone")(this.$62(d));return}var e=d.getStream();d=d.getScreenStream();var f=[];a.supportMultipleStreams()?(d?(f.push(d),this.$28.track(d)):this.$28.update(),e?(f.push(e),this.$26.track(e)):this.$26.update()):d?(this.$28.track(d),this.$26.track(d),f.push(d)):(this.$28.update(),e&&(this.$26.track(e),f.push(e)));if(b("ScotchRTWebClientFeatureGating").restartVideoWithTrackAPI()&&f.length===1){d=b("ScotchFBRTCPeerConnectionHelper").resetLocalStreamWithTrackAPI(this.$4,f[0],c);this.$8=this.$8||d}else{e=b("ScotchFBRTCPeerConnectionHelper").resetLocalStreams(this.$4,f);this.$8=this.$8||e}};c.updateStreamForUnifiedPlan=function(c){b("ScotchFBRTCPeerConnection").shouldUseAddTrackForUnifiedPlan()||b("FBLogger")("rtc_www").mustfix("This function must be called within Firefox context"),this.$8=!0,this.$4.addStream(c),a.replaceLocalStream(c)};c.$63=function(a){this.$38(h.WEBRTC_ERROR,!1,!0,!1,a.message)};c.$68=function(a){var c=this;this.$7=!0;this.$8=!1;this.$10="passive";this.internalResetConnection();this.$35("RTCP2PProtocolHandler_connection_recovery_"+a);this.$34("connection recovery",a);this.$69().then(function(a){b("ScotchRTCP2PCallActions").setConnectionStatus("RECONNECTING"),c.$70(a),c.$10="active"})["catch"](function(b){c.$63(new Error("Failed recovering from "+a))})};c.$69=function(){var a=!b("ScotchRTCP2PCallStore").isAudioOnly()||b("ScotchRTCP2PCallEscalator").initVideoInAudioCall(),c={ADD_AUDIO_NACK:b("ScotchRTCSignalingExperiments").shouldEnableAudioNack(),DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),SSRC_CONTENT_TYPE:b("ScotchRTWebClientFeatureGating").addScreenContentTypeInSDP()?b("ScotchRTCCallStore").getState().localUser.getMediaTypeForTracks():void 0};return this.$4.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:a,preserveH264:b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264()},c)};c.$64=function(a){var b=a.sdpMid;if(b!=null){b=this.$4.rewriteLocalIceCandidate(b,a.sdpMLineIndex);var c=b[0];b=b[1];if(window.RTCIceCandidate){var d=a.candidate;a=new RTCIceCandidate(babelHelpers["extends"]({candidate:d,sdpMid:c},b!=null?{sdpMLineIndex:b}:null))}else a.sdpMid=c}a.candidate!==""&&this.$11.sendIceCandidate(this.$2,this.$3,a)};c.$54=function(a){};c.$55=function(a){};c.internalResetConnection=function(){var a=this;this.$8=!1;var c=this.$2,d=b("ScotchRTCCallStore").getState().remoteUsers.first(),e=d.streams,f=d.screenStreams;this.$29=!0;this.$30.clear("add");this.$30.push("remove",function(){for(var a=e,d=Array.isArray(a),g=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(d){if(g>=a.length)break;h=a[g++]}else{g=a.next();if(g.done)break;h=g.value}h=h;b("ScotchRTCCallActions").removeRemoteStream(h,c)}for(var h=f,g=Array.isArray(h),d=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(d>=h.length)break;a=h[d++]}else{d=h.next();if(d.done)break;a=d.value}a=a;b("ScotchRTCCallActions").removeRemoteScreenStream(a,c)}});this.$4.reset().then(function(){a.$29=!1,a.$30.drain()})["catch"](function(b){a.$63(new Error("Failed to reset peer connection: "+b.message))});b("FBRTCConfig").isVCEndpointCall()&&this.$4.createDataChannel("noop")};c.$74=function(a){var c=b("FBRTCConstants").StreamType;try{switch(this.$5.streams[a.id].type){case c.SCREEN_CONTENT:return c.SCREEN_CONTENT;case c.AUDIO_VIDEO:return c.AUDIO_VIDEO;case c.AUDIO_ONLY:return c.AUDIO_ONLY;default:throw Error("no known stream type found, detecting")}}catch(b){return a.getVideoTracks().length>0?c.AUDIO_VIDEO:c.AUDIO_ONLY}};c.$65=function(){this.$26.isStarted()?this.$26.update():this.$26.start();var a=b("ScotchRTCP2PCallStore").getState();a=a.callType;a!==b("ScotchRTCCallType").AUDIO_ONLY&&(this.$27.isStarted()?this.$27.update():this.$27.start());this.$28.isStarted()?this.$28.update():this.$28.start()};c.$66=function(){var a=b("ScotchRTCP2PCallStore").getState().connectionStatus;if(a==="ESCALATING_TO_BJN")return;b("ScotchRTCP2PCallActions").setConnectionStatus("CONNECTED");this.$33||(this.$33=!0,this.$11.sendClientReportedEvent(this.$2,this.$3,m.MEDIA_CONNECTED),this.$35("RTCP2PProtocolHandler_first_time_media_connected"));s(function(a){a.onCallConnected(),a.onNetworkReady()})};c.$60=function(a){};c.startLocalVideoTracker=function(a){this.$26.track(a)};c.updateLocalVideoTracker=function(){this.$26.update()};a.initStream=function(c,d,e){b("ScotchRTWebUserActionLogger").startTimer("RTCP2PProtocolHandler_initStream");return a.internalInitStream(c,d,e).then(function(a){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"RTCP2PProtocolHandler_initStream",checkpointName:"RTCP2PProtocolHandler_initStream_success"});return a})["catch"](function(a){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"RTCP2PProtocolHandler_initStream",checkpointName:"RTCP2PProtocolHandler_initStream_failed"});throw a})};a.internalInitStream=function(a,c,d){var e=!a&&b("ScotchRTCP2PCallEscalator").initVideoInAudioCall();return t(a,e,c,d)};a.replaceLocalStream=function(a,c){c===void 0&&(c=!1);var d=b("ScotchRTCCallStore").getState().localUser.streams.first();b("ScotchRTCCallActions").replaceLocalStream(d,a);c&&b("ScotchRTCUtils").stopMediaStream(d)};c.escalateToMultiway=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;if(d&&a){s(function(a){return a.setEscalationInitiated()});d=c!==b("ScotchRTCCallType").AUDIO_ONLY&&(b("ScotchRTCCallStore").hasRemoteVideo()||b("ScotchRTCCallStore").hasLocalVideo());c=new(b("ScotchRTCGroupCallEscalator"))(a,d,this.$2,this.$3);c.startEscalationToMultiway()}};c.handleSwitchToMultiway=function(){var a=b("ScotchRTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;this.$7=!1;if(d&&a){s(function(a){return a.setReceivedEscalationRequest()});d=c!==b("ScotchRTCCallType").AUDIO_ONLY&&(b("ScotchRTCCallStore").hasRemoteVideo()||b("ScotchRTCCallStore").hasLocalVideo());c=new(b("ScotchRTCGroupCallEscalator"))(a,d,this.$2,this.$3);c.startEscalationToMultiway()}};c.$76=function(a,c){var d=b("gkx")("678353"),e=a&&d&&b("FBRTCSupport").isGroupCallWebtrcSupported();this.$14=e;this.$15=c;b("ScotchRTCP2PCallActions").setMultiwayEscalationSupport(e,c);s(function(a){a.setConferenceName(c),e&&a.setEscalationAvailable()})};c.$77=function(a){return b("gkx")("1606501")&&!b("ScotchRTCSignalingExperiments").shouldP2PPreserveH264()?b("ScotchFBRTCSdpUtils").removeH264(a):a};c.$46=function(){b("ScotchFBRTCUrlManager").onCallStarted(this.$2);if(this.$20){this.$7=!0;this.$8=!1;var a=this.$20.msg,c=a.sdp,d=a.attributes,e=a.offer_escalation_support;a=a.escalation_conference_name;b("ScotchRTCP2PCallActions").setRemoteSignalingExperiments(this.$20.getSignalingExperiments());this.$76(!!e,a);this.onReceivedRemoteSDP(this.$77(c),"offer",d);b("ScotchRTWebExperiments").passOfferWithWindowMessages()||b("FBRTCLocalMessageQueue").clearPeerOfferFromStorage(this.$2);this.$34("local message queue updates",{action:"removeOffer",offer:this.$20,callID:this.$3});this.$20=null}this.$34("call: try",{initialOffer:this.$20})};c.$70=function(a){var c=this;this.$7=!0;return this.$4.setLocalDescription(a).then(function(a){a=a.toDesc();var d=a.sdp;a=a.type;d=c.$4.transformLocalSdp(d);switch(a){case"offer":b("ScotchRTCP2PCallStore").getState().signalingExperiments.support("sdp_update")&&b("ScotchRTCCallStore").getState().callInfo.conferenceState==="CONNECTED"?c.$78(d):c.$79(d);c.$17=!1;break;case"answer":c.$80(d);break;default:break}})["catch"](function(a){c.$63(new Error("Failed to set local description: unexpected SDP type"))})};c.$81=function(){var c={},d=b("ScotchRTCCallStore").getState();d=d.localUser.screenStreams;if(b("ScotchRTWebExperiments").shouldUseSingleMediaStream()&&a.supportMultipleStreams()===!1)for(var e=this.$4.getLocalStreams(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h.getVideoTracks().length?b("FBRTCConstants").StreamType.AUDIO_VIDEO:b("FBRTCConstants").StreamType.AUDIO_ONLY;c[h.id]={type:i}}else for(var h=this.$4.getLocalStreams(),i=Array.isArray(h),g=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(i){if(g>=h.length)break;f=h[g++]}else{g=h.next();if(g.done)break;f=g.value}e=f;f=d.includes(e)?b("FBRTCConstants").StreamType.SCREEN_CONTENT:e.getVideoTracks().length?b("FBRTCConstants").StreamType.AUDIO_VIDEO:b("FBRTCConstants").StreamType.AUDIO_ONLY;c[e.id]={type:f}}return{streams:c}};c.$78=function(a){var c=b("ScotchRTCCallStore").getState();c=c.localUser;this.$11.sendSdpUpdate(this.$2,this.$3,a,!b("ScotchRTCP2PCallStore").isAudioOnly()&&!c.isVideoDisabled(),this.$81())};c.$79=function(a){var c=this,d=this.$9?b("FBRTCConstants").PayloadType.PCRESTART_OFFER:b("FBRTCConstants").PayloadType.OFFER,e=b("ScotchRTCCallStore").getState();e=e.callSummary;e=e?e.getCallTrigger():"";this.$12=new(b("ScotchFBRTCRetriableMessage"))(this.$11);this.$12.addListener("sendingRetry",this.$71);this.$12.addListener("timeoutFailure",this.$73);this.$12.sendMessage(d,this.$2,this.$3,{sdp:a,hasVideo:!b("ScotchRTCP2PCallStore").isAudioOnly(),attributes:this.$81(),callTrigger:e});this.$21=b("setTimeout")(function(){c.$38(h.NO_ANSWER_TIMEOUT,!1,!0,!1,"NoAnswerTimeout")},n)};c.$82=function(a){if(!Object.prototype.hasOwnProperty.call(a,"videoon"))return;a=!a.videoon;b("ScotchRTCCallActions").toggleMuteRemoteVideo(a,this.$2);for(var a=this.$4.getRemoteStreams(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(e.getAudioTracks().length>0){this.$34("remote steam: mute toggled",e);return}}this.$27.update()};c.$80=function(a){this.$13=new(b("ScotchFBRTCRetriableMessage"))(this.$11);this.$13.addListener("sendingRetry",this.$71);var c={escalationConferenceName:this.$15,negotiatedEscalationSupport:this.$14};this.$13.sendMessage(b("FBRTCConstants").PayloadType.ANSWER,this.$2,this.$3,{sdp:a,hasVideo:!b("ScotchRTCP2PCallStore").isAudioOnly(),attributes:this.$81(),multiwayInfo:c})};c.processQueuedMessages=function(){var a=this;b("FBRTCLocalMessageQueue").drainQueue(this.$2,function(b){a.$47(b,{skipDupeCheck:!0})})};c.$47=function(a,c){var d;try{d=new(b("ScotchFBRTCMessage"))(a)}catch(b){this.$6.logError(this.$2,this.$3,"Unknown data: "+JSON.stringify(a));return}this.$6.logReceivedMessage(d.peerID,d.callID,d.msg);this.$34("message received",d.msg);if(this.$83()){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (call ended): "+d.msgID);return}if(!(c==null?void 0:c.skipDupeCheck)&&!b("ScotchFBRTCMessageDedup").check(d.peerID,d.callID,d.msgID)){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (duplicate): "+d.msgID);return}if(b("ScotchRTCCallStore").getState().callInfo.conferenceState==="AWAITING_USER_START"){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (awaiting user start): "+d.msgID);return}if(this.$2&&this.$2!==d.peerID){d.isOffer()&&this.$84(d);this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (different peer): "+d.msgID);return}if(d.selfID!=null&&d.selfID!==this.$1){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (wrong receiver): "+d.msgID);return}if(!d.isForCall(this.$3,this.$15)){this.$72("ScotchRTCP2PProtocolHandler: Ignoring message (different call): "+d.msgID+"(callID: "+d.callID+")");return}this.$3&&this.$3===d.callID&&s(function(a){return a.onFullMessageReceived(d)});a=b("ScotchRTCGroupCallEscalationStore").getState().inProgress;switch(d.msgType){case b("FBRTCConstants").PayloadType.ICERESTART_OFFER:case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:this.internalResetConnection();this.$85(d);break;case b("FBRTCConstants").PayloadType.OFFER:this.$85(d);break;case b("FBRTCConstants").PayloadType.ANSWER:case b("FBRTCConstants").PayloadType.ICERESTART_ANSWER:case b("FBRTCConstants").PayloadType.PCRESTART_ANSWER:b("ScotchRTCP2PCallActions").setRemoteSignalingExperiments(d.getSignalingExperiments());this.$86(d);break;case b("FBRTCConstants").PayloadType.SDP_UPDATE:this.$87(d);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$88(d);break;case b("FBRTCConstants").PayloadType.HANGUP:this.$89(d);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$90(d);break;case b("FBRTCConstants").PayloadType.OFFER_NACK:this.$25=!0;break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$91();break;case b("FBRTCConstants").PayloadType.MSG_ACK:this.$92(d);break;case b("FBRTCConstants").PayloadType.SET_VIDEO:this.$93(d);break;case b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY:a||this.handleSwitchToMultiway();break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:case b("FBRTCConstants").PayloadType.ACK:case b("FBRTCConstants").PayloadType.OK:case b("FBRTCConstants").PayloadType.PING:case b("FBRTCConstants").PayloadType.PING_ACK:case b("FBRTCConstants").PayloadType.OTHER_DISMISS:case b("FBRTCConstants").PayloadType.PRANSWER:break;default:break}this.$31.parseMessage(d)};c.$45=function(a){switch(a.msg_type){case"bjn_escalating":var c=b("ScotchRTCP2PCallStore").getState().connectionStatus;b("ScotchRTCP2PCallActions").setConnectionStatus("ESCALATING_TO_BJN");b("setTimeout")(function(){b("ScotchRTCP2PCallActions").setConnectionStatus(c)},o);break;case"participants":b("ScotchRTCOneVCActions").storeParticipants(JSON.parse(a.payload).list);break;default:break}};c.$84=function(a){var c=a.peerID,d=a.callID;this.$35("RTCP2PProtocolHanlder_collision_offer_from_another_peer");var e=a.msg,f=new(b("FBRTCCallSummary"))({peerID:c,callID:d,isCaller:!1});f.setActiveConnection("p2p");f.onFullMessageReceived(a);f.setCallType(b("ScotchFBRTCSdpUtils").isVideoSupported(e.sdp)?i.DIRECT_VIDEO:i.VOIP);this.$11.sendOfferAck(c,d,e);f.onOfferAckSent(e);a=new(b("ScotchRTCEndCallReason"))(h.IN_ANOTHER_CALL);this.$94(c,d,a,!1);f.onCallEnded(a.getReasonID(),!1);f.save(b("FBRTCCallSummaryStore").getInstance())};c.$85=function(a){var c=a.msg;if(!b("ScotchRTWebExperiments").enableCallCollisionFix()){this.$3&&c.call_id!==this.$3&&this.$35("RTCP2PProtcolHandler_call_collision");var d=this.$4.getSignalingState();if(d!=="stable")return}if(c.calltype){this.$11.sendOfferNack(this.$2,c.call_id,c);return}this.$11.sendOfferAck(this.$2,c.call_id,c);this.$11.sendOtherDismiss(c.call_id);this.$95(c)?this.$96(a):this.$97(a)};c.resetCollisionSummary=function(a,c){var d=a.msg;s(function(a){a.onCallEnded(h.OTHER_INSTANCE_HANDLED,!1,!1,"call_collision"+(c?"_resetConnection":"_atStart"))});var e=new(b("FBRTCCallSummary"))({peerID:this.$2,callID:d.call_id,isCaller:!1});b("ScotchRTCCallActions").setCallSummary(e);s(function(c){c.setActiveConnection("p2p"),c.onFullMessageReceived(a),c.onOfferAckSent(d),c.setCallType(b("ScotchFBRTCSdpUtils").isVideoSupported(d.sdp)?i.DIRECT_VIDEO:i.VOIP),c.setCallTrigger("call_collision")})};c.handleCallCollision=function(a,c){this.$6.logEvent(this.$2,this.$3,"Handling offer collision");this.resetCollisionSummary(a,c);if(b("ScotchRTWebExperiments").enableCallCollisionFix()){this.$3=a.callID;a=a.msg;c?this.internalResetConnection():this.$11.sendOtherDismiss(a.call_id);b("ScotchRTCCallActions").callCollision(a.call_id.toString(),this.$2);this.$35("RTCP2PProtocolHandler_handling_call_collision"+(c?"_resetConnection":"_atStart"))}};c.$96=function(a){var c=a.msg;this.$82(c);b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();if(this.$3!==c.call_id){c=new(b("ScotchRTCEndCallReason"))(h.OTHER_INSTANCE_HANDLED);this.$94(this.$2,this.$3,c,!1);this.handleCallCollision(a,!0)}else this.$6.logEvent(this.$2,this.$3,"Handling offer refresh");this.$17=!1;this.$20=a;b("ScotchRTCP2PCallActions").processMessage(a);this.$46();this.$34("offer accepted",a.msgID)};c.$97=function(a){this.$6.logEvent(this.$2,this.$3,"Ignoring offer"),this.$34("offer ignored",a.msgID)};c.$87=function(a){var c=this,d=a.msg;b("ScotchRTCP2PCallActions").processMessage(a);this.$82(d);switch(this.$4.getSignalingState()){case"stable":this.onReceivedRemoteSDP(this.$101("offer",a),"offer",d.attributes);break;case"have-local-offer":this.onReceivedRemoteSDP(this.$101("answer",a),"answer",d.attributes).then(function(){return c.$102()})["catch"](function(a){c.$63(new Error("Failed to handle sdp update when signaling state is 'have-local-offer': "+a.message))});break;case"have-remote-offer":b("setTimeout")(function(){return c.$87(a)},1e3);break;case"have-local-pranswer":case"have-remote-pranswer":break;case"closed":break}this.$34("SDP update",[d.sdp,d.attributes])};c.$101=function(a,c){c=c.msg;var d=b("ScotchRTCP2PCallStore").getState();d=d.isPeerOnMobile;var e=b("ScotchRTCP2PCallStore").isCaller();return a==="offer"?!d&&e&&b("UserAgent").isBrowser("Firefox")?b("ScotchFBRTCSdpUtils").setDtlsRole(c.sdp,this.$10):c.sdp:b("ScotchFBRTCSdpUtils").setDtlsRole(c.sdp,d&&!e?"passive":this.$10)};c.$102=function(){this.$7=!1};c.$67=function(){var a=this.$4.getSenders().find(function(a){var b;return(a==null?void 0:(b=a.track)==null?void 0:b.kind)==="audio"&&typeof a.getParameters==="function"&&typeof a.setParameters==="function"});if(a==null)return;if(b("ScotchRTCSignalingExperiments").shouldCapAudioBitrate()){var c=b("FBRTCExperiment").getMediaQualityExperiments().getInt("max_audio_bitrate",0);if(c>0){var d=a.getParameters();d.encodings!=null?d.encodings[0].maxBitrate=c:d.encodings=[{maxBitrate:c}];b("Promise").resolve(a.setParameters(d))}else this.$6.logError(this.$2,this.$3,"received 0 for max audio bitrate")}};c.onReceivedRemoteSDP=function(a,c,d){var e=this;this.$103(d);d=b("ScotchRTCP2PCallStore").getState();d=d.isPeerOnMobile;d&&(a=b("ScotchFBRTCSdpUtils").setVideoBitrateConstraint(a));c==="answer"?a=this.$4.transformRemoteSdp(a):b("ScotchRTCP2PCallEscalationStore").isEscalated()&&(a=this.$4.processRemoteOfferSdpForP2PVideoEscalation(a));return this.$4.setRemoteDescription(new(b("ScotchRTCSessionDescription"))(k.P2P,{type:c,sdp:a})).then(function(){e.$17=!0,e.$16.drainCandidates(e.$2,e.$3,function(a){return e.$4.onReceivedRemoteIceCandidate(a)})}).then(function(){e.$66();return c!=="offer"?void 0:e.$4.createAnswer({DISABLE_OPUS_STEREO:b("ScotchRTWebClientFeatureGating").disableOpusStereo(),ADD_AUDIO_NACK:b("ScotchRTCSignalingExperiments").shouldEnableAudioNack()}).then(function(a){e.$70(a),e.$34("SDP update",{answer:a.toSdp()})})}).then(function(){e.$39()===b("ScotchRTCCallType").AUDIO_ONLY&&e.$11.sendMuteStateUpdate(e.$2,e.$3,!1)})["catch"](function(a){e.$63(a);throw a})};c.$103=function(a){if(a){var c=a.streams;this.$5=babelHelpers["extends"]({},this.$5,a,{streams:babelHelpers["extends"]({},this.$5.streams,c)});b("ScotchRTWebExperiments").shouldUseSingleMediaStream()||Object.keys(c).some(function(a){if(c[a].type===b("FBRTCConstants").StreamType.SCREEN_CONTENT){b("ScotchRTCCallActions").removeAllLocalScreenStreams(!0);return!0}return!1})}};c.$95=function(a){return a.call_id===this.$3?!0:Boolean((this.$21||!this.$20)&&(!this.$3||a.call_id!==this.$3)&&b("ScotchRTCP2PCallStore").isCaller()&&(!a.handlescollision||a.call_id<this.$3))};c.$86=function(a){var c=this,d=this.$4.getSignalingState();if(d!=="have-local-offer")return;d=a.msg;this.$76(!!d.negotiated_escalation_support,d.escalation_conference_name);b("clearTimeout")(this.$24);this.$98();this.$99();this.$11.sendAnswerAck(this.$2,this.$3,d);b("ScotchRTCP2PCallActions").processMessage(a);b("ScotchRTCP2PCallActions").setConnectionStatus("CONNECTING");this.onReceivedRemoteSDP(d.sdp,"answer",d.attributes).then(function(){c.$102(),b("ScotchRTCCallActions").callSuccess(!0)})["catch"](function(a){c.$63(new Error("Failed to handle answer on receiving remote SDP"))});this.$82(d)};c.$92=function(a){var b=a.msg;this.$12&&this.$12.isAckMsg(b)?(s(function(b){b.onMsgAckReceived(a,!0)}),this.$90(a)):this.$13&&this.$13.isAckMsg(b)&&(s(function(b){b.onMsgAckReceived(a,!1)}),this.$91())};c.$90=function(a){b("ScotchRTCP2PCallActions").setConnectionStatus("RINGING"),s(function(c){c.setUploadLogLevel(b("FBRTCLocalUploadLogLevel").getUploadLogLevel(b("FBRTCConstants").convertToUploadLogLevel(a.msg.ull)))}),b("clearTimeout")(this.$24),this.$98()};c.$91=function(){this.$100(),this.$102(),b("ScotchRTCCallActions").incomingCallSuccess()};c.$93=function(a){this.$19?this.$75(a):(this.$72("ScotchRTCP2PProtocolHandler: P2P message "+a.msgType+" queued for delay handling"),this.$18.push(a))};c.$75=function(a){b("ScotchRTCP2PCallStore").getState().isRemoteVideoSupported&&!b("ScotchRTCP2PCallStore").isAudioOnly()&&this.$82(a.msg)};c.$88=function(a){var b=this,c=a.msg;c.call_id===this.$3&&this.$17?this.$4.onReceivedRemoteIceCandidate(c)["catch"](function(a){b.$104(c)}):this.$104(c)};c.$104=function(a){this.$16.cacheCandidate(this.$2,a.call_id,a)};c.$89=function(a){a=a.msg;var b=a.call_id,c=a.reason;a=a.subreason;b===this.$3?this.$38(c,!0,!1,!1,a):(this.$6.logError(this.$2,this.$3,"Receiving hangup for a different call: "+b.toString()),this.$34("hangup callID missmatch",b.toString()))};c.$38=function(a,c,d,e,f){var g=this,i=new(b("ScotchRTCEndCallReason"))(a).setSubreason(f).setRemoteEnded(c);b("ScotchRTCCallActions").setEndCallReason(i);b("ScotchRTCCallNUXActions").refreshNUXState();a=b("ScotchRTCP2PCallEscalationStore").getState().inProgress;a&&b("ScotchRTCP2PCallEscalationActions").cancel();b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();if(this.$83()){this.$6.logError(this.$2,this.$3,"Ending an already-ended call");return}this.$6.logCallAction(this.$2,this.$3,b("FBRTCLogger").CallAction.END_CALL,i.toStrName());this.$34("call: ended",{reason:i.toStrName(),reasonID:i.getReasonID(),subReason:i.getSubreason(),isRemoteEnded:c,userCallType:this.$39(),isCaller:b("ScotchRTCP2PCallStore").isCaller()});d&&this.$94(this.$2,this.$3,i,e);this.$26.stop();this.$27.stop();this.$28.stop();b("ScotchRTCCallActions").hangupSuccess();this.$32||b("ScotchRTCCallActions").removeAllLocalStreams(!0);b("ScotchRTCCallActions").removeAllLocalScreenStreams(!0);b("ScotchRTCCallActions").removeAllRemoteStreams(this.$2);b("ScotchRTCP2PCallActions").setConnectionStatus("DISCONNECTED");if(b("gkx")("965758")){f=b("ScotchRTCCallStore").getState();a=f.callSummary;d=f.callInfo;e=b("ZenonTSLogDataHelper").serialize(d.tsLogData);this.$6.logTsLogData(e,a.peerID,a.callID,d.conferenceName)}s(function(a){a.setCallType(b("ScotchRTCP2PCallEscalationStore").getState().callType),a.setVideoDurations(g.$26.getDuration(),g.$27.getDuration()),a.setScreenDuration(g.$28.getDuration()),a.onCallEnded(i.getReasonID(),c,null,i.getSubreason()),g.$35("logged end call to call summary")});this.$4&&this.$4.close();i.getReasonID()===h.HANGUP_CALL&&i.getSubreason()==="CallReset"&&c&&b("ScotchRTCP2PCallWindowHandler").close()};c.$39=function(){var a=b("ScotchRTCCallStore").getState();a=a.localUser;var c=this.$49(a);return c===!1&&a.isAudioDisabled()?b("ScotchRTCCallType").NO_AUDIO_VIDEO:c===!1&&!a.isAudioDisabled()?b("ScotchRTCCallType").AUDIO_ONLY:b("ScotchRTCCallType").AUDIO_VIDEO};c.shutDownP2PListenersForMultiwayEscalation=function(){var a=this;b("clearTimeout")(this.$24);this.$98();this.$99();this.$100();this.$26.stop();this.$27.stop();this.$4&&this.$4.removeAllListeners();b("setTimeout")(function(){b("ScotchRTCGroupCallEscalationStore").logToP2PCallSummary(function(c){c.setCallType(b("ScotchRTCP2PCallEscalationStore").getState().callType),c.setVideoDurations(a.$26.getDuration(),a.$27.getDuration()),c.setScreenDuration(a.$28.getDuration()),c.onCallEnded(h.HANGUP_CALL,!1,!1,"multiway escalation")}),b("ScotchRTCCallActions").completeTransitionToMultiway()},100);this.destroy()};c.$94=function(a,b,c,d){if(!this.$11)return;this.$11.sendHangup(a,b,c.getReasonID(),d,c.getSubreason());this.$11.sendOtherDismiss(b)};c.$98=function(){this.$12&&this.$12.stopRetrying()};c.$100=function(){this.$13&&this.$13.stopRetrying()};c.$99=function(){this.$21&&b("clearTimeout")(this.$21),this.$21=null};c.$83=function(){return b("ScotchRTCCallStore").getState().callInfo.conferenceState==="TERMINATED"};c.$61=function(a){var c=this;r(function(d){d=d.logConnectionStats(function(){var c=a.getSignalingState();return c!=="closed"?a.getStats():b("Promise").reject("peer connection closed")},c.$2,c.$3);var e=d.start,f=d.stop;d=function b(d){d=d.target;d=d.iceConnectionState;(d==="completed"||d==="connected")&&(c.$35("RTCP2PProtocolHandler_call_connected"),c.$34("call: connected"),e(),a.removeEventListener("iceconnectionstatechange",b),a.addEventListener("iceconnectionstatechange",g))};var g=function b(c){c=c.target;c=c.iceConnectionState;c==="closed"&&(f(),a.removeEventListener("iceconnectionstatechange",b))};a.addEventListener("iceconnectionstatechange",d)})};c.$34=function(a,b){var c=this;r(function(d){return d.log(a,{peerID:c.$2,callID:c.$3,eventDetails:b})})};c.destroy=function(){this.$30.clear();if(b("ScotchRTWebExperiments").shouldUseZenonSignaling()){var a=b("ScotchRTCP2PCallStore").getState().signalingChild;a!=null&&a.removeAllListeners("messageReceived")}else b("FBRTCMessageListener").removeMessageHandler();b("FBRTCConfig").isVCEndpointCall()&&b("FBRTCMessageListener").removeOneVCMessageHandler();this.$11.onMessageSent=null,this.$11.onSendFailure=null};c.generateEscalationRequestToken=function(a){return this.$31.generateRequestToken(a)};c.generateEscalationResponseToken=function(a,b){return this.$31.generateResponseToken(a,b)};a.getDefaultVideoQuality=function(){return b("FBRTCConfig").isVCEndpointCall()||b("FBRTCConfig").shouldUseHDVideoQuality()?l.HD_VIDEO:b("CurrentUser").isWorkUser()?l.SD_VIDEO:l.LQ_VIDEO};a.showRedialButton=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.endCallReason;var c=b("ScotchRTCCallStore").getState();c=c.callSummary;return a!=null&&(a.getReasonID()===h.IGNORE_CALL||a.getReasonID()===h.NO_ANSWER_TIMEOUT)||c.getCallDuration()<=p};a.showStarRating=function(){if(!b("FBRTCConfig").isVCEndpointCall()){var c=b("ScotchRTCP2PCallStore").getState(),d=c.endCallReason;c=c.wasConnected;return c&&d!=null&&d.getReasonID()===h.HANGUP_CALL}else return!a.showRedialButton()};c.$72=function(a){this.$6.logInfo(this.$2,this.$3,a)};c.$35=function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:a,callID:this.$3?this.$3.toString():null,callType:"p2p"})};return a}();function r(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["ScotchCollabMessengerLogger"],a,"ScotchRTCP2PProtocolHandler")}function s(a){var c=b("ScotchRTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}function t(a,c,d,e){var f,g,h,i;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f={requestAudio:!0};d!=null&&(f.deviceId={ideal:d});g={requestVideo:a||c,aspectRatio:{ideal:Number((16/9).toFixed(10))},height:{max:j.SD_HEIGHT,min:j.LQ_HEIGHT,ideal:j.LQ_HEIGHT},width:{max:j.SD_WIDTH,min:j.LQ_WIDTH,ideal:j.LQ_WIDTH},frameRate:{max:j.FRAME_RATE,min:10,ideal:j.LQ_FRAME_RATE}};e!=null&&(g.deviceId={ideal:e});k.next=6;return b("regeneratorRuntime").awrap(b("ZenonLocalMediaSDK").getUserMediaWithFallback(f,a||c?g:{requestVideo:!1}));case 6:h=k.sent;if(!(c&&!a)){k.next=11;break}i=[];h.forEach(function(a){a.contentType==="video"&&(a.webrtcTrack.enabled=!1,i.push(new(b("ZenonImmutableMediaTrack"))({trackId:a.trackId,label:a.label,webrtcStream:a.webrtcStream,webrtcTrack:a.webrtcTrack,enabled:!1,userMuted:a.userMuted,remote:a.remote,contentType:a.contentType,contentHint:a.contentHint}))),i.push(a)});return k.abrupt("return",i[0].webrtcStream);case 11:return k.abrupt("return",h[0].webrtcStream);case 12:case"end":return k.stop()}},null,this)}e.exports=f}),null);
__d("ScotchFBRTCMediaMetricsConst",[],(function(a,b,c,d,e,f){"use strict";a={JITTER:"jitter",ACCELERATE_RATE:"accelerate_rate",DECODING_CNG:"decoding_cng",DECODING_NORMAL:"decoding_normal",DECODING_PLC:"decoding_plc",DECODING_PLC_CNG:"decoding_plc_cng",DECODING_NETEQ_CALL:"decoding_neteq_call",DISCARD_RATE:"discard_rate",EXPAND_RATE:"expand_rate",PREEMPTIVE_RATE:"preemptive_rate",AUDIO_PACKETS_RECEIVED:"audio_packets_received",AUDIO_FEC_PACKETS_RECEIVED:"audio_fec_packets_received",AUDIO_FEC_PACKETS_DISCARDED:"audio_fec_packets_discarded",AUDIO_PACKETS_RECEIVED_LOST:"audio_packets_received_lost",AUDIO_PACKETS_SENT:"audio_packets_sent",AUDIO_PACKETS_SENT_LOST:"audio_packets_sent_lost",VIDEO_BYTES_RECEIVED:"video_bytes_received",VIDEO_BYTES_SENT:"video_bytes_sent",INBOUND_QP:"inbound_qp",OUTBOUND_QP:"outbound_qp",FRAMES_ENCODED:"frames_encoded",FRAMES_DECODED:"frames_decoded",FRAMES_RECEIVED:"frames_received",FRAMES_SENT:"frames_sent",VIDEOBWE_SEND_BANDWIDTH:"videobwe_send_bandwidth",VIDEOBWE_TRANSMIT_BITRATE:"videobwe_transmit_bitrate",VIDEOBWE_RETRANSMIT_BITRATE:"videobwe_retransmit_bitrate",AUDIO_BYTES_SENT:"audio_bytes_sent",AUDIO_BYTES_RECEIVED:"audio_bytes_received",VIDEO_PKTS_SENT:"video_pkts_sent",VIDEO_PKTS_SEND_LOST:"video_pkts_send_lost",VIDEO_PKTS_RECEIVED:"video_pkts_received",VIDEO_FEC_PKTS_RECEIVED:"video_fec_pkts_received",VIDEO_FEC_PKTS_DISCARDED:"video_fec_pkts_discarded",VIDEO_PKTS_RECV_LOST:"video_pkts_receive_lost",AUDIO_RTT_RECEIVED:"audio_rtt_received",AUDIO_RTT_SENT:"audio_rtt_sent",AUDIO_DEV_REC_STALLS:"audio_dev_rec_stalls",AUDIO_DEV_TOTAL_STALLS:"audio_dev_total_stalls",AUDIO_DEV_IS_STALLED:"audio_dev_is_stalled",AUDIO_DEV_STALL_DURATION:"audio_dev_stall_duration",VIDEO_FREEZE_COUNT:"video_freeze_cnt",VIDEO_FREEZE_DURATION:"video_freeze_duration",VIDEO_PAUSE_COUNT:"video_pause_cnt",VIDEO_PAUSE_DURATION:"video_pause_duration",VIDEO_CAPTURE_WIDTH:"video_capture_width",VIDEO_CAPTURE_HEIGHT:"video_capture_height",VIDEO_SUM_CAPTURE_PIXEL:"video_sum_capture_pixel",VIDEO_CAPTURE_FRAME_COUNT:"video_capture_frame_count",VIDEO_DECODED_WIDTH:"video_decoded_width",VIDEO_DECODED_HEIGHT:"video_decoded_height",VIDEO_ENCODED_WIDTH:"video_encoded_width",VIDEO_ENCODED_HEIGHT:"video_encoded_height",VIDEO_SUM_DECODED_PIXEL:"video_sum_decoded_pixel",VIDEO_SUM_ENCODED_PIXEL:"video_sum_encoded_pixel",AUDIO_TOTAL_PACKET_SEND_DELAY:"audio_total_packet_send_delay",VIDEO_TOTAL_PACKET_SEND_DELAY:"video_total_packet_send_delay",AUDIO_TOTAL_ENCODE_TIME:"audio_total_encode_time",VIDEO_TOTAL_ENCODE_TIME:"video_total_encode_time",AUDIO_TOTAL_DECODE_TIME:"audio_total_decode_time",VIDEO_TOTAL_DECODE_TIME:"video_total_decode_time",AUDIO_JITTER_BUFFER_DELAY:"audio_jitter_buffer_delay",VIDEO_JITTER_BUFFER_DELAY:"video_jitter_buffer_delay",AUDIO_JITTER_BUFFER_EMITTED_COUNT:"audio_jitter_buffer_emitted_count",VIDEO_JITTER_BUFFER_EMITTED_COUNT:"video_jitter_buffer_emitted_count",AUDIO_E2E_LATENCY:"audio_e2e_latency",VIDEO_E2E_LATENCY:"video_e2e_latency",AV_SYNC:"av_sync",AV_SYNC_ABS:"av_sync_abs",AV_SYNC_COUNT:"av_sync_count",AV_SYNC_OOB:"av_sync_oob",VIDEO_DEBUGFPS:"video_debugFPS",VIDEO_DEBUGLASTUPDATE:"video_debuglastUpdate",VIDEO_DEBUGTRACKTIMESTAMP:"video_debugtracktimestamp",AUDIO_NETEQ_WAIT_TIME:"audio_neteq_wait_time",AUDIO_PACKET_LOSS_RATE:"audio_packet_loss_rate",AUDIO_PLC_CNG_RATE:"audio_plc_cng_rate",AUDIO_PLC_RATE:"audio_plc_rate",GLOBAL_AUDIO_BITRATE:"global_audio_bitrate",GLOBAL_BATTERY_USAGE:"global_battery_usage",GLOBAL_CPU_USAGE:"global_cpu_usage",GLOBAL_VIDEO_BITRATE:"global_video_bitrate",VIDEO_AV_SYNC_ABS:"video_av_sync_abs",VIDEO_AV_SYNC_OOB:"video_av_sync_oob",VIDEO_FRAME_RATE:"video_frame_rate",VIDEO_FREEZE_COUNT_PER_MIN:"video_freeze_count_per_min",VIDEO_FREEZE_DURATION_PER_MIN:"video_freeze_duration_per_min",VIDEO_NETEQ_WAIT_TIME:"video_neteq_wait_time",VIDEO_PACKET_LOSS_RATE:"video_packet_loss_rate",VIDEO_RENDER_SCALE_RATIO:"video_render_scale_ratio",VIDEO_CROPPING_RATIO:"video_cropping_ratio",VIDEO_RTT_RECEIVED:"video_rtt_received",VIDEO_RTT_SENT:"video_rtt_sent",SIMULCAST_LAYER_CHANGES:"simulcast_layer_changes",VIDEO_QUALITY_SENT:"video_quality_sent",VIDEO_ENCODED_FRAME_RATE:"video_encoded_frame_rate",VIDEO_QP_SENT:"video_qp_sent",VIDEO_DECODE_TIME:"video_decode_time"};e.exports=a}),null);
__d("ZenonNetworkQualityMonitor",["ScotchRTWebUserActionLogger","UserAgent","ZenonExperiments"],(function(a,b,c,d,e,f){"use strict";var g=2;a=function(){function a(){var a;this.$3=0;this.$4=!1;this.$1=(a=b("ZenonExperiments").getNetworkMonitorRttThreshold())!=null?a:Number.POSITIVE_INFINITY;this.$2=(a=b("ZenonExperiments").getNetworkMonitorPacketLossRateThreshold())!=null?a:Number.POSITIVE_INFINITY;b("ScotchRTWebUserActionLogger").logEvent({checkpoint:"ZenonNetworkQualityMonitor constructed: rtt "+this.$1+", packetLoss "+this.$2,eventName:"checkpoint"})}var c=a.prototype;c.$5=function(a,b,c){a=a.get(b);if(a!=null){b=a.cumulativeStat[c];if(b!=null)return b.getCurrentValue()>this.$1}return!1};c.$6=function(a,b){a=a/(a+b);return a>=this.$2};c.$7=function(a,b,c,d){a=a.get(b);if(a!=null){b=a.cumulativeStat[c];c=a.cumulativeStat[d];if(b!=null&&c!=null)return this.$6(b.getCurrentValue(),c.getCurrentValue())}return!1};c.$8=function(a,b,c){var d=this,e=c.packetLostKey,f=c.packetsKey,g=c.rttKey;c=b.some(function(b){var c=d.$7(a,b,e,f);return c||d.$5(a,b,g)});return c};c.getMetricKeys=function(a){return{packetLostKey:"packetsLost",packetsKey:a?"packetsSent":"packetsReceived",rttKey:b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera")?"googRtt":"roundTripTime"}};c.getCount=function(){return this.$3};c.determineQuality=function(a){var b=this.$3,c=this.$8(a,Array.from(a.keys()),this.getMetricKeys(!0));a=this.$8(a,Array.from(a.keys()),this.getMetricKeys(!1));c||a?this.$3<g&&this.$3++:this.$3>0&&this.$3--;b!==this.$3&&this.$3>=g?this.$4=!0:b>0&&this.$3<=0&&(this.$4=!1);return this.$4};return a}();e.exports=a}),null);
__d("ZenonHistogram",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){return(a.value||0)-(b.value||0)}a=function(){function a(){this.$1=[],this.$2=!0}var b=a.prototype;b.$3=function(){this.$2===!1&&this.$1.sort(g),this.$2=!0};b.add=function(a){this.$1.push(a),this.$2=!1};b.getAvgAndPercentile=function(a,b){this.$2||this.$3();var c=b?this.$1.filter(b):this.$1;if(c.length===0)return{avg:null,percentiles:null};b=c.reduce(function(a,b){return a+b.value},0)/c.length;a=a.map(function(a){a=Math.min(100,Math.max(0,a));a=(c.length-1)*a/100;var b=Math.floor(a),d=Math.ceil(a);if(b===d)return c[b].value;var e=c[b].value*(d-a);d=c[d].value*(a-b);return e+d});return{avg:b,percentiles:a}};return a}();e.exports=a}),null);
__d("ZenonPercentMediaStat",["ZenonHistogram","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new(b("ZenonHistogram"))()}var c=a.prototype;c.add=function(a,b,c,d){c={contentType:c,value:a,view:b,voiceEnergy:d};this.$1.add(c)};c.getAvgAndPercentile=function(a,c,d,e){var f;e==null?f=function(a){return a.view===c&&a.contentType===d}:f=function(a){var f=a.voiceEnergy>b("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD;return a.view===c&&a.contentType===d&&f===e};return this.$1.getAvgAndPercentile(a,f)};return a}();e.exports=a}),null);
__d("ScotchFBRTCMediaMetricParser",["FBRTCLogger","FBRTCMediaMetricTracker","FBRTCParticipantCallState","ScotchCallModelEmitter","ScotchFBRTCMediaMetricsConst","ScotchFBRTCStatsHelpers","ScotchRTCCallStore","ScotchRTCP2PCallActions","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonMediaStatsReportPoller","ZenonNetworkQualityMonitor","ZenonPercentMediaStat","ZenonRenderedView","gkx","performanceNow","promiseDone","qex"],(function(a,b,c,d,e,f){"use strict";var g,h=b("ScotchCallModelEmitter").CallsModelEmitterInstance,i=5e3,j=[(a=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS],k=[{trackId:a.OUTBOUND_AUDIO_STATS_TRACKID,contentType:"audio",renderedView:(c=b("ZenonRenderedView")).GRID,isRemote:!1},{trackId:a.OUTBOUND_VIDEO_STATS_TRACKID,contentType:"video",renderedView:c.GRID,isRemote:!1},{trackId:a.OUTBOUND_SCREEN_STATS_TRACKID,contentType:"screen",renderedView:c.GRID,isRemote:!1}],l=[{trackId:a.GLOBAL_STATS_TRACKID,contentType:a.GLOBAL_STATS_CONTENT_TYPE,renderedView:a.GLOBAL_STATS_RENDERED_VIEW,isRemote:!1},{trackId:a.PINNED_AUDIO_STATS_TRACKID,contentType:"audio",renderedView:c.PINNED,isRemote:!0},{trackId:a.PINNED_VIDEO_STATS_TRACKID,contentType:"video",renderedView:c.PINNED,isRemote:!0}].concat(k);d={DEFAULT_POLL_RATE_MS:i,addZenonGlobalStatsToScotch:r,addZenonPercentStatsToScotch:t,addZenonSpecialTrackStatsToScotch:q,addZenonFilteredStatsToScotch:u,getMediaMetricConst:v,updateBatteryStats:s,startCollectingMediaStats:function(){var a,c=null,d=!1,e=0,f=new Map();b("gkx")("995523")&&(c=new(b("ZenonNetworkQualityMonitor"))());var g=(a=b("qex")._("1064222"))!=null?a:i;a=function a(){var i,j=(i=b("ScotchRTCCallStore")).getState().callInfo.conferenceState,k=i.getState().callSummary,l=i.getState().connections.first();i=i.getState().callInfo.tsLogData;if(j!=="TERMINATED"&&l){j=h.getCallsModel().get("0");var m=Array.from(j.mediaTracks.values());b("ZenonMediaStatsReportPoller").updateStatsFromConnection(m,f,l,i,j.participants);var v=k.getMediaMetricTracker();m.forEach(function(a){var c=f.get(a.trackId);if(c!=null){u(f,v,a.trackId,a.contentType,a.remote);var d=[b("ZenonRenderedView").GRID,b("ZenonRenderedView").THUMBNAIL];for(var e=0;e<d.length;e++){var g=d[e];t(f,v,a.trackId,a.contentType,g,a.remote)}n(a,c,k);p(c,k)}});b("promiseDone")(b("ScotchFBRTCStatsHelpers").getBatteryStats(),function(a){k.addExtraInfo(b("FBRTCLogger").Key.BATTERY_END,a.level),k.setDeviceCharged(a.wasCharged),s(f,a.level)});m.forEach(function(a){a.remote===!1&&a.enabled===!0&&(a.contentType==="video"?k.setVideoDevice(a.label):a.contentType==="audio"&&k.setAudioDevice(a.label))});b("gkx")("1673659")||r(f,v);q(f,v);o(f,k);if(c!=null){l=d;d=c.determineQuality(f);l!=d&&b("ScotchRTCP2PCallActions").togglePoorNetworkQualityIndicator(d)}i=0;j=b("ScotchRTCCallStore").getState();m=j.callInfo;if((m==null?void 0:m.conferenceState)==="CONNECTED")if(m.protocol==="p2p")i=2;else{l=b("ScotchRTCCallStore").getState();j=l.remoteUsers;if(j!=null){m=j.filter(function(a){a=a.participantState;return(a==null?void 0:a.state)===b("FBRTCParticipantCallState").CONNECTED});i=m.count()}i++}i>e&&(e=i,k.addExtraInfo(b("FBRTCLogger").Key.MAX_CONCURRENT_CONNECTED_PARTICIPANTS,e));window.setTimeout(a,g)}};a()}};function m(a){switch(a){case b("ZenonRenderedView").GRID:return"grid";case b("ZenonRenderedView").PINNED:return"pinned";case b("ZenonRenderedView").THUMBNAIL:return"thumbnail"}return"grid"}function n(a,b,c){b.codec!=null&&(a.contentType==="audio"?a.remote||c.setAudioSentCodec(b.codec):a.remote?c.setVideoReceivedCodec(b.codec):c.setVideoSentCodec(b.codec));if(b.codecHistory!=null){a=Object.fromEntries(b.codecHistory.map(function(a){var b=a.codec;a=a.updateTime;return[Math.round(a).toString(),b]}));c.setEhist(a)}}function o(a,b){var c=0;a.forEach(function(a){a.cumulativeStat.framesDecoded!=null&&a.maxTotalDecodeTime!=null&&(c=Math.max(c,a.maxTotalDecodeTime))});b.setVideoMaxTotalDecodeTime(c)}function p(a,b){a=a.cumulativeStat;var c=a.totalDecodeTime;a=a.totalEncodeTime;if(c){var d;b.setTotalDecodeTime(((d=b.getTotalDecodeTime())!=null?d:0)+c.getDeltaFromLastUpdate())}if(a){b.setTotalEncodeTime(((d=b.getTotalEncodeTime())!=null?d:0)+a.getDeltaFromLastUpdate())}}function q(a,c){if(b("gkx")("1674571"))for(var d=0;d<k.length;d++){var e=k[d];u(a,c,e.trackId,e.contentType,e.isRemote)}for(var e=l,d=Array.isArray(e),f=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(d){if(f>=e.length)break;g=e[f++]}else{f=e.next();if(f.done)break;g=f.value}g=g;t(a,c,g.trackId,g.contentType,g.renderedView,g.isRemote)}}function r(a,c){var d=a.get(b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);d!=null&&(Object.keys(d.deltaStat).forEach(function(a){var e=v(a,!1,!0);e!=null&&c.addMetricStat(b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID,e,d.deltaStat[a].getLastAddedValue())}),Object.keys(d.cumulativeStat).forEach(function(a){var e=v(a,!1,!0);e!=null&&c.addMetricStat(b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID,e,d.cumulativeStat[a].getCurrentValue())}))}function s(a,c){a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(a,b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);var d=b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_BATTERY_USAGE;if(a.batteryLevel!=null&&a.batteryLevel!==c){var e=a.batteryLevel-c,f=(g||(g=b("performanceNow")))();a.batteryLastChangeTimestamp!=null&&f>a.batteryLastChangeTimestamp&&e>0&&a.batteryCharging!==!0&&(a.percentStat[d]==null&&(a.percentStat[d]=new(b("ZenonPercentMediaStat"))()),a.percentStat[d].add(e*100*6e4/(f-a.batteryLastChangeTimestamp),b("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,b("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,0));a.batteryLastChangeTimestamp=f;e<0?a.batteryCharging=!0:a.batteryCharging=!1}a.batteryLevel=c}function t(a,c,d,e,f,g){var h=a.get(d),i=m(f),k=e==="audio";h!=null&&Object.keys(h.percentStat).forEach(function(a){var l=v(a,g,k),m=null;j.includes(a)&&(m=!0);if(l!=null){a=h.percentStat[a].getAvgAndPercentile(b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED,f,e,m);if(a.avg!=null&&a.percentiles!=null){m=((m=a.percentiles)==null?void 0:m.length)||0;if(k){c.addMetricStat(d,b("FBRTCMediaMetricTracker").getAvgMediaKey(l,i),a.avg);for(var n=0;n<m;n++){var o;c.addMetricStat(d,b("FBRTCMediaMetricTracker").getPercentMediaKey(l,i,b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED[n]),(o=a.percentiles)==null?void 0:o[n])}}else{c.setVideoMetric(d,b("FBRTCMediaMetricTracker").getAvgMediaKey(l,i),a.avg);for(var o=0;o<m;o++){c.setVideoMetric(d,b("FBRTCMediaMetricTracker").getPercentMediaKey(l,i,b("ZenonMediaStatsConfig").PERCENTILES_REQUESTED[o]),(n=a.percentiles)==null?void 0:n[o])}}}}})}function u(a,c,d,e,f){var g=e==="audio",h=a.get(d);if(h==null)return;if(b("gkx")("1674571")&&!f&&d!==b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID&&d!==b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID)return;if(g&&h.deltaStat.googCurrentDelayMs!=null){var i;a=(a=h.cumulativeStat.jitterBufferDelay)==null?void 0:a.getDeltaFromLastUpdate();i=(i=h.cumulativeStat.jitterBufferEmittedCount)==null?void 0:i.getDeltaFromLastUpdate();a!=null&&i>0&&c.addJitterBufferDelay(d,a/i)}!g&&f===!1&&(c.setHistResScale(d,e,h.histResScale),c.setVideoContentType(d,e),e==="video"&&h.sender!=null&&c.updateVideoSender(d,e,h.sender));Object.keys(h.deltaStat).forEach(function(a){var b=v(a,f,g);b!=null&&(g?c.addMetricStat(d,b,h.deltaStat[a].getLastAddedValue()):c.setVideoMetric(d,b,h.deltaStat[a].getLastAddedValue()))});Object.keys(h.cumulativeStat).forEach(function(a){var b=v(a,f,g);b!=null&&(g?c.addMetricStat(d,b,h.cumulativeStat[a].getCurrentValue()):c.setVideoMetric(d,b,h.cumulativeStat[a].getCurrentValue()))})}function v(a,c,d){switch(a){case"packetsReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_RECEIVED;case"fecPacketsReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_FEC_PKTS_RECEIVED;case"fecPacketsDiscarded":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_DISCARDED:b("ScotchFBRTCMediaMetricsConst").VIDEO_FEC_PKTS_DISCARDED;case b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED:return c?d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED_LOST:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_RECV_LOST:d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_SENT_LOST:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_SEND_LOST;case"packetsSent":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKETS_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_PKTS_SENT;case"bytesSent":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_BYTES_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_BYTES_SENT;case"bytesReceived":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_BYTES_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_BYTES_RECEIVED;case"framesDecoded":return b("ScotchFBRTCMediaMetricsConst").FRAMES_DECODED;case"framesEncoded":return b("ScotchFBRTCMediaMetricsConst").FRAMES_ENCODED;case"framesReceived":return b("ScotchFBRTCMediaMetricsConst").FRAMES_RECEIVED;case"framesSent":return b("ScotchFBRTCMediaMetricsConst").FRAMES_SENT;case"googDecodingPLC":return b("ScotchFBRTCMediaMetricsConst").DECODING_PLC;case"googDecodingPLCCNG":return b("ScotchFBRTCMediaMetricsConst").DECODING_PLC_CNG;case"googDecodingCNG":return b("ScotchFBRTCMediaMetricsConst").DECODING_CNG;case"googDecodingNormal":return b("ScotchFBRTCMediaMetricsConst").DECODING_NORMAL;case"googDecodingCTN":return b("ScotchFBRTCMediaMetricsConst").DECODING_NETEQ_CALL;case"googRtt":return d?c?b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_RECEIVED:b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_SENT:c?b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_RECEIVED:b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_SENT;case"googJitterReceived":case"jitter":return b("ScotchFBRTCMediaMetricsConst").JITTER;case"googAccelerateRate":return b("ScotchFBRTCMediaMetricsConst").ACCELERATE_RATE;case"googExpandRate":return b("ScotchFBRTCMediaMetricsConst").EXPAND_RATE;case"googPreemptiveExpandRate":return b("ScotchFBRTCMediaMetricsConst").PREEMPTIVE_RATE;case"googSecondaryDiscardedRate":return b("ScotchFBRTCMediaMetricsConst").DISCARD_RATE;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME:return b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODE_TIME;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PAUSE_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PAUSE_DURATION;case"width":return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_WIDTH;case"height":return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_HEIGHT;case"availableOutgoingBitrate":return b("ScotchFBRTCMediaMetricsConst").VIDEOBWE_SEND_BANDWIDTH;case"frameWidth":return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODED_WIDTH:b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_WIDTH;case"frameHeight":return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_DECODED_HEIGHT:b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_HEIGHT;case"totalPacketSendDelay":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_PACKET_SEND_DELAY:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_PACKET_SEND_DELAY;case"totalDecodeTime":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_DECODE_TIME:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_DECODE_TIME;case"totalEncodeTime":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_TOTAL_ENCODE_TIME:b("ScotchFBRTCMediaMetricsConst").VIDEO_TOTAL_ENCODE_TIME;case"jitterBufferDelay":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_DELAY:b("ScotchFBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_DELAY;case"jitterBufferEmittedCount":return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_EMITTED_COUNT:b("ScotchFBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_EMITTED_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY:return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_E2E_LATENCY:b("ScotchFBRTCMediaMetricsConst").VIDEO_E2E_LATENCY;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_ABS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB:return b("ScotchFBRTCMediaMetricsConst").AV_SYNC_OOB;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_IS_STALLED;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_REC_STALLS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_TOTAL_STALLS;case b("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION:return b("ScotchFBRTCMediaMetricsConst").AUDIO_DEV_STALL_DURATION;case b("ZenonMediaStatsConfig").DERIVED_METRICS.SIMULCAST_LAYER_CHANGES:return b("ScotchFBRTCMediaMetricsConst").SIMULCAST_LAYER_CHANGES;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL:return c?b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_DECODED_PIXEL:b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_ENCODED_PIXEL;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL:return b("ScotchFBRTCMediaMetricsConst").VIDEO_SUM_CAPTURE_PIXEL;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT:return b("ScotchFBRTCMediaMetricsConst").VIDEO_CAPTURE_FRAME_COUNT;case b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM:return c?b("ScotchFBRTCMediaMetricsConst").INBOUND_QP:b("ScotchFBRTCMediaMetricsConst").OUTBOUND_QP;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_NETEQ_WAIT_TIME:return b("ScotchFBRTCMediaMetricsConst").AUDIO_NETEQ_WAIT_TIME;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PACKET_LOSS_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PACKET_LOSS_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_CNG_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PLC_CNG_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_RATE:return b("ScotchFBRTCMediaMetricsConst").AUDIO_PLC_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_AUDIO_BITRATE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_AUDIO_BITRATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_BATTERY_USAGE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_BATTERY_USAGE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_CPU_USAGE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_CPU_USAGE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_VIDEO_BITRATE:return b("ScotchFBRTCMediaMetricsConst").GLOBAL_VIDEO_BITRATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS:return b("ScotchFBRTCMediaMetricsConst").VIDEO_AV_SYNC_ABS;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_OOB:return b("ScotchFBRTCMediaMetricsConst").VIDEO_AV_SYNC_OOB;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FRAME_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FRAME_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_COUNT_PER_MIN:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT_PER_MIN;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_DURATION_PER_MIN:return b("ScotchFBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION_PER_MIN;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_NETEQ_WAIT_TIME:return b("ScotchFBRTCMediaMetricsConst").VIDEO_NETEQ_WAIT_TIME;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_PACKET_LOSS_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_PACKET_LOSS_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_RENDER_SCALE_RATIO:return b("ScotchFBRTCMediaMetricsConst").VIDEO_RENDER_SCALE_RATIO;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_CROPPING_RATIO:return b("ScotchFBRTCMediaMetricsConst").VIDEO_CROPPING_RATIO;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.ROUND_TRIP_TIME:return d?b("ScotchFBRTCMediaMetricsConst").AUDIO_RTT_SENT:b("ScotchFBRTCMediaMetricsConst").VIDEO_RTT_SENT;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_QUALITY:return b("ScotchFBRTCMediaMetricsConst").VIDEO_QUALITY_SENT;case"video_debugFPS":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGFPS;case"video_debuglastUpdate":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGLASTUPDATE;case"video_debugtracktimestamp":return b("ScotchFBRTCMediaMetricsConst").VIDEO_DEBUGTRACKTIMESTAMP;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_ENCODED_FRAME_RATE:return b("ScotchFBRTCMediaMetricsConst").VIDEO_ENCODED_FRAME_RATE;case b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_QP:return b("ScotchFBRTCMediaMetricsConst").VIDEO_QP_SENT}}e.exports=d}),null);
__d("ZenonCallFeatures",["immutable"],(function(a,b,c,d,e,f){"use strict";a=b("immutable").Record({canAddParticipants:!1,canReplaceLocalStreams:!1,dominantSpeaker:null,poorConnectionStatus:!1,screenSharingAvailability:"available",supportMultipleStreams:!1});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);e.exports=c}),null);
__d("ZenonCall",["immutable","ZenonCallFeatures"],(function(a,b,c,d,e,f){"use strict";c=(a=b("immutable")).Record({callState:"new",clientCallId:"",collisionContext:{groupThreadID:null,peerID:null,serverInfoData:null},endCallReason:null,features:new(b("ZenonCallFeatures"))(),groupEscalationStatus:null,mediaTracks:a.Map(),participants:a.Map(),remoteScreenSharingUserIDs:a.OrderedSet(),responseSubCode:null,rtpReceivers_I_KNOW_WHAT_I_AM_DOING:a.Set(),rtpSenders_I_KNOW_WHAT_I_AM_DOING:a.Set(),stateSyncInputStates:a.Map(),stateSyncOutputStates:a.Map(),videoEscalationStatus:null});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c);e.exports=d}),null);
__d("ZenonCallParticipant",["immutable"],(function(a,b,c,d,e,f){"use strict";a=b("immutable").Record({id:void 0,isVideoSubscribed:!1,participantType:void 0,state:"disconnected",trackIDs:void 0});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);e.exports=c}),null);
__d("ScotchCallModelEmitter",["invariant","requireCond","EventEmitter","FBLogger","FBRTCConfig","FBRTCParticipantCallState","RTWebCallModelTypedLogger","ScotchFBRTCGroupCallStore","ScotchFBRTCScreenSharingUtils","ScotchRTCAppDispatcher","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCGroupCallEscalationStore","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallStore","cr:1420073","ScotchRTWebBrowserFeatureSupport","ScotchRTWebExperiments","UserAgent","ZenonCall","ZenonCallFeatures","ZenonCallParticipant","ZenonImmutableMediaTrack","gkx","immutable"],(function(a,b,c,d,e,f,g){"use strict";var h=[b("ScotchFBRTCGroupCallStore"),b("ScotchRTCCallStore"),b("ScotchRTCP2PCallStore"),b("ScotchRTCP2PCallEscalationStore"),b("ScotchRTCGroupCallEscalationStore")];b("cr:1420073")&&h.push(b("cr:1420073"));var i=["IgnoreCall","HangupCall","InAnotherCall","CallEndAcceptAfterHangUp","NoAnswerTimeout","IncomingTimeout","OtherInstanceHandled","SignalingMessageFailed","ConnectionDropped","ClientInterrupted","WebRTCError","ClientError","NoPermission","OtherNotCapable","NoUIShown","VersionUnsupported","CallerNotVisible","CarrierBlocked","OtherCarrierBlocked","ClientEncryptionError","InactiveTimeout"];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.$ScotchCallModelEmitter1=b("ScotchRTCAppDispatcher").explicitlyRegisterStores(h);return c}var d=c.prototype;d.getDispatchTokens=function(){return this.$ScotchCallModelEmitter1};d.$ScotchCallModelEmitter3=function(){return b("ScotchRTCCallStore").getState().callInfo.collisionContext};d.$ScotchCallModelEmitter4=function(){var a=b("ScotchRTCCallStore").getState().callInfo.conferenceState;switch(a){case"CONNECTED":case"RENEGOTIATING":return"connected";case"CONNECTING":var c=b("ScotchRTCCallStore").getState().remoteUsers.find(function(a){return a.hasStream()});return c?"connected":"connecting";case"TERMINATING":return"terminating";case"TERMINATED":return"terminated";case"PENDING_APPROVAL":return"pending_approval";case"NEW":case"AWAITING_USER_START":return"new";default:new(b("RTWebCallModelTypedLogger"))().setCallID(b("ScotchRTCCallStore").getState().callInfo.callID).setCallModelEvent("invalid_conference_state").log(),g(0,14242,a)}};d.$ScotchCallModelEmitter5=function(a){a=this.$ScotchCallModelEmitter4();if(a!=="terminating"&&a!=="terminated")return null;a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";a=a?b("ScotchFBRTCGroupCallStore").getState().endCallReason:b("ScotchRTCP2PCallStore").getState().endCallReason;return a!==null&&a!==void 0?(a=i[a.getReasonID()])!=null?a:"Unknown":null};d.$ScotchCallModelEmitter6=function(){return b("ScotchRTCCallStore").getState().callInfo.responseSubCode};d.$ScotchCallModelEmitter7=function(a){a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";var c;if(a)c=!0;else{var d=b("ScotchRTCP2PCallStore").getState(),e=d.offerEscalationSupport;d=d.escalationConferenceName;c=e&&d!=null}e=b("ScotchFBRTCGroupCallStore").getState().dominantSpeakerFBID;if(a)b("ScotchRTWebBrowserFeatureSupport").isReplaceTrackSupported()&&b("ScotchRTWebExperiments").shouldUseSingleMediaStream()?d="available":d="group_call_unsupported";else{var f=b("ScotchRTCP2PCallStore").getState(),g=f.callType;f=f.signalingExperiments;g===b("ScotchRTCCallType").AUDIO_ONLY?d="audio_call_unsupported":!b("ScotchFBRTCScreenSharingUtils").canPeerReceiveScreenSharing(f)?d="remote_unsupported":d="available"}g=b("ScotchRTCP2PCallStore").getState().isPoorNetworkQualityShown;f=b("ScotchRTCP2PCallStore").getState();var h=f.isPeerOnMobile;f=f.signalingExperiments;h=h&&b("UserAgent").isBrowser("Firefox");var i=a&&b("gkx")("1409396");i=(!a||i)&&!h;h=!a&&(f.support("multiple_streams_plan_b")||f.support("multiple_streams_unified"));return new(b("ZenonCallFeatures"))({canAddParticipants:c,canReplaceLocalStreams:i,dominantSpeaker:e,screenSharingAvailability:d,supportMultipleStreams:h,poorConnectionStatus:g})};d.$ScotchCallModelEmitter8=function(a,c,d){for(var e=a.streams.toArray(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;for(var i=h.getTracks(),j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;c.set(l.id,new(b("ZenonImmutableMediaTrack"))({trackId:l.id,label:l.label,webrtcStream:h,webrtcTrack:l,enabled:l.enabled,userMuted:Boolean(a.audioStreamMuteStates.get(l.id)),remote:d,contentType:l.kind==="video"?"video":"audio",contentHint:(l=l.contentHint)!=null?l:"",pausedDownlink:a.pausedDownlink}))}}for(var l=a.screenStreams.toArray(),k=Array.isArray(l),j=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(j>=l.length)break;i=l[j++]}else{j=l.next();if(j.done)break;i=j.value}h=i;for(var g=h.getTracks(),f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;i=g[e++]}else{e=g.next();if(e.done)break;i=e.value}i=i;c.set(i.id,new(b("ZenonImmutableMediaTrack"))({trackId:i.id,label:i.label,webrtcStream:h,webrtcTrack:i,enabled:i.enabled,userMuted:Boolean(a.audioStreamMuteStates.get(i.id)),remote:d,contentType:i.kind==="video"?"screen":"audio",contentHint:(i=i.contentHint)!=null?i:"",pausedDownlink:a.pausedDownlink}))}}};d.$ScotchCallModelEmitter9=function(a){a=new Map();this.$ScotchCallModelEmitter8(b("ScotchRTCCallStore").getState().localUser,a,!1);for(var c=b("ScotchRTCCallStore").getState().remoteUsers.toArray(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;this.$ScotchCallModelEmitter8(f,a,!0)}return b("immutable").Map(a)};d.$ScotchCallModelEmitter10=function(a){a=new Map();var c=this.$ScotchCallModelEmitter11(b("ScotchRTCCallStore").getState().localUser,!0);a.set(c.id,c);c=b("ScotchRTCCallStore").getState().remoteUsers.toArray();for(var c=c,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f=this.$ScotchCallModelEmitter11(f,!1);a.set(f.id,f)}f=this.$ScotchCallModelEmitter12();return b("immutable").Map(a).merge(b("immutable").Map(f))};d.$ScotchCallModelEmitter11=function(a,c){var d=a.isMessengerUser?"messenger":a.isGuestUser?"guest":b("FBRTCConfig").isVCEndpointCall()?"workplace":"facebook";c?c=this.$ScotchCallModelEmitter13():(c=this.$ScotchCallModelEmitter14(a.participantState),a.getStream()!=null&&(c="connected"));var e=new Set();for(var f=a.streams.toArray(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;for(var i=i.getTracks(),j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;e.add(l.id)}}for(var l=a.screenStreams.toArray(),k=Array.isArray(l),j=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(j>=l.length)break;i=l[j++]}else{j=l.next();if(j.done)break;i=j.value}h=i;for(var g=h.getTracks(),f=Array.isArray(g),i=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(i>=g.length)break;h=g[i++]}else{i=g.next();if(i.done)break;h=i.value}h=h;e.add(h.id)}}h=new(b("ZenonCallParticipant"))({id:a.FBID,isVideoSubscribed:a.isVideoSubscribed,participantType:d,state:c,trackIDs:b("immutable").Set(e)});return h};d.$ScotchCallModelEmitter13=function(){var a=this.$ScotchCallModelEmitter4();if(a==="terminating"||a==="terminated")return"disconnected";else return"connected"};d.$ScotchCallModelEmitter14=function(a){if(b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway"&&!b("ScotchRTCGroupCallEscalationStore").isInProgress())return this.$ScotchCallModelEmitter15(a);else return this.$ScotchCallModelEmitter16()};d.$ScotchCallModelEmitter15=function(a){if(!a)return"disconnected";a=a.state;switch(a){case b("FBRTCParticipantCallState").DISCONNECTED:case b("FBRTCParticipantCallState").NO_ANSWER:case b("FBRTCParticipantCallState").REJECTED:case b("FBRTCParticipantCallState").UNREACHABLE:case b("FBRTCParticipantCallState").CONNECTION_DROPPED:case b("FBRTCParticipantCallState").PARTICIPANT_LIMIT_REACHED:case b("FBRTCParticipantCallState").IN_ANOTHER_CALL:case b("FBRTCParticipantCallState").RING_TYPE_UNSUPPORTED:case b("FBRTCParticipantCallState").UNKNOWN:return"disconnected";case b("FBRTCParticipantCallState").CONTACTING:return"contacting";case b("FBRTCParticipantCallState").RINGING:return"ringing";case b("FBRTCParticipantCallState").CONNECTING:return"connecting";case b("FBRTCParticipantCallState").CONNECTED:return"connected";case b("FBRTCParticipantCallState").PENDING_APPROVAL:return"pending_approval";case b("FBRTCParticipantCallState").APPROVED:return"approved";case b("FBRTCParticipantCallState").FAILED_APPROVAL:return"failed_approval";default:new(b("RTWebCallModelTypedLogger"))().setCallID(b("ScotchRTCCallStore").getState().callInfo.callID).setCallModelEvent("invalid_participant_state").log(),g(0,14312,a)}};d.$ScotchCallModelEmitter16=function(){var a=b("ScotchRTCP2PCallStore").getState();a=a.connectionStatus;switch(a){case"CONNECTED":return"connected";case"ESCALATING_TO_BJN":case"CONNECTING":return"connecting";case"CONTACTING":return"contacting";case"RECONNECTING":return"reconnecting";case"RINGING":return"ringing";case"PROVISIONAL_RINGING":return"provisional_ringing";case"INIT":case"DISCONNECTED":default:return"disconnected"}};d.$ScotchCallModelEmitter17=function(){var a=b("ScotchRTCCallStore").getState().callInfo.protocol==="multiway";if(a)return null;a=b("ScotchRTCP2PCallEscalationStore").getState();var c=a.awaitingACK,d=a.inProgress,e=a.failureReason,f=a.initiatedEscalation;a=a.escalated;if(a)return null;if(e&&!d)switch(e){case"cancelled":return"VideoEscalationCancelled";case"denied":return"VideoEscalationDeclined";case"timeout":return"VideoEscalationTimedOut"}if(d&&f)return"VideoEscalationPendingPeerFeedback";if(d&&!f&&!c)return"VideoEscalationInitiatedFromPeer";return c?"VideoEscalationAccepted":null};d.$ScotchCallModelEmitter12=function(){var a=new Map(),c=b("ScotchRTCGroupCallEscalationStore").getState().usersToRing;c!==null&&b("ScotchRTCGroupCallEscalationStore").isInProgress()&&c.forEach(function(c){if(c.fbid!=null){c=new(b("ZenonCallParticipant"))({id:c.fbid,participantType:"facebook",state:"precontacting",trackIDs:b("immutable").Set()});a.set(c.id,c)}});return a};d.$ScotchCallModelEmitter18=function(){if(b("ScotchRTCGroupCallEscalationStore").isInProgress())return"GroupEscalationStarted";if(b("ScotchRTCGroupCallEscalationStore").isEscalated())return"GroupEscalationCompleted";return b("ScotchRTCGroupCallEscalationStore").getState().aborted?"GroupEscalationCancelled":null};d.$ScotchCallModelEmitter19=function(){return b("cr:1420073")?b("cr:1420073").getState().inputStates:b("immutable").Map()};d.$ScotchCallModelEmitter20=function(){return b("cr:1420073")?b("cr:1420073").getState().outputStates:b("immutable").Map()};d.$ScotchCallModelEmitter21=function(a){return new(b("ZenonCall"))({callState:this.$ScotchCallModelEmitter4(),collisionContext:this.$ScotchCallModelEmitter3(),clientCallId:a,endCallReason:this.$ScotchCallModelEmitter5(a),responseSubCode:this.$ScotchCallModelEmitter6(),features:this.$ScotchCallModelEmitter7(a),groupEscalationStatus:this.$ScotchCallModelEmitter18(),mediaTracks:this.$ScotchCallModelEmitter9(a),participants:this.$ScotchCallModelEmitter10(a),remoteScreenSharingUserIDs:b("ScotchRTCCallStore").getState().remoteScreenSharingUserIDs,videoEscalationStatus:this.$ScotchCallModelEmitter17(),stateSyncInputStates:this.$ScotchCallModelEmitter19(),stateSyncOutputStates:this.$ScotchCallModelEmitter20(),rtpSenders_I_KNOW_WHAT_I_AM_DOING:this.$ScotchCallModelEmitter22(),rtpReceivers_I_KNOW_WHAT_I_AM_DOING:this.$ScotchCallModelEmitter23()})};d.$ScotchCallModelEmitter22=function(){return b("ScotchRTCCallStore").getState().connections.map(function(a){try{return b("immutable").Set(a.getSenders())}catch(a){b("FBLogger")("rtc_www").catching(a).mustfix("error while trying to getSenders()");return[]}}).flatten().toSet()};d.$ScotchCallModelEmitter23=function(){return b("ScotchRTCCallStore").getState().connections.map(function(a){try{return b("immutable").Set(a.getReceivers())}catch(a){b("FBLogger")("rtc_www").catching(a).mustfix("error while trying to getReceivers()");return[]}}).flatten().toSet()};d.getCallsModel=function(){var a=b("immutable").Map({0:this.$ScotchCallModelEmitter21("0")});return a};d.emitCallsModel=function(){var a=this.getCallsModel();try{var c=JSON.stringify(a);c!==this.$ScotchCallModelEmitter2&&(this.$ScotchCallModelEmitter2=c,this.emit("callsModelUpdate",a))}catch(c){b("FBLogger")("rtc_www").catching(c).mustfix("error while diffing callsModel"),this.$ScotchCallModelEmitter2=null,this.emit("callsModelUpdate",a)}};return c}(b("EventEmitter"));c=new a();e.exports={CallsModelEmitterInstance:c,ScotchCallModelEmitterStores:h}}),null);
__d("PlatformType",[],(function(a,b,c,d,e,f){"use strict";e.exports=Object.freeze({SCOTCH:"Scotch",ZENON:"Zenon"})}),null);
__d("RTWebFluxDebugger",["FluxDebugUtils","WebStorage"],(function(a,b,c,d,e,f){"use strict";var g,h=(g||b("WebStorage")).getLocalStorage(),i=!!(h&&h.getItem("__fluxDebug")==="1"),j=new Map(),k;function a(a,b){Object.keys(b).forEach(function(a){j.set(a,b[a])}),k&&s(),k={dispatcher:a,originalDispatch:a.dispatch,patchedDispatch:null},i&&r()}function l(a){return a&&typeof a.toJS==="function"?a.toJS():a}function c(){var a={};for(var b=j.entries(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];a[f]=l(e.getState())}return a}function m(a,b,c){var d=Date.now(),e=Array.from(j.entries()).map(function(a){var b=a[0];a=a[1];return{name:b,stateBefore:a.getState(),stateAfter:null}});b.call(a,c);if(!i)return;b=Date.now()-d;e=e.map(function(a,b){b=j.get(a.name);return b!=null?babelHelpers["extends"]({},a,{stateAfter:b.getState()}):null}).filter(Boolean);a=c.type;d=babelHelpers.objectWithoutPropertiesLoose(c,["type"]);console.groupCollapsed("Flux:",a);try{n(e)}finally{console.groupEnd()}}function n(a){a.filter(function(a){return a.stateBefore!==a.stateAfter}).forEach(function(a){p(a.name,function(){var c=l(a.stateBefore),d=l(a.stateAfter);c&&d&&b("FluxDebugUtils").diff(c,d).forEach(o)})})}function o(a){var b=a.path.join(".");switch(a.op){case"add":break;case"update":break;case"delete":break}}function p(a,b){q(a,function(){console.group(a),b()})}function q(a,b){try{b()}finally{console.groupEnd()}}function r(){if(!k)return;k.patchedDispatch&&s();k.patchedDispatch=k.dispatcher.dispatch=m.bind(null,k.dispatcher,k.dispatcher.dispatch)}function s(){if(!k||!k.patchedDispatch)return;k.dispatcher.dispatch=k.originalDispatch;k.patchedDispatch=null}window.__fluxDebugOn=function(){i=!0,h&&h.setItem("__fluxDebug","1"),r()};window.__fluxDebugOff=function(){i=!1,h&&h.setItem("__fluxDebug","0"),s()};window.__fluxDump=function(){var a=function(){if(c){if(d>=b.length)return"break";e=b[d++]}else{d=b.next();if(d.done)return"break";e=d.value}var a=e,f=a[0];a=a[1];p(f,function(){return!1})};for(var b=j,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e,f=a();if(f==="break")break}};window.__fluxDumpState=c;e.exports={attach:a,fluxDumpState:c}}),null);
__d("ScotchRTCCallNUXReducer",["ScotchFBRTCUtils","XBasicFBNuxDismissController","XBasicFBNuxViewController"],(function(a,b,c,d,e,f){"use strict";function a(a,c){switch(c.type){case"DISMISS_NUX":var d=b("XBasicFBNuxDismissController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("ScotchFBRTCUtils").sendServerRequest(d);switch(c.nuxID){case 6265:return a.set("showVideoChatFiltersNUX",!1);case 5609:return a.set("showAddGroupMemberNUX",!1);case 4775:return a.set("showRemoteCameraControlsNUX",!1);case 4774:return a.set("showRemoteScreenContentPopOutNUX",!1);case 4773:return a.set("showRemoteStreamsSliderNUX",!1);case 4776:return a.set("showSettingsNUX",!1);default:return a}default:return a}}function c(a,b){switch(b.type){case"INIT_NUX_STATE":b=b.payload;return a.set("showVideoChatFiltersNUX",b.showVideoChatFiltersNUX).set("showAddGroupMemberNUX",b.showAddGroupMemberNUX).set("showRemoteCameraControlsNUX",b.showRemoteCameraControlsNUX).set("showRemoteScreenContentPopOutNUX",b.showRemoteScreenContentPopOutNUX).set("showRemoteStreamsSliderNUX",b.showRemoteStreamsSliderNUX).set("showSettingsNUX",b.showSettingsNUX);default:return a}}function d(a,c){switch(c.type){case"MARK_NUX_VIEWED":c=b("XBasicFBNuxViewController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("ScotchFBRTCUtils").sendServerRequest(c);return a;default:return a}}e.exports={dismissNUX:a,markNUXViewed:d,refreshNUXState:c}}),null);
__d("ScotchRTCCallNUXStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";a={showVideoChatFiltersNUX:!1,showAddGroupMemberNUX:!1,showRemoteCameraControlsNUX:!1,showRemoteScreenContentPopOutNUX:!1,showRemoteStreamsSliderNUX:!1,showSettingsNUX:!1};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c}),null);
__d("ScotchRTCCallNUXStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCCallNUXActions","ScotchRTCCallNUXReducer","ScotchRTCCallNUXStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCCallNUXReducer").dismissNUX,b("ScotchRTCCallNUXReducer").markNUXViewed,b("ScotchRTCCallNUXReducer").refreshNUXState];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("ScotchRTCAppDispatcher"))||this;b("ScotchRTCCallNUXActions").refreshNUXState();return c}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCCallNUXStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a()}),null);
__d("ScotchRTCMediaDevicesActions",["ScotchRTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";a={enumerate:function(a){b("ScotchRTCAppDispatcher").dispatch({type:"ENUMERATE_MEDIA_DEVICES",devices:a})}};e.exports=a}),null);
__d("ScotchRTCMediaDevicesStore",["FBRTCConsoleLogger","FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCMediaDevices","ScotchRTCMediaDevicesActions","ScotchRTWebUserActionLogger"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("ScotchRTCAppDispatcher"))||this;c.$ScotchRTCMediaDevicesStore1();b("ScotchRTCMediaDevices").addEventListener("devicechange",c.$ScotchRTCMediaDevicesStore1);return c}var d=c.prototype;d.$ScotchRTCMediaDevicesStore1=function(){b("ScotchRTCMediaDevices").enumerateDevices().then(function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"enumerateDevices: "+JSON.stringify(a)}),b("ScotchRTCMediaDevicesActions").enumerate(a)})["catch"](function(a){})};d.getInitialState=function(){return null};d.reduce=function(a,b){var c=b.type;b=b.devices;switch(c){case"ENUMERATE_MEDIA_DEVICES":return[].concat(b);default:return a}};d.refresh=function(){this.$ScotchRTCMediaDevicesStore1()};d.getByLabel=function(a,b){var c=this.getState();return!c?null:c.find(function(c){return c.kind===b&&c.label===a})||c.find(function(c){return c.kind===b&&h(c.label,a)})};return c}(b("FluxReduceStore"));a.__moduleID=e.id;var g=/#\d+\s(\([\da-f]{4}:[\da-f]{4}\))$|\s#\d+$/;function h(a,b){return a.replace(g,"$1")===b.replace(g,"$1")}e.exports=new a()}),null);
__d("ScotchRTCUserSettingsReducers",["ScotchRTCMediaDevicesStore"],(function(a,b,c,d,e,f){function a(a,b){switch(b.type){case"USER_SETTINGS_EDIT":return a.set("editing",!0);case"USER_SETTINGS_CANCEL_EDITING":return a.set("editing",!1);case"USER_SETTINGS_SAVE":return a.set("audioInput",b.audioInput).set("audioOutput",b.audioOutput).set("editing",!1).set("videoInput",b.videoInput);case"USER_SETTINGS_SET_AUDIO_INPUT":return a.set("audioInput",b.audioInput);case"USER_SETTINGS_SET_AUDIO_OUTPUT":return a.set("audioOutput",b.audioOutput);case"USER_SETTINGS_SET_VIDEO_INPUT":return a.set("videoInput",b.videoInput);default:return a}}function c(a,b){switch(b.type){case"ADD_LOCAL_STREAM":return a.set("audioInput",g(b.stream.getAudioTracks()[0],"audioinput")||a.audioInput).set("videoInput",g(b.stream.getVideoTracks()[0],"videoinput")||a.videoInput);default:return a}}function g(a,c){if(!a)return null;a=b("ScotchRTCMediaDevicesStore").getByLabel(a.label,c);return a?a.deviceId:null}e.exports={activelySetSettings:a,passivelySetSettings:c}}),null);
__d("ScotchRTCUserSettingsStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({audioInput:null,audioOutput:null,editing:!1,videoInput:null}));e.exports=a}),null);
__d("ScotchRTCUserSettingsStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCUserSettingsReducers","ScotchRTCUserSettingsStoreState"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCUserSettingsReducers").activelySetSettings,b("ScotchRTCUserSettingsReducers").passivelySetSettings];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.call(this,b("ScotchRTCAppDispatcher"))||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCUserSettingsStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a()}),null);
__d("ScotchSignalingEventEmitter",["EventEmitter"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.emitJoinReady=function(a){this.emit("signalingPlatformEvent",{messageType:"joinReady",offer:a})};c.emitParentWindowConnectionTimeout=function(){this.emit("signalingPlatformEvent",{messageType:"parentWindowConnectionTimeout"})};return b}(b("EventEmitter"));c=new a();e.exports=c}),null);
__d("ScotchUtils",["invariant","Promise","regeneratorRuntime","requireCond","ChannelManager","CurrentUser","FBLogger","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConsoleLogger","FBRTCConstants","FBRTCHangupReason","FBRTCLogger","FBRTCMessageListener","MercuryIDs","MessengerParticipants.re","PlatformType","RTCUser","RTWebFluxDebugger","ScotchFBRTCGroupCallStore","ScotchFBRTCMWProtocolStore","ScotchgenerateRTCCallID","ScotchRTCAppData","ScotchRTCAppDispatcher","ScotchRTCCallActions","ScotchRTCCallNotificationStore","ScotchRTCCallNUXStore","ScotchRTCCallStore","ScotchRTCCallType","ScotchRTCCoExperienceStore","ScotchRTCGroupCallActions","ScotchRTCGroupCallEscalationActions","ScotchRTCGroupCallEscalationStore","ScotchRTCMediaDevicesStore","ScotchRTCMWProtocolHandler","ScotchRTCP2PCallActions","ScotchRTCP2PCallEscalationActions","ScotchRTCP2PCallEscalationStore","ScotchRTCP2PCallEscalator","ScotchRTCP2PCallStore","ScotchRTCP2PCallWindowHandler","ScotchRTCP2PLoggerStore","ScotchRTCP2PProtocolHandler","ScotchRTCProxyUserStore","ScotchRTCScreenSharing","cr:1420073","ScotchRTCUserSettingsStore","ScotchRTWebBrowserFeatureSupport","ScotchRTWebClientFeatureGating","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","ScotchSignalingEventEmitter","gkx","immutable","isStringNullOrEmpty","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=b("FBRTCLogger").Key,i=b("ScotchRTWebBrowserFeatureSupport").isReplaceTrackSupported;a=function(){function a(a){this.$2="",this.$1=a}var c=a.prototype;c.initializeSignaling=function(a,c,d){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"initializeSignaling",conferenceName:d});this.$2=d;if(this.$1.getConfigManager().getZenonStartCallImmediatelyConfig().isEnabled())b("ScotchSignalingEventEmitter").emitJoinReady(),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_JoinReady",conferenceName:d});else{c!=null&&b("FBRTCMessageListener").setParentWindowNonce(c);c=b("Promise").race([new(b("Promise"))(function(a){b("FBRTCMessageListener").setParentWindowStartCallHandler(function(b){a({offer:b,isTimeout:!1})})}),new(b("Promise"))(function(a){window.setTimeout(function(){a({offer:null,isTimeout:!0})},2e3)})]);b("promiseDone")(c,function(a){a.isTimeout?(b("FBRTCMessageListener").setParentWindowStartCallHandler(null),b("ScotchSignalingEventEmitter").emitParentWindowConnectionTimeout(),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_ParentWindowConnectionTimeout",conferenceName:d})):(b("ScotchSignalingEventEmitter").emitJoinReady(a.offer),b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Signaling_JoinReady",conferenceName:d}))})}b("FBRTCMessageListener").init(!0,a)};c.initializeV2Infrastructure=function(a,b){b.peerID==="MW_PEER_ID"?this.initializeMW(b):this.initializeP2P(b)};c.initializeP2P=function(a){var c;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:(c=a.callID)==null?void 0:c.toString(),checkpoint:"initializeP2P",conferenceName:a.roomID});c={ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchRTCP2PCallEscalationStore:b("ScotchRTCP2PCallEscalationStore"),ScotchRTCCallNUXStore:b("ScotchRTCCallNUXStore"),ScotchRTCP2PCallStore:b("ScotchRTCP2PCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchRTCP2PLoggerStore:b("ScotchRTCP2PLoggerStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCUserSettingsStore:b("ScotchRTCUserSettingsStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore")};var d=[];for(var e in c)d.push(c[e]);b("gkx")("882839")||d.push(b("ScotchRTCProxyUserStore"));b("ScotchRTCAppDispatcher").explicitlyRegisterStores(d);d=a.roomID;b("isStringNullOrEmpty")(d)&&(d=b("ScotchgenerateRTCCallID")().toString(),b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"ScotchgenerateRTCCallID",conferenceName:d}));b("ScotchRTCCallActions").initialize({protocol:b("FBRTCConstants").SignalingProtocol.P2P,conferenceName:d,serverInfoData:null,callID:d});var f=a.initializeVideo?b("ScotchRTCCallType").AUDIO_VIDEO:b("ScotchRTCCallType").AUDIO_ONLY;b("ScotchRTCP2PCallActions").setCallType(f);b("ChannelManager").startChannelManagerForApp(b("ScotchRTCAppData").getChannelManagerAppName());b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),c);c=a.usersToRing.length===1;b("ScotchRTCP2PCallActions").setIsCaller(c);b("ScotchRTCP2PCallWindowHandler").init(window);a=a.peerID;c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),a,d,c);b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"setCallSummaryFromStorage",conferenceName:d});c.onPopupOpened();c.setCallType(f);c.setActiveConnection("p2p");b("ScotchRTCCallActions").setCallSummary(c);f=b("ScotchRTCP2PCallStore").getState();c=f.protocolHandler;c.init(a,Number(d));f=new(b("RTCUser"))({FBID:b("CurrentUser").getID()});b("ScotchRTCCallActions").initLocalUser(f);c=new(b("RTCUser"))({FBID:a});b("ScotchRTCCallActions").initRemoteUsers(b("immutable").Set.of(c))};c.initializeMW=function(a){var c;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:(c=a.callID)==null?void 0:c.toString(),checkpoint:"initializeMW",conferenceName:a.roomID});b("ChannelManager").startChannelManagerForApp(b("ScotchRTCAppData").getChannelManagerAppName());if(b("cr:1420073")!=null){c={ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore"),ScotchRTCStateSyncStore:b("cr:1420073")};var d=b("gkx")("882839")?{}:{ScotchRTCProxyUserStore:b("ScotchRTCProxyUserStore")};b("ScotchRTCAppDispatcher").explicitlyRegisterStoresInMap(babelHelpers["extends"]({},c,d));b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),c)}else{d={ScotchRTCCallStore:b("ScotchRTCCallStore"),ScotchFBRTCGroupCallStore:b("ScotchFBRTCGroupCallStore"),ScotchRTCCoExperienceStore:b("ScotchRTCCoExperienceStore"),ScotchFBRTCMWProtocolStore:b("ScotchFBRTCMWProtocolStore"),ScotchRTCCallNotificationStore:b("ScotchRTCCallNotificationStore"),ScotchRTCMediaDevicesStore:b("ScotchRTCMediaDevicesStore"),ScotchRTCGroupCallEscalationStore:b("ScotchRTCGroupCallEscalationStore")};c=b("gkx")("882839")?{}:{ScotchRTCProxyUserStore:b("ScotchRTCProxyUserStore")};b("ScotchRTCAppDispatcher").explicitlyRegisterStoresInMap(babelHelpers["extends"]({},d,c));b("RTWebFluxDebugger").attach(b("ScotchRTCAppDispatcher"),d)}b("ScotchRTCGroupCallActions").setLayout(b("FBRTCConstants").GroupVideoViewLayout.GRID);c=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());d={};d[c]=null;c=b("immutable").Map(d);b("ScotchRTCGroupCallActions").initThread(null,c);d=new(b("RTCUser"))({FBID:b("CurrentUser").getID()});b("ScotchRTCCallActions").initLocalUser(d);c=a.callID;d=a.peerID;a=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),d,c,!1);b("ScotchRTCCallActions").setCallSummary(a)};c.join=function(a){b("ScotchRTWebUserActionLogger").logCheckpoint({callID:a.serverCallID,checkpoint:"join",conferenceName:a.roomID});if(k()){a.usersToRing.length<=1||g(0,17639);a.usersToRing.length===0&&(a.peerID!==""||g(0,17640));var c=b("ScotchRTCCallStore").getState().remoteUsers.toArray()[0].FBID;a.peerID===c||g(0,15117,a.peerID,c);if(a.callTrigger===b("FBRTCLogger").Trigger.REDIAL_BUTTON){c=b("ScotchgenerateRTCCallID")().toString();b("ScotchRTCCallActions").resetForRedial(c,c)}c=b("ScotchRTCP2PCallStore").getState();var d=c.protocolHandler;c=m(a.localMedia);for(var e=0;e<c.length;e++){var f=c[e];b("ScotchRTCCallActions").addLocalStream(f)}b("ScotchRTWebUserActionLogger").startTimer("fetchTurnCredentialsTimer");d.fetchTURNCredentials().then(function(){b("ScotchRTWebUserActionLogger").logStopTimer({timerName:"fetchTurnCredentialsTimer",checkpointName:"CallStart_fetchTurnCredentialsTimer"}),d.startCall(a.callTrigger,a.offer)})["catch"](function(){b("FBLogger")("rtc_www").warn("failed to fetch turn credentials"),b("ScotchRTWebUserActionLogger").logError({errorDomain:"failed to fetch turn credentials"})})}else{a.callTrigger===b("FBRTCLogger").Trigger.REDIAL_BUTTON&&b("ScotchRTCCallActions").updateRemoteUsers(b("immutable").Set());f=m(a.localMedia);for(var e=0;e<f.length;e++){c=f[e];b("ScotchRTCCallActions").addLocalStream(c)}c={};c.isEscalatedCall=!1;e=(e=b("ScotchFBRTCGroupCallStore").getState().thread)==null?void 0:(e=e.rtc_call_data)==null?void 0:e.server_info_data;c.serverInfoData=(e=e)!=null?e:a.serverInfoData;c.callTrigger=a.callTrigger;b("ScotchRTWebClientFeatureGating").preferIsacForGroupCalls()&&(c.preferredCodecs={audio:"ISAC/16000"});b("gkx")("1369511")&&(c.connectedOnJoin=!0);b("ScotchRTWebExperiments").shouldSubscribeToSimpleTopicOnJoin()&&(a.initialSyncStates!=null?a.initialSyncStates.set("simple_external",{number:42}):a.initialSyncStates=new Map([["simple_external",{number:42}]]));b("cr:1420073")!=null&&a.initialSyncStates!=null&&(c.initialSyncStates=a.initialSyncStates);e=new(b("ScotchRTCMWProtocolHandler"))(Number(a.serverCallID));e.startCall(a.usersToRing,f,a.roomID,c)}};c.approveParticipants=function(a,b){this.$3(b,1)};c.denyParticipants=function(a,b){this.$3(b,0)};c.$3=function(a,c){var d=b("ScotchRTCCallStore").getState().callInfo,e=d.callID,f=d.conferenceName;d=d.serverInfoData;var g=a.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"[WR] User is setting approval status of "+g+" to "+c,conferenceName:f});b("ScotchRTCMWProtocolHandler").sendApprovalRequest(f,d,a.toArray(),c)};c.unsubscribeFromStateSyncTopic=function(a,c){if(b("cr:1420073")==null)return;a=b("ScotchRTCCallStore").getState().callInfo;var d=a.callID,e=a.conferenceName;a=a.serverInfoData;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:d,checkpoint:"[SS] User is unsubscribing from state with topic: "+c,conferenceName:e});d=b("cr:1420073").setUpdatedInputState(c,null);b("ScotchRTCGroupCallActions").setStateSyncUnsubscribe(c);b("ScotchRTCMWProtocolHandler").sendUnsubscribeRequest(e,a,c,d.version)};c.updateStateSyncTopic=function(a,c,d){if(b("cr:1420073")==null)return;a=b("ScotchRTCCallStore").getState().callInfo;var e=a.callID,f=a.conferenceName;a=a.serverInfoData;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"[SS] User is updating state with topic: "+c,conferenceName:f});e=b("cr:1420073").setUpdatedInputState(c,d);b("ScotchRTCGroupCallActions").setStateSyncSubscribe(c);b("ScotchRTCMWProtocolHandler").sendUpdateRequest(f,a,c,e.version,e.data)};c.muteTrack=function(a,b){this.$4(b,!1)};c.unmuteTrack=function(a,b){this.$4(b,!0)};c.$4=function(a,c){var d=b("ScotchRTCCallStore").getState();d=d.localUser;d=[].concat(d.streams.toArray(),d.screenStreams.toArray());var e=null;for(var d=d,f=Array.isArray(d),g=0,d=f?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=d.length)break;h=d[g++]}else{g=d.next();if(g.done)break;h=g.value}h=h;for(var h=h.getTracks(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{j=h.next();if(j.done)break;k=j.value}k=k;k.id===a&&(e=k)}}if(!e)return;b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Toggle track:"+a+" from:"+e.enabled.toString()+" to:"+c.toString()});if(e.enabled===c)return;e.kind==="audio"?b("ScotchRTCCallActions").toggleMuteAudio(c):e.kind==="video"&&b("ScotchRTCCallActions").toggleMuteVideo(c)};c.endCall=function(a,c,d){if(k()){a=b("FBRTCConstants").endCallReasonFromString(c);var e=b("ScotchRTCCallStore").getState().callInfo.conferenceState;if(e==="NEW"||e==="AWAITING_USER_START"){e=b("ScotchRTCCallStore").getState().callSummary;e.onCallEnded(a,!1,null,"DidNotInitiate");e.save(b("FBRTCCallSummaryStore").getInstance());return}e=b("ScotchRTCP2PCallStore").getState();e=e.protocolHandler;e.endCall(a,d)}else{e=b("ScotchRTCCallStore").getState().callInfo;a=e.conferenceName;e=e.serverInfoData;a=a==null||a==""?this.$2:a;c=n(c);b("ScotchRTCMWProtocolHandler").endCall(a,e,c,d)}};c.ringParticipants=function(a,c){if(c.length===0)return;if(k()){a=c.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.re").getMulti(a,function(a){b("ScotchRTCGroupCallEscalationActions").setUsersToRing(b("immutable").Map(a));a=b("ScotchRTCP2PCallStore").getState();a=a.protocolHandler;a.escalateToMultiway()})}else b("ScotchRTCMWProtocolHandler").addParticipants(b("ScotchRTCCallStore").getState().callInfo.conferenceName,b("ScotchRTCCallStore").getState().callInfo.serverInfoData,c)};c.addLocalTrack=function(a,c){c.contentType==="screen"||g(0,17183);k()||j()||g(0,14970);if(k()){a=b("ScotchRTCP2PCallStore").getState();a=a.protocolHandler;a.startScreenStream(c.webrtcStream)}else b("ScotchRTCMWProtocolHandler").startScreenStream(c.webrtcStream)};c.removeLocalTrack=function(a,c){k()||j()||g(0,14970);a=b("ScotchRTCCallStore").getState();a=a.localUser;a=a.screenStreams.toArray().find(function(a){return a.getTracks().find(function(a){return a.id===c})});if(!a)return;if(k()){var d=b("ScotchRTCP2PCallStore").getState();d=d.protocolHandler;d.stopScreenStream(a);b("ScotchRTCScreenSharing").stop()}else b("ScotchRTCMWProtocolHandler").stopScreenStream(a)};c.replaceLocalTrack=function(a,c,d,e){e===void 0&&(e=!1);a=b("ScotchRTCCallStore").getState();a=a.localUser;if(d.contentType==="screen"){var f=a.screenStreams.toArray().find(function(a){return a.getTracks().find(function(a){return a.id===c})});if(f)if(k()){var h=b("ScotchRTCP2PCallStore").getState();h=h.protocolHandler;h.updateScreenStream(f,d.webrtcStream)}else j()||g(0,21464),b("ScotchRTCMWProtocolHandler").updateScreenStream(f,d.webrtcStream);return b("Promise").resolve()}if(e){var i=a.streams.first();i!==void 0&&i.getTracks().forEach(function(a){a.kind!==d.webrtcTrack.kind&&(d.webrtcStream.addTrack(a),i.removeTrack(a))})}if(k()){b("ScotchRTCP2PProtocolHandler").replaceLocalStream(d.webrtcStream,!0);return b("Promise").resolve()}else{this.$5(a,d);return b("ScotchRTCMWProtocolHandler").updateLocalStream(d.webrtcStream,e)}};c.$5=function(a,b){var c;a=a.streams.toArray();c=(c=a.find(function(a){return(a=(a==null?void 0:(a=a.getAudioTracks())==null?void 0:a.length)>0)!=null?a:!1}))==null?void 0:c.getAudioTracks();a=(a=a.find(function(a){return(a=(a==null?void 0:(a=a.getVideoTracks())==null?void 0:a.length)>0)!=null?a:!1}))==null?void 0:a.getVideoTracks();c=(c=c&&c[0]&&!c[0].enabled)!=null?c:!1;a=(a=a&&a[0]&&!a[0].enabled)!=null?a:!1;if(c){c=b.webrtcStream.getAudioTracks()[0];c!=null&&(c.enabled=!1)}if(a){c=b.webrtcStream.getVideoTracks()[0];c!=null&&(c.enabled=!1)}};c.getCallProtocolType=function(){var a=b("ScotchRTCCallStore").getState().callInfo.protocol;return a==="p2p"?"p2p":a==="multiway"?"multiway":null};c.submitRating=function(a,c,d,e){c!==null&&b("ScotchRTCCallActions").submitRating(c),d!==null&&b("ScotchRTCCallActions").submitFeedback(d),e!==null&&b("ScotchRTCCallActions").submitSurveyChoice(e)};c.setRatingImpression=function(a,c){a&&b("ScotchRTCCallStore").mutateCallSummary(function(a){a.addExtraInfo(h.RATING_SHOWN,"1")}),c&&b("ScotchRTCCallStore").mutateCallSummary(function(a){a.addExtraInfo(h.SURVEY_SHOWN,"1")})};c.acceptVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:l();b("ScotchRTCCallStore").mutateCallSummary(function(a){a.setVidEscalationAcceptedClick(),a.setVidEscalationMediaRequested()});a.prev=2;a.next=5;return b("regeneratorRuntime").awrap(b("ScotchRTCP2PCallEscalator").acceptEscalation());case 5:b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaSuccess()});a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](2),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaFailed()});case 12:case"end":return a.stop()}},null,this,[[2,8]])};c.declineVideoEscalation=function(){l(),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationDeclinedClick()}),b("ScotchRTCP2PCallEscalator").declineEscalation()};c.cancelVideoEscalation=function(){l(),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationInitClick()}),b("ScotchRTCP2PCallEscalationActions").cancel()};c.startVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!k()){a.next=15;break}b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationInitClick()});b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaRequested()});a.prev=3;a.next=6;return b("regeneratorRuntime").awrap(b("ScotchRTCP2PCallEscalator").initEscalation());case 6:b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaSuccess()});a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](3),b("ScotchRTCCallStore").mutateCallSummary(function(a){return a.setVidEscalationMediaFailed()}),b("ScotchRTWebUserActionLogger").logError({errorDomain:"video_escalation_error",errorType:a.t0.toString()});case 13:a.next=16;break;case 15:b("ScotchRTCMWProtocolHandler").escalateLocalStream();case 16:case"end":return a.stop()}},null,this,[[3,9]])};c.removeParticipants=function(a,c){a=b("ScotchRTCCallStore").getState().callInfo;var d=a.conferenceName;a=a.serverInfoData;b("ScotchRTCMWProtocolHandler").removeParticipants(d,a,c)};c.notifyScreenShareStart=function(a){b("ScotchRTCMWProtocolHandler").notifyScreenShareStart(a)};c.notifyScreenShareEnd=function(a){b("ScotchRTCMWProtocolHandler").notifyScreenShareEnd(a)};c.sendCompositingServiceDataMessageRequest=function(a,c,d){a=b("ScotchRTCCallStore").getState().callInfo;var e=a.callID;a=a.conferenceName;b("ScotchRTWebUserActionLogger").logCheckpoint({callID:e,checkpoint:"compositing_service_request",conferenceName:a});b("ScotchRTCMWProtocolHandler").sendCompositingServiceDataMessageRequest(c,d)};c.forceEncodingEnabled=function(a,c){b("ScotchRTCGroupCallActions").forceEncodingEnabled(c)};c.createDataMessageSubscription=function(a,b,c){};c.removeDataMessageSubscription=function(a,b,c){};c.sendGenericDataMessage=function(a,b,c,d,e){};c.logWithLogIdentifiers=function(a,c){a=b("ScotchRTCCallStore").getState();var d=a.callInfo,e=a.callSummary;a=a.remoteUsers;if(k()){var f;c({sharedCallID:d.callID,localCallID:(f=e.localCallID)!=null?f:"",peerID:a.first().FBID})}else{d.serverInfoData!=null||g(0,21793);c({sharedCallID:d.serverInfoData,localCallID:(f=e.localCallID)!=null?f:"",peerID:"MW_PEER_ID"})}};c.subscribeToRemoteVideo=function(a,c,d){a=b("ScotchRTCCallStore").getState();var e=a.callInfo,f=e.callID,g=e.conferenceName,h=e.conferenceState;e=e.protocol;var i=a.remoteUsers;a=h==="TERMINATED"||h==="TERMINATING";a&&b("ScotchRTWebUserActionLogger").logCheckpointOnceForDomain({callID:f,checkpoint:"subscribeToRemoteVideo when call terminated or terminating",conferenceName:g});if(e==="multiway"&&!a){var j=[],k=[];c.forEach(function(a){var b=a.user;a=a.videoQuality;var c=i.find(function(a){return a.FBID===b});if(!c){k.push({error:"remote user doesn't exist",user:b});return}c=c.getActiveStream();c&&c.getVideoTracks().length>0?j.push({stream:c,videoQuality:a}):k.push({error:"no active video track found",user:b})});k.length>0&&b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchUtils.subscribeToRemoteVideo: missing subscriptions: "+JSON.stringify(k)});b("ScotchRTCMWProtocolHandler").subscriptionV2(j,d)}};c.getPlatformType=function(){return b("PlatformType").SCOTCH};c.stopLocalVideo=function(a,c){b("ScotchRTCCallActions").stopLocalVideo()};return a}();function j(){return!k()&&i()&&b("ScotchRTWebExperiments").shouldUseSingleMediaStream()}function k(){return b("ScotchRTCCallStore").getState().callInfo.protocol==="p2p"}function l(){k()||g(0,15678),b("ScotchRTCP2PCallEscalationStore").getState().inProgress||g(0,15713)}function m(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;b.includes(e.webrtcStream)||b.push(e.webrtcStream)}return b}function n(a){switch(a){case"HangupCall":return b("FBRTCHangupReason").HANGUP_CALL;case"IgnoreCall":return b("FBRTCHangupReason").IGNORE_CALL;case"NoAnswerTimeout":return b("FBRTCHangupReason").NO_ANSWER_TIMEOUT;case"InAnotherCall":return b("FBRTCHangupReason").IN_ANOTHER_CALL;case"ClientInterrupted":return b("FBRTCHangupReason").CLIENT_INTERRUPTED;case"ClientError":case"WebRTCError":return b("FBRTCHangupReason").CLIENT_ERROR;default:return b("FBRTCHangupReason").HANGUP_CALL}}e.exports=a}),null);
__d("ZenonCallsContext",["React","ZenonCallSDK","err","immutable"],(function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext({callMediaTypes:b("immutable").Map(),callSDK:new(b("ZenonCallSDK"))({}),callTimers:b("immutable").Map(),calls:b("immutable").Map(),currentClientCallId:"0",endCallHooks:new Set(),setCurrentClientCallId:function(){throw b("err")("setCurrentClientCallId is not implemented!")}});e.exports=c}),null);
__d("ZenonThreadContext",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext(null);e.exports=c}),null);
__d("ZenonThreadHooks",["MercuryIDs","React","ZenonThreadContext"],(function(a,b,c,d,e,f){"use strict";a=b("React");var g=a.useContext,h=a.useDebugValue,i=a.useMemo;c={useThreadFBID:function(){var a=g(b("ZenonThreadContext"));a=a?a.id:null;h(a);return a},useThreadAndCallParticipants:function(){var a=g(b("ZenonThreadContext"));a=a?a.participants:[];h(a);return a},useThreadParticipants:function(){var a=g(b("ZenonThreadContext")),c=(a=a==null?void 0:(a=a.mercuryThread)==null?void 0:a.participants)!=null?a:null;a=i(function(){return c?c.map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)}).filter(Boolean):[]},[c]);h(a);return a},useThreadImage:function(){var a=g(b("ZenonThreadContext"));a=a?a.imageUrl:null;h(a);return a},useThreadType:function(){var a=g(b("ZenonThreadContext"));a=(a=a==null?void 0:a.type)!=null?a:"other";h(a);return a},useThreadName:function(){var a=g(b("ZenonThreadContext"));a=a?a.name:null;h(a);return a},useOngoingCall:function(){var a=g(b("ZenonThreadContext"));a=a?a.hasOngoingCall:null;h(a);return a},useMercuryThread:function(){var a=g(b("ZenonThreadContext"));a=a?a.mercuryThread:null;h(a);return a}};e.exports=c}),null);
__d("ZenonCallsHooks",["CurrentUser","FBLogger","React","ZenonCallsContext","ZenonThreadHooks","immutable","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=b("React");var g=a.useCallback,h=a.useContext,i=a.useDebugValue,j=a.useEffect,k=a.useMemo,l=a.useState,m={useCallConnectedTime:function(){var a=h(b("ZenonCallsContext")),c=a.callTimers;a=a.currentClientCallId;a=(c=c.get(a))!=null?c:null;i(a);return a},useCallParticipant:function(a){var b=null,c=q();if(c){b=(c=c.get(a))!=null?c:null}i(b);return b},useCallParticipants:function(){var a=q();return(a=a)!=null?a:b("immutable").Map()},useCallParticipantsIDs:function(){var a=q(),b=k(function(){return a===null?[]:Array.from(a.keys()).sort()},[a]);i(b);return b},useCallState:function(){var a=o();a=a?a.callState:"new";i(a);return a},useCollisionContext:function(){var a=o();a=(a=a==null?void 0:a.collisionContext)!=null?a:null;i(a);return a},useConnectedCallParticipantsIDs:function(){var a=q(),b=k(function(){if(a!==null&&a.size>0){var b=a.filter(function(a){a=a.state;return a==="connected"});return Array.from(b.keys()).sort()}return[]},[a]);i(b);return b},useConnectedRemoteUserCount:function(){var a=b("CurrentUser").getID(),c=q(),d=k(function(){return c===null?0:c.filter(function(b){var c=b.id;b=b.state;return c!==a&&b==="connected"}).size},[a,c]);i(d);return d},useConnectedRemoteUsersIDs:function(){var a=b("CurrentUser").getID(),c=q(),d=k(function(){if(c!==null&&c.size>0){var b=c.filter(function(b){var c=b.id;b=b.state;return c!==a&&b==="connected"});return Array.from(b.keys()).sort()}return[]},[a,c]);i(d);return d},useCoplayOutputState:function(){var a=o();if(a){a=(a=a.stateSyncOutputStates.get("coplay"))==null?void 0:a.data;return{eligibleParticipants:(a==null?void 0:a.eligibleParticipants)||[],matchState:(a==null?void 0:a.matchState)||null}}return null},useDominantSpeakerID_DEPRECATED:function(){var a=o();a=(a=a==null?void 0:a.features.dominantSpeaker)!=null?a:null;i(a);return a},useEndCallReason:function(){var a=o();a=(a=a==null?void 0:a.endCallReason)!=null?a:null;i(a);return a},useGroupEscalationStatus:function(){var a=o();a=(a=a==null?void 0:a.groupEscalationStatus)!=null?a:null;i(a);return a},useIsAudioCall:function(){var a=h(b("ZenonCallsContext")),c=a.callMediaTypes;a=a.currentClientCallId;c=c.get(a,"audio");i(c);return c==="audio"},useIsP2P_TEMP:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK;a=a.currentClientCallId;c=c.getCallProtocolType_DEPRECATED(a)==="p2p";return c},useLiveMediaTrack:function(a,b){var c=o(),d=null;if(c){a=c.participants.get(a);if(a){d=(a=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).find(function(a){return a.contentType===b&&a.enabled&&a.webrtcTrack.readyState==="live"}))!=null?a:null}}i(d);return d},useMediaTrack_DEBUG:function(a,b){var c=o(),d=null;if(c){a=c.participants.get(a);if(a){d=(a=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).find(function(a){return a.contentType===b}))!=null?a:null}}i(d);return d},useLiveMediaTracks_DEBUG:function(a,c){var d=o(),e=b("immutable").Set();if(d){a=d.participants.get(a);if(a){a=a.trackIDs.map(function(a){return d.mediaTracks.get(a)}).filter(function(a){return a.contentType===c&&a.enabled&&a.webrtcTrack.readyState==="live"});e=a}}i(e);return e},useLocalAudio:function(){var a;a=(a=p().find(function(a){return a.contentType==="audio"}))!=null?a:null;i(a);return a},useLocalScreen:function(){var a;a=(a=p().find(function(a){return a.contentType==="screen"}))!=null?a:null;i(a);return a},useLocalVideo:function(){var a;a=(a=p().find(function(a){return a.contentType==="video"}))!=null?a:null;i(a);return a},usePreContactingRemoteUsersIDs:function(){var a=b("CurrentUser").getID(),c=q(),d=k(function(){if(c!==null&&c.size>0){var b=c.filter(function(b){var c=b.id;b=b.state;return c!==a&&b==="precontacting"});return Array.from(b.keys()).sort()}return[]},[a,c]);i(d);return d},useRemoteScreen:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK;a=a.currentClientCallId;c=c.getCallProtocolType_DEPRECATED(a)==="p2p";a=o();var d=null;if(c){d=a===null?null:(c=a.mediaTracks.find(function(a){return a.remote===!0&&a.contentType==="screen"&&a.enabled}))!=null?c:null}i(d);return d},useRemoteVideoTracks:function(){var a=m.useIsAudioCall(),b=o();a=!a&&b!==null?b.mediaTracks.filter(function(a){return a.remote===!0&&a.contentType==="video"&&a.enabled}).toArray():[];i(a);return a},useResponseSubCode:function(){var a=o();return(a=a==null?void 0:a.responseSubCode)!=null?a:null},useVideoEscalationStatus:function(){var a=o();a=(a=a==null?void 0:a.videoEscalationStatus)!=null?a:null;i(a);return a},useAcceptVideoEscalation:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(){c.acceptVideoEscalation(d)},[c,d])},useAddLocalTrack:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){return c.addLocalTrack(d,a)},[c,d])},useApproveParticipants:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.approveParticipants(d,a)},[c,d])},useCallSpecificState:function(a){if(typeof a==="function")throw b("unrecoverableViolation")("Functional state types will break useCallSpecificState!","rtc_www");var c=h(b("ZenonCallsContext")),d=c.currentClientCallId;c=l(function(){return b("immutable").Map([[d,a]])});var e=c[0],f=c[1];c=g(function(b){typeof b==="function"?f(function(c){return c.set(d,b(c.get(d,a)))}):f(e.set(d,b))},[d,a,e]);j(function(){e.has(d)||f(e.set(d,a))},[d,a,e]);return[e.get(d,a),c]},useCanAddParticipants:function(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.canAddParticipants)!=null?a:!1;i(c);return c},useCanReplaceLocalStreams:function(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.canReplaceLocalStreams)!=null?a:!1;i(c);return c},useCancelVideoEscalation:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(){c.cancelVideoEscalation(d)},[c,d])},useDataMessageSubscription:function(a,c){var d=h(b("ZenonCallsContext")),e=d.callSDK,f=d.currentClientCallId,g=m.useCallState();j(function(){g==="connected"&&e.createDataMessageSubscription(f,a,c);return function(){e.removeDataMessageSubscription(f,a,c)}},[e,g,f,a,c])},useDeclineVideoEscalation:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(){c.declineVideoEscalation(d)},[c,d])},useDenyParticipants:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.denyParticipants(d,a)},[c,d])},useEndCall:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId,e=a.endCallHooks;return g(function(a,b){c.endCall(d,a,b),e.forEach(function(c){return c(a,b)})},[c,d,e])},useGetPlatformType:function(){var a=h(b("ZenonCallsContext"));a=a.callSDK;return a.getPlatformType()},useIsGuest:function(a){var c=m.useCallParticipant(a),d=b("ZenonThreadHooks").useThreadParticipants();return k(function(){return(c==null?void 0:c.participantType)==="guest"||!d.includes(a)},[c,a,d])},useMuteTrack:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.muteTrack(d,a)},[c,d])},useOnCallEnded:function(){var a=h(b("ZenonCallsContext")),c=a.endCallHooks;return g(function(a){c.add(a)},[c])},usePoorConnectionStatus:function(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.poorConnectionStatus)!=null?a:!1;i(c);return c},useRemoteScreenSharingUserIDs_DEPRECATED:function(){var a=o();return(a=a==null?void 0:a.remoteScreenSharingUserIDs)!=null?a:b("immutable").OrderedSet()},useRemoveAllGuestParticipants:function(){var a=m.useCallParticipantsIDs(),c=m.useRemoveParticipants(),d=k(function(){return a.filter(function(a){return b("CurrentUser").getID()!==a})},[a]);return g(function(){c(d)},[d,c])},useRemoveLocalTrack:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){return c.removeLocalTrack(d,a)},[c,d])},useRemoveParticipants:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.removeParticipants(d,a)},[c,d])},useReplaceLocalTrack:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a,b,e){return c.replaceLocalTrack(d,a,b,e)},[c,d])},useRingParticipants:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.ringParticipants(d,a)},[c,d])},useRtpReceivers_I_KNOW_WHAT_I_AM_DOING:function(){var a=o();a=(a=a==null?void 0:a.rtpReceivers_I_KNOW_WHAT_I_AM_DOING.toArray())!=null?a:[];n("useRtpReceivers");i(a);return a},useRtpSenders_I_KNOW_WHAT_I_AM_DOING:function(){var a=o();a=(a=a==null?void 0:a.rtpSenders_I_KNOW_WHAT_I_AM_DOING.toArray())!=null?a:[];n("useRtpSenders");i(a);return a},useScreenSharingAvailability:function(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.screenSharingAvailability)!=null?a:"unknown";i(c);return c},useServerInfoData:function(){var a=m.useCollisionContext();return(a=a==null?void 0:a.serverInfoData)!=null?a:null},useStartVideoEscalation:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(){c.startVideoEscalation(d)},[c,d])},useSubscribeToRemoteVideo:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a,b){c.subscribeToRemoteVideo(d,a,b)},[c,d])},useSupportMultipleStreams:function(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;c=(a=(c=c.get(a))==null?void 0:c.features.supportMultipleStreams)!=null?a:!1;i(c);return c},useUnmuteTrack:function(){var a=h(b("ZenonCallsContext")),c=a.callSDK,d=a.currentClientCallId;return g(function(a){c.unmuteTrack(d,a)},[c,d])}};function n(a){j(function(){b("FBLogger")("ZenonCallsHooks").event(a)},[a])}function o(){var a=h(b("ZenonCallsContext")),c=a.calls;a=a.currentClientCallId;a=(c=c.get(a))!=null?c:null;i(a);return a}function p(){var a=o();a=a==null?void 0:a.mediaTracks;return!a?[]:a.filter(function(a){return a.remote===!1}).toArray()}function q(){var a=o();a=(a=a==null?void 0:a.participants)!=null?a:null;i(a);return a}e.exports=m}),null);
__d("ZenonCallsModelEmitter",["EventEmitter","ZenonCall","ZenonCallParticipant","ZenonDismissReason","ZenonParticipantState","immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonDismissReason").dismissToEndCallReason,h=b("ZenonParticipantState").toCallParticipantState;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$ZenonCallsModelEmitter1=b("immutable").Map(),c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.emitCallsModel=function(a,c){var d=this.$ZenonCallsModelEmitter1.get(a);c=new(b("ZenonCall"))({callState:this.$ZenonCallsModelEmitter2(c),clientCallId:a,collisionContext:c.collisionContext,endCallReason:this.$ZenonCallsModelEmitter3(c),features:c.capabilities,groupEscalationStatus:this.$ZenonCallsModelEmitter4(c),mediaTracks:this.$ZenonCallsModelEmitter5(c),participants:this.$ZenonCallsModelEmitter6(c),rtpReceivers_I_KNOW_WHAT_I_AM_DOING:this.$ZenonCallsModelEmitter7(c),rtpSenders_I_KNOW_WHAT_I_AM_DOING:this.$ZenonCallsModelEmitter8(c),stateSyncInputStates:this.$ZenonCallsModelEmitter9(c),stateSyncOutputStates:this.$ZenonCallsModelEmitter10(c),videoEscalationStatus:this.$ZenonCallsModelEmitter11(c)});d=JSON.stringify(d);var e=JSON.stringify(c);d!==e&&(this.$ZenonCallsModelEmitter1=this.$ZenonCallsModelEmitter1.set(a,c),this.emitCallsModelDelegate(this.$ZenonCallsModelEmitter1))};d.emitCallsModelDelegate=function(a){this.emit("callsModelUpdate",a)};d.$ZenonCallsModelEmitter2=function(a){return i[a.connectionState]};d.$ZenonCallsModelEmitter3=function(a){return a.dismissReason!=null?g(a.dismissReason):null};d.$ZenonCallsModelEmitter4=function(a){return null};d.$ZenonCallsModelEmitter5=function(a){return b("immutable").Map(a.getTracks())};d.$ZenonCallsModelEmitter6=function(a){var c=a.getConsolidatedParticipantStates(),d=a.getUserToTracksMap(),e=a.getTracks();a=b("immutable").Map().withMutations(function(a){c.forEach(function(c,f){a.set(f,new(b("ZenonCallParticipant"))({id:f,participantType:"messenger",state:h(c),trackIDs:b("immutable").Set(d.get(f)).filter(function(a){return e.has(a)})}))})});return a};d.$ZenonCallsModelEmitter9=function(a){return b("immutable").Map(a.getStateSyncInputs())};d.$ZenonCallsModelEmitter10=function(a){return b("immutable").Map(a.getStateSyncOutputs())};d.$ZenonCallsModelEmitter11=function(a){return null};d.$ZenonCallsModelEmitter8=function(a){return b("immutable").Set(a.getRtpSenders_I_KNOW_WHAT_I_AM_DOING())};d.$ZenonCallsModelEmitter7=function(a){return b("immutable").Set(a.getRtpReceivers_I_KNOW_WHAT_I_AM_DOING())};d.getCallsModel=function(){return this.$ZenonCallsModelEmitter1};return c}(b("EventEmitter"));c=new a();var i=Object.freeze({clientInitiatedRenegotiation:"connected",creatingSdp:"connecting",init:"new",peerConnectionRestarting:"connected",pendingApproval:"pending_approval",sdpNegotiated:"connected",sdpRenegotiating:"connected",sdpSet:"connecting",terminated:"terminated",waitingForIncoming:"new"});e.exports={CONNECTION_STATE_TO_CALL_STATE_MAP:i,CallsModelEmitterInstance:c}}),null);
__d("ZenonCapabilities",[],(function(a,b,c,d,e,f){"use strict";function a(a){return"{AddParticipantEnabled : "+String(a.addParticipantEnabled)+"}"}e.exports={capabilitiesToString:a}}),null);
__d("ZenonConnectionInitState",["ZenonCapabilities","ZenonParticipantState"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonCapabilities").capabilitiesToString,h=b("ZenonParticipantState").ZenonParticipantState;a={onCreateConnection:function(a,b){var c;if(b.type!=="createConnection")return;var d=b.payload.direction==="outgoing";b=b.payload;var e=b.dataChannels,f=b.initialSyncStates,i=b.mwRingRequest,j=b.tracks;b=b.usersToRing;var k=d?b:i==null?void 0:(c=i.jsonPayload.body.ringRequest)==null?void 0:c.otherParticipants;a.updateConnectionModel(function(b){k==null?void 0:k.forEach(function(a){b.updateParticipantState(a,h.CONTACTING)}),b.registerTrackFetcher(function(){return a.peerConnectionManager.getTracks()}),b.registerRtpSendersFetcher(function(){return a.peerConnectionManager.getRtpSenders()}),b.registerRtpReceiversFetcher(function(){return a.peerConnectionManager.getRtpReceivers()})});d&&a.signalingClient.sendInvite(b);c=a.getConnectionModel();b=c.capabilities;c=c.selfUserID;b=b.get("canAddParticipants");b=g({addParticipantEnabled:b});a.signalingClient.sendClientInfo(new Map([[c,b]]),f);j&&a.peerConnectionManager.addLocalTracks(j);e&&e.forEach(function(b){return a.peerConnectionManager.createDataChannel(b)});(d||(i==null?void 0:(c=i.jsonPayload.body.ringRequest)==null?void 0:c.offer)==null)&&a.peerConnectionManager.applyLocalSdp()}};e.exports=a}),null);
__d("ZenonConnectionPeerConnectionRestartingState",[],(function(a,b,c,d,e,f){"use strict";a={onAnswerSdpReceived:function(a,b){if(b.type!=="sdpReceived"||b.payload.sdp.type!=="answer")return;b=b.payload;var c=b.mediaStates;b=b.sdp;a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(c.tracks)});a.secondaryPeerConnectionManager.applyRemoteSdp(b,c)},onSecondaryConnectionEstablished:function(a,b){if(b.type!=="connectionEstablished"||b.payload.peerConnectionRole!=="secondary")return{};b=a.peerConnectionManager;var c=a.secondaryPeerConnectionManager,d=a.updateConnectionModel;c.setTrackListenersFromManager(b);d(function(a){a.registerTrackFetcher(function(){return c.getTracks()})});b.end(!1);a.logEvent({mediaMode:a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),name:"callEscalated"});return{peerConnectionManager:c}}};e.exports=a}),null);
__d("ZenonScreenShare",["ZenonExperiments"],(function(a,b,c,d,e,f){"use strict";a={isScreenSharingTrack:function(a){return a.length===1&&a[0].contentType==="screen"&&b("ZenonExperiments").screenShareWithReplaceTrack()}};e.exports=a}),null);
__d("ZenonConnectionSMGuards",["ZenonScreenShare"],(function(a,b,c,d,e,f){"use strict";a={addScreenShareTrackWithReplaceGuard:function(a,c){if(c.type!=="addLocalTracks")return!1;c=c.payload.tracks;return!b("ZenonScreenShare").isScreenSharingTrack(c)?!1:Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return!a.remote&&(a.contentType==="video"||a.contentType==="screen")})},incomingConnectionGuard:function(a,b){return b.type==="createConnection"&&b.payload.direction==="incoming"},outgoingConnectionGuard:function(a,b){return b.type==="createConnection"&&b.payload.direction==="outgoing"},removeScreenShareTrackWithReplaceGuard:function(a,c){if(c.type!=="removeLocalTrack")return!1;c=c.payload.trackID;var d=a.getConnectionModel().getTracks().get(c);if(d==null)return!1;return!b("ZenonScreenShare").isScreenSharingTrack([d])?!1:Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return a.trackId!==d.trackId&&!a.remote&&(a.contentType==="video"||a.contentType==="screen")})},sdpAnswerReceiveGuard:function(a,b){return b.type==="sdpReceived"&&b.payload.sdp.type==="answer"},sdpOfferReceiveGuard:function(a,b){return b.type==="sdpReceived"&&b.payload.sdp.type==="offer"},secondaryPeerConnectionGuard:function(a,b){return b.payload!=null&&b.payload.peerConnectionRole!=null&&b.payload.peerConnectionRole==="secondary"}};e.exports=a}),null);
__d("ZenonConnectionSdpNegotiatedState",["ZenonScreenShare"],(function(a,b,c,d,e,f){"use strict";a={onAddLocalTracks:function(a,b){if(b.type==="addLocalTracks"){b=b.payload.tracks;a.peerConnectionManager.addLocalTracks(b);a.peerConnectionManager.applyLocalSdp()}},onAddScreenShareLocalTrack:function(a,c){if(c.type!=="addLocalTracks")return;c=c.payload.tracks;if(!b("ZenonScreenShare").isScreenSharingTrack(c))return;a.peerConnectionManager.addLocalTracks(c)},onInitiatePeerConnectionRestarting:function(a,b){if(b.type==="initiatePeerConnectionRestarting"){b=a.peerConnectionManager;var c=a.secondaryPeerConnectionManager;c.setLocalMediaStateVersion(b.getLocalMediaStateVersion());c.addLocalTracks(Array.from(b.getTracks().values()).filter(function(a){return!a.remote}));b.getDataChannelLabels().forEach(function(a){c.createDataChannel(a)});c.applyLocalSdp()}},onRemoveLocalTrack:function(a,b){if(b.type==="removeLocalTrack"){b=b.payload.trackID;a.peerConnectionManager.removeLocalTrack(b);a.peerConnectionManager.applyLocalSdp()}},onRemoveScreenShareLocalTrack:function(a,b){if(b.type==="removeLocalTrack"){b=b.payload.trackID;a.peerConnectionManager.removeLocalTrack(b)}},onReplaceLocalTrack:function(a,b){if(b.type!=="replaceLocalTrack")return;b=b.payload;var c=b.replacementTrack;b=b.trackIDToReplace;a.peerConnectionManager.replaceLocalTrack(b,c)}};e.exports=a}),null);
__d("ZenonConnectionSdpSetState",["ZenonParticipantState"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonParticipantState").ZenonParticipantState;a={onConnectionEstablished:function(a,b){b.type==="connectionEstablished"&&(a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,g.CONNECTED)}),a.logEvent({mediaMode:a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),name:"callConnected"}),a.logEvent({name:"connectionReady"}),a.logEvent({isCallOngoing:function(){return a.getConnectionModel().connectionState!=="terminated"},name:"startHeartbeat"}))}};e.exports=a}),null);
__d("ZenonConnectionSharedActions",["ScotchRTWebUserActionLogger","ZenonDismissReason","ZenonParticipantState","immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonDismissReason").mediaErrorToDismissReason,h=b("ZenonParticipantState").ZenonParticipantState;a={onAddParticipants:function(a,b){if(b.type==="addParticipants"){var c=!1,d=b.payload.usersToRing;a.updateConnectionModel(function(a){var b=a.getConsolidatedParticipantStates();d.forEach(function(d){i(d,b)||(a.updateParticipantState(d,h.CONTACTING),c=!0)})});c&&a.signalingClient.sendAddParticipantsMessage(d)}},onAnswerReady:function(a,b){if(b.type==="answerReady"){b=b.payload;var c=b.mediaStates;b=b.sdp;a.signalingClient.sendSdp(b,c)}},onCapabilitiesReceived:function(a,b){if(b.type==="capabilitiesReceived"){var c=b.payload.capabilities;a.updateConnectionModel(function(a){a.updateCapabilities(c)})}},onConnectionDestroyed:function(a,b){if(b.type==="connectionDestroyed"){var c=g(b.payload.error);a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,h.DISCONNECTED),a.dismissReason=c});a.logEvent({name:"connectionDestroyed"});a.logEvent({endCallReason:c,endCallSubreason:b.payload.error,isRemoteEnded:!1,name:"callEnded"})}},onConnectionDropped:function(a,b){b.type==="connectionDropped"&&a.updateConnectionModel(function(a){i(a.selfUserID,a.getConsolidatedParticipantStates())&&a.updateParticipantState(a.selfUserID,h.CONNECTING)})},onCreateDataMessageSubscription:function(a,c){if(c.type==="createDataMessageSubscription"){var d=c.payload.dataChannelLabel;c=c.payload.messageHandler;var e=a.dataMessageSubscriptions.get(d,b("immutable").Set());a=a.dataMessageSubscriptions.set(d,e.add(c));return{dataMessageSubscriptions:a}}return{}},onDataMessageReceived:function(a,b){if(b.type==="dataMessageReceived"){b=b.payload;var c=b.data;b=b.dataChannelLabel;a=a.dataMessageSubscriptions.get(b);a&&a.forEach(function(a){return a(c)})}},onEndConnection:function(a,b){if(b.type==="endConnection"){b=b.payload;var c=b.dismissReason,d=b.dismissReasonSetByRemote,e=b.dismissSubreason;b=b.shouldInformPeer;a.updateConnectionModel(function(a){a.updateParticipantState(a.selfUserID,h.DISCONNECTED),a.dismissReason=c});b&&a.signalingClient.sendDismiss(c);a.logEvent({endCallReason:c,endCallSubreason:e,isRemoteEnded:d,name:"callEnded"});a.peerConnectionManager.end(!0)}},onForceEncodingEnabled:function(a,b){if(b.type!=="forceEncodingEnabled")return;a.peerConnectionManager.forceEncodingEnabled(b.payload.enabled)},onIceCandidateReady:function(a,b){if(b.type==="iceCandidateReady"){var c;b=b.payload.candidate;b={candidateSdpString:b.candidate,sdpMLineIndex:(c=b.sdpMLineIndex)!=null?c:0,sdpMid:(c=b.sdpMid)!=null?c:""};a.signalingClient.sendIceCandidate(b)}},onIceCandidateReceived:function(a,b){if(b.type==="iceCandidateReceived"){b=b.payload;b={candidate:b.candidateSdpString,sdpMLineIndex:b.sdpMLineIndex,sdpMid:b.sdpMid};a.peerConnectionManager.applyRemoteIceCandidate(b)}},onLocalMediaStateUpdateProcessing:function(a,b){if(b.type==="localMediaStateUpdateProcessing"){b=b.payload;var c=b.enabled;b=b.trackID;c?a.peerConnectionManager.unmuteLocalTrack(b):a.peerConnectionManager.muteLocalTrack(b)}},onLocalMediaStateUpdateReady:function(a,b){b.type==="localMediaStateUpdateReady"&&a.signalingClient.sendMediaUpdate(b.payload.mediaStates)},onOfferReady:function(a,b){b.type==="offerReady"&&a.signalingClient.sendSdp(b.payload.sdp,b.payload.mediaStates)},onParticipantUpdateReceivedEvent:function(a,b){if(b.type==="participantUpdateReceived"){var c=b.payload.participantStates;a.updateConnectionModel(function(a){c.forEach(function(b,c){c!==a.selfUserID&&a.updateParticipantState(c,b)})})}},onRemoveDataMessageSubscription:function(a,c){if(c.type==="removeDataMessageSubscription"){var d=c.payload.dataChannelLabel;c=c.payload.messageHandler;var e=a.dataMessageSubscriptions.get(d,b("immutable").Set());a=a.dataMessageSubscriptions.set(d,e["delete"](c));return{dataMessageSubscriptions:a}}return{}},onRemoveParticipants:function(a,b){if(b.type==="removeParticipants"){b=b.payload.usersToRemove;a.signalingClient.sendRemoveParticipantsRequest(b)}},onRoomContextUpdateReceived:function(a,b){if(b.type==="connectionRoomUpdateReceived"){var c=b.payload.context;a.updateConnectionModel(function(a){a.collisionContext=c})}},onSdpReceived:function(a,b){if(b.type==="sdpReceived"){b=b.payload;var c=b.mediaStates;b=b.sdp;a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(c.tracks)});a.peerConnectionManager.applyRemoteSdp(b,c);b.type==="answer"?a.logEvent({name:"answerSdpReceived"}):b.type==="offer"&&a.logEvent({name:"offerSdpReceived"})}},onSendGenericDataMessage:function(a,b){if(b.type==="sendGenericDataMessage"){b=b.payload;var c=b.data,d=b.recipientIDs,e=b.serviceRecipients;b=b.topic;a.signalingClient.sendGenericDataMessage(b,c,d,e)}},onStateSyncUnsubscribe:function(a,b){if(b.type!=="stateSyncUnsubscribe")return;b=b.payload.topic;a.signalingClient.sendStateSyncUnsubscribe(b)},onStateSyncUpdate:function(a,b){if(b.type!=="stateSyncUpdate")return;b=b.payload;var c=b.inputData;b=b.topic;a.signalingClient.sendStateSyncUpdate(b,c)},onStopLocalTrack:function(a,b){if(b.type!=="stopLocalTrack")return;b=b.payload.trackID;a.peerConnectionManager.stopLocalTrack(b)},onSubscriptionRequest:function(a,c){if(c.type!=="subscriptionRequest")return{};var d=c.payload,e=d.includeDominantSpeaker;d=d.subscriptions;var f=a.getConnectionModel(),g=f.getUserToTracksMap(),h=f.getTracks(),i=[],j=new Map(),k=[];d.forEach(function(a){var b=a.user,c=a.videoQuality;j.set(b,null);a=g.get(b);if(!a){k.push({error:"track map doesn't exist",user:b});return}var d=[];a.forEach(function(a){var e=h.get(a);e&&e.webrtcStream.active&&e.contentType==="video"?(i.push({cname:e.webrtcStream.id,options:{videoQuality:c}}),j.set(b,e.webrtcStream.id)):d.push(a)});d.length>0&&k.push({error:"no active video track found. found trackIDs: "+JSON.stringify(d),user:b})});k.length>0&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[ZP] Subscription request errors: "+JSON.stringify(k)});e&&i.push({cname:""});a.signalingClient.sendSubscriptionRequest(i);return{currentVideoSubscriptions:{request:c,userToCnameMap:j}}},onUserApprovalRequest:function(a,b){if(b.type!=="userApprovalRequest")return;b=b.payload;var c=b.approvalStatus;b=b.targetUsers;a.signalingClient.sendUsersApprovalRequest(c,b)}};function i(a,b){b=b.get(a);return b===h.CONNECTED}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("xstate-4.7.7",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){Object.defineProperty(g,"__esModule",{value:!0}),g.STATE_DELIMITER=".",g.EMPTY_ACTIVITY_MAP={},g.DEFAULT_GUARD_TYPE="xstate.guard",g.TARGETLESS_KEY=""}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){Object.defineProperty(l,"__esModule",{value:!0}),l.IS_PRODUCTION=!0}var o=!1;function p(){o||(o=!0,n());return m.exports}var q={},r={exports:q};function s(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a};Object.defineProperty(q,"__esModule",{value:!0});var e=k(),f=p();function g(a){return Object.keys(a)}q.keys=g;function h(a,b,c){c===void 0&&(c=e.STATE_DELIMITER);var d=n(a,c),f=n(b,c);if(J(f))return J(d)?f===d:!1;return J(d)?d in f:g(d).every(function(a){return!(a in f)?!1:h(d[a],f[a])})}q.matchesState=h;function i(a){try{return J(a)||typeof a==="number"?""+a:a.type}catch(a){throw new Error("Events must be strings or objects with a string event.type property.")}}q.getEventType=i;function j(a){try{return J(a)||typeof a==="number"?""+a:I(a)?a.name:a.type}catch(a){throw new Error("Actions must be strings or objects with a string action.type property.")}}q.getActionType=j;function l(a,b){try{return H(a)?a:a.toString().split(b)}catch(b){throw new Error("'"+a+"' is not a valid state path.")}}q.toStatePath=l;function m(a){return typeof a==="object"&&"value"in a&&"context"in a&&"event"in a&&"_event"in a}q.isStateLike=m;function n(a,b){if(m(a))return a.value;if(H(a))return o(a);if(typeof a!=="string")return a;a=l(a,b);return o(a)}q.toStateValue=n;function o(a){if(a.length===1)return a[0];var b={},c=b;for(var d=0;d<a.length-1;d++)d===a.length-2?c[a[d]]=a[d+1]:(c[a[d]]={},c=c[a[d]]);return b}q.pathToStateValue=o;function r(a,b){var c={},d=g(a);for(var e=0;e<d.length;e++){var f=d[e];c[f]=b(a[f],f,a,e)}return c}q.mapValues=r;function s(a,c,d){var e,f,h={};try{for(var i=b(g(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];if(!d(l))continue;h[k]=c(l,k,a)}}catch(a){e={error:a}}finally{try{j&&!j.done&&(f=i["return"])&&f.call(i)}finally{if(e)throw e.error}}return h}q.mapFilterValues=s;q.path=function(a){return function(c){var d,e;c=c;try{for(var f=b(a),g=f.next();!g.done;g=f.next()){var h=g.value;c=c[h]}}catch(a){d={error:a}}finally{try{g&&!g.done&&(e=f["return"])&&e.call(f)}finally{if(d)throw d.error}}return c}};function t(a,c){return function(d){var e,f;d=d;try{for(var g=b(a),h=g.next();!h.done;h=g.next()){var i=h.value;d=d[c][i]}}catch(a){e={error:a}}finally{try{h&&!h.done&&(f=g["return"])&&f.call(g)}finally{if(e)throw e.error}}return d}}q.nestedPath=t;function u(a){if(!a)return[[]];if(J(a))return[[a]];var b=w(g(a).map(function(b){var c=a[b];return typeof c!=="string"&&(!c||!Object.keys(c).length)?[[b]]:u(a[b]).map(function(a){return[b].concat(a)})}));return b}q.toStatePaths=u;function v(a){var c,d,e={};if(a&&a.length===1&&a[0].length===1)return a[0][0];try{for(var a=b(a),f=a.next();!f.done;f=a.next()){var g=f.value,h=e;for(var i=0;i<g.length;i++){var j=g[i];if(i===g.length-2){h[j]=g[i+1];break}h[j]=h[j]||{};h=h[j]}}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=a["return"])&&d.call(a)}finally{if(c)throw c.error}}return e}q.pathsToStateValue=v;function w(a){var b;return(b=[]).concat.apply(b,d(a))}q.flatten=w;function x(a){return H(a)?a:[a]}q.toArrayStrict=x;function y(a){return a===void 0?[]:x(a)}q.toArray=y;function z(a,c,d){var e,f;if(I(a))return a(c,d.data);var h={};try{for(var i=b(g(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];I(l)?h[k]=l(c,d.data):h[k]=l}}catch(a){e={error:a}}finally{try{j&&!j.done&&(f=i["return"])&&f.call(i)}finally{if(e)throw e.error}}return h}q.mapContext=z;function A(a){return/^(done|error)\./.test(a)}q.isBuiltInEvent=A;function B(a){if(a instanceof Promise)return!0;return a!==null&&(I(a)||typeof a==="object")&&I(a.then)?!0:!1}q.isPromiseLike=B;function C(a,d){var e,f,g=c([[],[]],2),h=g[0];g=g[1];try{for(var a=b(a),i=a.next();!i.done;i=a.next()){var j=i.value;d(j)?h.push(j):g.push(j)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(f=a["return"])&&f.call(a)}finally{if(e)throw e.error}}return[h,g]}q.partition=C;function D(a,b){return r(a.states,function(a,c){if(!a)return void 0;c=(J(b)?void 0:b[c])||(a?a.current:void 0);return!c?void 0:{current:c,states:D(a,c)}})}q.updateHistoryStates=D;function E(a,b){return{current:b,states:D(a,b)}}q.updateHistoryValue=E;function F(a,c,d,e){f.IS_PRODUCTION||G(!!a,"Attempting to update undefined context");d=a?d.reduce(function(a,d){var f,h,i=d.assignment;d={state:e,action:d,_event:c};var j={};if(I(i))j=i(a,c.data,d);else try{for(var k=b(g(i)),l=k.next();!l.done;l=k.next()){var m=l.value,n=i[m];j[m]=I(n)?n(a,c.data,d):n}}catch(a){f={error:a}}finally{try{l&&!l.done&&(h=k["return"])&&h.call(k)}finally{if(f)throw f.error}}return Object.assign({},a,j)},a):a;return d}q.updateContext=F;var G=function(){};q.warn=G;f.IS_PRODUCTION||(q.warn=G=function(a,b){var c=a instanceof Error?a:void 0;if(!c&&a)return;if(console!==void 0){a=["Warning: "+b];c&&a.push(c);console.warn.apply(console,a)}});function H(a){return Array.isArray(a)}q.isArray=H;function I(a){return typeof a==="function"}q.isFunction=I;function J(a){return typeof a==="string"}q.isString=J;function K(a,b){if(!a)return void 0;if(J(a))return{type:e.DEFAULT_GUARD_TYPE,name:a,predicate:b?b[a]:void 0};return I(a)?{type:e.DEFAULT_GUARD_TYPE,name:a.name,predicate:a}:a}q.toGuard=K;function L(a){try{return"subscribe"in a&&I(a.subscribe)}catch(a){return!1}}q.isObservable=L;q.symbolObservable=function(){return typeof Symbol==="function"&&Symbol.observable||"@@observable"}();function M(a){try{return"__xstatenode"in a}catch(a){return!1}}q.isMachine=M;function N(a){return!!a&&typeof a.send==="function"}q.isActor=N;q.uniqueId=function(){var a=0;return function(){a++;return a.toString(16)}}();function O(b,c){return J(b)||typeof b==="number"?a({type:b},c):b}q.toEventObject=O;function P(b,c){if(!J(b)&&"$$type"in b&&b.$$type==="scxml")return b;b=O(b);return a({name:b.type,data:b,$$type:"scxml",type:"external"},c)}q.toSCXMLEvent=P;function Q(b,c){c=x(c).map(function(c){return typeof c==="undefined"||typeof c==="string"||M(c)?{target:c,event:b}:a(a({},c),{event:b})});return c}q.toTransitionConfigArray=Q;function R(a){return a===void 0||a===e.TARGETLESS_KEY?void 0:y(a)}q.normalizeTarget=R;function S(a,b,c){if(!f.IS_PRODUCTION){var d=a.stack?" Stacktrace was '"+a.stack+"'":"";if(a===b)console.error("Missing onError handler for invocation '"+c+"', error was '"+a+"'."+d);else{var e=b.stack?" Stacktrace was '"+b.stack+"'":"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '"+c+"'. "+("Original error: '"+a+"'. "+d+" Current error is '"+b+"'."+e))}}}q.reportUnhandledExceptionOnInvocation=S}var t=!1;function u(){t||(t=!0,s());return r.exports}var v={},w={exports:v};function x(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(v,"__esModule",{value:!0});var b=u();function c(c,d){var e,f,g;try{for(var h=a(b.keys(c)),i=h.next();!i.done;i=h.next()){var j=i.value;b.matchesState(j,d)&&(!g||d.length>g.length)&&(g=j)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(f=h["return"])&&f.call(h)}finally{if(e)throw e.error}}return c[g]}v.mapState=c}var y=!1;function z(){y||(y=!0,x());return w.exports}var A={},B={exports:A};function C(){Object.defineProperty(A,"__esModule",{value:!0}),(function(a){a.Start="xstate.start",a.Stop="xstate.stop",a.Raise="xstate.raise",a.Send="xstate.send",a.Cancel="xstate.cancel",a.NullEvent="",a.Assign="xstate.assign",a.After="xstate.after",a.DoneState="done.state",a.DoneInvoke="done.invoke",a.Log="xstate.log",a.Init="xstate.init",a.Invoke="xstate.invoke",a.ErrorExecution="error.execution",a.ErrorCommunication="error.communication",a.ErrorPlatform="error.platform",a.ErrorCustom="xstate.error",a.Update="xstate.update",a.Pure="xstate.pure"})(A.ActionTypes||(A.ActionTypes={})),(function(a){a.Parent="#_parent",a.Internal="#_internal"})(A.SpecialTargets||(A.SpecialTargets={}))}var D=!1;function E(){D||(D=!0,C());return B.exports}var F={},G={exports:F};function H(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},b=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},c=this&&this.__spread||function(){for(var a=[],c=0;c<arguments.length;c++)a=a.concat(b(arguments[c]));return a};Object.defineProperty(F,"__esModule",{value:!0});var d=u();F.isLeafNode=function(a){return a.type==="atomic"||a.type==="final"};function e(a){return d.keys(a.states).map(function(b){return a.states[b]})}F.getChildren=e;function f(a){var b=[a];return F.isLeafNode(a)?b:b.concat(d.flatten(e(a).map(f)))}F.getAllStateNodes=f;function g(b,c){var d,f,g,h,j,k,l,m;b=new Set(b);b=i(b);var n=new Set(c);try{for(var c=a(n),o=c.next();!o.done;o=c.next()){var p=o.value,q=p.parent;while(q&&!n.has(q))n.add(q),q=q.parent}}catch(a){d={error:a}}finally{try{o&&!o.done&&(f=c["return"])&&f.call(c)}finally{if(d)throw d.error}}o=i(n);try{for(var c=a(n),r=c.next();!r.done;r=c.next()){var p=r.value;if(p.type==="compound"&&(!o.get(p)||!o.get(p).length))b.get(p)?b.get(p).forEach(function(a){return n.add(a)}):p.initialStateNodes.forEach(function(a){return n.add(a)});else if(p.type==="parallel")try{for(var s=(j=void 0,a(e(p))),t=s.next();!t.done;t=s.next()){var u=t.value;if(u.type==="history")continue;n.has(u)||(n.add(u),b.get(u)?b.get(u).forEach(function(a){return n.add(a)}):u.initialStateNodes.forEach(function(a){return n.add(a)}))}}catch(a){j={error:a}}finally{try{t&&!t.done&&(k=s["return"])&&k.call(s)}finally{if(j)throw j.error}}}}catch(a){g={error:a}}finally{try{r&&!r.done&&(h=c["return"])&&h.call(c)}finally{if(g)throw g.error}}try{for(var u=a(n),t=u.next();!t.done;t=u.next()){var p=t.value,q=p.parent;while(q&&!n.has(q))n.add(q),q=q.parent}}catch(a){l={error:a}}finally{try{t&&!t.done&&(m=u["return"])&&m.call(u)}finally{if(l)throw l.error}}return n}F.getConfiguration=g;function h(a,b){var c=b.get(a);if(!c)return{};if(a.type==="compound"){a=c[0];if(a){if(F.isLeafNode(a))return a.key}else return{}}var d={};c.forEach(function(a){d[a.key]=h(a,b)});return d}function i(b){var c,d,e=new Map();try{for(var b=a(b),f=b.next();!f.done;f=b.next()){var g=f.value;e.has(g)||e.set(g,[]);g.parent&&(e.has(g.parent)||e.set(g.parent,[]),e.get(g.parent).push(g))}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=b["return"])&&d.call(b)}finally{if(c)throw c.error}}return e}F.getAdjList=i;function j(a,b){b=g([a],b);return h(a,i(b))}F.getValue=j;function k(a,b){if(Array.isArray(a))return a.some(function(a){return a===b});return a instanceof Set?a.has(b):!1}F.has=k;function l(a){return d.flatten(c(new Set(a.map(function(a){return a.ownEvents}))))}F.nextEvents=l;function m(a,b){if(b.type==="compound")return e(b).some(function(b){return b.type==="final"&&k(a,b)});return b.type==="parallel"?e(b).every(function(b){return m(a,b)}):!1}F.isInFinalState=m}var I=!1;function J(){I||(I=!0,H());return G.exports}var K={},L={exports:K};function M(){Object.defineProperty(K,"__esModule",{value:!0});var a=E();K.start=a.ActionTypes.Start;K.stop=a.ActionTypes.Stop;K.raise=a.ActionTypes.Raise;K.send=a.ActionTypes.Send;K.cancel=a.ActionTypes.Cancel;K.nullEvent=a.ActionTypes.NullEvent;K.assign=a.ActionTypes.Assign;K.after=a.ActionTypes.After;K.doneState=a.ActionTypes.DoneState;K.log=a.ActionTypes.Log;K.init=a.ActionTypes.Init;K.invoke=a.ActionTypes.Invoke;K.errorExecution=a.ActionTypes.ErrorExecution;K.errorPlatform=a.ActionTypes.ErrorPlatform;K.error=a.ActionTypes.ErrorCustom;K.update=a.ActionTypes.Update;K.pure=a.ActionTypes.Pure}var N=!1;function O(){N||(N=!0,M());return L.exports}var P={},Q={exports:P};function R(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};Object.defineProperty(P,"__esModule",{value:!0});var c=E(),d=O();P.actionTypes=d;var e=u(),f=u();P.initEvent=e.toSCXMLEvent({type:d.init});function g(a,b){return b?b[a]||void 0:void 0}P.getActionFunction=g;function h(c,d){var f;if(e.isString(c)||typeof c==="number"){var h=g(c,d);e.isFunction(h)?f={type:c,exec:h}:h?f=h:f={type:c,exec:void 0}}else if(e.isFunction(c))f={type:c.name||c.toString(),exec:c};else{var h=g(c.type,d);if(e.isFunction(h))f=a(a({},c),{exec:h});else if(h){d=c.type;var i=b(c,["type"]);f=a(a({type:d},h),i)}else f=c}Object.defineProperty(f,"toString",{value:function(){return f.type},enumerable:!1,configurable:!0});return f}P.toActionObject=h;P.toActionObjects=function(a,b){if(!a)return[];a=f.isArray(a)?a:[a];return a.map(function(a){return h(a,b)})};function i(b){var c=h(b);return a(a({id:e.isString(b)?b:c.id},c),{type:c.type})}P.toActivityDefinition=i;function j(a){return!e.isString(a)?l(a,{to:c.SpecialTargets.Internal}):{type:d.raise,event:a}}P.raise=j;function k(a){return{type:d.raise,_event:e.toSCXMLEvent(a.event)}}P.resolveRaise=k;function l(a,b){return{to:b?b.to:void 0,type:d.send,event:e.isFunction(a)?a:e.toEventObject(a),delay:b?b.delay:void 0,id:b&&b.id!==void 0?b.id:e.isFunction(a)?a.name:e.getEventType(a)}}P.send=l;function m(b,c,d,f){var g={_event:d},h=e.toSCXMLEvent(e.isFunction(b.event)?b.event(c,d.data,g):b.event);if(e.isString(b.delay)){f=f&&f[b.delay];f=e.isFunction(f)?f(c,d.data,g):f}else f=e.isFunction(b.delay)?b.delay(c,d.data,g):b.delay;c=e.isFunction(b.to)?b.to(c,d.data,g):b.to;return a(a({},b),{to:c,_event:h,event:h.data,delay:f})}P.resolveSend=m;function n(b,d){return l(b,a(a({},d),{to:c.SpecialTargets.Parent}))}P.sendParent=n;function o(){return n(d.update)}P.sendUpdate=o;function p(b,c){return l(b,a(a({},c),{to:function(a,b,c){a=c._event;return a.origin}}))}P.respond=p;var q=function(a,b){return{context:a,event:b}};function r(a,b){a===void 0&&(a=q);return{type:d.log,label:b,expr:a}}P.log=r;P.resolveLog=function(b,c,d){return a(a({},b),{value:e.isString(b.expr)?b.expr:b.expr(c,d.data,{_event:d})})};P.cancel=function(a){return{type:d.cancel,sendId:a}};function s(a){a=i(a);return{type:c.ActionTypes.Start,activity:a,exec:void 0}}P.start=s;function t(a){a=i(a);return{type:c.ActionTypes.Stop,activity:a,exec:void 0}}P.stop=t;P.assign=function(a){return{type:d.assign,assignment:a}};function v(a){return typeof a==="object"&&"type"in a}P.isActionObject=v;function w(a,b){b=b?"#"+b:"";return c.ActionTypes.After+"("+a+")"+b}P.after=w;function x(a,b){var d=c.ActionTypes.DoneState+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.done=x;function y(a,b){var d=c.ActionTypes.DoneInvoke+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.doneInvoke=y;function z(a,b){var d=c.ActionTypes.ErrorPlatform+"."+a;a={type:d,data:b};a.toString=function(){return d};return a}P.error=z;function A(a){return{type:c.ActionTypes.Pure,get:a}}P.pure=A;function B(b,c){return l(function(a,b){return b},a(a({},c),{to:b}))}P.forwardTo=B;function C(b,f){return n(function(a,c,f){return{type:d.error,data:e.isFunction(b)?b(a,c,f):b}},a(a({},f),{to:c.SpecialTargets.Parent}))}P.escalate=C}var S=!1;function T(){S||(S=!0,R());return Q.exports}var U={},aa={exports:U};function ba(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a};Object.defineProperty(U,"__esModule",{value:!0});var e=k(),f=u(),g=J(),h=T();function i(a,b){if(a===b)return!0;if(a===void 0||b===void 0)return!1;if(f.isString(a)||f.isString(b))return a===b;var c=f.keys(a),d=f.keys(b);return c.length===d.length&&c.every(function(c){return i(a[c],b[c])})}U.stateValuesEqual=i;function j(a){return f.isString(a)?!1:"value"in a&&"history"in a}U.isState=j;function l(b,c){var d=b.exec,e=a(a({},b),{exec:d!==void 0?function(){return d(c.context,c.event,{action:b,state:c,_event:c._event})}:void 0});return e}U.bindActionToState=l;j=function(){function a(a){this.actions=[],this.activities=e.EMPTY_ACTIVITY_MAP,this.meta={},this.events=[],this.value=a.value,this.context=a.context,this._event=a._event,this._sessionid=a._sessionid,this.event=this._event.data,this.historyValue=a.historyValue,this.history=a.history,this.actions=a.actions||[],this.activities=a.activities||e.EMPTY_ACTIVITY_MAP,this.meta=a.meta||{},this.events=a.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=a.configuration,this.transitions=a.transitions,this.children=a.children,this.done=!!a.done,Object.defineProperty(this,"nextEvents",{get:function(){return g.nextEvents(a.configuration)}})}a.from=function(b,c){if(b instanceof a)return b.context!==c?new a({value:b.value,context:c,_event:b._event,_sessionid:null,historyValue:b.historyValue,history:b.history,actions:[],activities:b.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):b;var d=h.initEvent;return new a({value:b,context:c,_event:d,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})};a.create=function(b){return new a(b)};a.inert=function(b,c){if(b instanceof a){if(!b.actions.length)return b;var d=h.initEvent;return new a({value:b.value,context:c,_event:d,_sessionid:null,historyValue:b.historyValue,history:b.history,activities:b.activities,configuration:b.configuration,transitions:[],children:{}})}return a.from(b,c)};a.prototype.toStrings=function(a,b){var c=this;a===void 0&&(a=this.value);b===void 0&&(b=".");if(f.isString(a))return[a];var e=f.keys(a);return e.concat.apply(e,d(e.map(function(d){return c.toStrings(a[d],b).map(function(a){return d+b+a})})))};a.prototype.toJSON=function(){var a=this;a.configuration;a.transitions;a=b(a,["configuration","transitions"]);return a};a.prototype.matches=function(a){return f.matchesState(a,this.value)};return a}();U.State=j}var ca=!1;function V(){ca||(ca=!0,ba());return aa.exports}var W={},da={exports:W};function ea(){Object.defineProperty(W,"__esModule",{value:!0});function a(a){return{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){return void 0}}},toJSON:function(){return{id:a}}}}W.createNullActor=a;function b(b){var c=a(b.id);c.meta=b;return c}W.createInvocableActor=b;function c(a){try{return typeof a.send==="function"}catch(a){return!1}}W.isActor=c}var fa=!1;function ga(){fa||(fa=!0,ea());return da.exports}var X={},ha={exports:X};function ia(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)},b=this&&this.__rest||function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},c=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},d=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a},e=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(X,"__esModule",{value:!0});var f=u(),g=E(),h=u(),i=V(),j=O(),l=T(),m=p(),n=k(),o=J(),q=ga(),r="",s="#",t="*",v={},w=function(a){return a[0]===s},x=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},y=function(a,b,c){c=c.slice(0,-1).some(function(a){return!("cond"in a)&&!("in"in a)&&(f.isString(a.target)||f.isMachine(a.target))});b=b===r?"the transient event":"event '"+b+"'";f.warn(!c,"One or more transitions for "+b+" on state '"+a.id+"' are unreachable. Make sure that the default transition is the last one defined.")},z=function(){function k(b,c,g){var h=this;this.config=b;this.context=g;this.order=-1;this.__xstatenode=!0;this.__cache={events:void 0,relativeValue:new Map(),initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0};this.idMap={};this.options=Object.assign(x(),c);this.parent=this.options._parent;this.key=this.config.key||this.options._key||this.config.id||"(machine)";this.machine=this.parent?this.parent.machine:this;this.path=this.parent?this.parent.path.concat(this.key):[];this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:n.STATE_DELIMITER);this.id=this.config.id||d([this.machine.key],this.path).join(this.delimiter);this.version=this.parent?this.parent.version:this.config.version;this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&f.keys(this.config.states).length?"compound":this.config.history?"history":"atomic");m.IS_PRODUCTION||f.warn(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '+(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '"+this.type+"'`")+" in the config for state node '"+this.id+"' instead.");this.initial=this.config.initial;this.states=this.config.states?f.mapValues(this.config.states,function(b,c){b=new k(b,{_parent:h,_key:c});Object.assign(h.idMap,a((c={},c[b.id]=b,c),b.idMap));return b}):v;var i=0;function p(a){var b,c;a.order=i++;try{for(var a=e(o.getChildren(a)),d=a.next();!d.done;d=a.next()){var f=d.value;p(f)}}catch(a){b={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(b)throw b.error}}}p(this);this.history=this.config.history===!0?"shallow":this.config.history||!1;this._transient=this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(a){a=a.event;return a===r}):r in this.config.on:!1;this.strict=!!this.config.strict;this.onEntry=f.toArray(this.config.entry||this.config.onEntry).map(function(a){return l.toActionObject(a)});this.onExit=f.toArray(this.config.exit||this.config.onExit).map(function(a){return l.toActionObject(a)});this.meta=this.config.meta;this.data=this.type==="final"?this.config.data:void 0;this.invoke=f.toArray(this.config.invoke).map(function(b,c){var d;if(f.isMachine(b)){h.machine.options.services=a((d={},d[b.id]=b,d),h.machine.options.services);return{type:j.invoke,src:b.id,id:b.id}}else if(typeof b.src!=="string"){d=h.id+":invocation["+c+"]";h.machine.options.services=a((c={},c[d]=b.src,c),h.machine.options.services);return a(a({type:j.invoke,id:d},b),{src:d})}else return a(a({},b),{type:j.invoke,id:b.id||b.src,src:b.src})});this.activities=f.toArray(this.config.activities).concat(this.invoke).map(function(a){return l.toActivityDefinition(a)});this.transition=this.transition.bind(this)}k.prototype._init=function(){if(this.__cache.transitions)return;o.getAllStateNodes(this).forEach(function(a){return a.on})};k.prototype.withConfig=function(b,c){c===void 0&&(c=this.context);var d=this.options,e=d.actions,f=d.activities,g=d.guards,h=d.services;d=d.delays;return new k(this.config,{actions:a(a({},e),b.actions),activities:a(a({},f),b.activities),guards:a(a({},g),b.guards),services:a(a({},h),b.services),delays:a(a({},d),b.delays)},c)};k.prototype.withContext=function(a){return new k(this.config,this.options,a)};Object.defineProperty(k.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,type:this.type,initial:this.initial,history:this.history,states:f.mapValues(this.states,function(a){return a.definition}),on:this.on,transitions:this.transitions,onEntry:this.onEntry,onExit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.data,invoke:this.invoke}},enumerable:!0,configurable:!0});k.prototype.toJSON=function(){return this.definition};Object.defineProperty(k.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var a=this.transitions;return this.__cache.on=a.reduce(function(a,b){a[b.eventType]=a[b.eventType]||[];a[b.eventType].push(b);return a},{})},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!0,configurable:!0});k.prototype.getCandidates=function(a){if(this.__cache.candidates[a])return this.__cache.candidates[a];var b=a===r,c=this.transitions.filter(function(c){var d=c.eventType===a;return b?d:d||c.eventType===t});this.__cache.candidates[a]=c;return c};k.prototype.getDelayedTransitions=function(){var b=this,c=this.config.after;if(!c)return[];var d=function(a,c){c=f.isFunction(a)?b.id+":delay["+c+"]":a;c=l.after(c,b.id);b.onEntry.push(l.send(c,{delay:a}));b.onExit.push(l.cancel(c));return c},e=f.isArray(c)?c.map(function(b,c){c=d(b.delay,c);return a(a({},b),{event:c})}):f.flatten(f.keys(c).map(function(b,e){var g=c[b];g=f.isString(g)?{target:g}:g;var h=isNaN(+b)?b:+b,i=d(h,e);return f.toArray(g).map(function(b){return a(a({},b),{event:i,delay:h})})}));return e.map(function(c){var d=c.delay;return a(a({},b.formatTransition(c)),{delay:d})})};k.prototype.getStateNodes=function(a){var b,c=this;if(!a)return[];var d=a instanceof i.State?a.value:f.toStateValue(a,this.delimiter);if(f.isString(d)){a=this.getStateNode(d).initial;return a!==void 0?this.getStateNodes((b={},b[d]=a,b)):[this.states[d]]}a=f.keys(d);b=a.map(function(a){return c.getStateNode(a)});return b.concat(a.reduce(function(a,b){b=c.getStateNode(b).getStateNodes(d[b]);return a.concat(b)},[]))};k.prototype.handles=function(a){a=f.getEventType(a);return this.events.includes(a)};k.prototype.resolveState=function(b){var c=Array.from(o.getConfiguration([],this.getStateNodes(b.value)));return new i.State(a(a({},b),{value:this.resolve(b.value),configuration:c}))};k.prototype.transitionLeafNode=function(a,b,c){a=this.getStateNode(a);a=a.next(b,c);return!a||!a.transitions.length?this.next(b,c):a};k.prototype.transitionCompoundNode=function(a,b,c){var d=f.keys(a),e=this.getStateNode(d[0]);e=e._transition(a[d[0]],b,c);return!e||!e.transitions.length?this.next(b,c):e};k.prototype.transitionParallelNode=function(a,b,c){var d,g,h={};try{for(var i=e(f.keys(a)),j=i.next();!j.done;j=i.next()){var k=j.value,l=a[k];if(!l)continue;var m=this.getStateNode(k);m=m._transition(l,b,c);m&&(h[k]=m)}}catch(a){d={error:a}}finally{try{j&&!j.done&&(g=i["return"])&&g.call(i)}finally{if(d)throw d.error}}l=f.keys(h).map(function(a){return h[a]});k=f.flatten(l.map(function(a){return a.transitions}));m=l.some(function(a){return a.transitions.length>0});if(!m)return this.next(b,c);a=f.flatten(l.map(function(a){return a.entrySet}));j=f.flatten(f.keys(h).map(function(a){return h[a].configuration}));return{transitions:k,entrySet:a,exitSet:f.flatten(l.map(function(a){return a.exitSet})),configuration:j,source:b,actions:f.flatten(f.keys(h).map(function(a){return h[a].actions}))}};k.prototype._transition=function(a,b,c){if(f.isString(a))return this.transitionLeafNode(a,b,c);return f.keys(a).length===1?this.transitionCompoundNode(a,b,c):this.transitionParallelNode(a,b,c)};k.prototype.next=function(a,b){var c,g,i=this,j=b.name,k=[],l=[],m;try{for(var n=e(this.getCandidates(j)),o=n.next();!o.done;o=n.next()){var p=o.value,q=p.cond,r=p["in"],s=a.context;r=r?f.isString(r)&&w(r)?a.matches(f.toStateValue(this.getStateNodeById(r).path,this.delimiter)):h.matchesState(f.toStateValue(r,this.delimiter),f.path(this.path.slice(0,-2))(a.value)):!0;var t=!1;try{t=!q||this.evaluateGuard(q,s,b,a)}catch(a){throw new Error("Unable to evaluate guard '"+(q.name||q.type)+"' in transition for event '"+j+"' in state node '"+this.id+"':\n"+a.message)}if(t&&r){p.target!==void 0&&(l=p.target);k.push.apply(k,d(p.actions));m=p;break}}}catch(a){c={error:a}}finally{try{o&&!o.done&&(g=n["return"])&&g.call(n)}finally{if(c)throw c.error}}if(!m)return void 0;if(!l.length)return{transitions:[m],entrySet:[],exitSet:[],configuration:a.value?[this]:[],source:a,actions:k};s=f.flatten(l.map(function(b){return i.getRelativeStateNodes(b,a.historyValue)}));q=!!m.internal;t=q?[]:f.flatten(s.map(function(a){return i.nodesFromChild(a)}));return{transitions:[m],entrySet:t,exitSet:q?[]:[this],configuration:s,source:a,actions:k}};k.prototype.nodesFromChild=function(a){if(a.escapes(this))return[];var b=[];a=a;while(a&&a!==this)b.push(a),a=a.parent;b.push(this);return b};k.prototype.escapes=function(a){if(this===a)return!1;var b=this.parent;while(b){if(b===a)return!1;b=b.parent}return!0};k.prototype.evaluateGuard=function(a,b,c,d){var e=this.machine.options.guards;d={state:d,cond:a,_event:c};if(a.type===n.DEFAULT_GUARD_TYPE)return a.predicate(b,c.data,d);e=e[a.type];if(!e)throw new Error("Guard '"+a.type+"' is not implemented on machine '"+this.machine.id+"'.");return e(b,c.data,d)};k.prototype.getActions=function(a,b,g,h){var i,j,k,m;h=o.getConfiguration([],h?this.getStateNodes(h.value):[this]);var n=a.configuration.length?o.getConfiguration(h,a.configuration):h;try{for(var p=e(n),q=p.next();!q.done;q=p.next()){var r=q.value;o.has(h,r)||a.entrySet.push(r)}}catch(a){i={error:a}}finally{try{q&&!q.done&&(j=p["return"])&&j.call(p)}finally{if(i)throw i.error}}try{for(var q=e(h),p=q.next();!p.done;p=q.next()){var r=p.value;(!o.has(n,r)||o.has(a.exitSet,r.parent))&&a.exitSet.push(r)}}catch(a){k={error:a}}finally{try{p&&!p.done&&(m=q["return"])&&m.call(q)}finally{if(k)throw k.error}}a.source||(a.exitSet=[],a.entrySet.push(this));h=f.flatten(a.entrySet.map(function(c){var d=[];if(c.type!=="final")return d;var e=c.parent;d.push(l.done(c.id,c.data),l.done(e.id,c.data?f.mapContext(c.data,b,g):void 0));if(e.parent){c=e.parent;c.type==="parallel"&&(o.getChildren(c).every(function(b){return o.isInFinalState(a.configuration,b)})&&d.push(l.done(c.id,c.data)))}return d}));a.exitSet.sort(function(a,b){return b.order-a.order});a.entrySet.sort(function(a,b){return a.order-b.order});n=new Set(a.entrySet);r=new Set(a.exitSet);p=c([f.flatten(Array.from(n).map(function(a){return d(a.activities.map(function(a){return l.start(a)}),a.onEntry)})).concat(h.map(l.raise)),f.flatten(Array.from(r).map(function(a){return d(a.onExit,a.activities.map(function(a){return l.stop(a)}))}))],2);q=p[0];n=p[1];h=l.toActionObjects(n.concat(a.actions).concat(q),this.machine.options.actions);return h};k.prototype.transition=function(a,b,c){a===void 0&&(a=this.initialState);b=f.toSCXMLEvent(b);var e;if(a instanceof i.State)e=c===void 0?a:this.resolveState(i.State.from(a,c));else{a=f.isString(a)?this.resolve(f.pathToStateValue(this.getResolvedPath(a))):this.resolve(a);c=c?c:this.machine.context;e=this.resolveState(i.State.from(a,c))}if(!m.IS_PRODUCTION&&b.name===t)throw new Error("An event cannot have the wildcard type ('"+t+"')");if(this.strict&&(!this.events.includes(b.name)&&!f.isBuiltInEvent(b.name)))throw new Error("Machine '"+this.id+"' does not accept event '"+b.name+"'");a=this._transition(e.value,e,b)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:e,actions:[]};c=o.getConfiguration([],this.getStateNodes(e.value));c=a.configuration.length?o.getConfiguration(c,a.configuration):c;a.configuration=d(c);return this.resolveTransition(a,e,b)};k.prototype.resolveRaisedTransition=function(a,b,c){var e=a.actions;a=this.transition(a,b);a._event=c;a.event=c.data;(b=a.actions).unshift.apply(b,d(e));return a};k.prototype.resolveTransition=function(b,d,h,k){var n,p,r=this;h===void 0&&(h=l.initEvent);k===void 0&&(k=this.machine.context);var s=b.configuration,t=!d||b.transitions.length>0;t=t?o.getValue(this.machine,s):void 0;var u=d?d.historyValue?d.historyValue:b.source?this.machine.historyValue(d.value):void 0:void 0;k=d?d.context:k;var v=this.getActions(b,k,h,d),w=d?a({},d.activities):{};try{for(var x=e(v),y=x.next();!y.done;y=x.next()){var z=y.value;z.type===j.start?w[z.activity.type]=z:z.type===j.stop&&(w[z.activity.type]=!1)}}catch(a){n={error:a}}finally{try{y&&!y.done&&(p=x["return"])&&p.call(x)}finally{if(n)throw n.error}}z=c(f.partition(v,function(a){return a.type===j.assign}),2);y=z[0];x=z[1];var A=y.length?f.updateContext(k,h,y,d):k;v=f.flatten(x.map(function(a){switch(a.type){case j.raise:return l.resolveRaise(a);case j.send:var b=l.resolveSend(a,A,h,r.machine.options.delays);m.IS_PRODUCTION||f.warn(!f.isString(a.delay)||typeof b.delay==="number","No delay reference for delay expression '"+a.delay+"' was found on machine '"+r.machine.id+"'");return b;case j.log:return l.resolveLog(a,A,h);case j.pure:return a.get(A,h.data)||[];default:return l.toActionObject(a,r.options.actions)}}));z=c(f.partition(v,function(a){return a.type===j.raise||a.type===j.send&&a.to===g.SpecialTargets.Internal}),2);k=z[0];x=z[1];z=v.filter(function(a){return a.type===j.start&&a.activity.type===j.invoke});v=z.reduce(function(b,a){b[a.activity.id]=q.createInvocableActor(a.activity);return b},d?a({},d.children):{});z=t?b.configuration:d?d.configuration:[];var B=z.reduce(function(a,b){b.meta!==void 0&&(a[b.id]=b.meta);return a},{}),C=o.isInFinalState(z,this);u=new i.State({value:t||d.value,context:A,_event:h,_sessionid:d?d._sessionid:null,historyValue:t?u?f.updateHistoryValue(u,t):void 0:d?d.historyValue:void 0,history:!t||b.source?d:void 0,actions:t?x:[],activities:t?w:d?d.activities:{},meta:t?B:d?d.meta:void 0,events:[],configuration:z,transitions:b.transitions,children:v,done:C});u.changed=h.name===j.update||!!y.length;x=u.history;x&&delete x.history;if(!t)return u;w=u;if(!C){B=this._transient||s.some(function(a){return a._transient});B&&(w=this.resolveRaisedTransition(w,{type:j.nullEvent},h));while(k.length){d=k.shift();w=this.resolveRaisedTransition(w,d._event,h)}}z=w.changed||(x?!!w.actions.length||!!y.length||typeof x.value!==typeof w.value||!i.stateValuesEqual(w.value,x.value):void 0);w.changed=z;w.historyValue=u.historyValue;w.history=x;return w};k.prototype.getStateNode=function(a){if(w(a))return this.machine.getStateNodeById(a);if(!this.states)throw new Error("Unable to retrieve child state '"+a+"' from '"+this.id+"'; no child states exist.");var b=this.states[a];if(!b)throw new Error("Child state '"+a+"' does not exist on '"+this.id+"'");return b};k.prototype.getStateNodeById=function(a){a=w(a)?a.slice(s.length):a;if(a===this.id)return this;var b=this.machine.idMap[a];if(!b)throw new Error("Child state node '#"+a+"' does not exist on machine '"+this.id+"'");return b};k.prototype.getStateNodeByPath=function(a){if(typeof a==="string"&&w(a))try{return this.getStateNodeById(a.slice(1))}catch(a){}a=f.toStatePath(a,this.delimiter).slice();var b=this;while(a.length){var c=a.shift();if(!c.length)break;b=b.getStateNode(c)}return b};k.prototype.resolve=function(a){var b,c=this;if(!a)return this.initialStateValue||v;switch(this.type){case"parallel":return f.mapValues(this.initialStateValue,function(b,d){return b?c.getStateNode(d).resolve(a[d]||b):v});case"compound":if(f.isString(a)){var d=this.getStateNode(a);return d.type==="parallel"||d.type==="compound"?(b={},b[a]=d.initialStateValue,b):a}return!f.keys(a).length?this.initialStateValue||{}:f.mapValues(a,function(a,b){return a?c.getStateNode(b).resolve(a):v});default:return a||v}};k.prototype.getResolvedPath=function(a){if(w(a)){var b=this.machine.idMap[a.slice(s.length)];if(!b)throw new Error("Unable to find state node '"+a+"'");return b.path}return f.toStatePath(a,this.delimiter)};Object.defineProperty(k.prototype,"initialStateValue",{get:function(){var a;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var b;if(this.type==="parallel")b=f.mapFilterValues(this.states,function(a){return a.initialStateValue||v},function(a){return!(a.type==="history")});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '"+this.initial+"' not found on '"+this.key+"'");b=o.isLeafNode(this.states[this.initial])?this.initial:(a={},a[this.initial]=this.states[this.initial].initialStateValue,a)}this.__cache.initialStateValue=b;return this.__cache.initialStateValue},enumerable:!0,configurable:!0});k.prototype.getInitialState=function(a,b){a=this.getStateNodes(a);return this.resolveTransition({configuration:a,entrySet:a,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,b)};Object.defineProperty(k.prototype,"initialState",{get:function(){this._init();var a=this.initialStateValue;if(!a)throw new Error("Cannot retrieve initial state from simple state '"+this.id+"'.");return this.getInitialState(a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"target",{get:function(){var a;if(this.type==="history"){var b=this.config;f.isString(b.target)?a=w(b.target)?f.pathToStateValue(this.machine.getStateNodeById(b.target).path.slice(this.path.length-1)):b.target:a=b.target}return a},enumerable:!0,configurable:!0});k.prototype.getRelativeStateNodes=function(a,b,c){c===void 0&&(c=!0);return c?a.type==="history"?a.resolveHistory(b):a.initialStateNodes:[a]};Object.defineProperty(k.prototype,"initialStateNodes",{get:function(){var a=this;if(o.isLeafNode(this))return[this];if(this.type==="compound"&&!this.initial){m.IS_PRODUCTION||f.warn(!1,"Compound state node '"+this.id+"' has no initial state.");return[this]}var b=f.toStatePaths(this.initialStateValue);return f.flatten(b.map(function(b){return a.getFromRelativePath(b)}))},enumerable:!0,configurable:!0});k.prototype.getFromRelativePath=function(a){if(!a.length)return[this];a=c(a);var b=a[0];a=a.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '"+b+"' from node with no states");var d=this.getStateNode(b);if(d.type==="history")return d.resolveHistory();if(!this.states[b])throw new Error("Child state '"+b+"' does not exist on '"+this.id+"'");return this.states[b].getFromRelativePath(a)};k.prototype.historyValue=function(a){return!f.keys(this.states).length?void 0:{current:a||this.initialStateValue,states:f.mapFilterValues(this.states,function(b,c){if(!a)return b.historyValue();c=f.isString(a)?void 0:a[c];return b.historyValue(c||b.initialStateValue)},function(a){return!a.history})}};k.prototype.resolveHistory=function(a){var b=this;if(this.type!=="history")return[this];var c=this.parent;if(!a){var d=this.target;return d?f.flatten(f.toStatePaths(d).map(function(a){return c.getFromRelativePath(a)})):c.initialStateNodes}d=f.nestedPath(c.path,"states")(a).current;return f.isString(d)?[c.getStateNode(d)]:f.flatten(f.toStatePaths(d).map(function(a){return b.history==="deep"?c.getFromRelativePath(a):[c.states[a[0]]]}))};Object.defineProperty(k.prototype,"stateIds",{get:function(){var a=this,b=f.flatten(f.keys(this.states).map(function(b){return a.states[b].stateIds}));return[this.id].concat(b)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"events",{get:function(){var a,b,c,d;if(this.__cache.events)return this.__cache.events;var g=this.states,h=new Set(this.ownEvents);if(g)try{for(var i=e(f.keys(g)),j=i.next();!j.done;j=i.next()){var k=j.value;k=g[k];if(k.states)try{for(var k=(c=void 0,e(k.events)),l=k.next();!l.done;l=k.next()){var m=l.value;h.add(""+m)}}catch(a){c={error:a}}finally{try{l&&!l.done&&(d=k["return"])&&d.call(k)}finally{if(c)throw c.error}}}}catch(b){a={error:b}}finally{try{j&&!j.done&&(b=i["return"])&&b.call(i)}finally{if(a)throw a.error}}return this.__cache.events=Array.from(h)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"ownEvents",{get:function(){var a=new Set(this.transitions.filter(function(a){return!(!a.target&&!a.actions.length&&a.internal)}).map(function(a){return a.eventType}));return Array.from(a)},enumerable:!0,configurable:!0});k.prototype.resolveTarget=function(a){var b=this;return a===void 0?void 0:a.map(function(a){if(!f.isString(a))return a;var c=a[0]===b.delimiter;if(c&&!b.parent)return b.getStateNodeByPath(a.slice(1));c=c?b.key+a:a;if(b.parent)try{a=b.parent.getStateNodeByPath(c);return a}catch(a){throw new Error("Invalid transition definition for state node '"+b.id+"':\n"+a.message)}else return b.getStateNodeByPath(c)})};k.prototype.formatTransition=function(b){var c=this,d=f.normalizeTarget(b.target),e="internal"in b?b.internal:d?d.some(function(a){return f.isString(a)&&a[0]===c.delimiter}):!0,g=this.machine.options.guards;d=this.resolveTarget(d);return a(a({},b),{actions:l.toActionObjects(f.toArray(b.actions)),cond:f.toGuard(b.cond,g),target:d,source:this,internal:e,eventType:b.event})};k.prototype.formatTransitions=function(){var a,c,g=this,h;if(!this.config.on)h=[];else if(Array.isArray(this.config.on))h=this.config.on;else{var i=this.config.on,j=t,k=i[j];k=k===void 0?[]:k;var n=b(i,[typeof j==="symbol"?j:j+""]);h=f.flatten(f.keys(n).map(function(a){var b=f.toTransitionConfigArray(a,n[a]);m.IS_PRODUCTION||y(g,a,b);return b}).concat(f.toTransitionConfigArray(t,k)))}i=this.config.onDone?f.toTransitionConfigArray(String(l.done(this.id)),this.config.onDone):[];j=f.flatten(this.invoke.map(function(a){var b=[];a.onDone&&b.push.apply(b,d(f.toTransitionConfigArray(String(l.doneInvoke(a.id)),a.onDone)));a.onError&&b.push.apply(b,d(f.toTransitionConfigArray(String(l.error(a.id)),a.onError)));return b}));k=this.after;i=f.flatten(d(i,j,h).map(function(a){return f.toArray(a).map(function(a){return g.formatTransition(a)})}));try{for(var j=e(k),h=j.next();!h.done;h=j.next()){k=h.value;i.push(k)}}catch(b){a={error:b}}finally{try{h&&!h.done&&(c=j["return"])&&c.call(j)}finally{if(a)throw a.error}}return i};return k}();X.StateNode=z}var ja=!1;function ka(){ja||(ja=!0,ia());return ha.exports}var Y={},la={exports:Y};function ma(){Object.defineProperty(Y,"__esModule",{value:!0});var a=ka();function b(b,c,d){d===void 0&&(d=b.context);d=typeof d==="function"?d():d;return new a.StateNode(b,c,d)}Y.Machine=b;function c(b,c){var d=typeof b.context==="function"?b.context():b.context;return new a.StateNode(b,c,d)}Y.createMachine=c}var na=!1;function oa(){na||(na=!0,ma());return la.exports}var pa={},qa={exports:pa};function ra(){var a=this&&this.__assign||function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)};Object.defineProperty(pa,"__esModule",{value:!0});var b={deferEvents:!1},c=function(){function c(c){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=a(a({},b),c)}c.prototype.initialize=function(a){this.initialized=!0;if(a){if(!this.options.deferEvents){this.schedule(a);return}this.process(a)}this.flushEvents()};c.prototype.schedule=function(a){if(!this.initialized||this.processingEvent){this.queue.push(a);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(a);this.flushEvents()};c.prototype.clear=function(){this.queue=[]};c.prototype.flushEvents=function(){var a=this.queue.shift();while(a)this.process(a),a=this.queue.shift()};c.prototype.process=function(a){this.processingEvent=!0;try{a()}catch(a){this.clear();throw a}finally{this.processingEvent=!1}};return c}();pa.Scheduler=c}var sa=!1;function ta(){sa||(sa=!0,ra());return qa.exports}var ua={},va={exports:ua};function wa(){Object.defineProperty(ua,"__esModule",{value:!0});var a=new Map(),b=0;ua.registry={bookId:function(){return"x:"+b++},register:function(b,c){a.set(b,c);return b},get:function(b){return a.get(b)},free:function(b){a["delete"](b)}}}var xa=!1;function ya(){xa||(xa=!0,wa());return va.exports}var za={},Aa={exports:za};function Ba(){Object.defineProperty(za,"__esModule",{value:!0});var a=p();function b(){var a=window;return a.__xstate__?a.__xstate__:void 0}function c(c){if(a.IS_PRODUCTION||typeof window==="undefined")return;var d=b();d&&d.register(c)}za.registerService=c}var Ca=!1;function Da(){Ca||(Ca=!0,Ba());return Aa.exports}var Z={},Ea={exports:Z};function Fa(){var b=this&&this.__assign||function(){b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return b.apply(this,arguments)},c=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},d=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e},e=this&&this.__spread||function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(d(arguments[b]));return a};Object.defineProperty(Z,"__esModule",{value:!0});var f=E(),g=V(),h=O(),i=T(),j=p(),k=u(),l=ta(),m=ga(),n=J(),o=ya(),q=Da(),r={sync:!1,autoForward:!1},s=function(){var a=[];return function(b,c){b&&a.push(b);c=c(b||a[a.length-1]);b&&a.pop();return c}}(),t;(function(a){a[a.NotStarted=0]="NotStarted",a[a.Running=1]="Running",a[a.Stopped=2]="Stopped"})(t||(t={}));var v=function(){function d(a,c){var e=this;c===void 0&&(c=d.defaultOptions);this.machine=a;this.scheduler=new l.Scheduler();this.delayedEventsMap={};this.listeners=new Set();this.contextListeners=new Set();this.stopListeners=new Set();this.doneListeners=new Set();this.eventListeners=new Set();this.sendListeners=new Set();this.initialized=!1;this._status=t.NotStarted;this.children=new Map();this.forwardTo=new Set();this.init=this.start;this.send=function(a,b){if(k.isArray(a)){e.batch(a);return e.state}var c=k.toSCXMLEvent(k.toEventObject(a,b));if(e._status===t.Stopped){j.IS_PRODUCTION||k.warn(!1,'Event "'+c.name+'" was sent to stopped service "'+e.machine.id+'". This service has already reached its final state, and will not transition.\nEvent: '+JSON.stringify(c.data));return e.state}if(e._status===t.NotStarted&&e.options.deferEvents)j.IS_PRODUCTION||k.warn(!1,'Event "'+c.name+'" was sent to uninitialized service "'+e.machine.id+'" and is deferred. Make sure .start() is called for this service.\nEvent: '+JSON.stringify(c.data));else if(e._status!==t.Running)throw new Error('Event "'+c.name+'" was sent to uninitialized service "'+e.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: '+JSON.stringify(c.data));e.scheduler.schedule(function(){e.forward(c);var a=e.nextState(c);e.update(a,c)});return e._state};this.sendTo=function(a,c){var d=e.parent&&(c===f.SpecialTargets.Parent||e.parent.id===c),g=d?e.parent:m.isActor(c)?c:e.children.get(c)||o.registry.get(c);if(!g){if(!d)throw new Error("Unable to send event to child '"+c+"' from service '"+e.id+"'.");j.IS_PRODUCTION||k.warn(!1,"Service '"+e.id+"' has no parent: unable to send event "+a.type);return}"machine"in g?g.send(b(b({},a),{name:a.name===h.error?""+i.error(e.id):a.name,origin:e.sessionId})):g.send(a.data)};c=b(b({},d.defaultOptions),c);var g=c.clock,n=c.logger,p=c.parent,q=c.id;q=q!==void 0?q:a.id;this.id=q;this.logger=n;this.clock=g;this.parent=p;this.options=c;this.scheduler=new l.Scheduler({deferEvents:this.options.deferEvents});this.sessionId=o.registry.bookId()}Object.defineProperty(d.prototype,"initialState",{get:function(){var a=this;return this._initialState?this._initialState:s(this,function(){a._initialState=a.machine.initialState;return a._initialState})},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"state",{get:function(){j.IS_PRODUCTION||k.warn(this._status!==t.NotStarted,"Attempted to read state from uninitialized service '"+this.id+"'. Make sure the service is started first.");return this._state},enumerable:!0,configurable:!0});d.prototype.execute=function(a,b){var d,e;try{for(var f=c(a.actions),g=f.next();!g.done;g=f.next()){var h=g.value;this.exec(h,a,b)}}catch(a){d={error:a}}finally{try{g&&!g.done&&(e=f["return"])&&e.call(f)}finally{if(d)throw d.error}}};d.prototype.update=function(a,b){var d,e,f,g,h,j,l,m,o=this;a._sessionid=this.sessionId;this._state=a;this.options.execute&&this.execute(this.state);this.devTools&&this.devTools.send(b.data,a);if(a.event)try{for(var p=c(this.eventListeners),q=p.next();!q.done;q=p.next()){var r=q.value;r(a.event)}}catch(a){d={error:a}}finally{try{q&&!q.done&&(e=p["return"])&&e.call(p)}finally{if(d)throw d.error}}try{for(var q=c(this.listeners),p=q.next();!p.done;p=q.next()){var r=p.value;r(a,a.event)}}catch(a){f={error:a}}finally{try{p&&!p.done&&(g=q["return"])&&g.call(q)}finally{if(f)throw f.error}}try{for(var p=c(this.contextListeners),q=p.next();!q.done;q=p.next()){var s=q.value;s(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(a){h={error:a}}finally{try{q&&!q.done&&(j=p["return"])&&j.call(p)}finally{if(h)throw h.error}}s=n.isInFinalState(a.configuration||[],this.machine);if(this.state.configuration&&s){q=a.configuration.find(function(a){return a.type==="final"&&a.parent===o.machine});p=q&&q.data?k.mapContext(q.data,a.context,b):void 0;try{for(var s=c(this.doneListeners),q=s.next();!q.done;q=s.next()){var r=q.value;r(i.doneInvoke(this.id,p))}}catch(a){l={error:a}}finally{try{q&&!q.done&&(m=s["return"])&&m.call(s)}finally{if(l)throw l.error}}this.stop()}};d.prototype.onTransition=function(a){this.listeners.add(a);this._status===t.Running&&a(this.state,this.state.event);return this};d.prototype.subscribe=function(a,b,c){var d=this;if(!a)return{unsubscribe:function(){return void 0}};var e,f=c;typeof a==="function"?e=a:(e=a.next.bind(a),f=a.complete.bind(a));this.listeners.add(e);this._status===t.Running&&e(this.state);f&&this.onDone(f);return{unsubscribe:function(){e&&d.listeners["delete"](e),f&&d.doneListeners["delete"](f)}}};d.prototype.onEvent=function(a){this.eventListeners.add(a);return this};d.prototype.onSend=function(a){this.sendListeners.add(a);return this};d.prototype.onChange=function(a){this.contextListeners.add(a);return this};d.prototype.onStop=function(a){this.stopListeners.add(a);return this};d.prototype.onDone=function(a){this.doneListeners.add(a);return this};d.prototype.off=function(a){this.listeners["delete"](a);this.eventListeners["delete"](a);this.sendListeners["delete"](a);this.stopListeners["delete"](a);this.doneListeners["delete"](a);this.contextListeners["delete"](a);return this};d.prototype.start=function(a){var b=this;if(this._status===t.Running)return this;o.registry.register(this.sessionId,this);this.initialized=!0;this._status=t.Running;var c=a===void 0?this.initialState:s(this,function(){return g.isState(a)?b.machine.resolveState(a):b.machine.resolveState(g.State.from(a,b.machine.context))});this.options.devTools&&this.attachDev();this.scheduler.initialize(function(){b.update(c,i.initEvent)});return this};d.prototype.stop=function(){var a,b,d,e,f,g,h,i,j,l;try{for(var m=c(this.listeners),n=m.next();!n.done;n=m.next()){var p=n.value;this.listeners["delete"](p)}}catch(b){a={error:b}}finally{try{n&&!n.done&&(b=m["return"])&&b.call(m)}finally{if(a)throw a.error}}try{for(var n=c(this.stopListeners),m=n.next();!m.done;m=n.next()){var p=m.value;p();this.stopListeners["delete"](p)}}catch(a){d={error:a}}finally{try{m&&!m.done&&(e=n["return"])&&e.call(n)}finally{if(d)throw d.error}}try{for(var m=c(this.contextListeners),n=m.next();!n.done;n=m.next()){var p=n.value;this.contextListeners["delete"](p)}}catch(a){f={error:a}}finally{try{n&&!n.done&&(g=m["return"])&&g.call(m)}finally{if(f)throw f.error}}try{for(var n=c(this.doneListeners),m=n.next();!m.done;m=n.next()){var p=m.value;this.doneListeners["delete"](p)}}catch(a){h={error:a}}finally{try{m&&!m.done&&(i=n["return"])&&i.call(n)}finally{if(h)throw h.error}}this.children.forEach(function(a){k.isFunction(a.stop)&&a.stop()});try{for(var p=c(k.keys(this.delayedEventsMap)),m=p.next();!m.done;m=p.next()){n=m.value;this.clock.clearTimeout(this.delayedEventsMap[n])}}catch(a){j={error:a}}finally{try{m&&!m.done&&(l=p["return"])&&l.call(p)}finally{if(j)throw j.error}}this.scheduler.clear();this.initialized=!1;this._status=t.Stopped;o.registry.free(this.sessionId);return this};d.prototype.batch=function(a){var b=this;if(this._status===t.NotStarted&&this.options.deferEvents)j.IS_PRODUCTION||k.warn(!1,a.length+' event(s) were sent to uninitialized service "'+this.machine.id+'" and are deferred. Make sure .start() is called for this service.\nEvent: '+JSON.stringify(event));else if(this._status!==t.Running)throw new Error(a.length+' event(s) were sent to uninitialized service "'+this.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.');this.scheduler.schedule(function(){var d,f,h=b.state,i=!1,j=[],l=function(a){var c=k.toSCXMLEvent(a);b.forward(c);h=s(b,function(){return b.machine.transition(h,c)});j.push.apply(j,e(h.actions.map(function(a){return g.bindActionToState(a,h)})));i=i||!!h.changed};try{for(var m=c(a),n=m.next();!n.done;n=m.next()){var o=n.value;l(o)}}catch(a){d={error:a}}finally{try{n&&!n.done&&(f=m["return"])&&f.call(m)}finally{if(d)throw d.error}}h.changed=i;h.actions=j;b.update(h,k.toSCXMLEvent(a[a.length-1]))})};d.prototype.sender=function(a){return this.send.bind(this,a)};d.prototype.nextState=function(a){var b=this,c=k.toSCXMLEvent(a);if(c.name.indexOf(h.errorPlatform)===0&&!this.state.nextEvents.some(function(a){return a.indexOf(h.errorPlatform)===0}))throw c.data.data;a=s(this,function(){return b.machine.transition(b.state,c)});return a};d.prototype.forward=function(a){var b,d;try{for(var e=c(this.forwardTo),f=e.next();!f.done;f=e.next()){var g=f.value,h=this.children.get(g);if(!h)throw new Error("Unable to forward event '"+a+"' from interpreter '"+this.id+"' to nonexistant child '"+g+"'.");h.send(a)}}catch(a){b={error:a}}finally{try{f&&!f.done&&(d=e["return"])&&d.call(e)}finally{if(b)throw b.error}}};d.prototype.defer=function(a){var b=this;this.delayedEventsMap[a.id]=this.clock.setTimeout(function(){a.to?b.sendTo(a._event,a.to):b.send(a._event)},a.delay)};d.prototype.cancel=function(a){this.clock.clearTimeout(this.delayedEventsMap[a]),delete this.delayedEventsMap[a]};d.prototype.exec=function(a,b,c){var d=b.context;b=b._event;c=i.getActionFunction(a.type,c)||a.exec;c=k.isFunction(c)?c:c?c.exec:a.exec;if(c)try{return c(d,b.data,{action:a,state:this.state,_event:b})}catch(a){this.parent&&this.parent.send({type:"xstate.error",data:a});throw a}switch(a.type){case h.send:c=a;if(typeof c.delay==="number"){this.defer(c);return}else c.to?this.sendTo(c._event,c.to):this.send(c._event);break;case h.cancel:this.cancel(a.sendId);break;case h.start:c=a.activity;if(!this.state.activities[c.type])break;if(c.type===f.ActionTypes.Invoke){var e=this.machine.options.services?this.machine.options.services[c.src]:void 0,g=c.id,l=c.data;j.IS_PRODUCTION||k.warn(!("forward"in c),"`forward` property is deprecated (found in invocation of '"+c.src+"' in in machine '"+this.machine.id+"'). Please use `autoForward` instead.");var m="autoForward"in c?c.autoForward:!!c.forward;if(!e){j.IS_PRODUCTION||k.warn(!1,"No service found for invocation '"+c.src+"' in machine '"+this.machine.id+"'.");return}e=k.isFunction(e)?e(d,b.data):e;k.isPromiseLike(e)?this.state.children[g]=this.spawnPromise(Promise.resolve(e),g):k.isFunction(e)?this.state.children[g]=this.spawnCallback(e,g):k.isObservable(e)?this.state.children[g]=this.spawnObservable(e,g):k.isMachine(e)&&(this.state.children[g]=this.spawnMachine(l?e.withContext(k.mapContext(l,d,b)):e,{id:g,autoForward:m}))}else this.spawnActivity(c);break;case h.stop:this.stopChild(a.activity.id);break;case h.log:l=a.label;d=a.value;l?this.logger(l,d):this.logger(d);break;default:j.IS_PRODUCTION||k.warn(!1,"No implementation found for action type '"+a.type+"'");break}return void 0};d.prototype.stopChild=function(a){var b=this.children.get(a);if(!b)return;this.children["delete"](a);this.forwardTo["delete"](a);delete this.state.children[a];k.isFunction(b.stop)&&b.stop()};d.prototype.spawn=function(a,c,d){if(k.isPromiseLike(a))return this.spawnPromise(Promise.resolve(a),c);else if(k.isFunction(a))return this.spawnCallback(a,c);else if(m.isActor(a))return this.spawnActor(a);else if(k.isObservable(a))return this.spawnObservable(a,c);else if(k.isMachine(a))return this.spawnMachine(a,b(b({},d),{id:c}));else throw new Error('Unable to spawn entity "'+c+'" of type "'+typeof a+'".')};d.prototype.spawnMachine=function(a,c){var e=this;c===void 0&&(c={});var f=new d(a,b(b({},this.options),{parent:this,id:c.id||a.id}));a=b(b({},r),c);a.sync&&f.onTransition(function(a){e.send(h.update,{state:a,id:f.id})});f.onDone(function(a){e.send(k.toSCXMLEvent(a,{origin:f.id}))}).start();c=f;this.children.set(f.id,c);a.autoForward&&this.forwardTo.add(f.id);return c};d.prototype.spawnPromise=function(a,b){var c=this,d=!1;a.then(function(a){d||c.send(k.toSCXMLEvent(i.doneInvoke(b,a),{origin:b}))},function(a){if(!d){var e=i.error(b,a);try{c.send(k.toSCXMLEvent(e,{origin:b}))}catch(d){k.reportUnhandledExceptionOnInvocation(a,d,b),c.devTools&&c.devTools.send(e,c.state),c.machine.strict&&c.stop()}}});var e={id:b,send:function(){return void 0},subscribe:function(b,c,d){var e=!1;a.then(function(a){if(e)return;b&&b(a);if(e)return;d&&d()},function(a){if(e)return;c(a)});return{unsubscribe:function(){return e=!0}}},stop:function(){d=!0},toJSON:function(){return{id:b}}};this.children.set(b,e);return e};d.prototype.spawnCallback=function(a,b){var c=this,d=!1,e=new Set(),f=new Set(),g=function(a){f.forEach(function(b){return b(a)});if(d)return;c.send(a)},h;try{h=a(g,function(a){e.add(a)})}catch(a){this.send(i.error(b,a))}if(k.isPromiseLike(h))return this.spawnPromise(h,b);a={id:b,send:function(a){return e.forEach(function(b){return b(a)})},subscribe:function(a){f.add(a);return{unsubscribe:function(){f["delete"](a)}}},stop:function(){d=!0,k.isFunction(h)&&h()},toJSON:function(){return{id:b}}};this.children.set(b,a);return a};d.prototype.spawnObservable=function(a,b){var c=this,d=a.subscribe(function(a){c.send(k.toSCXMLEvent(a,{origin:b}))},function(a){c.send(k.toSCXMLEvent(i.error(b,a),{origin:b}))},function(){c.send(k.toSCXMLEvent(i.doneInvoke(b),{origin:b}))}),e={id:b,send:function(){return void 0},subscribe:function(b,c,d){return a.subscribe(b,c,d)},stop:function(){return d.unsubscribe()},toJSON:function(){return{id:b}}};this.children.set(b,e);return e};d.prototype.spawnActor=function(a){this.children.set(a.id,a);return a};d.prototype.spawnActivity=function(a){var b=this.machine.options&&this.machine.options.activities?this.machine.options.activities[a.type]:void 0;if(!b){j.IS_PRODUCTION||k.warn(!1,"No implementation found for activity '"+a.type+"'");return}b=b(this.state.context,a);this.spawnEffect(a.id,b)};d.prototype.spawnEffect=function(a,b){this.children.set(a,{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){return void 0}}},stop:b||void 0,toJSON:function(){return{id:a}}})};d.prototype.attachDev=function(){if(this.options.devTools&&typeof window!=="undefined"){if(window.__REDUX_DEVTOOLS_EXTENSION__){var a=typeof this.options.devTools==="object"?this.options.devTools:void 0;this.devTools=window.__REDUX_DEVTOOLS_EXTENSION__.connect(b(b({name:this.id,autoPause:!0,stateSanitizer:function(a){return{value:a.value,context:a.context,actions:a.actions}}},a),{features:b({jump:!1,skip:!1},a?a.features:void 0)}),this.machine);this.devTools.init(this.state)}q.registerService(this)}};d.prototype.toJSON=function(){return{id:this.id}};d.prototype[k.symbolObservable]=function(){return this};d.defaultOptions=function(b){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(a,c){return b.setTimeout.call(null,a,c)},clearTimeout:function(a){return b.clearTimeout.call(null,a)}},logger:b.console.log.bind(console),devTools:!1}}(typeof window==="undefined"?a:window);d.interpret=z;return d}();Z.Interpreter=v;var w=function(a){a===void 0&&(a="null");return{id:a,send:function(){return void 0},subscribe:function(){return{unsubscribe:function(){}}},toJSON:function(){return{id:a}}}},x=function(a){return k.isString(a)?b(b({},r),{name:a}):b(b(b({},r),{name:k.uniqueId()}),a)};function y(a,b){var c=x(b);return s(void 0,function(b){j.IS_PRODUCTION||k.warn(!!b,'Attempted to spawn an Actor (ID: "'+(k.isMachine(a)?a.id:"undefined")+'") outside of a service. This will have no effect.');if(b)return b.spawn(a,c.name,c);else return w(c.name)})}Z.spawn=y;function z(a,b){a=new v(a,b);return a}Z.interpret=z}var Ga=!1;function Ha(){Ga||(Ga=!0,Fa());return Ea.exports}var Ia={},Ja={exports:Ia};function Ka(){var a=this&&this.__values||function(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},b=this&&this.__read||function(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e};Object.defineProperty(Ia,"__esModule",{value:!0});var c=V();function d(d,e,f){var g,h;d=c.State.from(d,d instanceof c.State?d.context:void 0);try{for(var e=a(e),i=e.next();!i.done;i=e.next()){var j=b(i.value,2),k=j[0];j=j[1];if(d.matches(k))return j(d)}}catch(a){g={error:a}}finally{try{i&&!i.done&&(h=e["return"])&&h.call(e)}finally{if(g)throw g.error}}return f(d)}Ia.matchState=d}var La=!1;function Ma(){La||(La=!0,Ka());return Ja.exports}var $={},Na={exports:$};function Oa(){function a(a){for(var b in a)$.hasOwnProperty(b)||($[b]=a[b])}Object.defineProperty($,"__esModule",{value:!0});var b=u();$.matchesState=b.matchesState;b=z();$.mapState=b.mapState;b=ka();$.StateNode=b.StateNode;b=V();$.State=b.State;b=oa();$.Machine=b.Machine;$.createMachine=b.createMachine;b=T();$.send=b.send;$.sendParent=b.sendParent;$.sendUpdate=b.sendUpdate;$.assign=b.assign;$.doneInvoke=b.doneInvoke;$.forwardTo=b.forwardTo;var c=Ha();$.interpret=c.interpret;$.Interpreter=c.Interpreter;$.spawn=c.spawn;c=Ma();$.matchState=c.matchState;c={raise:b.raise,send:b.send,sendParent:b.sendParent,sendUpdate:b.sendUpdate,log:b.log,cancel:b.cancel,start:b.start,stop:b.stop,assign:b.assign,after:b.after,done:b.done,respond:b.respond,forwardTo:b.forwardTo,escalate:b.escalate};$.actions=c;a(E())}var Pa=!1;function Qa(){Pa||(Pa=!0,Oa());return Na.exports}function b(a){switch(a){case void 0:return Qa()}}e.exports=b}),null);
__d("xstate",["xstate-4.7.7"],(function(a,b,c,d,e,f){e.exports=b("xstate-4.7.7")()}),null);
__d("ZenonDeferrableStateMachine",["xstate"],(function(a,b,c,d,e,f){"use strict";var g=b("xstate").interpret;a={interpret:function(a){var b=[],c=g(a.withConfig({actions:{defer:function(a,c){b.push(c)}}})).onTransition(function(a){if(a.value!==((a=a.history)==null?void 0:a.value)){a=b;b=[];while(a.length>0)c.send(a.shift())}}).start();return c}};e.exports=a}),null);
__d("ZenonConnectionStateMachine",["ZenonConnectionInitState","ZenonConnectionPeerConnectionRestartingState","ZenonConnectionSdpNegotiatedState","ZenonConnectionSdpSetState","ZenonConnectionSharedActions","ZenonConnectionSMGuards","ZenonDebugLogger","ZenonDeferrableStateMachine","immutable","xstate"],(function(a,b,c,d,e,f){"use strict";var g,h,i=b("xstate").Machine;a=b("xstate").assign;c=function(){function a(a,c){var d=this;c===void 0&&(c="init");c=babelHelpers["extends"]({},F,{context:babelHelpers["extends"]({currentVideoSubscriptions:null,dataMessageSubscriptions:b("immutable").Map({})},a),initial:c});a.peerConnectionManager.registerTrackListener(function(){var a=d.$1.state.context,b=a.currentVideoSubscriptions;a=a.getConnectionModel;if(b){var c=b.request;b=b.userToCnameMap;a=a();var e=a.getUserToTracksMap();a=a.getTracks();for(var b=b,f=Array.isArray(b),g=0,b=f?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=b.length)break;h=b[g++]}else{g=b.next();if(g.done)break;h=g.value}h=h;var i=h[0];h=h[1];i=e.get(i);if(i)for(var i=i,j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{k=i.next();if(k.done)break;l=k.value}l=l;l=a.get(l);if(l&&l.webrtcStream.active&&l.contentType==="video"&&l.webrtcStream.id!==h){d.processEvent(c);return}}}}});this.$1=b("ZenonDeferrableStateMachine").interpret(i(c,{guards:b("ZenonConnectionSMGuards")})).onTransition(function(b){a.updateConnectionModel(function(a){b.changed&&a.updateConnectionState(b.value)})});b("ZenonDebugLogger").getInstance().startQPL(64243854,+a.signalingClient.getSignalingModel().getSignalingID())}var c=a.prototype;c.processEvent=function(a){G.has(a.type)||b("ZenonDebugLogger").getInstance().logStateMachine("ConnectionStateMachine",this.getState(),a.type,this.$1.state.context.signalingClient.getSignalingModel().getSignalingID()),this.$1.send(a)};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};return a}();f={actions:[(d=b("ZenonConnectionSdpNegotiatedState")).onAddLocalTracks],target:"clientInitiatedRenegotiation"};var j={actions:[(g=b("ZenonConnectionSharedActions")).onAddParticipants]},k={actions:[g.onLocalMediaStateUpdateProcessing]},l={actions:[g.onStopLocalTrack]},m={actions:[g.onLocalMediaStateUpdateReady]},n={actions:[g.onEndConnection],target:"terminated"},o={actions:[g.onCapabilitiesReceived]},p={actions:[g.onParticipantUpdateReceivedEvent]},q={actions:[g.onRemoveParticipants]},r={actions:[g.onIceCandidateReady]},s={actions:[a(g.onCreateDataMessageSubscription)]},t={actions:[a(g.onRemoveDataMessageSubscription)]},u={actions:[g.onDataMessageReceived]},v={actions:[g.onRoomContextUpdateReceived]},w={actions:[g.onIceCandidateReceived]},x={actions:[g.onConnectionDestroyed],target:"terminated"},y={actions:[g.onConnectionDropped]},z={actions:[g.onStateSyncUnsubscribe]},A={actions:[g.onStateSyncUpdate]},B={actions:[a(g.onSubscriptionRequest)]},C={actions:[g.onSendGenericDataMessage]},D={actions:[g.onUserApprovalRequest]},E={actions:[g.onForceEncodingEnabled]},F={initial:"init",states:{init:{on:{capabilitiesReceived:o,connectionDestroyed:x,connectionRoomUpdateReceived:v,createConnection:[{actions:[b("ZenonConnectionInitState").onCreateConnection],cond:(h=b("ZenonConnectionSMGuards")).outgoingConnectionGuard,target:"creatingSdp"},{actions:[b("ZenonConnectionInitState").onCreateConnection],cond:h.incomingConnectionGuard,target:"waitingForIncoming"}],createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},waitingForIncoming:{on:{capabilitiesReceived:o,connectionDestroyed:x,connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,offerReady:[{actions:[g.onOfferReady],target:"sdpSet"}],participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sdpReceived:[{actions:[g.onSdpReceived],cond:h.sdpOfferReceiveGuard,target:"creatingSdp"}],sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},creatingSdp:{on:{answerReady:[{actions:[g.onAnswerReady],target:"sdpSet"}],capabilitiesReceived:o,connectionDestroyed:x,connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,offerReady:[{actions:[g.onOfferReady],target:"sdpSet"}],participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sdpReceived:{actions:["defer"]},sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},sdpSet:{on:{capabilitiesReceived:o,connectionDestroyed:x,connectionEstablished:[{actions:[b("ZenonConnectionSdpSetState").onConnectionEstablished],target:"sdpNegotiated"}],connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,initiatePeerConnectionRestarting:{actions:[d.onInitiatePeerConnectionRestarting],target:"peerConnectionRestarting"},localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,participantUpdateReceived:p,pendingApproval:[{target:"pendingApproval"}],removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sdpReceived:[{actions:[g.onSdpReceived],cond:h.sdpAnswerReceiveGuard},{actions:["defer"],cond:h.sdpOfferReceiveGuard}],sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},pendingApproval:{on:{capabilitiesReceived:{actions:["defer"]},connectionDestroyed:x,connectionRoomUpdateReceived:{actions:["defer"]},createDataMessageSubscription:{actions:["defer"]},dataMessageReceived:{actions:["defer"]},endConnection:n,forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},iceCandidateReceived:{actions:["defer"]},initiatePeerConnectionRestarting:{actions:[d.onInitiatePeerConnectionRestarting],target:"peerConnectionRestarting"},localMediaStateUpdateProcessing:{actions:["defer"]},localMediaStateUpdateReady:{actions:["defer"]},participantUpdateReceived:{actions:["defer"]},removeDataMessageSubscription:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:{actions:["defer"]},subscriptionRequest:{actions:["defer"]}}},sdpNegotiated:{on:{addLocalTracks:[{actions:[d.onAddScreenShareLocalTrack],cond:h.addScreenShareTrackWithReplaceGuard},{actions:[d.onAddLocalTracks],target:"clientInitiatedRenegotiation"}],addParticipants:j,capabilitiesReceived:o,connectionDestroyed:x,connectionDropped:y,connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,initiatePeerConnectionRestarting:{actions:[d.onInitiatePeerConnectionRestarting],target:"peerConnectionRestarting"},localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:[{actions:[d.onRemoveScreenShareLocalTrack],cond:h.removeScreenShareTrackWithReplaceGuard},{actions:[d.onRemoveLocalTrack],target:"clientInitiatedRenegotiation"}],removeParticipants:q,replaceLocalTrack:{actions:[d.onReplaceLocalTrack]},sdpReceived:{actions:[g.onSdpReceived],cond:h.sdpOfferReceiveGuard,target:"sdpRenegotiating"},sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:B,userApprovalRequest:D}},sdpRenegotiating:{on:{addParticipants:j,answerReady:{actions:[g.onAnswerReady],target:"sdpNegotiated"},capabilitiesReceived:o,connectionDestroyed:x,connectionDropped:y,connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:r,iceCandidateReceived:w,localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:m,participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},clientInitiatedRenegotiation:{on:{capabilitiesReceived:o,connectionDestroyed:x,connectionDropped:y,connectionEstablished:{target:"sdpNegotiated"},connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:u,endConnection:n,forceEncodingEnabled:E,iceCandidateReady:r,iceCandidateReceived:w,localMediaStateUpdateProcessing:{actions:["defer"]},localMediaStateUpdateReady:{actions:["defer"]},offerReady:{actions:[g.onOfferReady]},participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sdpReceived:[{actions:[g.onSdpReceived],cond:h.sdpAnswerReceiveGuard},{actions:["defer"]}],sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:{actions:["defer"]},subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},peerConnectionRestarting:{on:{addLocalTracks:f,addParticipants:j,capabilitiesReceived:o,connectionDestroyed:babelHelpers["extends"]({cond:h.secondaryPeerConnectionGuard},x),connectionDropped:y,connectionEstablished:{actions:[a(b("ZenonConnectionPeerConnectionRestartingState").onSecondaryConnectionEstablished)],cond:h.secondaryPeerConnectionGuard,target:"sdpNegotiated"},connectionRoomUpdateReceived:v,createDataMessageSubscription:s,dataMessageReceived:babelHelpers["extends"]({cond:h.secondaryPeerConnectionGuard},u),endConnection:n,forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:babelHelpers["extends"]({cond:h.secondaryPeerConnectionGuard},r),iceCandidateReceived:w,localMediaStateUpdateProcessing:k,localMediaStateUpdateReady:babelHelpers["extends"]({cond:h.secondaryPeerConnectionGuard},m),offerReady:{actions:[g.onOfferReady],cond:h.secondaryPeerConnectionGuard},participantUpdateReceived:p,removeDataMessageSubscription:t,removeLocalTrack:{actions:["defer"]},removeParticipants:q,replaceLocalTrack:{actions:["defer"]},sdpReceived:[{actions:[b("ZenonConnectionPeerConnectionRestartingState").onAnswerSdpReceived],cond:h.sdpAnswerReceiveGuard},{actions:["defer"]}],sendGenericDataMessage:C,stateSyncUnsubscribe:z,stateSyncUpdate:A,stopLocalTrack:l,subscriptionRequest:{actions:["defer"]},userApprovalRequest:D}},terminated:{}}},G=new Set(["dataMessageReceived"]);e.exports=c}),null);
__d("ZenonConnectionStateModel",["CurrentUser","UserAgent","ZenonCallFeatures","ZenonGetDisplayMediaUtils","ZenonParticipantState"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonParticipantState").ZenonParticipantState;a=function(){function a(a,c,d,e,f,h){e===void 0&&(e={groupThreadID:null,peerID:null,serverInfoData:null}),f===void 0&&(f=new(b("ZenonCallFeatures"))({canReplaceLocalStreams:!b("UserAgent").isBrowser("Firefox"),screenSharingAvailability:b("ZenonGetDisplayMediaUtils").isNativeScreenSharingSupported()?"available":"unknown"})),h===void 0&&(h="init"),this.selfUserID=b("CurrentUser").getID(),this.collisionContext=e,this.capabilities=f,this.connectionDirection=d,this.connectionState=h,this.$4=function(){return new Map()},this.$5=function(){return[]},this.$6=function(){return[]},this.$7=function(){return a.getStateSyncStore().getInputStates()},this.$8=function(){return a.getStateSyncStore().getOutputStates()},this.$9=new Map(),this.$1=c,this.$1.set(this.selfUserID,g.CONNECTED),this.$2=new Set(),this.$3=new Map(this.$1)}var c=a.prototype;c.getConsolidatedParticipantStates=function(){return this.$3};c.updateParticipantState=function(a,b){this.$1.set(a,b),this.$2.has(a)||(this.$3=this.$3.set(a,b))};c.updateConnectionState=function(a){this.connectionState=a};c.updateCapabilities=function(a){this.capabilities=this.capabilities.set("canAddParticipants",a.addParticipantEnabled)};c.updateConsolidatedParticipantStates=function(){var a=new Map(this.$1);this.$2.forEach(function(b){a.set(b,g.CONNECTED)});this.$3=a};c.getTracks=function(){return this.$4()};c.registerTrackFetcher=function(a){this.$4=a};c.getRtpSenders_I_KNOW_WHAT_I_AM_DOING=function(){return this.$5()};c.registerRtpSendersFetcher=function(a){this.$5=a};c.getRtpReceivers_I_KNOW_WHAT_I_AM_DOING=function(){return this.$6()};c.registerRtpReceiversFetcher=function(a){this.$6=a};c.getStateSyncInputs=function(){return this.$7()};c.getStateSyncOutputs=function(){return this.$8()};c.getUserToTracksMap=function(){return this.$9};c.updateTrackMapFromMediaStates=function(a){var b=this;this.$2=new Set();a.forEach(function(a){var c=a.userID;if(c!=null){var d;d=(d=b.$9.get(c))!=null?d:new Set();d.add(a.trackID);b.$9.set(c,d);b.$2.add(c)}});this.updateConsolidatedParticipantStates()};return a}();e.exports=a}),null);
__d("ZenonConnectionStatePeerConnectionDelegate",[],(function(a,b,c,d,e,f){"use strict";var g={connectionDestroyed:function(a,b,c){a.processEvent({payload:{error:c,peerConnectionRole:b},type:"connectionDestroyed"})},connectionDropped:function(a,b){a.processEvent({payload:{peerConnectionRole:b},type:"connectionDropped"})},connectionEstablished:function(a,b){a.processEvent({payload:{peerConnectionRole:b},type:"connectionEstablished"})},dataChannelMesageReceived:function(a,b,c,d){a.processEvent({payload:{data:d,dataChannelLabel:c,peerConnectionRole:b},type:"dataMessageReceived"})},sendIceCandidate:function(a,b,c){a.processEvent({payload:{candidate:c,peerConnectionRole:b},type:"iceCandidateReady"})},sendLocalMediaStateUpdate:function(a,b,c){a.processEvent({payload:{mediaStates:c,peerConnectionRole:b},type:"localMediaStateUpdateReady"})},sendSdpReady:function(a,b,c,d,e){var f={tracks:[],version:c.version};d.forEach(function(a){a={enabled:a.enabled,trackID:a.trackId,type:a.contentType,userID:e};f.tracks.push(a)});d={mediaStates:f,peerConnectionRole:b,sdp:c};c.type==="offer"?a.processEvent({payload:d,type:"offerReady"}):a.processEvent({payload:d,type:"answerReady"})},setPeerConnectionEventHandlers:function(a,b,c,d){a.setPeerConnectionEventHandlers({onConnectionDestroyed:function(a){return g.connectionDestroyed(b,c,a)},onConnectionDropped:function(){return g.connectionDropped(b,c)},onConnectionEstablished:function(){return g.connectionEstablished(b,c)},onDataChannelMessageReceived:function(a,d){return g.dataChannelMesageReceived(b,c,a,d)},onIceCandidateReady:function(a){return g.sendIceCandidate(b,c,a)},onLocalMediaStateUpdate:function(a){return g.sendLocalMediaStateUpdate(b,c,a)},onLocalSdpSet:function(e){return g.sendSdpReady(b,c,e,a.getLocalTracksForMWS(),d().selfUserID)}})}};e.exports=g}),null);
__d("ZenonConnectionStateSignalingDelegate",[],(function(a,b,c,d,e,f){"use strict";var g={onCapabilitiesReceived:function(a,b,c){a.processEvent({payload:{capabilities:b,escalationConferenceName:c},type:"capabilitiesReceived"})},onDismissReceived:function(a,b){b={dismissReason:b,dismissReasonSetByRemote:!0,shouldInformPeer:!1};a.processEvent({payload:b,type:"endConnection"})},onGenericDataMessageReceived:function(a,b,c){c={data:c,dataChannelLabel:b};a.processEvent({payload:c,type:"dataMessageReceived"})},onIceCandidateReceived:function(a,b){a.processEvent({payload:b,type:"iceCandidateReceived"})},onParticipantUpdateReceived:function(a,b){a.processEvent({payload:{participantStates:b},type:"participantUpdateReceived"})},onPendingApprovalReceived:function(a){a.processEvent({type:"pendingApproval"})},onRenegotiationRequested:function(a){a.processEvent({type:"initiatePeerConnectionRestarting"})},onRoomContextUpdateReceived:function(a,b){a.processEvent({payload:{context:b},type:"connectionRoomUpdateReceived"})},onSdpReceived:function(a,b,c){a.processEvent({payload:{mediaStates:c,sdp:b},type:"sdpReceived"})},setSignalingEventHandlers:function(a,b){a.setSignalingEventHandlers({onCapabilitiesReceived:function(a,c){return g.onCapabilitiesReceived(b,a,c)},onDismissReceived:function(a,c){return g.onDismissReceived(b,c)},onGenericDataMessageReceived:function(a,c){return g.onGenericDataMessageReceived(b,a,c)},onIceCandidateReceived:function(a){return g.onIceCandidateReceived(b,a)},onParticipantUpdateReceived:function(a){return g.onParticipantUpdateReceived(b,a)},onPendingApprovalReceived:function(){return g.onPendingApprovalReceived(b)},onRenegotiationRequested:function(){return g.onRenegotiationRequested(b)},onRoomContextUpdateReceived:function(a){return g.onRoomContextUpdateReceived(b,a)},onSdpReceived:function(a,c){return g.onSdpReceived(b,a,c)}})}};e.exports=g}),null);
__d("ZenonConnectionStateManager",["ZenonCallsModelEmitter","ZenonConnectionStateMachine","ZenonConnectionStateModel","ZenonConnectionStatePeerConnectionDelegate","ZenonConnectionStateSignalingDelegate","ZenonParticipantState","ZenonPeerConnectionManager","ZenonPlatformExperiments","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonCallsModelEmitter").CallsModelEmitterInstance,h=b("ZenonCallsModelEmitter").CONNECTION_STATE_TO_CALL_STATE_MAP,i=b("ZenonParticipantState").ZenonParticipantState;a=function(){function a(a,c,d,e,f,g){var h=this;g===void 0&&(g=!1);this.$8=function(){return h.$2};this.$6=function(a){a(h.$2),h.$7(),h.$11()};this.$1=a;var i=c.getSignalingModel();i.setNotifyCallback(function(){h.$6(function(a){a.collisionContext.serverInfoData=i.getRemoteSignalingID()})});this.$2=new(b("ZenonConnectionStateModel"))(i,new Map(),d,{groupThreadID:null,peerID:null,serverInfoData:c.getSignalingModel().getRemoteSignalingID()});var j=new(b("ZenonPeerConnectionManager"))(e,g);j.registerTrackListener(function(){h.$7()});a=new(b("ZenonPeerConnectionManager"))(e,g);this.$3=new(b("ZenonConnectionStateMachine"))({getConnectionModel:this.$8,logEvent:function(a){return f.log(a)},peerConnectionManager:j,secondaryPeerConnectionManager:a,signalingClient:c,updateConnectionModel:this.$6});b("ZenonConnectionStateSignalingDelegate").setSignalingEventHandlers(c,this.$3);b("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(j,this.$3,"primary",this.$8);b("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(a,this.$3,"secondary",this.$8);g&&this.createDataMessageSubscription("data",function(a){a=JSON.parse(a);a=a.body;if(a.videoUploadRequest){var b=null;a.videoUploadRequest.perSsrcTargetBitrateBpsMap&&(b=h.$9(a.videoUploadRequest.perSsrcTargetBitrateBpsMap));b={perSsrcTargetBitrateBpsMap:b,qualityMask:a.videoUploadRequest.qualityMask};j.handleSimulcastUploadRequest(b)}});this.$4=f;c.setLoggingEventHandler(function(a){return f.log(a)});j.setLoggingEventHandler(function(a){return f.log(a)});a.setLoggingEventHandler(function(a){return f.log(a)});this.$5=0}var c=a.prototype;c.$9=function(a){var c=new Map();Object.keys(a).forEach(function(d){var e=parseInt(a[d],10);if(isNaN(e)){b("recoverableViolation")("Simulcast bitrate string could not be parsed as int","rtc_www");return}c.set(d,e)});return c};c.start=function(a){var c=a.mwRingRequest!=null?"incoming":"outgoing",d=a.dataChannels,e=a.initialSyncStates,f=a.localMedia,g=a.mwRingRequest;a=a.usersToRing;d={dataChannels:d,direction:c,initialSyncStates:b("ZenonPlatformExperiments").shouldUseStateSync()&&e?e:void 0,mwRingRequest:g,tracks:f,usersToRing:a};this.$3.processEvent({payload:d,type:"createConnection"})};c.muteTrack=function(a){this.$10(a,!1)};c.unmuteTrack=function(a){this.$10(a,!0)};c.$10=function(a,b){b={enabled:b,trackID:a};this.$3.processEvent({payload:b,type:"localMediaStateUpdateProcessing"})};c.stopLocalTrack=function(a){a={trackID:a};this.$3.processEvent({payload:a,type:"stopLocalTrack"})};c.end=function(a,b){a={dismissReason:a,dismissReasonSetByRemote:!1,dismissSubreason:b,shouldInformPeer:!0};this.$3.processEvent({payload:a,type:"endConnection"})};c.addParticipants=function(a){a={usersToRing:a};this.$3.processEvent({payload:a,type:"addParticipants"})};c.removeParticipants=function(a){a={usersToRemove:a};this.$3.processEvent({payload:a,type:"removeParticipants"})};c.addLocalTrack=function(a){this.$3.processEvent({payload:{tracks:[a]},type:"addLocalTracks"})};c.replaceLocalTrack=function(a,b){this.$3.processEvent({payload:{replacementTrack:b,trackIDToReplace:a},type:"replaceLocalTrack"})};c.removeLocalTrack=function(a){this.$3.processEvent({payload:{trackID:a},type:"removeLocalTrack"})};c.createDataMessageSubscription=function(a,b){this.$3.processEvent({payload:{dataChannelLabel:a,messageHandler:b},type:"createDataMessageSubscription"})};c.removeDataMessageSubscription=function(a,b){this.$3.processEvent({payload:{dataChannelLabel:a,messageHandler:b},type:"removeDataMessageSubscription"})};c.sendGenericDataMessage=function(a,b,c,d){b={data:b,recipientIDs:c,serviceRecipients:d,topic:a};this.$3.processEvent({payload:b,type:"sendGenericDataMessage"})};c.updateStateSyncTopic=function(a,b){b={inputData:b,topic:a};this.$3.processEvent({payload:b,type:"stateSyncUpdate"})};c.unsubscribeFromStateSyncTopic=function(a){a={topic:a};this.$3.processEvent({payload:a,type:"stateSyncUnsubscribe"})};c.subscribeToRemoteVideo=function(a,b){b={includeDominantSpeaker:b,subscriptions:a};this.$3.processEvent({payload:b,type:"subscriptionRequest"})};c.approveParticipants=function(a){this.$3.processEvent({payload:{approvalStatus:1,targetUsers:a},type:"userApprovalRequest"})};c.denyParticipants=function(a){this.$3.processEvent({payload:{approvalStatus:0,targetUsers:a},type:"userApprovalRequest"})};c.forceEncodingEnabled=function(a){this.$3.processEvent({payload:{enabled:a},type:"forceEncodingEnabled"})};c.getConnectionState=function(){return this.$2.connectionState};c.getClientCallID=function(){return this.$1};c.getServerCallID=function(){return this.$2.collisionContext.serverInfoData};c.$7=function(){g.emitCallsModel(this.$1,this.$2)};c.$11=function(){if(h[this.$2.connectionState]!=="connected")return;var a=this.$2.getConsolidatedParticipantStates();if(a){a=Array.from(a.values());a=a.filter(function(a){return a===i.CONNECTED});a=a.length;a>this.$5&&(this.$4.log({connectedParticipantsCount:a,name:"setMaxConnectedParticipants"}),this.$5=a)}};return a}();e.exports=a}),null);
__d("ZenonVideoDurationTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";var g;function h(a){a.startedAt==null&&(a.startedAt=(g||(g=b("performanceNow")))())}function i(a){a.startedAt!=null&&(a.duration=k(a),a.startedAt=null)}function j(a,b){b=b.filter(function(a){return a.enabled});b.length>0?h(a):i(a)}function k(a){var c=a.startedAt;return c!=null?a.duration+(g||(g=b("performanceNow")))()-c:a.duration}a=function(){function a(){this.$1={localScreenShareDuration:{duration:0,startedAt:null},localVideoDuration:{duration:0,startedAt:null},remoteVideoDuration:{duration:0,startedAt:null}}}var b=a.prototype;b.getLocalVideoDuration=function(){return k(this.$1.localVideoDuration)};b.getLocalScreenShareDuration=function(){return k(this.$1.localScreenShareDuration)};b.getRemoteVideoDuration=function(){return k(this.$1.remoteVideoDuration)};b.update=function(a){var b=this.$1.localVideoDuration,c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&!a.remote});j(b,c);b=this.$1.localScreenShareDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="screen";return b&&!a.remote});j(b,c);b=this.$1.remoteVideoDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&a.remote});j(b,c)};return a}();e.exports=a}),null);
__d("ZenonMediaChannelManager",["regeneratorRuntime","FBLogger","ZenonMediaStatsManager","ZenonMediaUtils","ZenonRTCVideoResolutionHelper","ZenonScreenShare","ZenonVideoDurationTracker","err","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c){var d=this;this.$1=a;this.$2=new Map();this.$7=new Map();this.$8=new Map();this.$5=[];this.$4=new(b("ZenonVideoDurationTracker"))();this.$3=new(b("ZenonMediaStatsManager"))(this.$1,this.$2,c,this.$4);this.$3.listen();this.$1.addEventListener("track",function(a){d.addRemoteTrackFromEvent(a)});this.$9=!0}var c=a.prototype;c.cleanUp=function(){this.$3.stopPolling()};c.getTracks=function(){return this.$2};c.getLocalTracksForMWS=function(){var a=this,b=new Map();this.$2.forEach(function(c,d){if(!c.remote){var e,f=(e=a.$8.get(d))!=null?e:d;e=c.update("trackId",function(){return f});b.set(f,e)}});return b};c.addTrack=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:a.contentType==="video"&&a.remote===!1&&(this.$6=a);if(!(b("ZenonScreenShare").isScreenSharingTrack([a])&&this.$6!=null)){c.next=8;break}this.$9=this.$6.enabled&&this.$6.webrtcTrack.enabled;c.next=5;return b("regeneratorRuntime").awrap(this.$10(this.$6,a));case 5:this.unmuteTrack(a.trackId);c.next=9;break;case 8:this.$11(a);case 9:b("ZenonScreenShare").isScreenSharingTrack([a])&&b("ZenonRTCVideoResolutionHelper").handleStartScreenSharing(this.$1.getSenders(),this.$1.getReceivers(),this.$1.supportsSimulcast()),this.$12();case 11:case"end":return c.stop()}},null,this)};c.removeTrack=function(a){var c,d,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c=this.$2.get(a);if(!(c==null)){h.next=3;break}return h.abrupt("return");case 3:if(!(b("ZenonScreenShare").isScreenSharingTrack([c])&&this.$6!=null)){h.next=9;break}h.next=6;return b("regeneratorRuntime").awrap(this.$10(c,this.$6));case 6:this.$9?this.unmuteTrack((d=(e=this.$6)==null?void 0:e.trackId)!=null?d:""):this.muteTrack((f=(g=this.$6)==null?void 0:g.trackId)!=null?f:"");h.next=10;break;case 9:this.$13(c);case 10:c.webrtcTrack.stop(),b("ZenonScreenShare").isScreenSharingTrack([c])&&b("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(this.$1.getSenders(),this.$1.getReceivers(),this.$1.supportsSimulcast()),this.$12();case 13:case"end":return h.stop()}},null,this)};c.replaceTrack=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=this.$2.get(a);if(!(e==null)){f.next=3;break}return f.abrupt("return");case 3:((d=this.$6)==null?void 0:d.trackId)===a&&(this.$6=c);f.next=6;return b("regeneratorRuntime").awrap(this.$10(e,c));case 6:this.$12(),e.webrtcTrack.stop();case 8:case"end":return f.stop()}},null,this)};c.$10=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=this.$1.getSenders().find(function(b){return b.track===a.webrtcTrack});if(!(d===void 0)){f.next=3;break}throw new(b("err"))("track to be replaced is not found");case 3:f.next=5;return b("regeneratorRuntime").awrap(d.replaceTrack(c.webrtcTrack));case 5:e=this.$8.get(a.trackId),e!=null?this.$8["delete"](a.trackId):e=a.trackId,this.$8.set(c.trackId,e),this.$2["delete"](a.trackId),this.$2.set(c.trackId,c);case 10:case"end":return f.stop()}},null,this)};c.addRemoteTrackFromEvent=function(a){a=b("ZenonMediaUtils").convertToZenonImmutableMediaTrack(a.track,{isRemote:!0,isUserMuted:!1,stream:a.streams?a.streams[0]:null});var c=this.$7.get(a.trackId);c!=null&&(a.contentType!=="audio"&&(a.webrtcTrack.enabled=c.enabled,a=a.set("enabled",c.enabled)),a=a.set("userMuted",c.userMuted),this.$7["delete"](a.trackId));this.$2=this.$2.set(a.trackId,a);this.$12()};c.createDataChannel=function(a,b){this.$1.createDataChannel(a,b)};c.muteTrack=function(a){var b=this.$2.get(a);if(b==null){this.$7.set(a,{enabled:!1,userMuted:!0});return}a=b;b.userMuted||(a=a.set("userMuted",!0));var c=Boolean((b==null?void 0:b.remote)&&b.contentType==="audio");!c&&b.enabled&&b.webrtcTrack.enabled&&(a.webrtcTrack.enabled=!1,a=a.set("enabled",!1));b!==a&&(this.$2=this.$2.set(a.trackId,a),this.$12())};c.unmuteTrack=function(a){var b=this.$2.get(a);if(b==null){this.$7.set(a,{enabled:!0,userMuted:!1});return}a=b;b.userMuted&&(a=a.set("userMuted",!1));var c=Boolean((b==null?void 0:b.remote)&&b.contentType==="audio");!c&&!b.enabled&&!b.webrtcTrack.enabled&&(a.webrtcTrack.enabled=!0,a=a.set("enabled",!0));b!==a&&(this.$2=this.$2.set(a.trackId,a),this.$12())};c.forceEncodingEnabled=function(a){if(!b("gkx")("1478914"))return;var c=this.$1.getRemoteStreams().length>0||a;this.$1.getSenders().forEach(function(a){var d=a.getParameters();d.encodings.forEach(function(a){a.active=c});b("promiseDone")(a.setParameters(d),null,function(a){b("FBLogger")("rtc_www").catching(a).mustfix("Error while trying to toggle encoding")})})};c.stopLocalTracks=function(){this.$2.forEach(function(a){a.remote===!1&&a.webrtcTrack.stop()}),this.$6!=null&&!this.$2.has(this.$6.trackId)&&this.$6.webrtcTrack.stop(),this.$12()};c.stopLocalTrack=function(a){a=this.$2.get(a);if(a==null)return;if(a.remote)return;a.webrtcTrack.stop()};c.registerTrackListener=function(a){this.$5.push(a)};c.setTrackListenersFromManager=function(a){this.$5=a.$5};c.$12=function(){this.$4.update(this.$2),this.$5.forEach(function(a){a()})};c.$13=function(a){this.$1.removeTrack(a.webrtcTrack),this.$2["delete"](a.trackId),a.webrtcTrack.stop()};c.$11=function(a){this.$1.addTrack(a.webrtcTrack,a.webrtcStream),this.$2=this.$2.set(a.trackId,a)};c.timeSeries=function(){return this.$3.timeSeries()};return a}();e.exports=a}),null);
__d("ZenonMediaStatsManager",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsReportPoller","ZenonTSLogDataHelper","promiseDone"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,h=b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID,i=b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID;a=function(){function a(a,c,d,e,f){f===void 0&&(f=5e3),this.$1=a,this.$2=c,this.$3=new Map(),this.$4=d,this.$5=b("ZenonTSLogDataHelper").emptyTSLogDataHolder(),this.__videoDurationTracker=e,this.$6=f}var c=a.prototype;c.listen=function(){var a=this;this.$1.addEventListener("iceconnectionstatechange",function(b){b=b.target;b=b.iceConnectionState;switch(b){case"connected":a.pollRecurring();break}})};c.pollOnce=function(){var a=this;b("promiseDone")(b("ZenonMediaStatsReportPoller").updateStatsFromConnection(Array.from(this.$2.values()),this.$3,this.$1,this.$5),function(){return a.$4(a.$7())})};c.pollRecurring=function(){this.$6!==null&&(this.pollOnce(),window.setTimeout(this.pollRecurring.bind(this,this.$6),this.$6))};c.stopPolling=function(){window.clearTimeout(this.$6),this.$6=null};c.timeSeries=function(){return JSON.stringify(b("ZenonTSLogDataHelper").serialize(this.$5))};c.$7=function(){var a=this,b={CoreAudioMetrics:{},extraInfo:{},receiver:{},sender:{},video:{}},c={},d=this.$3.get(g);d!=null&&(this.$8(d,b.sender),this.$9(d,b.CoreAudioMetrics));d=this.$3.get(h);d!=null&&this.$10(b.video,d);d=this.$3.get(i);d!=null&&this.$11(b.video,d);this.$3.forEach(function(d,e){e=a.$2.get(e);if(e==null)return;var f=d.localIceCandidateStats,g=d.remoteIceCandidateStats;!b.extraInfo.localIceCandidate&&f&&(b.extraInfo.localIceCandidate=f);!b.extraInfo.remoteIceCandidate&&g&&(b.extraInfo.remoteIceCandidate=g);if(e.remote===!1){e.enabled===!0&&e.contentType==="audio"&&e.webrtcTrack.readyState==="live"&&(b.CoreAudioMetrics.audio_device=e.label);return}e.contentType==="audio"?a.$12(d,b.receiver,e,c):e.contentType==="video"&&a.$13(b.video,d,c)});return b};c.$8=function(a,c){var d=a.cumulativeStat,e=d.bytesSent;d=d.packetsSent;var f=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],g=a.deltaStat.googRtt;f=new Map([["bytes",e],["plost",f],["psent",d]]);f.forEach(function(a,b){a!=null&&b!=="codec"&&b!=="ice"&&b!=="ice_g0"&&(c[b]=a.getCurrentValue())});if(e){d=e.getElapsedTime();d>0&&(c.ube_avg=Math.round(e.getDeltaValue()*8/d*1e3))}if(g){f=g.getTotal();e=g.getCount();if(e>0){c.avgrtt=Math.round(f/e);c.maxrtt=Math.max((d=c.maxrtt)!=null?d:Number.MIN_SAFE_INTEGER,g.getMax());c.minrtt=Math.min((f=c.minrtt)!=null?f:Number.MAX_SAFE_INTEGER,g.getMin())}}a.codec!=null&&a.codec!==""&&(c.codec={www:a.codec});return c};c.$12=function(a,c,d,e){a.codec!=null&&a.codec!==""&&(c.codec==null&&(c.codec={}),c.codec[d.hashCode().toString()]=a.codec);d=a.cumulativeStat;var f=d.bytesReceived,g=d.fecPacketsDiscarded,h=d.fecPacketsReceived,i=d.googDecodingCNG,k=d.googDecodingNormal,l=d.googDecodingPLC,m=d.googDecodingPLCCNG,n=d.jitterBufferDelay,o=d.jitterBufferEmittedCount;d=d.packetsReceived;var p=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED];a=a.deltaStat;var q=a.googRtt;a=a.jitter;if(f){var r=f.getElapsedTime();if(r>0){var s=j(c.dbe_total_bytes,f.getDeltaValue());c.dbe_total_bytes=s;r=Math.round(j(c.dbe_total_time,r));c.dbe_total_time=r;c.dbe_avg=Math.round(s*8/r*1e3)}}if(q){e.sumrtt=((s=e.sumrtt)!=null?s:0)+q.getTotal();e.countrtt=((r=e.countrtt)!=null?r:0)+q.getCount();e.sumrtt!=null&&e.countrtt>0&&(c.avgrtt=Math.round(e.sumrtt/e.countrtt));c.maxrtt=Math.max((s=c.maxrtt)!=null?s:Number.MIN_SAFE_INTEGER,q.getMax());c.minrtt=Math.min((r=c.minrtt)!=null?r:Number.MAX_SAFE_INTEGER,q.getMin())}n&&(c.jbd=j(c.jbd,1e3*n.getCurrentValue()));s=new Map([["dec_plc",l],["dec_plc_cng",m],["dec_cng",i],["dec_normal",k],["bytes",f],["plost",p],["precv",d],["fecpd",g],["fecpr",h],["jbec",o]]);s.forEach(function(a,b){a!=null&&b!=="codec"&&b!=="ice"&&b!=="ice_g0"&&(c[b]=Math.round(j(c[b],a.getCurrentValue())))});if(c.dec_plc!=null||c.dec_plc_cng!=null||c.dec_cng!=null||c.dec_normal!=null){c.neteq_calls=((r=c.dec_plc)!=null?r:0)+((q=c.dec_plc_cng)!=null?q:0)+((n=c.dec_cng)!=null?n:0)+((l=c.dec_normal)!=null?l:0)}if(a&&d&&c.precv!=null&&c.precv>0){m=c.precv;i=a.getTotal()*d.getCurrentValue();e.weightedJitterSum=((k=e.weightedJitterSum)!=null?k:0)+i;c.jitter=Math.round(1e3*e.weightedJitterSum/m)}return c};c.$10=function(a,c){a.ld=Math.round(this.__videoDurationTracker.getLocalVideoDuration());var d=a.sender||{};c.codec!=null&&c.codec!==""&&(d.ename=c.codec);c.histResScale&&(d.histResScale=c.histResScale);var e=c.cumulativeStat,f=e.bytesSent,g=e.captureFrameCount,h=e.firCount,i=e.framesEncoded,j=e.framesSent,k=e.keyFramesEncoded,l=e.packetsSent,m=e.simulcast_layer_changes,n=e.totalEncodeTime,o=e.totalPacketSendDelay,p=e.videoConvertedQpSum,q=e.videoSumCapturePixel;e=e.videoSumPixel;var r=c.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],s=c.deltaStat,t=s.frameHeight,u=s.frameWidth,v=s.height;s=s.width;f=new Map([["enc_bytes",f],["eqps",p],["plost",r],["psent",l],["fcsn",j],["fir",h],["tet",n],["tpsd",o],["fcap",g],["frames",i],["kframes",k],["sim_l_chg",m],["ah",t],["aw",u],["ch",v],["cw",s]]);f.forEach(function(a,c){if(a!=null&&c!=="ename"&&c!=="histResScale"&&c!=="ehist"&&c!=="ss")if(a instanceof b("ZenonCumulativeMediaStat"))d[c]=Math.round(a.getCurrentValue());else{d[c]=Math.round((c=a.getLastAddedValue())!=null?c:0)}});if(d.enc_bytes!=null&&a.ld!=null&&a.ld>0){p=d.enc_bytes;r=a.ld;a.bwe={avg_enc_bitrate:Math.round(p*8/r*1e3)}}d.tet!=null&&(d.tet*=1e3);d.tpsd!=null&&(d.tpsd*=1e3);if(q&&d.fcap!=null&&d.fcap>0){l=d.fcap;d.eipxl=Math.round(q.getCurrentValue()/l)}if(e&&d.frames!=null&&d.frames>0){j=d.frames;d.eopxl=Math.round(e.getCurrentValue()/j)}c.codecHistory!=null&&(d.ehist=Object.fromEntries(c.codecHistory.map(function(a){var b=a.codec;a=a.updateTime;return[Math.round(a).toString(),b]})));a.sender=d};c.$13=function(a,c,d){a.rd=Math.round(this.__videoDurationTracker.getRemoteVideoDuration());var e=a.receiver,f=e===void 0?{}:e;c.codec!=null&&c.codec!==""&&c.lastUpdate>((e=d.lastCodecUpdate)!=null?e:Number.MIN_SAFE_INTEGER)&&(f.dname=c.codec,d.lastCodecUpdate=c.lastUpdate);e=c.cumulativeStat;var g=e.bytesReceived,h=e.framesDecoded,i=e.jitterBufferDelay,k=e.jitterBufferEmittedCount,l=e.packetsReceived,m=e.pliCount,n=e.totalDecodeTime,o=e.tracktimestamp,p=e.videoConvertedQpSum,q=e.videoDecodedBytes,r=e.videoDecodeTime,s=e.videoFreezeCount,t=e.videoFreezeDuration,u=e.videoPauseCount,v=e.videoPauseDuration;e=e.videoSumPixel;var w=c.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],x=c.deltaStat,y=x.avSync,z=x.avSyncAbs,A=x.e2eLatency,B=x.frameHeight;x=x.frameWidth;q&&(f.dec_bytes=j(f.dec_bytes,q.getDeltaValue()));if(c.maxTotalDecodeTime!=null){f.dec_time=Math.round(Math.max(c.maxTotalDecodeTime,(q=f.dec_time)!=null?q:0))}if(h){c=Math.round(j(f.frd,h.getCurrentValue()));if(A&&c>0){q=A.getAverage()*h.getCurrentValue();f.e2el=(A=f.e2el)!=null?A:0;f.frd=(A=f.frd)!=null?A:0;f.e2el=Math.round((f.e2el*f.frd+q)/c)}if(e!=null&&c>0){q=((A=d.aggVideoSumPixel)!=null?A:0)+e.getCurrentValue();f.dpxl=Math.round(q/c);d.aggVideoSumPixel=q}if(y!=null&&z!=null&&c>0){e=((A=d.weigtedAvSync)!=null?A:0)+y.getAverage()*h.getCurrentValue();A=((q=d.weigtedAvSyncAbs)!=null?q:0)+z.getAverage()*h.getCurrentValue();f.av=Math.round(e/c);f.avabs=Math.round(A/c);d.weigtedAvSync=e;d.weigtedAvSyncAbs=A}f.frd=c;f.dec_frame=c}if(x&&B&&o.getCurrentTime()>((y=d.lastFrameUpdate)!=null?y:Number.MIN_SAFE_INTEGER)){f.rh=(q=B.getLastAddedValue())!=null?q:0;f.rw=(z=x.getLastAddedValue())!=null?z:0;d.lastFrameUpdate=o.getCurrentTime()}n&&(f.tdt=j(f.tdt,1e3*n.getCurrentValue()));i&&(f.jbd=j(f.jbd,1e3*i.getCurrentValue()));h=new Map([["recv",g],["qps",p],["plost",w],["precv",l],["pli",m],["pact",u],["padur",v],["jbec",k],["frcnt",s],["frdur",t],["dec_time_all_streams",r]]);h.forEach(function(a,b){a!=null&&b!=="dname"&&(f[b]=Math.round(j(f[b],a.getCurrentValue())))});f.jbd!=null&&f.jbec!=null&&f.jbec>0&&(f.recjbl=Math.round(f.jbd/f.jbec));a.receiver=f};c.$11=function(a,b){var c,d=((c=a.sender)==null?void 0:c.ss)||{};d.dur=Math.round(this.__videoDurationTracker.getLocalScreenShareDuration());c=b.cumulativeStat;var e=c.captureFrameCount,f=c.framesEncoded,g=c.videoBytesSent,h=c.videoConvertedQpSum,i=c.videoSumCapturePixel;c=c.videoSumPixel;b=b.deltaStat.availableOutgoingBitrate;e=new Map([["eiframes",e],["eqps",h],["frames",f]]);e.forEach(function(a,b){a!=null&&(d[b]=a.getCurrentValue())});if(i!=null&&d.eiframes!=null&&d.eiframes>0){h=d.eiframes;d.eipxl=Math.round(i.getCurrentValue()/h)}if(c!=null&&d.frames!=null&&d.frames>0){f=d.frames;d.eopxl=Math.round(c.getCurrentValue()/f)}b&&(d.avbw=Math.round(b.getAverage()));if(g&&d.dur!=null&&d.dur>0){e=d.dur;d.avbr=Math.round(g.getCurrentValue()*8/e)}a.sender=(i=a.sender)!=null?i:{};a.sender.ss=d};c.$9=function(a,b){var c=a.cumulativeStat,d=c.audioDevRecStalls,e=c.audioDevStallDuration;c=c.audioDevTotalStalls;a=a.deltaStat.audioDevIsStalled;c=new Map([["astall",c],["sdur",e],["rstall",d]]);c.forEach(function(a,c){a!=null&&c!=="audio_device"&&(b[c]=a.getCurrentValue())});if(a){b.isstall=(e=a.getLastAddedValue())!=null?e:0}};return a}();function j(a,b){return a===void 0?b:a+b}e.exports=a}),null);
__d("ZenonAudioStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser","gkx"],(function(a,b,c,d,e,f){"use strict";var g=5e3;a=b("ZenonMediaStatsConfig").DERIVED_METRICS;var h=a.AUDIO_DEV_IS_STALLED,i=a.AUDIO_DEV_REC_STALLS,j=a.AUDIO_DEV_STALL_DURATION,k=a.AUDIO_DEV_TOTAL_STALLS;function l(a){a=a.cumulativeStat;var b=a.bytesSent,c=a["media-sourcetimestamp"];a=a[j];return b!=null&&c!=null?b.getCurrentTimeSinceLastUpdate()>g?a.getCurrentTimeSinceLastUpdate():b.getCurrentValue()===0||b.getDeltaFromLastUpdate()===0?c.getDeltaFromLastUpdate():0:0}function m(a){a.deltaStat[h]==null&&(a.deltaStat[h]=new(b("ZenonDeltaMediaStat"))()),a.cumulativeStat[i]==null&&(a.cumulativeStat[i]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[k]==null&&(a.cumulativeStat[k]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[j]==null&&(a.cumulativeStat[j]=new(b("ZenonCumulativeMediaStat"))(0))}function n(a){var b=l(a),c=b===0?0:1;m(a);var d=!p(a)&&c?1:0;a.cumulativeStat[i].update(a.cumulativeStat[i].getCurrentValue()+d);a.cumulativeStat[k].update(a.cumulativeStat[k].getCurrentValue()+d);a.cumulativeStat[j].update(a.cumulativeStat[j].getCurrentValue()+b);a.deltaStat[h].add(c)}function o(a,b){b=b?0:1;var c=!p(a)&&b?1:0;a.cumulativeStat[i].update(a.cumulativeStat[i].getCurrentValue()+c);a.cumulativeStat[k].update(a.cumulativeStat[k].getCurrentValue()+c);a.deltaStat[h].add(b);c=b?a.cumulativeStat[j].getCurrentTimeSinceLastUpdate():0;a.cumulativeStat[j].update(a.cumulativeStat[j].getCurrentValue()+c)}function p(a){return a.deltaStat[h]!=null&&a.deltaStat[h].getLastAddedValue()===1}c={updateStatsWithDerivedMetric:function(a,c){var d=0;a.filter(function(a){return a.contentType==="audio"&&!a.remote&&a.webrtcTrack.readyState==="live"}).forEach(function(a){d++;a=c.get(a.trackId);a!=null&&n(a)});b("gkx")("1673659")?a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID):a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);a!=null&&(m(a),d===0?o(a,!1):o(a,!0))}};e.exports=c}),null);
__d("ZenonAvSyncDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT,h=b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB,i={findAssociatedAudioTrackId:function(a){a=a.webrtcStream.getAudioTracks();return a!=null&&a.length>0?a[0].id:null},isMutedDuringInterval:function(a){var c;if(a.cumulativeStat.totalAudioEnergy!=null&&a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate()<=b("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD){a.isMuted=!0;return!0}c=(c=a.isMuted)!=null?c:!1;a.isMuted=!1;return c},updateTrackerWithAvSync:function(a,c){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){var d=i.findAssociatedAudioTrackId(a);if(d!=null){d=c.get(d);var e=c.get(a.trackId);if(d!=null&&d.cumulativeStat.estimatedPlayoutTimestamp!=null&&e!=null&&e.cumulativeStat.estimatedPlayoutTimestamp!=null){var f,k,l;a=e.cumulativeStat.estimatedPlayoutTimestamp;var m=d.cumulativeStat.estimatedPlayoutTimestamp;f=(f=e.lastEstimatedPlayoutTimestamp)!=null?f:0;k=(k=d.lastEstimatedPlayoutTimestamp)!=null?k:0;e.lastEstimatedPlayoutTimestamp=a.getCurrentValue();d.lastEstimatedPlayoutTimestamp=m.getCurrentValue();if(((l=e.lastEstimatedPlayoutTimestamp)!=null?l:0)<=f||((l=d.lastEstimatedPlayoutTimestamp)!=null?l:0)<=k){j(e,g,0);j(e,h,0);return}j(e,g,1);f=m.getCurrentValue()-a.getCurrentValue();l=Math.abs(f);if(l>b("ZenonMediaStatsConfig").AV_SYNC_CUTOFF){j(e,h,1);return}j(e,h,0);if(i.isMutedDuringInterval(d))return;k=[{key:b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC,value:f},{key:b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,value:l}];k.forEach(function(a){e.deltaStat[a.key]==null&&(e.deltaStat[a.key]=new(b("ZenonDeltaMediaStat"))()),e.deltaStat[a.key].add(a.value)})}}})}};function j(a,c,d){a.cumulativeStat[c]==null&&(a.cumulativeStat[c]=new(b("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[c].update(a.cumulativeStat[c].getCurrentValue()+d)}e.exports=i}),null);
__d("ZenonE2ELatencyDeriver",["ZenonDeltaMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=-22089888e5;a={updateTrackerWithE2ELatency:function(a,c){a.filter(function(a){return a.remote}).forEach(function(a){a=c.get(a.trackId);var d=b("ZenonMediaStatsConfig").DERIVED_METRICS.E2E_LATENCY;if(a!=null&&a.cumulativeStat.estimatedPlayoutTimestamp!=null&&a.cumulativeStat.estimatedPlayoutTimestamp.getDeltaFromLastUpdate()>0){var e=Date.now()-g-a.cumulativeStat.estimatedPlayoutTimestamp.getCurrentValue();a.deltaStat[d]==null&&(a.deltaStat[d]=new(b("ZenonDeltaMediaStat"))());a.deltaStat[d].add(e)}})}};e.exports=a}),null);
__d("ZenonMediaElementTracker",["FBLogger","React"],(function(a,b,c,d,e,f){"use strict";a=b("React");var g=a.useEffect,h=new Map(),i={track:function(a,c){h.has(a)&&b("FBLogger")("rtc_www").warn("ZenonMediaElementTracker already has a stream associated with the given element"),h.set(a,c)},untrack:function(a){h["delete"](a)||b("FBLogger")("rtc_www").warn("ZenonMediaElementTracker did not have a stream associated with the given element")},updateStats:function(a){for(var c=h,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f.getTracks(),i=Array.isArray(f),j=0,f=i?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=f.length)break;k=f[j++]}else{j=f.next();if(j.done)break;k=j.value}k=k;var l=a.get(k.id);if(l==null){b("FBLogger")("rtc_www").warn("Failed to find stream ID in media stats. Is ZenonMediaElementTracker leaking?");continue}if(k.kind==="video"&&g instanceof HTMLVideoElement){if(g.videoWidth===0||g.videoHeight===0)continue;var m=g.getBoundingClientRect();l.renderedWidth=m.width;l.renderedHeight=m.height;var n=m.width/g.videoWidth,o=m.height/g.videoHeight,p=getComputedStyle(g);p=p.objectFit;var q=1,r=1;switch(p){case"cover":q=Math.max(n,o);r=m.width*m.height/(q*q*g.videoWidth*g.videoHeight);break;case"contain":q=Math.min(n,o);break;default:b("FBLogger")("rtc_www").warn("Unknown object-fit type %s",p)}l.scaleRatio=q*q;l.croppingRatio=r}else k.kind==="audio"&&g instanceof HTMLAudioElement}}},useMediaElementTracker:function(a,b){g(function(){var c=a.current;if(!b||!c)return;i.track(c,b);return function(){i.untrack(c)}},[a,b])}};e.exports=i}),null);
__d("ZenonOutboundStatsWriter",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f){"use strict";var g=Object.freeze({audio:b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,screen:b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,video:b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID});function h(a,c,d){if(d==null)return;a.cumulativeStat[c]==null?a.cumulativeStat[c]=new(b("ZenonCumulativeMediaStat"))(d.getCurrentValue()):a.cumulativeStat[c].update(a.cumulativeStat[c].getCurrentValue()+d.getDeltaFromLastUpdate())}function i(a,c,d){if(d==null)return;a.deltaStat[c]==null&&(a.deltaStat[c]=new(b("ZenonDeltaMediaStat"))());d=d.getLastAddedValue();d!=null&&a.deltaStat[c].add(d)}a={updateOutboundStats:function(a,c){a.filter(function(a){return a.remote===!1&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var d=c.get(a.trackId);if(d!=null){a=g[a.contentType];a=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,a);var e=d.cumulativeStat,f=d.deltaStat,j=d.histResScale;d.percentStat;d.simulcastStats;d=babelHelpers.objectWithoutPropertiesLoose(d,["cumulativeStat","deltaStat","histResScale","percentStat","simulcastStats"]);Object.assign(a,d);a.histResScale=[].concat(j);for(var k in e)h(a,k,e[k]);for(var l in f)i(a,l,f[l])}})}};e.exports=a}),null);
__d("ZenonVideoQualityDeriver",["ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=1280*720;a=160*96;var h=Math.log2(g/a);c=51;var i=16,j=c-i,k=j+Math.floor(h*6),l={_convertToH264QP:function(a){var b=Math.max(1,Math.min(64,a));a=[1,5,12,28,42,53,64];var c=a.findIndex(function(a){return a>b});return c==null?0:Math.min(51,Math.floor(12+6*c+6*(b-a[c-1])/(a[c]-a[c-1])))},computeVideoQuality:function(a){var c=a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM],d=a.cumulativeStat.framesEncoded,e=a.deltaStat,f=e.frameHeight;e=e.frameWidth;if(c==null||d==null||f==null||e==null)return;d=d.getDeltaFromLastUpdate();c=c.getDeltaFromLastUpdate();e=e.getLastAddedValue();f=f.getLastAddedValue();if(d===0||f==null||e==null||e<=0||f<=0)return;c=c/d;if(c<=0)return;((d=a.codec)==null?void 0:d.indexOf("264"))===-1?a=l._convertToH264QP(c):a=c;d=Math.max(0,Math.min(j,a-i));c=e*f;a=Math.max(0,Math.min(h,Math.log2(g/c)));return Math.max(0,k-d-a*6)/k*100}};e.exports=l}),null);
__d("ZenonPerStreamAggregator",["ZenonAvSyncDeriver","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonPercentMediaStat","ZenonRenderedView","ZenonVideoQualityDeriver","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonRenderedView").GRID,h=Object.freeze({audio:b("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID,screen:b("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,video:b("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID});a={aggregatePerStream:function(a,b){s(a,b),r(a,b),q(a,b)}};function i(a,c,d,e,f,g){if(d==null)return;a.percentStat[c]==null&&(a.percentStat[c]=new(b("ZenonPercentMediaStat"))());a.percentStat[c].add(d,e,f,g)}function j(a,b){return a<b?a:b}function k(a,c){var d=c.get(a.trackId),e=0;if(d==null)return e;if(a.contentType==="audio")d.cumulativeStat.totalAudioEnergy!=null&&(e=d.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate());else{d=b("ZenonAvSyncDeriver").findAssociatedAudioTrackId(a);if(d!=null){a=c.get(d);a!=null&&a.cumulativeStat.totalAudioEnergy!=null&&(e=a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate(),b("ZenonAvSyncDeriver").isMutedDuringInterval(a)&&(e=0))}}return e}function l(a,c){var d,e=b("ZenonMediaStatsConfig").DERIVED_METRICS.RENDERED_VIEW;c=c.get(a.trackId);if(c==null)return g;c.deltaStat[e]==null&&(c.deltaStat[e]=new(b("ZenonDeltaMediaStat"))());a=(a=c.renderedView)!=null?a:g;d=(d=b("ZenonRenderedView").cast(c.deltaStat[e].getLastAddedValue()))!=null?d:a;c.deltaStat[e].add(a);c=j(a,d);return c}function m(a,b,c,d){if(a.cumulativeStat[c]&&a.cumulativeStat[c].getDeltaFromLastUpdate()!==0&&a.cumulativeStat[b]!=null){b=a.cumulativeStat[b].getDeltaFromLastUpdate()/a.cumulativeStat[c].getDeltaFromLastUpdate();return b*((a=d)!=null?a:1)}return null}function n(a){var c=null,d=b("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED;a.cumulativeStat.packetsReceived!=null&&a.cumulativeStat[d]!=null&&a.cumulativeStat[d].getDeltaFromLastUpdate()+a.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()!==0&&(c=a.cumulativeStat[d].getDeltaFromLastUpdate()/(a.cumulativeStat[d].getDeltaFromLastUpdate()+a.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()));return c}function o(a,b,c){if(a.cumulativeStat[b]&&a.cumulativeStat[b].getTimeSinceLastUpdate()!==0){a=a.cumulativeStat[b].getDeltaFromLastUpdate()/a.cumulativeStat[b].getTimeSinceLastUpdate();return a*((b=c)!=null?b:1)}return null}function p(a,b,c){if(a.deltaStat[b]){a=a.deltaStat[b].getLastAddedValue();return a!=null?a*((b=c)!=null?b:1):null}return null}function q(a,c){var d=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID),e=0,f=0,g=0,h=0,j=0,k=0;a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){var b=c.get(a.trackId);if(b!=null)if(a.remote===!1)b.cumulativeStat.totalEncodeTime!=null&&b.cumulativeStat.totalEncodeTime.getTimeSinceLastUpdate()>0&&(h+=b.cumulativeStat.totalEncodeTime.getDeltaFromLastUpdate(),j+=b.cumulativeStat.totalEncodeTime.getTimeSinceLastUpdate(),k++);else{var d=o(b,"bytesReceived",8e3);if(d==null)return;a.contentType==="audio"?f+=d:g+=d;b.cumulativeStat.totalDecodeTime!=null&&b.cumulativeStat.totalDecodeTime.getTimeSinceLastUpdate()>0&&(h+=b.cumulativeStat.totalDecodeTime.getDeltaFromLastUpdate(),j+=b.cumulativeStat.totalDecodeTime.getTimeSinceLastUpdate(),k++)}});if(k>0){a=j/k;a=h*1e3/a;i(d,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_CPU_USAGE,a,b("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,b("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,e)}if(f+g>0){i(d,(a=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.GLOBAL_AUDIO_BITRATE,f,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e);i(d,a.PER_STREAM_AGG_METRICS.GLOBAL_VIDEO_BITRATE,g,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e)}}function r(a,c){a.filter(function(a){return b("gkx")("1674571")?a.remote===!1&&a.webrtcTrack.readyState==="live":a.webrtcTrack.readyState==="live"&&a.remote===!1&&a.webrtcTrack.muted===!1}).forEach(function(a){var d=c.get(a.trackId);if(d!=null){var e,f=h[a.contentType];f=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,f);i(f,(e=b("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.ROUND_TRIP_TIME,p(d,"googRtt",1),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);var g=b("ZenonVideoQualityDeriver").computeVideoQuality(d);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QUALITY,g,e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_ENCODED_FRAME_RATE,o(d,"framesEncoded",1e3),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QP,m(d,e.DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM,"framesEncoded",1),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0)}})}function s(a,c){var d=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").PINNED_AUDIO_STATS_TRACKID),e=b("ZenonMediaStatsParser").getOrCreateTrackerFromMap(c,b("ZenonMediaStatsConfig").PINNED_VIDEO_STATS_TRACKID);a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.remote===!0}).forEach(function(a){var f=c.get(a.trackId);if(f!=null){var g=k(a,c),h=l(a,c);if(a.contentType==="audio"){var j=h===b("ZenonRenderedView").PINNED?d:f;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_RATE,m(f,"googDecodingPLC","googDecodingCTN"),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_CNG_RATE,m(f,"googDecodingPLCCNG","googDecodingCTN"),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_NETEQ_WAIT_TIME,m(f,"jitterBufferDelay","jitterBufferEmittedCount",1e3),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PACKET_LOSS_RATE,n(f),h,a.contentType,g)}else if(a.contentType==="video"){j=h===b("ZenonRenderedView").PINNED?e:f;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_NETEQ_WAIT_TIME,m(f,"jitterBufferDelay","jitterBufferEmittedCount",1e3),h,a.contentType,g);if(f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT]!=null&&f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT].getDeltaFromLastUpdate()>0){var q=0;f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB]==null||f.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB].getDeltaFromLastUpdate()===0?i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS,p(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,1),h,a.contentType,g):q=1;i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_OOB,q,h,a.contentType,g)}i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FRAME_RATE,o(f,"framesDecoded",1e3),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_COUNT_PER_MIN,o(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,6e4),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_DURATION_PER_MIN,o(f,b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION,6e4),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_PACKET_LOSS_RATE,n(f),h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_RENDER_SCALE_RATIO,f.scaleRatio,h,a.contentType,g);i(j,b("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_CROPPING_RATIO,f.croppingRatio,h,a.contentType,g)}}})}e.exports=a}),null);
__d("ZenonVideoCaptureMetricDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT,h=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL,i={VIDEO_CAPTURE_FRAME_COUNT_STAT_KEY:g,VIDEO_SUM_CAPTURE_PIXEL_STAT_KEY:h,addDebugLog:function(a,c,d,e){var f="video_debugFPS",g="video_debugtracktimestamp",h="video_debuglastUpdate";a.deltaStat[f]!=null?a.deltaStat[f].add(c):(a.deltaStat[f]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[f].add(c));a.deltaStat[g]!=null?a.deltaStat[g].add(d):(a.deltaStat[g]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[g].add(d));a.deltaStat[h]!=null?a.deltaStat[h].add(e):(a.deltaStat[h]=new(b("ZenonDeltaMediaStat"))(),a.deltaStat[h].add(e))},calculateVideoCaptureFrameCount:function(a){var b=a.cumulativeStat.tracktimestamp,c=a.deltaStat.framesPerSecond;if(c!=null&&b!=null&&b.getCurrentValue()>a.lastUpdate&&b.getDeltaFromLastUpdate()!==b.getCurrentValue()){c=c.getLastAddedValue();var d=b.getDeltaFromLastUpdate();if(typeof c==="number"){d=Math.round(c*d/1e3);d>1e3&&i.addDebugLog(a,c,b.getCurrentValue(),a.lastUpdate);return d}}return 0},calculateVideoSumCapturePixel:function(a,b){var c=a.cumulativeStat,d=c.captureFrameCount;c=c.tracktimestamp;var e=a.deltaStat,f=e.height;e=e.width;if(d!=null&&e!=null&&f!=null&&c!=null&&c.getCurrentValue()>a.lastUpdate){c=b?d.getCurrentValue():d.getDeltaFromLastUpdate();b=(a=e.getLastAddedValue())!=null?a:0;e=(d=f.getLastAddedValue())!=null?d:0;a=c*b*e;return a}return 0},updateStatsWithDerivedMetric:function(a,c){var d=["video","screen"];a.filter(function(a){return d.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=c.get(a.trackId);if(a!=null){if(a.cumulativeStat[g]!=null){var d=a.cumulativeStat.framesEncoded;if(d!=null)if(d.getDeltaFromLastUpdate()<0)a.cumulativeStat[g].update(0);else{d=i.calculateVideoCaptureFrameCount(a);a.cumulativeStat[g].getCurrentValue()===0&&(d+=d);a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d)}}else a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(0);if(a.cumulativeStat[h]!=null){d=a.cumulativeStat.captureFrameCount;d=d.getDeltaFromLastUpdate()<0;var e=i.calculateVideoSumCapturePixel(a,d);d?a.cumulativeStat[h].update(e):a.cumulativeStat[h].update(a.cumulativeStat[h].getCurrentValue()+e)}else{d=i.calculateVideoSumCapturePixel(a,!0);a.cumulativeStat[h]=new(b("ZenonCumulativeMediaStat"))(d)}}})}};e.exports=i}),null);
__d("ZenonVideoConvertedQpDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonVideoQpConversion"],(function(a,b,c,d,e,f){"use strict";var g=["video","screen"],h={calculateVideoConvertedQP:function(a){var c=a.cumulativeStat,d=c.framesDecoded,e=c.framesEncoded,f=c.qpSum;c=c.tracktimestamp;var g=a.codec;e=e!=null?e:d;if(f!=null&&e!=null&&g!=null&&c!=null&&c.getCurrentValue()>a.lastUpdate){d=f.getDeltaFromLastUpdate();c=e.getDeltaFromLastUpdate();(c<=0||d<=0)&&(d=f.getCurrentValue(),c=e.getCurrentValue());a=g.includes("264");f=b("ZenonVideoQpConversion").convertQp(c,d,a);return f*c}return 0},updateStatsWithDerivedMetric:function(a,c){a.filter(function(a){return g.includes(a.contentType)&&a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var d=a.cumulativeStat.qpSum;if(d!=null){d=d.getDeltaFromLastUpdate()<0;var e=h.calculateVideoConvertedQP(a),f=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM;a.cumulativeStat[f]!=null?d?a.cumulativeStat[f].update(e):a.cumulativeStat[f].update(a.cumulativeStat[f].getCurrentValue()+e):a.cumulativeStat[f]=new(b("ZenonCumulativeMediaStat"))(e)}}})}};e.exports=h}),null);
__d("ZenonVideoDecodeTimeDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME;a={findMaxDecodeTime:function(a,b){var c=a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).reduce(function(a,c){c=b.get(c.trackId);return c!=null&&c.cumulativeStat.framesDecoded!=null&&c.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0?Math.max(c.cumulativeStat.framesDecoded.getTimeSinceLastUpdate(),a):a},0);b.forEach(function(a){if(a.cumulativeStat.framesDecoded!=null){a.maxTotalDecodeTime=((a=a.maxTotalDecodeTime)!=null?a:0)+c}})},updateTrackerWithDecodeTime:function(a,c){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=c.get(a.trackId);if(a!=null&&a.cumulativeStat.framesDecoded!=null&&a.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0){var d=a.cumulativeStat.framesDecoded.getTimeSinceLastUpdate();a.cumulativeStat[g]==null?a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(d):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d)}})}};e.exports=a}),null);
__d("ZenonVideoDecodedBytesDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES;a={updateTrackerWithDecodedBytes:function(a,c){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var d=a.cumulativeStat,e=d.bytesReceived;d=d.framesDecoded;if(e&&d){var f=d.getElapsedTime()===0&&d.getCurrentValue()>0;if(f||d.getDeltaFromLastUpdate()>0){d=e.getDeltaFromLastUpdate();f&&(d=e.getCurrentValue());a.cumulativeStat[g]==null?a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(d):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d)}}}})}};e.exports=a}),null);
__d("ZenonVideoFreezeCountDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=10,h={calculateVideoFreeze:function(a){a=a.cumulativeStat;var b=a.framesDecoded,c=a.totalInterFrameDelay;a=a.totalSquaredInterFrameDelay;if(b!=null&&c!=null&&a!=null&&b.getDeltaFromLastUpdate()>0){var d=b.getDeltaFromLastUpdate(),e=b.getAverageOverTime()*1e3;c=c.getDeltaFromLastUpdate();a=a.getDeltaFromLastUpdate();e=1/e;var f=e*g/100;e=Math.max(3*e,e+.15);var h=(f*f*d+e*e*(d-1)/d)/d;a=(a-c*c/d)/d;c=a>h?1:0;h=0;if(c)if(d>1){a=a-f*f;h=Math.sqrt(a*d*d/(d-1))*1e3}else h=b.getTimeSinceLastUpdate()/2>e*1e3?b.getTimeSinceLastUpdate()/2:0;return{count:c,duration:h}}return{count:0,duration:0}},updateStatsWithDerivedMetric:function(a,c){var d=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,e=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION;a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){a=c.get(a.trackId);if(a!=null){var f=h.calculateVideoFreeze(a);a.cumulativeStat[d]!=null?a.cumulativeStat[d].update(a.cumulativeStat[d].getCurrentValue()+f.count):a.cumulativeStat[d]=new(b("ZenonCumulativeMediaStat"))(f.count);a.cumulativeStat[e]!=null?a.cumulativeStat[e].update(a.cumulativeStat[e].getCurrentValue()+f.duration):a.cumulativeStat[e]=new(b("ZenonCumulativeMediaStat"))(f.duration)}})}};e.exports=h}),null);
__d("ZenonVideoPauseDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=5e3;a={updateVideoPause:function(a,b){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){a=b.get(a.trackId);a!=null&&h(a)})}};function h(a){var c=a.cumulativeStat,d=c.framesDecoded;c=c.packetsReceived;if(c!=null){var e;e=(e=a.isVideoPaused)!=null?e:!1;if(!e)c.getDeltaFromLastUpdate()===0&&c.getTimeSinceLastUpdate()>1e3&&(a.isVideoPaused=!0,a.lastVideoPacketTime=c.getPreviousTime());else if(d!=null&&d.getDeltaFromLastUpdate()>0){a.isVideoPaused=!1;d=(c.getCurrentTime()+c.getPreviousTime())/2-((e=a.lastVideoPacketTime)!=null?e:c.getPreviousTime());a.lastVideoPacketTime=void 0;d>=g&&(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]!=null?a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].update(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].getCurrentValue()+1):a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]=new(b("ZenonCumulativeMediaStat"))(1),a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]!=null?a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].update(a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].getCurrentValue()+d):a.cumulativeStat[b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]=new(b("ZenonCumulativeMediaStat"))(d))}}}e.exports=a}),null);
__d("ZenonVideoSumPixelDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL,h=["video","screen"],i={calculateVideoSumPixel:function(a,b,c){var d=a.cumulativeStat,e=d.framesDecoded,f=d.framesEncoded;d=d.tracktimestamp;var g=a.deltaStat,h=g.frameHeight;g=g.frameWidth;c=c?e:f;if(c!=null&&g!=null&&h!=null&&d!=null&&d.getCurrentValue()>a.lastUpdate){e=b?c.getCurrentValue():c.getDeltaFromLastUpdate();d=(f=g.getLastAddedValue())!=null?f:0;b=(a=h.getLastAddedValue())!=null?a:0;c=e*d*b;return c}return 0},updateStatsWithDerivedMetric:function(a,c){a.filter(function(a){return h.includes(a.contentType)}).forEach(function(a){var d=a.remote;a=c.get(a.trackId);if(a!=null)if(a.cumulativeStat[g]!=null){var e=a.cumulativeStat,f=e.framesDecoded;e=e.framesEncoded;f=d?f:e;if(f!=null){e=f.getDeltaFromLastUpdate()<0;f=i.calculateVideoSumPixel(a,e,d);e?a.cumulativeStat[g].update(f):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+f)}}else{e=i.calculateVideoSumPixel(a,!0,d);a.cumulativeStat[g]=new(b("ZenonCumulativeMediaStat"))(e)}})}};e.exports=i}),null);
__d("ZenonMediaStatsReportPoller",["regeneratorRuntime","Promise","UserAgent","ZenonAudioStallStatsDeriver","ZenonAvSyncDeriver","ZenonE2ELatencyDeriver","ZenonMediaElementTracker","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonOutboundStatsWriter","ZenonPacketsLostDeriver","ZenonPerStreamAggregator","ZenonSpeakerTracker","ZenonTSLogDataHelper","ZenonVideoCaptureMetricDeriver","ZenonVideoConvertedQpDeriver","ZenonVideoDecodedBytesDeriver","ZenonVideoDecodeTimeDeriver","ZenonVideoFreezeCountDeriver","ZenonVideoPauseDeriver","ZenonVideoScaleHistogram","ZenonVideoSumPixelDeriver","gkx","immutable"],(function(a,b,c,d,e,f){"use strict";function g(a,b){return b.toArray().find(function(b){return b.trackIDs.contains(a.trackId)})}function h(a,c,d,e,f,h,i){var j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:j=d.getSenders().map(function(d){var h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:j=(h=d.track)==null?void 0:h.id;if(!(j!=null)){n.next=11;break}k=a.find(function(a){return a.trackId===j});if(!(k!=null&&k.webrtcTrack.readyState!=="ended")){n.next=11;break}n.next=6;return b("regeneratorRuntime").awrap(d.getStats());case 6:l=n.sent,m=b("ZenonMediaStatsParser").makeStatsReportMap(l),b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,b("ZenonMediaStatsParser").filterMediaReports(m),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,k.contentType,g(k,f)),b("ZenonMediaStatsParser").updateTrackStatsWithReport(k,c,m),i.push(k);case 11:case"end":return n.stop()}},null,this)});l.next=3;return b("regeneratorRuntime").awrap(b("Promise").all(j));case 3:k=d.getReceivers().map(function(d){var i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:j=(i=d.track)==null?void 0:i.id;if(!(j!=null)){n.next=11;break}k=a.find(function(a){return a.trackId===j});if(!(k!=null&&k.webrtcTrack.readyState!=="ended")){n.next=11;break}n.next=6;return b("regeneratorRuntime").awrap(d.getStats());case 6:l=n.sent,m=b("ZenonMediaStatsParser").makeStatsReportMap(l),b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,b("ZenonMediaStatsParser").filterMediaReports(m),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,k.contentType,g(k,f)),b("ZenonMediaStatsParser").updateTrackStatsWithReport(k,c,m),h.push(k);case 11:case"end":return n.stop()}},null,this)});l.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(k));case 6:case"end":return l.stop()}},null,this)}function i(a,c,d,e,f){var h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:h=function(){return new(b("Promise"))(function(a){d.getStats(a)})};j.next=3;return b("regeneratorRuntime").awrap(h());case 3:i=j.sent,a.forEach(function(a){if(a.webrtcTrack.readyState!=="ended"){var d=b("ZenonMediaStatsParser").makeStatsReportMap(i);b("gkx")("965758")&&b("ZenonTSLogDataHelper").addData(e,b("ZenonMediaStatsParser").filterLegacyMediaReports(a,d),b("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,a.contentType,g(a,f));b("ZenonMediaStatsParser").updateTrackStatsWithChromiumLegacyReport(a,c,d)}});case 5:case"end":return j.stop()}},null,this)}function j(a,b){a.forEach(function(a){a=b.get(a.trackId);a!=null&&a.cumulativeStat.tracktimestamp!=null&&(a.lastUpdate=a.cumulativeStat.tracktimestamp.getCurrentValue())})}a={updateStatsFromConnection:function(a,c,d,e,f){var g,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:f===void 0&&(f=b("immutable").Map());g=[];k=[];n.next=5;return b("regeneratorRuntime").awrap(h(a,c,d,e,f,g,k));case 5:if(!(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera"))){n.next=8;break}n.next=8;return b("regeneratorRuntime").awrap(i(a,c,d,e,f));case 8:if(!b("gkx")("965758")){n.next=15;break}n.next=11;return b("regeneratorRuntime").awrap(d.getStats());case 11:l=n.sent,m=b("ZenonMediaStatsParser").makeStatsReportMap(l),b("ZenonTSLogDataHelper").addCandidatePairStats(e,m),b("ZenonTSLogDataHelper").addNonMediaStates(e);case 15:b("ZenonTSLogDataHelper").advance(e),b("ZenonMediaElementTracker").updateStats(c),b("ZenonSpeakerTracker").updateStats(a,c),b("ZenonPacketsLostDeriver").updatePacketsLost(a,c),b("ZenonVideoFreezeCountDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoPauseDeriver").updateVideoPause(a,c),b("ZenonVideoCaptureMetricDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoSumPixelDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoConvertedQpDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonVideoDecodedBytesDeriver").updateTrackerWithDecodedBytes(a,c),b("ZenonVideoDecodeTimeDeriver").findMaxDecodeTime(a,c),b("ZenonVideoDecodeTimeDeriver").updateTrackerWithDecodeTime(a,c),b("ZenonVideoScaleHistogram").updateTrackerWithScaleHistogram(a,c),b("ZenonE2ELatencyDeriver").updateTrackerWithE2ELatency(a,c),b("ZenonAudioStallStatsDeriver").updateStatsWithDerivedMetric(a,c),b("ZenonAvSyncDeriver").updateTrackerWithAvSync(a,c),b("gkx")("1674571")&&b("ZenonOutboundStatsWriter").updateOutboundStats(k,c),b("ZenonPerStreamAggregator").aggregatePerStream([].concat(g,k),c),j(a,c);case 34:case"end":return n.stop()}},null,this)}};e.exports=a}),null);
__d("ZenonSpeakerTracker",["React","ZenonCallsHooks","ZenonRenderedView"],(function(a,b,c,d,e,f){"use strict";a=b("React");var g=a.useEffect,h=null,i=[],j=[],k={updateLayout:function(a,b,c){h=a,i=b,j=c},updateStats:function(a,c){for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(!f.remote)continue;var g=c.get(f.trackId);if(!g)continue;g.isDominantSpeaker=i.indexOf(f.trackId)!==-1;switch(h){case"grid":g.renderedView=b("ZenonRenderedView").GRID;break;case"dominant_speaker":f=j.indexOf(f.trackId)!==-1;g.renderedView=f?b("ZenonRenderedView").PINNED:b("ZenonRenderedView").THUMBNAIL;break}}},useUpdateSpeakerTracker:function(a,c,d){var e,f=(e=b("ZenonCallsHooks").useLiveMediaTrack((e=c)!=null?e:"","video"))==null?void 0:e.trackId,h=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=c)!=null?e:"","audio"))==null?void 0:c.trackId,i=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","video"))==null?void 0:c.trackId,j=(c=b("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","audio"))==null?void 0:c.trackId;g(function(){k.updateLayout(a,[f,h],[i,j])},[i,j,a,f,h])}};e.exports=k}),null);
__d("LsRtcTslogFalcoEvent",["FalcoLoggerInternal","getSamplingPolicyConfig_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getSamplingPolicyConfig_DO_NOT_USE")("falco","ls_rtc_tslog");c=b("FalcoLoggerInternal").create(a);e.exports=c}),null);
__d("ZenonChildCallSummaryLogProcessor",["ChannelClientID","DateConsts","LsRtcTslogFalcoEvent","ZenonCallSummary","ZenonCallSummaryStore","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance,h=10*b("DateConsts").MS_PER_SEC;a=function(){function a(a){this.$3=null;this.$2=a.protocol;this.$2==="mw"&&(a.peerID="MW_PEER_ID");var c=g.retrieveCallSummary(a.peerID,a.callID);c?(this.$1=c,this.$1.unsetEndCallFields(),this.$1.setDeviceID(b("ChannelClientID").getID())):this.$1=new(b("ZenonCallSummary"))(a);a.conferenceName!=null&&this.$1.setConferenceName(a.conferenceName);a.serverInfoData!=null?(this.$1.setServerInfoData(a.serverInfoData),this.$1.setJoinWithSID(!0)):this.$1.setJoinWithSID(!1);this.$1.save(g)}var c=a.prototype;c.processEvent=function(a){var c=this;switch(a.name){case"callJoinRequest":this.$1.onCallJoinRequest(a.hasOfferInRingRequest);this.$1.save(g);break;case"callConnected":this.$1.onCallConnected(a.mediaMode);this.$1.save(g);break;case"callEscalated":this.$1.onCallEscalated(a.mediaMode);this.$1.save(g);break;case"peerConnectionStateChanged":this.$1.setPCIsConnected(a.connected);this.$1.save(g);break;case"callEnded":this.$3!=null&&window.clearTimeout(this.$3);this.$1.onCallEnded(a.endCallReason,a.isRemoteEnded,!1,a.endCallSubreason);this.$1.save(g);b("gkx")("1369511")&&this.$1.uploadLog();break;case"inviteSent":this.$1.onInviteSent();this.$1.save(g);break;case"inviteResponseReceived":this.$1.onInviteResponseReceived();this.$1.save(g);break;case"inviteResponseProcessed":this.$1.onInviteResponseProcessed();this.$1.save(g);break;case"mediaConnected":this.$1.onMediaConnected();this.$1.save(g);break;case"setMediaStats":this.$1.setMediaStats(a.mediaStats);this.$1.save(g);break;case"setMaxConnectedParticipants":this.$1.setMaxConnectedParticipants(a.connectedParticipantsCount);this.$1.save(g);break;case"setHasAnswerInJoinResponse":this.$1.setHasAnswerInJoinResponse(a.hasAnswerInJoinResponse);this.$1.save(g);break;case"setRemoteSignalingID":this.$1.setServerInfoData(a.remoteSignalingID);this.$1.save(g);break;case"startHeartbeat":var d=function b(){a.isCallOngoing()&&(c.$1.save(g),c.$3=window.setTimeout(b,h))};d();break;case"callRated":this.$1.setRating(a.rating);this.$1.save(g);break;case"callFeedbackSubmitted":this.$1.setFeedback(a.feedback);this.$1.save(g);break;case"callSurveyChoiceSubmitted":this.$1.setSurveyChoice(a.surveyChoice);this.$1.save(g);break;case"logTSData":b("LsRtcTslogFalcoEvent").log(function(){return babelHelpers["extends"]({},c.$1.getLoggingArgs(),{time_series:a.time_series})});break}};return a}();e.exports=a}),null);
__d("ZenonSignalingTransportTypes",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({CHILD_WINDOW_READY:"rtc_child_window_ready",PARENT_INITIATED_CALL:"rtc_child_window_start_call",PARENT_TO_CHILD_MESSAGE:"rtc_child_window_message"});e.exports={ChildTransportMessageType:a}}),null);
__d("ZenonSignalingChildTransport",["Promise","Random","SecurePostMessage","URI","ZenonSignalingTransportTypes","gkx","isEmpty","isFacebookishURI"],(function(a,b,c,d,e,f){"use strict";var g,h,i=b("ZenonSignalingTransportTypes").ChildTransportMessageType;a=function(){function a(a,b,c,d){var e=this;this.$5=null;this.$9=function(a){a.data.type!=null&&a.data.type===i.PARENT_INITIATED_CALL&&a.data.nonce===e.$1&&(e.$5&&e.$5(a.data.mwRingRequest))};this.$2=a;this.$1=this.$7();this.$3=b;this.$6=c;this.$4=d}var c=a.prototype;c.connect=function(){var a=this,c=b("Promise").race([new(b("Promise"))(function(b){a.$5=function(a){return b({isTimeout:!1,mwRingRequest:a})},a.$8()}),new(b("Promise"))(function(b){window.setTimeout(function(){b({isTimeout:!0,mwRingRequest:null})},a.$6)})]);return c.then(function(b){var c;a.$5=null;if((c=b.isTimeout)!=null?c:!0)return{state:"join_unavailable"};else return{mwRingRequest:b.mwRingRequest,state:"join_ready"}})};c.$8=function(){var a=this;if(window.opener&&window.opener.postMessage){window.addEventListener("message",this.$9,!1);var c={childNonce:this.$1,nonce:this.$2,peerID:this.$3,roomID:this.$4,type:i.CHILD_WINDOW_READY},d=new MessageChannel();d.port1.onmessage=function(b){a.$9(b)};var e=window.location.origin;b("gkx")("1443572")||!(g||(g=b("isEmpty")))(document.referrer)&&e!==document.referrer&&(b("isFacebookishURI")(new(h||(h=b("URI")))(document.referrer))&&(e=document.referrer));b("SecurePostMessage").sendMessageToSpecificOrigin(window.opener,c,e,[d.port2])}};c.$7=function(){return String(b("Random").random())};return a}();e.exports=a}),null);
__d("ZenonSignalingInitState",["setInterval"],(function(a,b,c,d,e,f){"use strict";var g=3e4;a={onReceiveInvite:function(a,b){if(b.type==="receiveInviteRequest"){a.onInviteReceived(b.payload,b.configuration);return{inviteMessageID:b.messageID}}return{}},onSendInvite:function(a,b){b.type==="sendInviteRequest"&&a.sendSignalingEvent(b.payload)},startPingTimer:function(a){if(!a.pingTimer){var c={eventName:"pingRequest"},d=b("setInterval")(function(){a.sendSignalingEvent(c)},g);return{pingTimer:d}}return{}}};e.exports=a}),null);
__d("ZenonSignalingInviteReceivedState",["FBLogger"],(function(a,b,c,d,e,f){"use strict";a={onSendInviteResponse:function(a,c){c.type==="sendInviteResponse"&&(a.inviteMessageID!=null?(c.payload.ackMessageId=a.inviteMessageID,a.sendSignalingEvent(c.payload)):b("FBLogger")("rtc_www").mustfix("onSendInviteResponse handler invoked without populated inviteMessageID in signaling state machine context."))}};e.exports=a}),null);
__d("ZenonSignalingNegotiationCompleteState",[],(function(a,b,c,d,e,f){"use strict";a={onReceiveAnswer:function(a,b){if(b.type==="receiveRemoteSdpRequest"){b=b.payload;var c=b.mediaStates;b=b.sdp;a.onSdpReceived(b,c);return{lastRemoteSdpVersion:b.version}}return{}},onReceiveMediaUpdateResponse:function(a,b){if(b.type==="receiveMediaUpdateResponse"){b=a.mediaUpdateRequestToSend;if(b){a.sendSignalingEvent(b);return{isMediaUpdateResponsePending:!0,mediaUpdateRequestToSend:null}}else return{isMediaUpdateResponsePending:!1}}return{}},onSendMediaUpdateRequest:function(a,b){if(b.type==="sendMediaUpdateRequest")if(a.isMediaUpdateResponsePending===!0)return{mediaUpdateRequestToSend:b.payload};else{a.sendSignalingEvent(b.payload);return{isMediaUpdateResponsePending:!0}}return{}}};e.exports=a}),null);
__d("ZenonSignalingOfferSdpSentState",[],(function(a,b,c,d,e,f){"use strict";a={onInviteResponseReceived:function(a){a.logEvent({name:"inviteResponseReceived"})}};e.exports=a}),null);
__d("ZenonSignalingSMEvents",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a.eventName){case"addParticipantsRequest":return{payload:a,type:"sendAddParticipantsRequest"};case"addParticipantsResponse":return{payload:a,type:"sendAddParticipantsResponse"};case"answerIntentRequest":return{payload:a,type:"sendAnswerIntentRequest"};case"usersApprovalRequest":return{payload:a,type:"sendUsersApprovalRequest"};case"capabilitiesRequest":return{payload:a,type:"sendCapabilitiesRequest"};case"clientInfoRequest":return{payload:a,type:"sendClientInfoRequest"};case"dismissResponse":return{payload:a,type:"sendDismissResponse"};case"iceCandidateRequest":return{payload:a,type:"sendIceCandidateRequest"};case"iceCandidateResponse":return{payload:a,type:"sendIceCandidateResponse"};case"initiateRenegotiationRequest":return null;case"initiateRenegotiationResponse":return{payload:a,type:"sendInitiateRenegotiationResponse"};case"inviteRequest":return{payload:a,type:"sendInviteRequest"};case"inviteResponse":return{payload:a,type:"sendInviteResponse"};case"localSdpRequest":return{payload:a,type:"sendLocalSdpRequest"};case"localSdpResponse":return{payload:a,type:"sendLocalSdpResponse"};case"mediaUpdateRequest":return{payload:a,type:"sendMediaUpdateRequest"};case"mediaUpdateResponse":return{payload:a,type:"sendMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{payload:a,type:"sendOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{payload:a,type:"sendParticipantUpdateRequest"};case"participantUpdateResponse":return{payload:a,type:"sendParticipantUpdateResponse"};case"pingResponse":return null;case"pingRequest":return{payload:a,type:"sendPingRequest"};case"remoteSdpRequest":return null;case"remoteSdpResponse":return{payload:a,type:"sendRemoteSdpResponse"};case"subscriptionRequest":return{payload:a,type:"sendSubscriptionRequest"};case"removeParticipantsRequest":return{payload:a,type:"sendRemoveParticipantsRequest"};case"stateSyncNotifyRequest":return null;case"stateSyncNotifyResponse":return{payload:a,type:"sendStateSyncNotifyResponse"};case"stateSyncUnsubscribeRequest":return{payload:a,type:"sendStateSyncUnsubscribeRequest"};case"stateSyncUnsubscribeResponse":return null;case"stateSyncUpdateRequest":return{payload:a,type:"sendStateSyncUpdateRequest"};case"stateSyncUpdateResponse":return null;case"terminateRequest":return{payload:a,type:"sendTerminateRequest"};case"hangupResponse":return null;case"roomContextUpdateRequest":return null;case"genericDataMessageRequest":return{payload:a,type:"sendGenericDataMessageRequest"};case"pendingApprovalRequest":return null;default:a;return null}}function b(a,b,c){switch(a.eventName){case"addParticipantsRequest":return{payload:a,type:"receiveAddParticipantsRequest"};case"addParticipantsResponse":return{payload:a,type:"receiveAddParticipantsResponse"};case"pendingApprovalRequest":return{configuration:c,messageID:b,payload:a,type:"receivePendingApprovalRequest"};case"answerIntentRequest":return null;case"capabilitiesRequest":return{configuration:c,messageID:b,payload:a,type:"receiveCapabilitiesRequest"};case"clientInfoRequest":return{configuration:c,messageID:b,payload:a,type:"receiveClientInfoRequest"};case"dismissResponse":return{configuration:c,messageID:b,payload:a,type:"receiveDismissResponse"};case"iceCandidateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateRequest"};case"iceCandidateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateResponse"};case"initiateRenegotiationRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInitiateRenegotiationRequest"};case"initiateRenegotiationResponse":return null;case"inviteRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInviteRequest"};case"inviteResponse":return{configuration:c,messageID:b,payload:a,type:"receiveInviteResponse"};case"localSdpRequest":return null;case"localSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveLocalSdpResponse"};case"mediaUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateRequest"};case"mediaUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateRequest"};case"participantUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateResponse"};case"pingResponse":return{configuration:c,messageID:b,payload:a,type:"receivePingResponse"};case"pingRequest":return null;case"remoteSdpRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpRequest"};case"remoteSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpResponse"};case"stateSyncNotifyRequest":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncNotifyRequest"};case"stateSyncNotifyResponse":return null;case"stateSyncUnsubscribeRequest":return null;case"stateSyncUnsubscribeResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUnsubscribeResponse"};case"stateSyncUpdateRequest":return null;case"stateSyncUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUpdateResponse"};case"subscriptionRequest":return null;case"removeParticipantsRequest":return null;case"usersApprovalRequest":return null;case"terminateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveTerminateRequest"};case"hangupResponse":return{configuration:c,messageID:b,payload:a,type:"receiveHangupResponse"};case"roomContextUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRoomContextUpdateRequest"};case"genericDataMessageRequest":return{configuration:c,messageID:b,payload:a,type:"receiveGenericDataMessageRequest"};default:a;return null}}e.exports={getReceiveEvent:b,getSendEvent:a}}),null);
__d("ZenonSignalingSMGuards",[],(function(a,b,c,d,e,f){"use strict";a={sdpAnswerReceiveGuard:function(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="answer"},sdpAnswerSendGuard:function(a,b){return b.type==="sendLocalSdpRequest"&&b.payload.sdp.type==="answer"},sdpJoinResponseReceiveGuard:function(a,b){return b.type==="receiveLocalSdpResponse"&&b.payload.source==="joinResponse"},sdpOfferReceiveGuard:function(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="offer"},sdpOfferSendGuard:function(a,b){return b.type==="sendLocalSdpRequest"&&b.payload.sdp.type==="offer"}};e.exports=a}),null);
__d("ZenonSignalingSharedActions",["ZenonSignalingTypes"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus;a={genericEventSender:function(a,b){a.sendSignalingEvent(b.payload)},onReceiveCapabilitiesRequest:function(a,b){if(b.type==="receiveCapabilitiesRequest"){a.onCapabilitiesReceived(b.payload.capabilities,(a=b.payload.escalationConferenceName)!=null?a:null)}},onReceiveClientInfoRequest:function(a,b){b.type==="receiveClientInfoRequest"&&a.onClientInfoReceived(b.payload.userCapabilities)},onReceiveGenericDataMessageRequest:function(a,b){b.type==="receiveGenericDataMessageRequest"&&a.onGenericDataMessageReceived(b.payload.topic,b.payload.data)},onReceiveIceCandidateRequest:function(a,b){if(b.type==="receiveIceCandidateRequest"){var c={ackMessageId:b.messageID,eventName:"iceCandidateResponse"};a.sendSignalingEvent(c);var d=a.onIceCandidateReceived;b.payload.iceCandidates.forEach(function(a){return d(a)})}},onReceiveInitiateRenegotiationRequest:function(a,b){var c;if(b.type!=="receiveInitiateRenegotiationRequest")return{};var d=h(a.lastRemoteSdpVersion,b.payload.fromVersion);c={ackMessageId:b.messageID,acknowledgedVersion:d?(c=a.lastRemoteSdpVersion)!=null?c:0:b.payload.version,eventName:"initiateRenegotiationResponse",status:d?g.REJECTED_FROM_VERSION_DOES_NOT_MATCH:g.OK};a.sendSignalingEvent(c);if(d)return{};a.signalingModel.getMediaModeManager().onSfuEscalated();a.onRenegotiationRequested();return i((c=a.lastRemoteSdpVersion)!=null?c:null,b.payload.version)},onReceiveLocalSdpResponse:function(a,b){if(b.type!=="receiveLocalSdpResponse")return;a.logEvent({hasAnswerInJoinResponse:b.payload.hasAnswerInJoinResponse,name:"setHasAnswerInJoinResponse"})},onReceiveParticipantUpdateRequest:function(a,b){if(b.type==="receiveParticipantUpdateRequest"){var c={ackMessageId:b.messageID,eventName:"participantUpdateResponse",requestVersionId:b.payload.versionId};a.sendSignalingEvent(c);a.onParticipantUpdateReceived(b.payload.participantStates)}},onReceivePendingApprovalRequest:function(a){a.onPendingApprovalReceived(),a.logEvent({name:"pendingApproval"})},onReceiveRemoteSdpRequest:function(a,b){var c;if(b.type!=="receiveRemoteSdpRequest")return{};var d=h(a.lastRemoteSdpVersion,b.payload.fromVersion);if(((c=b.payload)==null?void 0:c.source)!=="joinResponse"){c={ackMessageId:b.messageID,acknowledgedVersion:d?a.lastRemoteSdpVersion:b.payload.sdp.version,eventName:"remoteSdpResponse",negotiateType:b.payload.negotiateType,status:d?g.REJECTED_FROM_VERSION_DOES_NOT_MATCH:g.OK,type:b.payload.sdp.type};a.sendSignalingEvent(c)}if(d)return{};a.onSdpReceived(b.payload.sdp,b.payload.mediaStates);return i((c=a.lastRemoteSdpVersion)!=null?c:null,b.payload.sdp.version)},onReceiveRoomContextUpdateRequest:function(a,b){b.type==="receiveRoomContextUpdateRequest"&&a.onRoomContextUpdateReceived(b.payload.context)},onReceiveStateSyncNotifyRequest:function(a,b){if(b.type!=="receiveStateSyncNotifyRequest")return;var c=a.signalingModel,d=b.payload,e=d.data,f=d.responseRequired,g=d.topic;d=d.version;c.getStateSyncStore().updateOutputState(g,{data:e,version:d});c.notify();if(f){e={ackMessageId:b.messageID,eventName:"stateSyncNotifyResponse",topic:g,version:d};a.sendSignalingEvent(e)}},onReceiveTerminateRequest:function(a,b){if(b.type==="receiveTerminateRequest"){if(b.payload.shouldInformPeer){var c={ackMessageId:b.messageID,eventName:"dismissResponse"};a.sendSignalingEvent(c)}a.onDismissReceived(a.signalingModel.getSignalingID(),b.payload.reason);b.payload.fromJoinResponse===!0&&a.logEvent({name:"inviteResponseReceived"})}},onSendTerminateRequest:function(a,b){b.type==="sendTerminateRequest"&&b.payload.shouldInformPeer&&a.sendSignalingEvent(b.payload)},onSendUsersApprovalRequest:function(a,b){if(b.type!=="sendUsersApprovalRequest")return;a.sendSignalingEvent(b.payload)}};function h(a,b){return a!=null&&b!=null&&a!==b}function i(a,b){return a==null||b>a?{lastRemoteSdpVersion:b}:{}}e.exports=a}),null);
__d("ZenonSignalingTerminatedState",["clearInterval"],(function(a,b,c,d,e,f){"use strict";a={stopPingTimer:function(a){if(a.pingTimer){b("clearInterval")(a.pingTimer);delete a.pingTimer;return a}return{}}};e.exports=a}),null);
__d("ZenonSignalingStateMachine",["ZenonDebugLogger","ZenonDeferrableStateMachine","ZenonSignalingInitState","ZenonSignalingInviteReceivedState","ZenonSignalingNegotiationCompleteState","ZenonSignalingOfferSdpSentState","ZenonSignalingSharedActions","ZenonSignalingSMEvents","ZenonSignalingSMGuards","ZenonSignalingTerminatedState","xstate"],(function(a,b,c,d,e,f){"use strict";var g,h=b("ZenonSignalingSMEvents").getReceiveEvent,i=b("ZenonSignalingSMEvents").getSendEvent,j=b("xstate").Machine;a=b("xstate").assign;c=function(){function a(a,c){c===void 0&&(c="init");c=babelHelpers["extends"]({},E,{context:babelHelpers["extends"]({},a),initial:c});this.$1=b("ZenonDeferrableStateMachine").interpret(j(c,{guards:b("ZenonSignalingSMGuards")}));b("ZenonDebugLogger").getInstance().startQPL(64245348,+a.signalingModel.getSignalingID())}var c=a.prototype;c.processSendEvent=function(a){a=i(a);a!=null&&this.$2(a)};c.processReceiveEvent=function(a,b,c){a=h(a,b,c);a!=null&&this.$2(a)};c.$2=function(a){b("ZenonDebugLogger").getInstance().logStateMachine("SignalingStateMachine",this.getState(),a.type,this.$3().signalingModel.getSignalingID()),this.$1.send(a)};c.$3=function(){return this.$1.state.context};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};return a}();f={actions:[(d=b("ZenonSignalingSharedActions")).genericEventSender]};var k={actions:[d.onReceiveTerminateRequest],target:"terminated"},l={actions:[d.genericEventSender]},m={actions:[d.genericEventSender]},n={actions:[d.genericEventSender]},o={actions:[d.onReceiveCapabilitiesRequest]},p={actions:[d.onReceiveClientInfoRequest]},q={actions:[d.onReceiveGenericDataMessageRequest]},r={actions:[d.onReceiveIceCandidateRequest]},s={actions:[d.genericEventSender]},t={actions:[d.genericEventSender]},u={actions:[d.genericEventSender]},v={actions:[d.onSendTerminateRequest],target:"terminated"},w={actions:[d.genericEventSender]},x={actions:[d.onReceiveParticipantUpdateRequest]},y={actions:[d.onReceiveRoomContextUpdateRequest]},z={actions:[d.onReceiveStateSyncNotifyRequest]},A={actions:[d.genericEventSender]},B={actions:[d.genericEventSender]},C={actions:[d.onSendUsersApprovalRequest]},D={actions:["defer"]},E={initial:"init",states:{init:{on:{sendInviteRequest:{actions:[a((g=b("ZenonSignalingInitState")).startPingTimer),g.onSendInvite],target:"inviteSent"},receiveInviteRequest:{target:"inviteReceived",actions:[a(g.startPingTimer),a(g.onReceiveInvite)]},receiveGenericDataMessageRequest:D,receiveIceCandidateRequest:D,sendGenericDataMessageRequest:D,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendClientInfoRequest:f,sendRemoveParticipantsRequest:w,sendUsersApprovalRequest:C,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:D,sendStateSyncUpdateRequest:D,sendSubscriptionRequest:u,sendTerminateRequest:v}},inviteSent:{on:{sendLocalSdpRequest:{actions:[d.genericEventSender],cond:(g=b("ZenonSignalingSMGuards")).sdpOfferSendGuard,target:"offerSdpSent"},sendIceCandidateRequest:D,receiveGenericDataMessageRequest:D,sendGenericDataMessageRequest:D,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendCapabilitiesRequest:t,sendClientInfoRequest:f,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:D,sendStateSyncUpdateRequest:D,sendSubscriptionRequest:u,sendTerminateRequest:v,sendUsersApprovalRequest:C}},offerSdpSent:{on:{receiveLocalSdpResponse:{actions:[a(d.onReceiveLocalSdpResponse)],cond:g.sdpJoinResponseReceiveGuard,target:"offerSdpAcknowledged"},receivePendingApprovalRequest:D,receiveRemoteSdpRequest:D,receiveInitiateRenegotiationRequest:D,sendGenericDataMessageRequest:D,sendIceCandidateRequest:D,sendMediaUpdateRequest:D,receiveGenericDataMessageRequest:D,receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendAddParticipantsRequest:s,sendAnswerIntentRequest:l,sendUsersApprovalRequest:C,sendClientInfoRequest:f,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:D,sendStateSyncUpdateRequest:D,sendSubscriptionRequest:u,sendTerminateRequest:v}},offerSdpAcknowledged:{on:{receivePendingApprovalRequest:{actions:[d.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:{actions:[b("ZenonSignalingOfferSdpSentState").onInviteResponseReceived,a(d.onReceiveRemoteSdpRequest)],cond:g.sdpAnswerReceiveGuard,target:"negotiationComplete"},receiveInitiateRenegotiationRequest:{actions:[a(d.onReceiveInitiateRenegotiationRequest)],target:"negotiationComplete"},sendGenericDataMessageRequest:D,sendMediaUpdateRequest:D,receiveGenericDataMessageRequest:D,sendIceCandidateRequest:n,receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendAddParticipantsRequest:s,sendAnswerIntentRequest:l,sendUsersApprovalRequest:C,sendClientInfoRequest:f,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v}},inviteReceived:{on:{sendInviteResponse:{actions:[b("ZenonSignalingInviteReceivedState").onSendInviteResponse],target:"inviteAcknowledged"},receiveCapabilitiesRequest:D,receiveClientInfoRequest:D,receiveGenericDataMessageRequest:D,receiveIceCandidateRequest:D,receiveParticipantUpdateRequest:D,receiveRemoteSdpRequest:D,sendGenericDataMessageRequest:D,receiveTerminateRequest:D,receiveRoomContextUpdateRequest:y,sendAnswerIntentRequest:l,sendIceCandidateRequest:n,sendUsersApprovalRequest:C,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v}},inviteAcknowledged:{on:{sendLocalSdpRequest:[{actions:[d.genericEventSender],cond:g.sdpOfferSendGuard,target:"offerSdpSent"},{actions:[d.genericEventSender],cond:g.sdpAnswerSendGuard,target:"negotiationComplete"}],receiveRemoteSdpRequest:{actions:[a(d.onReceiveRemoteSdpRequest)],cond:g.sdpOfferReceiveGuard,target:"offerSdpReceived"},sendGenericDataMessageRequest:D,receiveGenericDataMessageRequest:D,receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendAnswerIntentRequest:l,sendClientInfoRequest:f,sendIceCandidateRequest:n,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v,sendUsersApprovalRequest:C}},offerSdpReceived:{on:{sendLocalSdpRequest:{actions:[d.genericEventSender],cond:g.sdpAnswerSendGuard,target:"negotiationComplete"},sendGenericDataMessageRequest:D,receiveGenericDataMessageRequest:D,receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendAnswerIntentRequest:l,sendCapabilitiesRequest:t,sendUsersApprovalRequest:C,sendClientInfoRequest:f,sendIceCandidateRequest:n,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v}},negotiationComplete:{on:{receiveInitiateRenegotiationRequest:{actions:[a(d.onReceiveInitiateRenegotiationRequest)]},receiveLocalSdpResponse:{actions:[a(d.onReceiveLocalSdpResponse)],cond:g.sdpJoinResponseReceiveGuard},receiveMediaUpdateResponse:{actions:[a(b("ZenonSignalingNegotiationCompleteState").onReceiveMediaUpdateResponse)]},receivePendingApprovalRequest:{actions:[d.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:[{actions:[a(d.onReceiveRemoteSdpRequest)],cond:g.sdpOfferReceiveGuard,target:"renegotiating"},{actions:[a(b("ZenonSignalingNegotiationCompleteState").onReceiveAnswer)],cond:g.sdpAnswerReceiveGuard}],sendLocalSdpRequest:[{actions:[d.genericEventSender],cond:g.sdpOfferSendGuard,target:"renegotiating"},{actions:[d.genericEventSender],cond:g.sdpAnswerSendGuard}],sendMediaUpdateRequest:{actions:[a(b("ZenonSignalingNegotiationCompleteState").onSendMediaUpdateRequest)]},sendPingRequest:{actions:[d.genericEventSender]},receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveGenericDataMessageRequest:q,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,receiveTerminateRequest:k,sendAddParticipantsRequest:s,sendGenericDataMessageRequest:m,sendIceCandidateRequest:n,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v,sendUsersApprovalRequest:C}},renegotiating:{on:{sendLocalSdpRequest:[{actions:[d.genericEventSender],cond:g.sdpOfferSendGuard},{actions:[d.genericEventSender],cond:g.sdpAnswerSendGuard,target:"negotiationComplete"}],receiveRemoteSdpRequest:[{actions:["defer"],cond:g.sdpOfferReceiveGuard},{actions:[a(d.onReceiveRemoteSdpRequest)],cond:g.sdpAnswerReceiveGuard,target:"negotiationComplete"}],sendMediaUpdateRequest:D,receiveMediaUpdateResponse:D,receiveCapabilitiesRequest:o,receiveClientInfoRequest:p,receiveGenericDataMessageRequest:q,receiveIceCandidateRequest:r,receiveParticipantUpdateRequest:x,receiveRoomContextUpdateRequest:y,sendUsersApprovalRequest:C,receiveTerminateRequest:k,sendAddParticipantsRequest:s,sendIceCandidateRequest:n,sendRemoveParticipantsRequest:w,receiveStateSyncNotifyRequest:z,sendStateSyncUnsubscribeRequest:B,sendStateSyncUpdateRequest:A,sendSubscriptionRequest:u,sendTerminateRequest:v,sendGenericDataMessageRequest:m}},terminated:{entry:[a(b("ZenonSignalingTerminatedState").stopPingTimer)]}}};e.exports=c}),null);
__d("ZenonSignalingClient",["ZenonSignalingStateMachine","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e){var f=this;this.$5=null;this.$6=function(){};this.$1=a;var g=this.$7();this.$2=new(b("ZenonSignalingStateMachine"))(babelHelpers["extends"]({logEvent:function(a){return f.$6(a)},onInviteReceived:function(a,b){e(a,b,f)},sendSignalingEvent:function(a){return d.sendEvent(a)}},g,{signalingModel:a}));c.setReceiver(function(a,b,c){return f.$2.processReceiveEvent(a,b,c)});this.$3=c;this.$4=d}var c=a.prototype;c.getSignalingModel=function(){return this.$1};c.sendInvite=function(a,b){b={eventName:"inviteRequest",inviterID:"0",isRemoteOfferer:!1,otherParticipants:a,requestingVideo:!1,roomInfo:{name:"mock"}};this.$2.processSendEvent(b)};c.sendSdp=function(a,b){b={eventName:"localSdpRequest",mediaStates:b,sdp:a};this.$2.processSendEvent(b)};c.sendIceCandidate=function(a){a={eventName:"iceCandidateRequest",iceCandidates:[a]};this.$2.processSendEvent(a)};c.sendDismiss=function(a){this.$6({name:"dismissSent"});a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};this.$2.processSendEvent(a)};c.sendGenericDataMessage=function(a,b,c,d){b={data:b,eventName:"genericDataMessageRequest",recipientIDs:c,serviceRecipients:d,topic:a};this.$2.processSendEvent(b)};c.sendMediaUpdate=function(a){a={eventName:"mediaUpdateRequest",mediaStates:a};this.$2.processSendEvent(a)};c.sendAddParticipantsMessage=function(a){a={eventName:"addParticipantsRequest",participants:a};this.$2.processSendEvent(a)};c.sendRemoveParticipantsRequest=function(a){a={eventName:"removeParticipantsRequest",participants:a};this.$2.processSendEvent(a)};c.sendUsersApprovalRequest=function(a,b){a={approvalStatus:a,eventName:"usersApprovalRequest",targetUsers:b};this.$2.processSendEvent(a)};c.sendClientInfo=function(a,b){var c=this,d;b&&(d=new Map(),b.forEach(function(a,b){d.set(b,c.getSignalingModel().getStateSyncStore().updateInputState(b,a))}));b={eventName:"clientInfoRequest",initialSyncStates:d,userCapabilities:a};this.$2.processSendEvent(b)};c.sendStateSyncUnsubscribe=function(a){var b=this.getSignalingModel(),c=b.getStateSyncStore().unsubscribe(a);a={eventName:"stateSyncUnsubscribeRequest",topic:a,version:c.version};this.$2.processSendEvent(a);b.notify()};c.sendStateSyncUpdate=function(a,b){var c=this.getSignalingModel();b=c.getStateSyncStore().updateInputState(a,b);a={data:b.data!=null?b.data:void 0,eventName:"stateSyncUpdateRequest",topic:a,version:b.version};this.$2.processSendEvent(a);c.notify()};c.sendSubscriptionRequest=function(a){a={eventName:"subscriptionRequest",subscriptions:a};this.$2.processSendEvent(a)};c.receiveMessage=function(a){var b=a.getHeader();b=b.remoteSignalingID;b!=null&&this.$1.getRemoteSignalingID()!==b&&(this.$1.updateRemoteSignalingID(b),this.$6({name:"setRemoteSignalingID",remoteSignalingID:b}),this.$1.notify());this.$3.receiveMessage(a)};c.isTerminated=function(){return this.$2.getState()==="terminated"};c.sendAnswerIntent=function(){var a={eventName:"answerIntentRequest"};this.$2.processSendEvent(a)};c.respondToInvite=function(a){a={ackMessageId:"",eventName:"inviteResponse",status:a};this.$2.processSendEvent(a)};c.setSignalingEventHandlers=function(a){if(this.$5!=null){b("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$5=a};c.setLoggingEventHandler=function(a){this.$6=a,this.$3.setLoggingEventHandler(a)};c.$7=function(){return{onCapabilitiesReceived:this.$8("onCapabilitiesReceived"),onClientInfoReceived:this.$8("onClientInfoReceived"),onDismissReceived:this.$8("onDismissReceived"),onGenericDataMessageReceived:this.$8("onGenericDataMessageReceived"),onIceCandidateReceived:this.$8("onIceCandidateReceived"),onInviteAcknowledgeSent:this.$8("onInviteAcknowledgeSent"),onParticipantUpdateReceived:this.$8("onParticipantUpdateReceived"),onPendingApprovalReceived:this.$8("onPendingApprovalReceived"),onRenegotiationRequested:this.$8("onRenegotiationRequested"),onRoomContextUpdateReceived:this.$8("onRoomContextUpdateReceived"),onSdpReceived:this.$8("onSdpReceived")}};c.$8=function(a){var b=this;return function(){if(b.$5&&b.$5[a]){var c;(c=b.$5)[a].apply(c,arguments)}}};return a}();e.exports=a}),null);
__d("ZenonMWEventAggregator",["ZenonSignalingMessage","ZenonSignalingTypes","gkx","randomInt"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus,h=250;a=function(){function a(a,b){this.$3={},this.$4={},this.$5=0,this.$6=!1,this.$7=null,this.$8=null,this.$1=a,this.$2=b}var c=a.prototype;c.sendEvent=function(a){var c=[];switch(a.eventName){case"clientInfoRequest":this.$3.clientInfoRequest=a;c=this.$9();break;case"inviteRequest":this.$3.inviteRequest=a;c=this.$9();break;case"localSdpRequest":a.sdp.type==="offer"?this.$6?c=[a]:(this.$3.localSdpRequest=a,this.$6=!0,c=this.$9()):a.sdp.type==="answer"&&(this.$6?(this.$4.localSdpRequest=a,c=this.$10()):(this.$3.localSdpRequest=a,this.$6=!0,c=this.$9()));break;case"remoteSdpResponse":a.type==="offer"?a.status===g.OK?(this.$4.remoteSdpResponse=a,c=this.$10()):(this.$4={},c=[a]):c=[a];break;case"iceCandidateRequest":case"pingRequest":this.$1.getMediaModeManager().getMediaMode()==="p2p"&&(c=[a]);break;case"subscriptionRequest":!b("gkx")("1414812")?c=[a]:c=this.$11(a);break;case"usersApprovalRequest":case"iceCandidateResponse":case"addParticipantsRequest":case"dismissResponse":case"genericDataMessageRequest":case"initiateRenegotiationResponse":case"inviteResponse":case"mediaUpdateRequest":case"participantUpdateResponse":case"removeParticipantsRequest":case"stateSyncNotifyResponse":case"stateSyncUnsubscribeRequest":case"stateSyncUpdateRequest":case"terminateRequest":c=[a];break}this.$12(c,a)};c.$13=function(a){return{messageID:(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1),protocol:this.$1.getProtocol(),remoteInfo:this.$1.getRemoteInfo(),remoteSignalingID:this.$1.getRemoteSignalingID(),retryCount:0,roomInfo:this.$1.getRoomInfo(),sequenceNumber:this.$5++,signalingID:this.$1.getSignalingID(),userInfo:this.$1.getUserInfo()}};c.$9=function(){var a=this.$3,b=a.clientInfoRequest,c=a.inviteRequest;a=a.localSdpRequest;if(b!=null&&a!=null){this.$3={};return c!=null?[c,b,a]:[b,a]}return[]};c.$10=function(){var a=this.$4,b=a.localSdpRequest;a=a.remoteSdpResponse;if(a&&b){this.$4={};return[a,b]}return[]};c.$11=function(a){var b=this,c=[];this.$7!=null?this.$8=a:(c=[a],this.$7=window.setTimeout(function(){b.$8!=null&&(b.$12([b.$8],b.$8),b.$8=null),window.clearTimeout(b.$7),b.$7=null},h));return c};c.$12=function(a,c){if(a.length>0){c=(c=c.ackMessageId)!=null?c:(c=a.find(function(a){return a.ackMessageId}))==null?void 0:c.ackMessageId;c=this.$13(c);c=new(b("ZenonSignalingMessage"))(c,a);this.$2.sendMessage(c)}};return a}();e.exports=a}),null);
__d("ZenonMWSendMessageMutation",["regeneratorRuntime","Promise","RelayFBEnvironment","RelayModern","ZenonMWSendMessageMutation.graphql"],(function(a,b,c,d,e,f){"use strict";var g,h=b("RelayModern").commitMutation;b("RelayModern").graphql;function i(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:return c.abrupt("return",new(b("Promise"))(function(c,d){h(b("RelayFBEnvironment"),{mutation:g!==void 0?g:g=b("ZenonMWSendMessageMutation.graphql"),onCompleted:function(a){return c(a)},onError:function(a){return d(a)},variables:{input:{message:a}}})}));case 1:case"end":return c.stop()}},null,this)}function j(a){a=a.rtc_web_send_multiway_signaling_message;var b=null,c=null;a!=null&&(a.header!=null&&(b=JSON.parse(a.header)),a.body!=null&&(c=JSON.parse(a.body)));return{body:c,header:b}}a={sendMessage:function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(i(a));case 2:c=d.sent;return d.abrupt("return",j(c));case 4:case"end":return d.stop()}},null,this)}};e.exports=a}),null);
__d("ZenonMWMessageSender",["regeneratorRuntime","ZenonDebugLogger","ZenonMWMessageLogger","ZenonMWMessageTranslator","ZenonMWSendMessageMutation","ZenonMWTranslatorUtils","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.handleResponse=function(a){var c=a.header||null;a=a.body||null;var d=b("ZenonDebugLogger").getInstance();if(c!=null&&a!=null){c=b("ZenonMWTranslatorUtils").createMWMessage(c,a);d.logMWMessage("RECEIVED [GraphQL]",c);d.logReceivingMultiwayMessage(c);a=b("ZenonMWMessageTranslator").toSignalingMessage(c);if(this.$1!=null)this.$1(a),d.logProcessingMultiwayMessage(c);else throw b("unrecoverableViolation")("Should never have null message receiver","rtc_www")}};c.$3=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(b("ZenonMWSendMessageMutation").sendMessage(JSON.stringify(a)));case 2:c=d.sent,this.handleResponse(c);case 4:case"end":return d.stop()}},null,this)};c.sendMessage=function(a){a=b("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&(this.$4(a),this.$3(a))};c.setMessageReceiver=function(a){this.$1=a};c.setLoggingEventHandler=function(a){this.$2=a};c.$4=function(a){var c=b("ZenonDebugLogger").getInstance();c.logMWMessage("SENDING",a);c.logSendingMultiwayMessage(a);this.$2&&b("ZenonMWMessageLogger").logSentMessage(a,this.$2)};return a}();e.exports=a}),null);
__d("ZenonMWMessageSenderFactory",["ZenonMWMessageSender"],(function(a,b,c,d,e,f){"use strict";f.createMWMessageSender=function(){return new(b("ZenonMWMessageSender"))()}}),null);
__d("ZenonP2PEventAggregator",["ZenonSignalingMessage","randomInt"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$3={},this.$1=a,this.$2=b}var c=a.prototype;c.sendEvent=function(a){var c;c=(c=a.ackMessageId)!=null?c:null;c=this.$4(c);var d=[];switch(a.eventName){case"answerIntentRequest":this.$5();break;case"inviteResponse":this.$3.inviteResponse=a;d=this.$6();break;case"remoteSdpResponse":this.$3.remoteSdpResponse=a;d=this.$6();break;case"terminateRequest":this.$5();d.push(a);break}if(d.length>0){a=new(b("ZenonSignalingMessage"))(c,d);this.$2.sendMessage(a)}};c.setRemoteSignalingID=function(a){};c.$5=function(){var a=this.$4(null);a.remoteInfo={userID:a.userInfo.userID};var c={eventName:"answerIntentRequest"};a=new(b("ZenonSignalingMessage"))(a,[c]);this.$2.sendMessage(a)};c.$4=function(a){return{messageID:(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1),protocol:this.$1.getProtocol(),remoteInfo:this.$1.getRemoteInfo(),retryCount:0,roomInfo:this.$1.getRoomInfo(),signalingID:this.$1.getSignalingID(),userInfo:this.$1.getUserInfo()}};c.$6=function(){var a=this.$3,b=a.inviteResponse;a=a.remoteSdpResponse;if(b!=null&&a!=null){this.$3={};return[b,a]}return[]};return a}();e.exports=a}),null);
__d("ZenonP2PSendMessageMutation",["regeneratorRuntime","Promise","RelayFBEnvironment","RelayModern","ZenonP2PSendMessageMutation.graphql"],(function(a,b,c,d,e,f){"use strict";var g,h=b("RelayModern").commitMutation;b("RelayModern").graphql;function i(a,c,d){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new(b("Promise"))(function(e,f){h(b("RelayFBEnvironment"),{mutation:g!==void 0?g:g=b("ZenonP2PSendMessageMutation.graphql"),onCompleted:function(a){return e(a)},onError:function(a){return f(a)},variables:{input:{message:a,msg_id:d,recipient_id:c}}})}));case 1:case"end":return e.stop()}},null,this)}a={sendMessage:function(a,c,d){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(i(a,c,d));case 2:f=g.sent;return g.abrupt("return",(e=f.rtc_web_send_p2p_signaling_message)!=null?e:!1);case 4:case"end":return g.stop()}},null,this)}};e.exports=a}),null);
__d("ZenonP2PMessageSender",["ZenonP2PMessageTranslator","ZenonP2PSendMessageMutation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.sendMessage=function(a){var c=b("ZenonP2PMessageTranslator").toP2PMessage(a);if(c!=null){a=a.getHeader();var d=a.remoteInfo.userID;a=a.messageID;b("ZenonP2PSendMessageMutation").sendMessage(JSON.stringify(c),d,a)}};c.setMessageReceiver=function(a){};c.setLoggingEventHandler=function(a){};return a}();e.exports=a}),null);
__d("ZenonTransaction",["requireCond","cr:1577681","cr:1577682","cr:1577683","clearInterval","recoverableViolation","setInterval"],(function(a,b,c,d,e,f){"use strict";var g={WAITING_SEND_OR_RECEIVE_MESSAGE_STATE:1,REQUEST_PROCESSING_STATE:2,RESPONSE_PROCESSING_STATE:3,TERMINATED:4};Object.freeze(g);var h=3*1e3,i=60*1e3;a=function(){function a(a,b,c,d){this.$8=0,this.$2=a,this.$3=b,this.$1=g.WAITING_SEND_OR_RECEIVE_MESSAGE_STATE,this.$9=c,this.$10=d}var c=a.prototype;c.$11=function(){var a=this;if(this.$1!==g.REQUEST_PROCESSING_STATE){b("recoverableViolation")("Should never startRetryTimer in non-REQUEST_PROCESSING state: "+this.$1,"rtc_www");return}this.$12();this.$6=b("setInterval")(function(){a.$13()},h)};c.$14=function(){var a=this;if(this.$1!==g.REQUEST_PROCESSING_STATE){b("recoverableViolation")("Should never startTerminateTimer in non-REQUEST_PROCESSING state: "+this.$1,"rtc_www");return}this.$15();this.$7=b("setInterval")(function(){a.$16(),b("cr:1577681")&&a.$17(b("cr:1577681").FAIL)},i)};c.$13=function(){if(this.$1===g.TERMINATED){b("recoverableViolation")("Should never call onRetryTimer with transaction terminated.","rtc_www");return}if(this.$1!==g.REQUEST_PROCESSING_STATE){b("recoverableViolation")("Should never call onRetryTimer in non-REQUEST_PROCESSING state: "+this.$1+" for messageId: "+this.$2,"rtc_www");return}if(this.$4===null||this.$4===void 0){b("recoverableViolation")("Request should not be null or undefined when calling onRetryTimer","rtc_www");return}this.$8++;this.$4.setRetryCount(this.$8);this.$4!==null&&this.$4!==void 0&&this.$9(this.$4);this.$11()};c.$12=function(){b("clearInterval")(this.$6)};c.$15=function(){b("clearInterval")(this.$7)};c.$16=function(){this.$12(),this.$15(),this.$1=g.TERMINATED};c.$18=function(a){return isNaN(+a)?0:+a};c.$19=function(){b("cr:1577682")&&b("cr:1577683")&&b("cr:1577682").markerStart(b("cr:1577683").ZENON_TRANSACTION,this.$18(this.$2))};c.$17=function(a){b("cr:1577682")&&b("cr:1577683")&&b("cr:1577682").markerEnd(b("cr:1577683").ZENON_TRANSACTION,a,this.$18(this.$2))};c.$20=function(a,c){if(b("cr:1577682")&&b("cr:1577683")&&a){var d,e=this.$3.getSignalingID();d=(d=this.$3.getRemoteSignalingID())!=null?d:"";var f=this.$3.getUserInfo().userID,g=this.$3.getRoomInfo().name,h=this.$3.getProtocol();b("cr:1577682").markerPoint(b("cr:1577683").ZENON_TRANSACTION,a,{data:{"int":{retryCount:c},string:{protocol:h,remoteSignalingID:d,roomName:g,signalingID:e,userID:f}},instanceKey:this.$18(this.$2)})}};c.sendMessage=function(a){var c,d=a.getHeader().retryCount;switch(this.$1){case g.WAITING_SEND_OR_RECEIVE_MESSAGE_STATE:this.$19();this.$4=a;this.$1=g.REQUEST_PROCESSING_STATE;this.$9(this.$4);this.$11();this.$14();break;case g.REQUEST_PROCESSING_STATE:b("recoverableViolation")("Zenon should not generate an outgoing request more than once.","rtc_www");break;case g.RESPONSE_PROCESSING_STATE:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);if(this.$5===null||this.$5===void 0){this.$5=a;this.$9(this.$5);return}b("recoverableViolation")("Zenon should not generate a response to an incoming request more than once.","rtc_www");break;case g.TERMINATED:b("cr:1577681")&&this.$17(b("cr:1577681").SUCCESS);break;default:b("recoverableViolation")("ZenonTransaction is in unknown state: "+this.$1,"rtc_www");break}};c.receiveMessage=function(a){var c,d=a.getHeader().retryCount;switch(this.$1){case g.WAITING_SEND_OR_RECEIVE_MESSAGE_STATE:this.$19();this.$4=a;this.$1=g.RESPONSE_PROCESSING_STATE;this.$10(a);break;case g.REQUEST_PROCESSING_STATE:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);this.$16();this.$10(a);break;case g.RESPONSE_PROCESSING_STATE:this.$20((c=a.getEvents()[0])==null?void 0:c.eventName,d);this.$5!==null&&this.$5!==void 0&&(this.$9(this.$5),this.$20("send_back_same_response",d));break;case g.TERMINATED:b("cr:1577681")&&this.$17(b("cr:1577681").SUCCESS);break;default:b("recoverableViolation")("ZenonTransaction is in unknown state: "+this.$1,"rtc_www");break}};return a}();e.exports=a}),null);
__d("ZenonTransactionManager",["ZenonTransaction"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$4=function(){},this.$3=new Map(),this.$1=a,this.$2=b}var c=a.prototype;c.$5=function(a){var c=this;if(this.$3.has(a))return this.$3.get(a);this.$3.set(a,new(b("ZenonTransaction"))(a,this.$2,function(a){c.$1.sendMessage(a)},function(a){var b=a.getHeader(),d=b.messageID,e=b.protocol;b=a.getEvents();b.forEach(function(a){return c.$4(a,d,e)})}));return this.$3.get(a)};c.sendMessage=function(a){var b=a.getHeader();b=b.messageID;b=this.$5(b);b!==void 0&&b!==null&&b.sendMessage(a)};c.receiveMessage=function(a){var b=a.getHeader();b=b.messageID;b=this.$5(b);b!==void 0&&b!==null&&b.receiveMessage(a)};c.setReceiver=function(a){this.$4=a};c.setLoggingEventHandler=function(a){this.$1.setLoggingEventHandler(a)};return a}();e.exports=a}),null);
__d("ZenonProtocolConfiguration",["ZenonMWEventAggregator","ZenonMWMessageSenderFactory","ZenonP2PEventAggregator","ZenonP2PMessageSender","ZenonTransactionManager"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMWMessageSenderFactory").createMWMessageSender;a={getConfiguration:function(a){var c,d,e;a.getProtocol()==="p2p"?(c=new(b("ZenonP2PMessageSender"))(),d=new(b("ZenonTransactionManager"))(c,a),e=new(b("ZenonP2PEventAggregator"))(a,d)):(c=g(),d=new(b("ZenonTransactionManager"))(c,a),e=new(b("ZenonMWEventAggregator"))(a,d));return{eventAggregator:e,messageSender:c,transactionManager:d}}};e.exports=a}),null);
__d("ZenonMediaModeManager",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["MwCaller","MwCallee","MwppCaller","MwppCallee"]);a=function(){function a(){this.$1="sfu"}var b=a.prototype;b.onJoin=function(a,b,c,d){a=this.$2(a,b,c,d);switch(a){case g.MwppCaller:case g.MwppCallee:this.$3("p2p");return;case g.MwCaller:case g.MwCallee:this.$3("sfu");return}};b.onSfuEscalated=function(){this.$3("sfu")};b.getMediaMode=function(){return this.$1};b.$3=function(a){this.$1=a};b.$2=function(a,b,c,d){return a?b&&c===1?g.MwppCaller:g.MwCaller:b&&d?g.MwppCallee:g.MwCallee};return a}();e.exports=a}),null);
__d("jsbi",[],(function(a,b,c,d,e,f){(function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.JSBI=b()})(this,function(){"use strict";function a(b){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function i(){return i=h()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);b=Function.bind.apply(a,d);a=new b();return c&&g(a,c.prototype),a},i.apply(null,arguments)}function j(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function k(a){var b="function"==typeof Map?new Map():void 0;return k=function(a){function c(){return i(a,arguments,f(this).constructor)}if(null===a||!j(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),g(c,a)},k(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:l(a)}var n=function(c){var h=Math.abs,i=Math.max,j=Math.imul,k=Math.clz32;function g(a,c){if(b(this,g),a>g.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return a=m(this,f(g).call(this,a)),a.sign=c,a}return e(g,c),d(g,[{key:"toDebugString",value:function(){var a=["BigInt["],b=!0,c=!1,d=void 0;try{for(var e,e,f=this[Symbol.iterator]();!(b=(e=f.next()).done);b=!0)e=e.value,a.push((e?(e>>>0).toString(16):e)+", ")}catch(a){c=!0,d=a}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return a.push("]"),a.join("")}},{key:"toString",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>a||36<a)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(a&a-1)?g.__toStringBasePowerOfTwo(this,a):g.__toStringGeneric(this,a,!1)}},{key:"__copy",value:function(){for(var a=new g(this.length,this.sign),b=0;b<this.length;b++)a[b]=this[b];return a}},{key:"__trim",value:function(){for(var a=this.length,b=this[a-1];0===b;)a--,b=this[a-1],this.pop();return 0===a&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var a=0;a<this.length;a++)this[a]=0}},{key:"__clzmsd",value:function(){return k(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(a,b,c){c>this.length&&(c=this.length);for(var d=65535&a,a=a>>>16,e=0,f=65535&b,b=b>>>16,i=0;i<c;i++){var n=this.__digit(i),m=65535&n;n=n>>>16;var o=j(m,d);m=j(m,a);var p=j(n,d);n=j(n,a);var q=f+(65535&o);o=b+e+(q>>>16)+(o>>>16)+(65535&m)+(65535&p);f=(m>>>16)+(p>>>16)+(65535&n)+(o>>>16),e=f>>>16,f&=65535,b=n>>>16;this.__setDigit(i,65535&q|o<<16)}if(0!==e||0!==f||0!==b)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(a,b,c){for(var d,e=0,f=0;f<c;f++)d=this.__halfDigit(b+f)+a.__halfDigit(f)+e,e=d>>>16,this.__setHalfDigit(b+f,d);return e}},{key:"__inplaceSub",value:function(a,b,c){var d=0;if(1&b){b>>=1;for(var e=this.__digit(b),f=65535&e,k=0;k<c-1>>>1;k++){var l=a.__digit(k),m=(e>>>16)-(65535&l)-d;d=1&m>>>16,this.__setDigit(b+k,m<<16|65535&f),e=this.__digit(b+k+1),f=(65535&e)-(l>>>16)-d,d=1&f>>>16}m=a.__digit(k);l=(e>>>16)-(65535&m)-d;d=1&l>>>16,this.__setDigit(b+k,l<<16|65535&f);if(b+k+1>=this.length)throw new RangeError("out of bounds");0==(1&c)&&(e=this.__digit(b+k+1),f=(65535&e)-(m>>>16)-d,d=1&f>>>16,this.__setDigit(b+a.length,4294901760&e|65535&f))}else{b>>=1;for(var l=0;l<a.length-1;l++){k=this.__digit(b+l);m=a.__digit(l);e=(65535&k)-(65535&m)-d;d=1&e>>>16;f=(k>>>16)-(m>>>16)-d;d=1&f>>>16,this.__setDigit(b+l,f<<16|65535&e)}k=this.__digit(b+l);m=a.__digit(l);f=(65535&k)-(65535&m)-d;d=1&f>>>16;e=0;0==(1&c)&&(e=(k>>>16)-(m>>>16)-d,d=1&e>>>16),this.__setDigit(b+l,e<<16|65535&f)}return d}},{key:"__inplaceRightShift",value:function(a){if(0!==a){for(var b,c=this.__digit(0)>>>a,d=this.length-1,e=0;e<d;e++)b=this.__digit(e+1),this.__setDigit(e,b<<32-a|c),c=b>>>a;this.__setDigit(d,c)}}},{key:"__digit",value:function(a){return this[a]}},{key:"__unsignedDigit",value:function(a){return this[a]>>>0}},{key:"__setDigit",value:function(a,b){this[a]=0|b}},{key:"__setDigitGrow",value:function(a,b){this[a]=0|b}},{key:"__halfDigitLength",value:function(){var a=this.length;return 65535>=this.__unsignedDigit(a-1)?2*a-1:2*a}},{key:"__halfDigit",value:function(a){return 65535&this[a>>>1]>>>((1&a)<<4)}},{key:"__setHalfDigit",value:function(a,b){var c=a>>>1,d=this.__digit(c);a=1&a?65535&d|b<<16:4294901760&d|65535&b;this.__setDigit(c,a)}}],[{key:"BigInt",value:function(b){var c=Math.floor,d=Number.isFinite;if("number"==typeof b){if(0===b)return g.__zero();if((0|b)===b)return 0>b?g.__oneDigit(-b,!0):g.__oneDigit(b,!1);if(!d(b)||c(b)!==b)throw new RangeError("The number "+b+" cannot be converted to BigInt because it is not an integer");return g.__fromDouble(b)}if("string"==typeof b){d=g.__fromString(b);if(null===d)throw new SyntaxError("Cannot convert "+b+" to a BigInt");return d}if("boolean"==typeof b)return!0===b?g.__oneDigit(1,!1):g.__zero();if("object"===a(b)){if(b.constructor===g)return b;c=g.__toPrimitive(b);return g.BigInt(c)}throw new TypeError("Cannot convert "+b+" to a BigInt")}},{key:"toNumber",value:function(a){var b=a.length;if(0===b)return 0;if(1===b){var c=a.__unsignedDigit(0);return a.sign?-c:c}c=a.__digit(b-1);var d=k(c),e=32*b-d;if(1024<e)return a.sign?-Infinity:1/0;e=e-1;c=c;b=b-1;d=d+1;var f=32===d?0:c<<d;f>>>=12;var h=d-12,i=12<=d?0:c<<20+d;d=20+d;0<h&&0<b&&(b--,c=a.__digit(b),f|=c>>>32-h,i=c<<h,d=h),0<d&&0<b&&(b--,c=a.__digit(b),i|=c>>>32-d,d-=32);h=g.__decideRounding(a,d,b,c);if((1===h||0===h&&1==(1&i))&&(i=i+1>>>0,0===i&&(f++,0!=f>>>20&&(f=0,e++,1023<e))))return a.sign?-Infinity:1/0;d=a.sign?-2147483648:0;return e=e+1023<<20,g.__kBitConversionInts[1]=d|e|f,g.__kBitConversionInts[0]=i,g.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(a){if(0===a.length)return a;var b=a.__copy();return b.sign=!a.sign,b}},{key:"bitwiseNot",value:function(a){return a.sign?g.__absoluteSubOne(a).__trim():g.__absoluteAddOne(a,!0)}},{key:"exponentiate",value:function(a,b){if(b.sign)throw new RangeError("Exponent must be positive");if(0===b.length)return g.__oneDigit(1,!1);if(0===a.length)return a;if(1===a.length&&1===a.__digit(0))return a.sign&&0==(1&b.__digit(0))?g.unaryMinus(a):a;if(1<b.length)throw new RangeError("BigInt too big");b=b.__unsignedDigit(0);if(1===b)return a;if(b>=g.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===a.length&&2===a.__digit(0)){var c=1+(b>>>5),d=a.sign&&0!=(1&b);d=new g(c,d);d.__initializeDigits();var e=1<<(31&b);return d.__setDigit(c-1,e),d}c=null;e=a;for(0!=(1&b)&&(c=a),b>>=1;0!==b;b>>=1)e=g.multiply(e,e),0!=(1&b)&&(null===c?c=e:c=g.multiply(c,e));return c}},{key:"multiply",value:function(a,b){if(0===a.length)return a;if(0===b.length)return b;var c=a.length+b.length;32<=a.__clzmsd()+b.__clzmsd()&&c--;c=new g(c,a.sign!==b.sign);c.__initializeDigits();for(var d=0;d<a.length;d++)g.__multiplyAccumulate(b,a.__digit(d),c,d);return c.__trim()}},{key:"divide",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return g.__zero();var c=a.sign!==b.sign,d=b.__unsignedDigit(0);if(1===b.length&&65535>=d){if(1===d)return c===a.sign?a:g.unaryMinus(a);d=g.__absoluteDivSmall(a,d,null)}else d=g.__absoluteDivLarge(a,b,!0,!1);return d.sign=c,d.__trim()}},{key:"remainder",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return a;var c=b.__unsignedDigit(0);if(1===b.length&&65535>=c){if(1===c)return g.__zero();c=g.__absoluteModSmall(a,c);return 0===c?g.__zero():g.__oneDigit(c,a.sign)}c=g.__absoluteDivLarge(a,b,!1,!0);return c.sign=a.sign,c.__trim()}},{key:"add",value:function(a,b){var c=a.sign;return c===b.sign?g.__absoluteAdd(a,b,c):0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c)}},{key:"subtract",value:function(a,b){var c=a.sign;return c===b.sign?0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c):g.__absoluteAdd(a,b,c)}},{key:"leftShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__rightShiftByAbsolute(a,b):g.__leftShiftByAbsolute(a,b)}},{key:"signedRightShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__leftShiftByAbsolute(a,b):g.__rightShiftByAbsolute(a,b)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(a,b){return 0>g.__compareToBigInt(a,b)}},{key:"lessThanOrEqual",value:function(a,b){return 0>=g.__compareToBigInt(a,b)}},{key:"greaterThan",value:function(a,b){return 0<g.__compareToBigInt(a,b)}},{key:"greaterThanOrEqual",value:function(a,b){return 0<=g.__compareToBigInt(a,b)}},{key:"equal",value:function(a,b){if(a.sign!==b.sign)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a.__digit(c)!==b.__digit(c))return!1;return!0}},{key:"notEqual",value:function(a,b){return!g.equal(a,b)}},{key:"bitwiseAnd",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteAnd(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length)+1;c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return c=g.__absoluteOr(c,d,c),g.__absoluteAddOne(c,!0,c).__trim()}if(a.sign){d=[b,a];a=d[0],b=d[1]}return g.__absoluteAndNot(a,g.__absoluteSubOne(b)).__trim()}},{key:"bitwiseXor",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteXor(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length);c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return g.__absoluteXor(c,d,c).__trim()}d=i(a.length,b.length)+1;if(a.sign){c=[b,a];a=c[0],b=c[1]}c=g.__absoluteSubOne(b,d);return c=g.__absoluteXor(c,a,c),g.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(a,b){var c=i(a.length,b.length);if(!a.sign&&!b.sign)return g.__absoluteOr(a,b).__trim();if(a.sign&&b.sign){var d=g.__absoluteSubOne(a,c),e=g.__absoluteSubOne(b);return d=g.__absoluteAnd(d,e,d),g.__absoluteAddOne(d,!0,d).__trim()}if(a.sign){e=[b,a];a=e[0],b=e[1]}d=g.__absoluteSubOne(b,c);return d=g.__absoluteAndNot(d,a,d),g.__absoluteAddOne(d,!0,d).__trim()}},{key:"asIntN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=b.__unsignedDigit(c-1),e=1<<(31&a-1);if(b.length===c&&d<e)return b;if(!((d&e)===e))return g.__truncateToNBits(a,b);if(!b.sign)return g.__truncateAndSubFromPowerOfTwo(a,b,!0);if(0==(d&e-1)){for(var f=c-2;0<=f;f--)if(0!==b.__digit(f))return g.__truncateAndSubFromPowerOfTwo(a,b,!1);return b.length===c&&d===e?b:g.__truncateToNBits(a,b)}return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}},{key:"asUintN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(b.sign){if(a>g.__kMaxLengthBits)throw new RangeError("BigInt too big");return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=31&a;if(b.length==c){if(0==d)return b;c=b.__digit(c-1);if(0==c>>>d)return b}return g.__truncateToNBits(a,b)}},{key:"ADD",value:function(a,b){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a)return"string"!=typeof b&&(b=b.toString()),a+b;if("string"==typeof b)return a.toString()+b;if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)&&g.__isBigInt(b))return g.add(a,b);if("number"==typeof a&&"number"==typeof b)return a+b;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(a,b){return g.__compare(a,b,0)}},{key:"LE",value:function(a,b){return g.__compare(a,b,1)}},{key:"GT",value:function(a,b){return g.__compare(a,b,2)}},{key:"GE",value:function(a,b){return g.__compare(a,b,3)}},{key:"EQ",value:function(b,c){for(;;){if(g.__isBigInt(b))return g.__isBigInt(c)?g.equal(b,c):g.EQ(c,b);if("number"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("string"==typeof b){if(g.__isBigInt(c))return b=g.__fromString(b),null!==b&&g.equal(b,c);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("boolean"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,+b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("symbol"===a(b)){if(g.__isBigInt(c))return!1;if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("object"===a(b)){if("object"===a(c)&&c.constructor!==g)return b==c;b=g.__toPrimitive(b)}else return b==c}}},{key:"NE",value:function(a,b){return!g.EQ(a,b)}},{key:"__zero",value:function(){return new g(0,!1)}},{key:"__oneDigit",value:function(a,b){b=new g(1,b);return b.__setDigit(0,a),b}},{key:"__decideRounding",value:function(a,b,c,d){if(0<b)return-1;if(0>b)b=-b-1;else{if(0===c)return-1;c--,d=a.__digit(c),b=31}b=1<<b;if(0==(d&b))return-1;if(b-=1,0!=(d&b))return 1;for(;0<c;)if(c--,0!==a.__digit(c))return 1;return 0}},{key:"__fromDouble",value:function(a){g.__kBitConversionDouble[0]=a;var b,c=2047&g.__kBitConversionInts[1]>>>20;c=c-1023;var d=(c>>>5)+1;a=new g(d,0>a);var e=1048575&g.__kBitConversionInts[1]|1048576,f=g.__kBitConversionInts[0],k=20;c=31&c;var n=0;if(c<k){var m=k-c;n=m+32,b=e>>>m,e=e<<32-m|f>>>m,f<<=32-m}else if(c===k)n=32,b=e,e=f;else{m=c-k;n=32-m,b=e<<m|f>>>32-m,e=f<<m}a.__setDigit(d-1,b);for(var c=d-2;0<=c;c--)0<n?(n-=32,b=e,e=f):b=0,a.__setDigit(c,b);return a.__trim()}},{key:"__isWhitespace",value:function(a){return!!(13>=a&&9<=a)||(159>=a?32==a:131071>=a?160==a||5760==a:196607>=a?(a&=131071,10>=a||40==a||41==a||47==a||95==a||4096==a):65279==a)}},{key:"__fromString",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=0,d=a.length,e=0;if(e===d)return g.__zero();for(var f=a.charCodeAt(e);g.__isWhitespace(f);){if(++e===d)return g.__zero();f=a.charCodeAt(e)}if(43===f){if(++e===d)return null;f=a.charCodeAt(e),c=1}else if(45===f){if(++e===d)return null;f=a.charCodeAt(e),c=-1}if(0===b){if(b=10,48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(b=16,++e===d)return null;f=a.charCodeAt(e)}else if(79===f||111===f){if(b=8,++e===d)return null;f=a.charCodeAt(e)}else if(66===f||98===f){if(b=2,++e===d)return null;f=a.charCodeAt(e)}}}else if(16===b&&48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(++e===d)return null;f=a.charCodeAt(e)}}for(;48===f;){if(++e===d)return g.__zero();f=a.charCodeAt(e)}var m=d-e,i=g.__kMaxBitsPerChar[b],j=g.__kBitsPerCharTableMultiplier-1;if(m>1073741824/i)return null;var k=i*m+j>>>g.__kBitsPerCharTableShift,l=new g(k+31>>>5,!1),n=10>b?b:10,o=10<b?b-10:0;if(0==(b&b-1)){i>>=g.__kBitsPerCharTableShift;var p=[],q=[],r=!1;do{for(var s,t=0,u=0;;){if(void 0,f-48>>>0<n)s=f-48;else if((32|f)-97>>>0<o)s=(32|f)-87;else{r=!0;break}if(u+=i,t=t<<i|s,++e===d){r=!0;break}if(f=a.charCodeAt(e),32<u+i)break}p.push(t),q.push(u)}while(!r);g.__fillFromParts(l,p,q)}else{l.__initializeDigits();var v=!1,w=0;do{for(var x,y=0,z=1;;){if(void 0,f-48>>>0<n)x=f-48;else if((32|f)-97>>>0<o)x=(32|f)-87;else{v=!0;break}var A=z*b;if(4294967295<A)break;if(z=A,y=y*b+x,w++,++e===d){v=!0;break}f=a.charCodeAt(e)}j=32*g.__kBitsPerCharTableMultiplier-1;var B=i*w+j>>>g.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(z,y,B)}while(!v)}if(e!==d){if(!g.__isWhitespace(f))return null;for(e++;e<d;e++)if(f=a.charCodeAt(e),!g.__isWhitespace(f))return null}return 0!==c&&10!==b?null:(l.sign=-1===c,l.__trim())}},{key:"__fillFromParts",value:function(a,b,c){for(var d=0,e=0,f=0,k=b.length-1;0<=k;k--){var l=b[k],m=c[k];e|=l<<f,f+=m,32===f?(a.__setDigit(d++,e),f=0,e=0):32<f&&(a.__setDigit(d++,e),f-=32,e=l>>>m-f)}if(0!==e){if(d>=a.length)throw new Error("implementation bug");a.__setDigit(d++,e)}for(;d<a.length;d++)a.__setDigit(d,0)}},{key:"__toStringBasePowerOfTwo",value:function(a,b){var c=a.length,d=b-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);d=d;b=b-1;var e=a.__digit(c-1),f=k(e);f=0|(32*c-f+d-1)/d;if(a.sign&&f++,268435456<f)throw new Error("string too long");for(var h=Array(f),f=f-1,l=0,n=0,o=0;o<c-1;o++){var p=a.__digit(o),q=(l|p<<n)&b;h[f--]=g.__kConversionChars[q];q=d-n;for(l=p>>>q,n=32-q;n>=d;)h[f--]=g.__kConversionChars[l&b],l>>>=d,n-=d}p=(l|e<<n)&b;for(h[f--]=g.__kConversionChars[p],l=e>>>d-n;0!==l;)h[f--]=g.__kConversionChars[l&b],l>>>=d;if(a.sign&&(h[f--]="-"),-1!==f)throw new Error("implementation bug");return h.join("")}},{key:"__toStringGeneric",value:function(a,b,c){var d=a.length;if(0===d)return"";if(1===d){var e=a.__unsignedDigit(0).toString(b);return!1===c&&a.sign&&(e="-"+e),e}e=32*d-k(a.__digit(d-1));d=g.__kMaxBitsPerChar[b];d=d-1;e=e*g.__kBitsPerCharTableMultiplier;e+=d-1,e=0|e/d;var f;d=e+1>>1;e=g.exponentiate(g.__oneDigit(b,!1),g.__oneDigit(d,!1));var h=e.__unsignedDigit(0);if(1===e.length&&65535>=h){f=new g(a.length,!1),f.__initializeDigits();for(var i,j=0,l=2*a.length-1;0<=l;l--)i=j<<16|a.__halfDigit(l),f.__setHalfDigit(l,0|i/h),j=0|i%h;i=j.toString(b)}else{h=g.__absoluteDivLarge(a,e,!0,!0);f=h.quotient;l=h.remainder.__trim();i=g.__toStringGeneric(l,b,!0)}f.__trim();for(var j=g.__toStringGeneric(f,b,!0);i.length<d;)i="0"+i;return!1===c&&a.sign&&(j="-"+j),j+i}},{key:"__unequalSign",value:function(a){return a?-1:1}},{key:"__absoluteGreater",value:function(a){return a?-1:1}},{key:"__absoluteLess",value:function(a){return a?1:-1}},{key:"__compareToBigInt",value:function(a,b){var c=a.sign;if(c!==b.sign)return g.__unequalSign(c);a=g.__absoluteCompare(a,b);return 0<a?g.__absoluteGreater(c):0>a?g.__absoluteLess(c):0}},{key:"__compareToNumber",value:function(a,b){if(!0|b){var c=a.sign,d=0>b;if(c!==d)return g.__unequalSign(c);if(0===a.length){if(d)throw new Error("implementation bug");return 0===b?0:-1}if(1<a.length)return g.__absoluteGreater(c);d=h(b);var e=a.__unsignedDigit(0);return e>d?g.__absoluteGreater(c):e<d?g.__absoluteLess(c):0}return g.__compareToDouble(a,b)}},{key:"__compareToDouble",value:function(a,b){if(b!==b)return b;if(b===1/0)return-1;if(b===-Infinity)return 1;var c=a.sign;if(c!==0>b)return g.__unequalSign(c);if(0===b)throw new Error("implementation bug: should be handled elsewhere");if(0===a.length)return-1;g.__kBitConversionDouble[0]=b;b=2047&g.__kBitConversionInts[1]>>>20;if(2047==b)throw new Error("implementation bug: handled elsewhere");b=b-1023;if(0>b)return g.__absoluteGreater(c);var d=a.length,e=a.__digit(d-1),f=k(e),l=32*d-f;b=b+1;if(l<b)return g.__absoluteLess(c);if(l>b)return g.__absoluteGreater(c);b=1048576|1048575&g.__kBitConversionInts[1];var m=g.__kBitConversionInts[0],o=20;f=31-f;if(f!==(l-1)%31)throw new Error("implementation bug");var p;l=0;if(f<o){var q=o-f;l=q+32,p=b>>>q,b=b<<32-q|m>>>q,m<<=32-q}else if(f===o)l=32,p=b,b=m;else{q=f-o;l=32-q,p=b<<q|m>>>32-q,b=m<<q}if(e>>>=0,p>>>=0,e>p)return g.__absoluteGreater(c);if(e<p)return g.__absoluteLess(c);for(var f=d-2;0<=f;f--){0<l?(l-=32,p=b>>>0,b=m,m=0):p=0;o=a.__unsignedDigit(f);if(o>p)return g.__absoluteGreater(c);if(o<p)return g.__absoluteLess(c)}if(0!==b||0!==m){if(0===l)throw new Error("implementation bug");return g.__absoluteLess(c)}return 0}},{key:"__equalToNumber",value:function(a,b){return b|0===b?0===b?0===a.length:1===a.length&&a.sign===0>b&&a.__unsignedDigit(0)===h(b):0===g.__compareToDouble(a,b)}},{key:"__comparisonResultToBool",value:function(a,b){switch(b){case 0:return 0>a;case 1:return 0>=a;case 2:return 0<a;case 3:return 0<=a}throw new Error("unreachable")}},{key:"__compare",value:function(a,b,c){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a&&"string"==typeof b)switch(c){case 0:return a<b;case 1:return a<=b;case 2:return a>b;case 3:return a>=b}if(g.__isBigInt(a)&&"string"==typeof b)return b=g.__fromString(b),null!==b&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("string"==typeof a&&g.__isBigInt(b))return a=g.__fromString(a),null!==a&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)){if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("number"!=typeof b)throw new Error("implementation bug");return g.__comparisonResultToBool(g.__compareToNumber(a,b),c)}if("number"!=typeof a)throw new Error("implementation bug");if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToNumber(b,a),2^c);if("number"!=typeof b)throw new Error("implementation bug");return 0===c?a<b:1===c?a<=b:2===c?a>b:3===c?a>=b:void 0}},{key:"__absoluteAdd",value:function(a,b,c){if(a.length<b.length)return g.__absoluteAdd(b,a,c);if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);var d=a.length;(0===a.__clzmsd()||b.length===a.length&&0===b.__clzmsd())&&d++;for(var d=new g(d,c),c=0,e=0;e<b.length;e++){var f=b.__digit(e),h=a.__digit(e),m=(65535&h)+(65535&f)+c;h=(h>>>16)+(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}for(;e<a.length;e++){f=a.__digit(e);m=(65535&f)+c;h=(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}return e<d.length&&d.__setDigit(e,c),d.__trim()}},{key:"__absoluteSub",value:function(a,b,c){if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);for(var c=new g(a.length,c),d=0,e=0;e<b.length;e++){var f=a.__digit(e),l=b.__digit(e),m=(65535&f)-(65535&l)-d;d=1&m>>>16;f=(f>>>16)-(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}for(;e<a.length;e++){l=a.__digit(e);m=(65535&l)-d;d=1&m>>>16;f=(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}return c.__trim()}},{key:"__absoluteAddOne",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length;null===c?c=new g(d,b):c.sign=b;for(var e=!0,f=0;f<d;f++){var k=a.__digit(f),l=-1===k;e&&(k=0|k+1),e=l,c.__setDigit(f,k)}return e&&c.__setDigitGrow(d,1),c}},{key:"__absoluteSubOne",value:function(a,b){var c=a.length;b=b||c;for(var d=new g(b,!1),e=!0,f=0;f<c;f++){var k=a.__digit(f),l=0===k;e&&(k=0|k-1),e=l,d.__setDigit(f,k)}for(var l=c;l<b;l++)d.__setDigit(l,0);return d}},{key:"__absoluteAnd",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,e,b=m,n}var k=f;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&b.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteAndNot",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;d<e&&(f=d);var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&~b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteOr",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)|b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteXor",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)^b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteCompare",value:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=a.length-1;0<=c&&a.__digit(c)===b.__digit(c);)c--;return 0>c?0:a.__unsignedDigit(c)>b.__unsignedDigit(c)?1:-1}},{key:"__multiplyAccumulate",value:function(a,b,c,d){if(0!==b){for(var e=65535&b,b=b>>>16,f=0,g=0,k=0,l=0;l<a.length;l++,d++){var m=c.__digit(d),n=65535&m,o=m>>>16,p=a.__digit(l),q=65535&p;p=p>>>16;var r=j(q,e);q=j(q,b);var s=j(p,e);p=j(p,b);n+=g+(65535&r),o+=k+f+(n>>>16)+(r>>>16)+(65535&q)+(65535&s),f=o>>>16,g=(q>>>16)+(s>>>16)+(65535&p)+f,f=g>>>16,g&=65535,k=p>>>16,m=65535&n|o<<16,c.__setDigit(d,m)}for(;0!==f||0!==g||0!==k;d++){r=c.__digit(d);q=(65535&r)+g;s=(r>>>16)+(q>>>16)+k+f;g=0,k=0,f=s>>>16,r=65535&q|s<<16,c.__setDigit(d,r)}}}},{key:"__internalMultiplyAdd",value:function(a,b,c,d,e){for(var c=c,f=0,h=0;h<d;h++){var l=a.__digit(h),m=j(65535&l,b),n=(65535&m)+f+c;c=n>>>16;l=j(l>>>16,b);m=(65535&l)+(m>>>16)+c;c=m>>>16,f=l>>>16,e.__setDigit(h,m<<16|65535&n)}if(e.length>d)for(e.__setDigit(d++,c+f);d<e.length;)e.__setDigit(d++,0);else if(0!==c+f)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(a,b,c){null===c&&(c=new g(a.length,!1));for(var d=0,e=2*a.length-1;0<=e;e-=2){var f=(d<<16|a.__halfDigit(e))>>>0,k=0|f/b;d=0|f%b,f=(d<<16|a.__halfDigit(e-1))>>>0;var l=0|f/b;d=0|f%b,c.__setDigit(e>>>1,k<<16|l)}return c}},{key:"__absoluteModSmall",value:function(a,b){for(var c,d=0,e=2*a.length-1;0<=e;e--)c=(d<<16|a.__halfDigit(e))>>>0,d=0|c%b;return d}},{key:"__absoluteDivLarge",value:function(a,b,c,d){var f=b.__halfDigitLength(),e=b.length,n=a.__halfDigitLength()-f,i=null;c&&(i=new g(n+2>>>1,!1),i.__initializeDigits());var l=new g(f+2>>>1,!1);l.__initializeDigits();var m=g.__clz16(b.__halfDigit(f-1));0<m&&(b=g.__specialLeftShift(b,m,0));for(var a=g.__specialLeftShift(a,m,1),k=b.__halfDigit(f-1),o=0,n=n;0<=n;n--){var p=65535,q=a.__halfDigit(n+f);if(q!==k){q=(q<<16|a.__halfDigit(n+f-1))>>>0;p=0|q/k;for(var q=0|q%k,r=b.__halfDigit(f-2),s=a.__halfDigit(n+f-2);j(p,r)>>>0>(q<<16|s)>>>0&&(p--,q+=k,!(65535<q)););}g.__internalMultiplyAdd(b,p,0,e,l);r=a.__inplaceSub(l,n,f+1);0!==r&&(r=a.__inplaceAdd(b,n,f),a.__setHalfDigit(n+f,a.__halfDigit(n+f)+r),p--),c&&(1&n?o=p<<16:i.__setDigit(n>>>1,o|p))}return d?(a.__inplaceRightShift(m),c?{quotient:i,remainder:a}:a):c?i:void 0}},{key:"__clz16",value:function(a){return k(a)-16}},{key:"__specialLeftShift",value:function(a,b,c){var e=a.length,d=new g(e+c,!1);if(0===b){for(var f=0;f<e;f++)d.__setDigit(f,a.__digit(f));return 0<c&&d.__setDigit(e,0),d}for(var j,f=0,l=0;l<e;l++)j=a.__digit(l),d.__setDigit(l,j<<b|f),f=j>>>32-b;return 0<c&&d.__setDigit(e,f),d}},{key:"__leftShiftByAbsolute",value:function(a,b){b=g.__toShiftAmount(b);if(0>b)throw new RangeError("BigInt too big");var c=b>>>5;b=31&b;var d=a.length,e=0!==b&&0!=a.__digit(d-1)>>>32-b,f=d+c+(e?1:0),m=new g(f,a.sign);if(0===b){for(var n=0;n<c;n++)m.__setDigit(n,0);for(;n<f;n++)m.__setDigit(n,a.__digit(n-c))}else{for(var n=0,f=0;f<c;f++)m.__setDigit(f,0);for(var o,f=0;f<d;f++)o=a.__digit(f),m.__setDigit(f+c,o<<b|n),n=o>>>32-b;if(e)m.__setDigit(d+c,n);else if(0!==n)throw new Error("implementation bug")}return m.__trim()}},{key:"__rightShiftByAbsolute",value:function(a,b){var c=a.length,d=a.sign;b=g.__toShiftAmount(b);if(0>b)return g.__rightShiftByMaximum(d);var e=b>>>5;b=31&b;var f=c-e;if(0>=f)return g.__rightShiftByMaximum(d);var i=!1;if(d)if(0!=(a.__digit(e)&(1<<b)-1))i=!0;else for(var m=0;m<e;m++)if(0!==a.__digit(m)){i=!0;break}if(i&&0===b){m=a.__digit(c-1);0==~m&&f++}m=new g(f,d);if(0===b)for(var f=e;f<c;f++)m.__setDigit(f-e,a.__digit(f));else{for(var n,d=a.__digit(e)>>>b,f=c-e-1,c=0;c<f;c++)n=a.__digit(c+e+1),m.__setDigit(c,n<<32-b|d),d=n>>>b;m.__setDigit(f,d)}return i&&(m=g.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(a){return a?g.__oneDigit(1,!0):g.__zero()}},{key:"__toShiftAmount",value:function(a){if(1<a.length)return-1;a=a.__unsignedDigit(0);return a>g.__kMaxLengthBits?-1:a}},{key:"__toPrimitive",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==a(b))return b;if(b.constructor===g)return b;var d=b[Symbol.toPrimitive];if(d){var e=d(c);if("object"!==a(e))return e;throw new TypeError("Cannot convert object to primitive value")}var f=b.valueOf;if(f){var k=f.call(b);if("object"!==a(k))return k}var l=b.toString;if(l){var m=l.call(b);if("object"!==a(m))return m}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(a){return g.__isBigInt(a)?a:+a}},{key:"__isBigInt",value:function(b){return"object"===a(b)&&b.constructor===g}},{key:"__truncateToNBits",value:function(a,b){for(var c=a+31>>>5,d=new g(c,b.sign),c=c-1,e=0;e<c;e++)d.__setDigit(e,b.__digit(e));e=b.__digit(c);if(0!=(31&a)){b=32-(31&a);e=e<<b>>>b}return d.__setDigit(c,e),d.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(a,b,c){for(var d=Math.min,e=a+31>>>5,c=new g(e,c),f=0,e=e-1,h=0,d=d(e,b.length);f<d;f++){var j=b.__digit(f),l=0-(65535&j)-h;h=1&l>>>16;j=0-(j>>>16)-h;h=1&j>>>16,c.__setDigit(f,65535&l|j<<16)}for(;f<e;f++)c.__setDigit(f,0|-h);l=e<b.length?b.__digit(e):0;j=31&a;if(0===j){d=0-(65535&l)-h;h=1&d>>>16;f=0-(l>>>16)-h;b=65535&d|f<<16}else{a=32-j;l=l<<a>>>a;d=1<<32-a;f=(65535&d)-(65535&l)-h;h=1&f>>>16;j=(d>>>16)-(l>>>16)-h;b=65535&f|j<<16,b&=d-1}return c.__setDigit(e,b),c.__trim()}},{key:"__digitPow",value:function(a,b){for(var c=1;0<b;)1&b&&(c*=a),b>>>=1,a*=a;return c}}]),g}(k(Array));return n.__kMaxLength=33554432,n.__kMaxLengthBits=n.__kMaxLength<<5,n.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],n.__kBitsPerCharTableShift=5,n.__kBitsPerCharTableMultiplier=1<<n.__kBitsPerCharTableShift,n.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.__kBitConversionBuffer=new ArrayBuffer(8),n.__kBitConversionDouble=new Float64Array(n.__kBitConversionBuffer),n.__kBitConversionInts=new Int32Array(n.__kBitConversionBuffer),n})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(a,b,c,d,e,f){var g=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),h=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:g.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:g.CT_BOOLEAN_FALSE}),i=[g.CT_STOP,0,g.CT_BOOLEAN_TRUE,g.CT_BYTE,g.CT_DOUBLE,0,g.CT_I16,0,g.CT_I32,0,g.CT_I64,g.CT_BINARY,g.CT_STRUCT,g.CT_MAP,g.CT_SET,g.CT_LIST,0,0,0,g.CT_FLOAT],j=Math.pow(2,7)-1,k=-1*Math.pow(2,7),l=Math.pow(2,15)-1,m=-1*Math.pow(2,15),n=Math.pow(2,31)-1,o=-1*Math.pow(2,31),p=Math.pow(2,32)-1,q=(a=b("jsbi")).BigInt("9223372036854775807"),r=a.BigInt("-9223372036854775808"),s=a.BigInt("18446744073709551615"),t=a.BigInt(63),u=a.BigInt(1),v=a.BigInt(0),w=a.BigInt(7),x=a.BigInt(70),y=a.BigInt(127),z=a.BigInt(128),A=Math.pow(2,4);c=function(){"use strict";function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var c=a.prototype;c.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};c.readStructEnd=function(){this.$3=this.$2.pop()};c.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};c.writeStructEnd=function(){this.$3=this.$2.pop();return 0};c.writeFieldBegin=function(a){if(a.ftype===b("ThriftTypes").BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,h.NONE)};c.writeListBegin=function(a){return this.$8(a)};c.writeSetBegin=function(a){return this.$8(a)};c.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};c.$7=function(a,b){var c=0;b=b===h.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=A-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};c.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=A-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};c.readFieldBegin=function(){var a=this.$1.readByte(),c=a&15;if(c===b("ThriftTypes").STOP)return{ftype:b("ThriftTypes").STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(c);(c===g.CT_BOOLEAN_TRUE||c===g.CT_BOOLEAN_FALSE)&&(this.$5=c===g.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};c.readListBegin=function(){return this.$11()};c.readSetBegin=function(){return this.$11()};c.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};c.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};c.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};c.readFieldEnd=function(){};c.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};c.writeByte=function(a){if(a<k||a>j)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};c.readFloat=function(){return this.$1.readFloatBE()};c.writeFloat=function(a){return this.$1.writeFloatBE(a)};c.readDouble=function(){return this.$1.readDoubleBE()};c.writeDouble=function(a){return this.$1.writeDoubleBE(a)};c.writeString=function(a){return this.writeBinary(b("StringToUtf8").StringToUtf8(a))};c.skip=function(a){switch(a){case b("ThriftTypes").STOP:return;case b("ThriftTypes").BOOL:this.readBool();break;case b("ThriftTypes").BYTE:this.readByte();break;case b("ThriftTypes").DOUBLE:this.readDouble();break;case b("ThriftTypes").I16:this.readI16();break;case b("ThriftTypes").I32:this.readI32();break;case b("ThriftTypes").I64:this.readI64();break;case b("ThriftTypes").STRING:this.readString();break;case b("ThriftTypes").STRUCT:this.readStructBegin();var c;while(!0){c=this.readFieldBegin();if(c.ftype===b("ThriftTypes").STOP)break;this.skip(c.ftype)}this.readStructEnd();break;case b("ThriftTypes").MAP:c=this.readMapBegin();if(c.size>0&&c.ktype!=null&&c.vtype!=null){var d=c.ktype,e=c.vtype;for(var f=0;f<c.size;f++)this.skip(d),this.skip(e)}break;case b("ThriftTypes").SET:case b("ThriftTypes").LIST:f=this.$11();for(var d=0;d<f.size;d++)this.skip(f.etype);break;case b("ThriftTypes").FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};c.toByteArray=function(){return this.$1.toByteArray()};c.writeFieldStop=function(){return this.$1.writeByte(b("ThriftTypes").STOP)};c.writeI16=function(a){if(a<m||a>l)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<m||a>l)throw new Error("read invalid i16: "+a);return a};c.writeI32=function(a){if(a<o||a>n)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI32=function(){return this.zigzagToI32(this.readVarint32())};c.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};c.readI64=function(){return this.zigzagToI64(this.readVarint64())};c.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===g.CT_BOOLEAN_TRUE;return a};c.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?h.CT_BOOLEAN_TRUE:h.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?g.CT_BOOLEAN_TRUE:g.CT_BOOLEAN_FALSE);return b};c.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};c.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};c.i32ToZigzag=function(a){if(a<o||a>n)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};c.zigzagToI32=function(a){if(a<0||a>p)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};c.i64ToZigzag=function(a){if(b("jsbi").greaterThan(a,q)||b("jsbi").lessThan(a,r))throw new Error("i64 out of range: "+a.toString());return b("jsbi").bitwiseXor(b("jsbi").signedRightShift(a,t),b("jsbi").leftShift(a,u))};c.zigzagToI64=function(a){if(b("jsbi").lessThan(a,0)||b("jsbi").greaterThan(a,s))throw new Error("invalid uint64: "+a.toString());return b("jsbi").equal(b("jsbi").bitwiseAnd(a,u),u)?b("jsbi").bitwiseNot(b("jsbi").signedRightShift(a,u)):b("jsbi").signedRightShift(a,u)};c.writeVarint32=function(a){if(a<0||a>p)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};c.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};c.writeVarint64=function(a){if(b("jsbi").lessThan(a,v)||b("jsbi").greaterThan(a,s))throw new Error("invalid uint64: "+a.toString());a=a;var c=0;while(!0)if(b("jsbi").equal(b("jsbi").signedRightShift(a,w),v)){this.$1.writeByte(b("jsbi").toNumber(a));c++;break}else{var d,e=(d=b("jsbi")).toNumber(d.bitwiseOr(d.bitwiseAnd(a,y),z));this.$1.writeByte(e);c++;a=d.signedRightShift(a,w)}return c};c.readVarint64=function(){var a=v,c=v,d;while(!0){var e;d=(e=b("jsbi")).BigInt(this.$1.readByte());a=e.bitwiseOr(a,e.leftShift(e.bitwiseAnd(d,y),c));c=e.add(c,w);if(b("jsbi").equal(b("jsbi").bitwiseAnd(d,z),v)){if(b("jsbi").equal(c,x)&&b("jsbi").notEqual(d,u))throw new Error("result exceeded 64 bit limit");break}if(b("jsbi").greaterThan(c,t))throw new Error("result exceeded 64 bit limit")}return a};c.readString=function(){return b("Utf8ToString").Utf8ToString(this.readBinary())};c.getLastFieldId=function(){return this.$3};c.getLastField=function(){return this.$2};c.getBooleanFieldInfo=function(){return this.$4};c.getBooleanValue=function(){return this.$5};c.$9=function(a){return i[a]};c.$10=function(a){switch(a){case g.CT_STOP:return b("ThriftTypes").STOP;case g.CT_BOOLEAN_FALSE:case g.CT_BOOLEAN_TRUE:return b("ThriftTypes").BOOL;case g.CT_BYTE:return b("ThriftTypes").BYTE;case g.CT_I16:return b("ThriftTypes").I16;case g.CT_I32:return b("ThriftTypes").I32;case g.CT_I64:return b("ThriftTypes").I64;case g.CT_DOUBLE:return b("ThriftTypes").DOUBLE;case g.CT_FLOAT:return b("ThriftTypes").FLOAT;case g.CT_BINARY:return b("ThriftTypes").STRING;case g.CT_LIST:return b("ThriftTypes").LIST;case g.CT_SET:return b("ThriftTypes").SET;case g.CT_MAP:return b("ThriftTypes").MAP;case g.CT_STRUCT:return b("ThriftTypes").STRUCT;default:throw new Error("don't know what type")}};return a}();e.exports=c}),null);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f){"use strict";var g={deserialize:function(a,c){a=new(b("TReadBuffer"))(a);a=new(b("TCompactProtocolPolyfill"))(a);return c(a)},deserializeNoThrow:function(a,b,c){try{return g.deserialize(a,b)}catch(a){c!=null&&c(a)}return null},serialize:function(a,c,d){d===void 0&&(d=!1);if(d){d=new(b("TNoOpWriteBuffer"))();var e=new(b("TCompactProtocolPolyfill"))(d);c(a,e);e=new(b("TWriteBuffer"))(d.currentSize())}else e=new(b("TWriteBuffer"))();d=new(b("TCompactProtocolPolyfill"))(e);c(a,d);return d.toByteArray()},serializeNoThrow:function(a,b,c,d){c===void 0&&(c=!1);try{return g.serialize(a,b,c)}catch(a){d!=null&&d(a)}return null}};e.exports=g}),null);
__d("ZenonStateSyncSerializer",["CompactSerializerPolyfill","CoplayState","LiveStreamState","MediaSyncAutoplayState","MediaSyncState","MeetingTranscriptionState","ModeratorControlsState","RaisedHandsQueueState","ScreenshareFloorControlState","SimplePassthroughState","SimpleState","WorkroomsState"],(function(a,b,c,d,e,f){"use strict";a={deserializeOutputState:function(a,c){var d=null;switch(a){case"raised_hands_queue":d=b("RaisedHandsQueueState").deserializeRaisedHandsQueueParticipantOutputState;break;case"simple_internal":case"simple_external":d=b("SimpleState").deserializeSimpleOutputState;break;case"simple_passthrough":d=b("SimplePassthroughState").deserializeSimplePassthroughOutputState;break;case"live_stream":d=b("LiveStreamState").deserializeLiveStreamClientOutputState;break;case"moderator_controls":d=b("ModeratorControlsState").deserializeModeratorControlsOutputState;break;case"media_sync":d=b("MediaSyncState").deserializeMediaSyncOutputState;break;case"media_sync_autoplay":d=b("MediaSyncAutoplayState").deserializeParticipantOutputState;break;case"coplay":d=b("CoplayState").deserializeCoplayOutputState;break;case"workroom":d=b("WorkroomsState").deserializeWorkroomOutputState;break;case"screenshare_floor_control":d=b("ScreenshareFloorControlState").deserializeScreenshareFloorControlOutputState;break;case"meeting_transcription":d=b("MeetingTranscriptionState").deserializeParticipantOutputState;break;default:break}return c!=null&&d!=null?b("CompactSerializerPolyfill").deserialize(new Uint8Array(atob(c).split("").map(function(a){return a.charCodeAt(0)})),d):null},serializeInputState:function(a,c){var d=null;switch(a){case"raised_hands_queue":d=b("RaisedHandsQueueState").serializeRaisedHandsQueueParticipantInputState;break;case"simple_internal":case"simple_external":d=b("SimpleState").serializeSimpleInputState;break;case"simple_passthrough":d=b("SimplePassthroughState").serializeSimplePassthroughInputState;break;case"live_stream":d=b("LiveStreamState").serializeLiveStreamClientInputState;break;case"moderator_controls":d=b("ModeratorControlsState").serializeModeratorControlsInputState;break;case"media_sync":d=b("MediaSyncState").serializeMediaSyncInputState;break;case"media_sync_autoplay":d=b("MediaSyncAutoplayState").serializeParticipantInputState;break;case"coplay":d=b("CoplayState").serializeCoplayMatchInputState;break;case"workroom":d=b("WorkroomsState").serializeWorkroomInputState;break;case"screenshare_floor_control":d=b("ScreenshareFloorControlState").serializeScreenshareFloorControlInputState;break;case"meeting_transcription":d=b("MeetingTranscriptionState").serializeParticipantInputState;break;default:break}return c!=null&&d!=null?btoa(String.fromCharCode.apply(null,b("CompactSerializerPolyfill").serialize(c,d))):null}};e.exports=a}),null);
__d("ZenonStateSyncStore",["ZenonStateSyncSerializer"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map(),this.$2=new Map(),this.$3=new Set()}var c=a.prototype;c.getInputStates=function(){return this.$1};c.getOutputStates=function(){return this.$2};c.updateInputState=function(a,c){var d;this.$3.add(a);d=((d=(d=this.$1.get(a))==null?void 0:d.version)!=null?d:0)+1;this.$1.set(a,{data:c,version:d});a=b("ZenonStateSyncSerializer").serializeInputState(a,c);return a!==null?{data:a,version:d}:{version:d}};c.updateOutputState=function(a,c){var d;if(!this.$3.has(a))return;d=(d=(d=this.$2.get(a))==null?void 0:d.version)!=null?d:-1;if(c.version<=d)return;d=b("ZenonStateSyncSerializer").deserializeOutputState(a,c.data);this.$2.set(a,{data:d,version:c.version})};c.unsubscribe=function(a){var b;this.$3["delete"](a);b=((b=(b=this.$1.get(a))==null?void 0:b.version)!=null?b:0)+1;this.$1.set(a,{data:null,version:b});return{version:b}};return a}();e.exports=a}),null);
__d("ZenonSignalingModel",["ZenonMediaModeManager","ZenonStateSyncStore"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e,f,g){this.$7=new(b("ZenonStateSyncStore"))(),this.$9=new(b("ZenonMediaModeManager"))(),this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$5=f,this.$6=g}var c=a.prototype;c.getSignalingID=function(){return this.$1};c.updateRemoteSignalingID=function(a){this.$2=a};c.getRemoteSignalingID=function(){return this.$2};c.getUserInfo=function(){return this.$3};c.getRemoteInfo=function(){return this.$4};c.getRoomInfo=function(){return this.$5};c.getProtocol=function(){return this.$6};c.getMediaModeManager=function(){return this.$9};c.getStateSyncStore=function(){return this.$7};c.setNotifyCallback=function(a){this.$8=a};c.notify=function(){this.$8&&this.$8()};return a}();e.exports=a}),null);
__d("ZenonSignalingClientManager",["CurrentUser","ZenonProtocolConfiguration","ZenonSignalingModel","immutable","randomInt"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c){this.$1=b("immutable").Map(),this.$2={userID:b("CurrentUser").getID()},this.$3=c,this.$4=new Set(),this.$5=a}var c=a.prototype;c.getSignalingClient=function(a){return this.$1.get(a)};c.getSignalingClientWithRemoteSignalingID=function(a){var b=this.$1.find(function(b){return b.getSignalingModel().getRemoteSignalingID()===a});return b};c.createSignalingClient=function(a,c,d,e,f){a=(a=a)!=null?a:String(b("randomInt")(0,4294967294)+1);d=new(b("ZenonSignalingModel"))(a,d,this.$2,c,f,e);c=b("ZenonProtocolConfiguration").getConfiguration(d);f=c.eventAggregator;e=c.messageSender;c=c.transactionManager;var g=new this.$5(d,c,f,this.$3);e.setMessageReceiver(function(a){return g.receiveMessage(a)});this.$1=this.$1.set(a,g);return g};c.receiveMessage=function(a){var b=a.getHeader(),c=this.$6(a);if(c==null)return;else a.setSignalingID(c);var d=this.getSignalingClient(c);if(d!=null)d.receiveMessage(a);else{d=this.createSignalingClient(c,b.remoteInfo,b.remoteSignalingID,b.protocol,b.roomInfo);d.getSignalingModel().updateRemoteSignalingID(b.remoteSignalingID);d.receiveMessage(a)}};c.$6=function(a){var c=a.getHeader(),d=c.signalingID;if(d!=null)return d;if(!this.$7(c.messageID))return null;c=c.remoteSignalingID;if(a.getEvents().some(function(a){return a.eventName==="terminateRequest"})&&c!=null){a=this.getSignalingClientWithRemoteSignalingID(c);a&&(d=a.getSignalingModel().getSignalingID())}if(d==null){c=b("randomInt")(0,4294967294)+1;d=String(c)}return d};c.$7=function(a){if(this.$4.has(a))return!1;this.$4.add(a);return!0};return a}();e.exports=a}),null);
__d("ZenonTransportEventEmitter",["EventEmitter"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.emitJoinReady=function(a){this.emit("transportPlatformEvent",{messageType:"joinReady",mwRingRequest:a})};c.emitParentWindowConnectionTimeout=function(){this.emit("transportPlatformEvent",{messageType:"parentWindowConnectionTimeout",mwRingRequest:null})};return b}(b("EventEmitter"));c=new a();e.exports=c}),null);
__d("ZenonCallsManager",["invariant","regeneratorRuntime","Promise","requireCond","FBLogger","FBRTCAppMessageDataAppCommandAction","FBRTCAppMessageDataAppCommandLayoutType","PlatformType","ScotchRTWebUserActionLogger","ZenonCallLogger","cr:1606520","ZenonChildCallSummaryLogProcessor","cr:1557768","ZenonConnectionStateManager","ZenonDismissReason","cr:1625711","ZenonMWMessageTranslator","ZenonMWMessageTypes","cr:1578322","ZenonPlatformExperiments","ZenonRTCPeerConnectionConfig","ZenonSignalingChildTransport","ZenonSignalingClient","ZenonSignalingClientManager","ZenonSimulcastExperiments","ZenonTransportEventEmitter","ZenonTurnDiscovery","immutable","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=b("ZenonDismissReason").ZenonDismissReason,i=b("ZenonDismissReason").endCallToDismissReason,j=b("ZenonMWMessageTypes").ZenonMWEndpointServiceType;a=function(){function a(a){var c=this;this.$4=new Map();this.$5=null;this.$6="";this.$7=b("ZenonPlatformExperiments").isMwpp()?"mw++":"mw";this.$1=b("immutable").Map();this.$2=a;this.$3=new(b("ZenonSignalingClientManager"))(b("ZenonSignalingClient"),function(a,b,d){return c.onInviteReceived(a,b,d)});this.$8=this.$9()}var c=a.prototype;c.$9=function(){var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a=Date.now();d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(b("ZenonTurnDiscovery").requestTurnCreds("ZenonPlatform","MW_PEER_ID"));case 4:c=d.sent;b("ZenonRTCPeerConnectionConfig").setTurnCredentials(c);b("ScotchRTWebUserActionLogger").logCheckpoint({callType:"mw",checkpoint:"[ZP] successfully acquired TURN credentials. Took "+(Date.now()-a)+" ms."});d.next=12;break;case 9:d.prev=9,d.t0=d["catch"](1),b("ScotchRTWebUserActionLogger").logError({callType:"mw",checkpoint:"[ZP] failed to get TURN credentials. Took "+(Date.now()-a)+" ms. Error message: "+d.t0,errorDomain:"ZenonCallsManager_fetchTurnCredentials"});case 12:case"end":return d.stop()}},null,this,[[1,9]])};c.$10=function(a){this.$6=a};c.getLogProcessors=function(){var a=[b("ZenonChildCallSummaryLogProcessor")];b("cr:1557768")&&a.push(b("cr:1557768"));b("cr:1578322")&&a.push(b("cr:1578322"));b("cr:1606520")&&a.push(b("cr:1606520"));b("cr:1625711")&&a.push(b("cr:1625711"));return a};c.onInviteReceived=function(a,b,c){b=this.$2.getConfigManager().getZenonMultiCallSupportConfig().getMaxConnectedCalls();var d=this.$1.filter(function(a){return a.getConnectionState()!=="terminated"}),e=d.filter(function(b){return b.getServerCallID()===((b=a.roomInfo.context)==null?void 0:b.serverInfoData)});if(e.size>0){c.respondToInvite("OK");return}e=d.some(function(a){return a.getServerCallID()==null});d.size===b&&(c.respondToInvite("IN_ANOTHER_CALL"),e||c.sendDismiss(h.InAnotherCall))};c.join=function(a){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return b("regeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:a.peerID!=null||g(0,18600);d={userID:a.peerID};e=a.callTrigger,f=a.clientCallID,h=a.localMedia,i=a.mwRingRequest,j=a.peerID,k=a.serverCallID,l=a.usersToRing;m={name:a.roomID};i!=null&&(i.jsonPayload.header.clientSessionId=(n=k)!=null?n:"");if(!(this.$1.get(f)!=null)){z.next=7;break}throw b("unrecoverableViolation")("Call with id "+f+" already exists. Use a new clientCallID/clientSessionID if rejoining.","rtc_www");case 7:o=null;k!=null&&(o=this.$3.getSignalingClient(k));o==null&&(o=this.$3.createSignalingClient(k,d,a.serverInfoData,this.$7,m));p=o.getSignalingModel();q=p.getSignalingID();r=i==null;s=(i==null?void 0:(c=i.jsonPayload.body.ringRequest)==null?void 0:c.offer)!=null;p.getMediaModeManager().onJoin(r,this.$7==="mw++",l.length,s);t=this.$4.get(f);t==null&&(v=h.find(function(a){return a.contentType==="video"})!=null,t=new(b("ZenonCallLogger"))({callID:(u=k)!=null?u:f,callTrigger:e,conferenceName:a.roomID,isCaller:r,isVideo:v,peerID:j,protocol:this.$7,serverInfoData:a.serverInfoData,signalingID:q},this.getLogProcessors()),this.$4.set(f,t));this.$10(q);w=b("ZenonSimulcastExperiments").shouldUseSimulcast(p.getMediaModeManager().getMediaMode()==="sfu");o!=null||g(0,23327);if(!(p.getMediaModeManager().getMediaMode()==="p2p")){z.next=23;break}z.next=23;return b("regeneratorRuntime").awrap(this.$8);case 23:x=new(b("ZenonConnectionStateManager"))(f,o,r?"outgoing":"incoming",this.$2.getConfigManager(),t,w),t.log({hasOfferInRingRequest:s,isCaller:r,name:"callJoinRequest"}),this.$1=this.$1.set(f,x),x.start(a),b("ScotchRTWebUserActionLogger").logCheckpoint({callID:k,callType:"mw",checkpoint:"[ZP] ZenonCallsManager_join called, starting connectionStateManager",conferenceName:a.roomID,isCaller:r}),i&&(y=b("ZenonMWMessageTranslator").toSignalingMessage(i),this.$3.receiveMessage(y));case 29:case"end":return z.stop()}},null,this)};c.addLocalTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.addLocalTrack(b)};c.removeLocalTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.removeLocalTrack(b)};c.muteTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.muteTrack(b)};c.unmuteTrack=function(a,b){(a=this.$1.get(a))==null?void 0:a.unmuteTrack(b)};c.stopLocalVideo=function(a,b){(a=this.$1.get(a))==null?void 0:a.stopLocalTrack(b)};c.initializeV2Infrastructure=function(a,c){var d,e={userID:c.peerID},f={name:c.roomID};d=this.$3.createSignalingClient((d=c.callID)==null?void 0:d.toString(),e,c.serverInfoData,this.$7,f);e=d.getSignalingModel().getSignalingID();f=new(b("ZenonCallLogger"))({callID:(d=(f=c.callID)==null?void 0:f.toString())!=null?d:a,callTrigger:c.callTrigger,conferenceName:c.roomID,isCaller:!1,isVideo:c.initializeVideo,peerID:c.peerID,protocol:this.$7,serverInfoData:c.serverInfoData,signalingID:e},this.getLogProcessors());this.$4.set(a,f)};c.initializeSignaling=function(a,c,d){var e=this,f=this.$2.getSignalingListener();f.subscribe(function(a){return e.$3.receiveMessage(a)},function(a){});f=this.$2.getConfigManager().getZenonStartCallImmediatelyConfig().isEnabled();if(f)b("ZenonTransportEventEmitter").emitJoinReady();else if(c!=null){f=this.$2.getConfigManager().getZenonPlatformSupportConfig().getParentWindowConnectionTimeoutMs();this.$5=new(b("ZenonSignalingChildTransport"))(c,a,f,d)}this.$5&&b("promiseDone")(this.$5.connect(),function(a){a.state==="join_ready"?b("ZenonTransportEventEmitter").emitJoinReady(a.mwRingRequest):b("ZenonTransportEventEmitter").emitParentWindowConnectionTimeout()})};c.endCall=function(a,c,d){c=i(c);var e=this.$1.get(a);if(e)e.end(c,d);else{e=this.$4.get(a);e!=null?e.log({endCallReason:c,endCallSubreason:d,isRemoteEnded:!1,name:"callEnded"}):b("FBLogger")("rtc_www").warn("ZenonCallLogger missing for endCall")}};c.ringParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.addParticipants(b)};c.removeParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.removeParticipants(b)};c.replaceLocalTrack=function(a,c,d,e){e===void 0;e=this.$1.get(a);e!=null&&e.replaceLocalTrack(c,d);return b("Promise").resolve()};c.notifyScreenShareStart=function(a){};c.notifyScreenShareEnd=function(a){};c.sendCompositingServiceDataMessageRequest=function(a,c,d){d={action:{type:b("FBRTCAppMessageDataAppCommandAction").PING},broadcastMetadata:{layoutMetadata:{compositingUserIds:d,type:b("FBRTCAppMessageDataAppCommandLayoutType").SIDE_BY_SIDE}}};(a=this.$1.get(a))==null?void 0:a.sendGenericDataMessage(c,JSON.stringify(d),[],[j.COMPOSITING_SERVICE])};c.forceEncodingEnabled=function(a,b){(a=this.$1.get(a))==null?void 0:a.forceEncodingEnabled(b)};c.acceptVideoEscalation=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:g(0,11323);case 1:case"end":return a.stop()}},null,this)};c.declineVideoEscalation=function(){g(0,11323)};c.cancelVideoEscalation=function(){g(0,11323)};c.startVideoEscalation=function(){g(0,11323)};c.submitRating=function(a,b,c,d){c===void 0&&(c=null);d===void 0&&(d=null);a=this.$4.get(a);a&&(b!=null&&a.log({name:"callRated",rating:b}),c!=null&&a.log({feedback:c,name:"callFeedbackSubmitted"}),d!=null&&a.log({name:"callSurveyChoiceSubmitted",surveyChoice:d}))};c.setRatingImpression=function(a,b){};c.getCalls=function(){return this.$1};c.setCalls=function(a){this.$1=a};c.createDataMessageSubscription=function(a,b,c){a=this.$1.get(a);a!=null&&a.createDataMessageSubscription(b,c)};c.removeDataMessageSubscription=function(a,b,c){a=this.$1.get(a);a!=null&&a.removeDataMessageSubscription(b,c)};c.sendGenericDataMessage=function(a,b,c,d,e){a=this.$1.get(a);a!=null&&a.sendGenericDataMessage(b,c,d,e)};c.logWithLogIdentifiers=function(a,b){a=this.$4.get(a);a!=null&&b(a.getLogIdentifiers())};c.subscribeToRemoteVideo=function(a,b,c){a=this.$1.get(a);a!=null&&a.subscribeToRemoteVideo(b,c)};c.updateStateSyncTopic=function(a,b,c){a=this.$1.get(a);a!=null&&a.updateStateSyncTopic(b,c)};c.unsubscribeFromStateSyncTopic=function(a,b){a=this.$1.get(a);a!=null&&a.unsubscribeFromStateSyncTopic(b)};c.approveParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.approveParticipants(b.toArray())};c.denyParticipants=function(a,b){a=this.$1.get(a);a!=null&&a.denyParticipants(b.toArray())};c.getPlatformType=function(){return b("PlatformType").ZENON};c.getCallProtocolType=function(){return"multiway"};return a}();e.exports=a}),null);
__d("ZenonPeerConnectionDataActions",[],(function(a,b,c,d,e,f){"use strict";a={onCreateDataChannel:function(a,b){if(b.type==="createDataChannel"){b=b.payload;var c=b.dataChannelLabel;b=b.onDataChannelMessage;a.mediaChannelManager.createDataChannel(c,b)}},onDataChannelMessageReceived:function(a,b){if(b.type==="dataChannelMessageReceived"){b=b.payload;var c=b.data;b=b.dataChannelLabel;a.onDataChannelMessageReceived(b,c)}}};e.exports=a}),null);
__d("ZenonPeerConnectionIceActions",[],(function(a,b,c,d,e,f){"use strict";var g={onIceConnected:function(a){a.onConnectionEstablished(),a.logEvent({name:"mediaConnected"})},onIceConnectionStateChanged:function(a,b){if(b.type==="iceConnectionStateChange"){var c=b.payload.iceConnectionState==="connected"||b.payload.iceConnectionState==="completed",d=b.payload.iceConnectionState==="disconnected";a.logEvent({connected:c,name:"peerConnectionStateChanged"});c?g.onIceConnected(a):d&&a.onConnectionDropped();return b.payload}return{}}};e.exports=g}),null);
__d("ZenonPeerConnectionMediaActions",["regeneratorRuntime","Promise","AggregateError","ScotchRTWebUserActionLogger","err"],(function(a,b,c,d,e,f){"use strict";a={applyRemoteIceCandidate:function(a,b){b.type==="applyRemoteIceCandidate"&&a.sdpManager.setRemoteIceCandidate(b.payload)},onAddLocalTracksError:function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to add local tracks: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onAddLocalTracks"})},onAddedLocalTracks:function(a,c){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Successfully added local tracks",codebase_version:"Zenon"});return c.data},onAddingLocalTracks:function(a,c){var d,e,f;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(c.type!=="addLocalTracks")){h.next=2;break}return h.abrupt("return",{});case 2:d=c.payload.tracks;e=[];h.next=6;return b("regeneratorRuntime").awrap(b("Promise").allSettled(d.map(function(c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(a.mediaChannelManager.addTrack(c));case 2:g(a,c.trackId,!0);case 3:case"end":return d.stop()}},null,this)})));case 6:f=h.sent;f.forEach(function(a){a.status==="rejected"&&e.push(new(b("err"))(a.reason))});if(!(e.length>0)){h.next=10;break}throw new(b("AggregateError"))(e);case 10:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"add local tracks",codebase_version:"Zenon"});return h.abrupt("return",{localMediaStateVersion:a.localMediaStateVersion+d.length});case 12:case"end":return h.stop()}},null,this)},onForceEncodingEnabled:function(a,b){if(b.type!=="forceEncodingEnabled")return;a.mediaChannelManager.forceEncodingEnabled(b.payload.enabled)},onIceCandidateReady:function(a,b){b.type==="iceCandidateReady"&&a.onIceCandidateReady(b.payload)},onMuteLocalTrack:function(a,c){if(c.type==="muteLocalTrack"){a=g(a,c.payload.trackId,!1);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"mute local track",codebase_version:"Zenon"});return a}return{}},onRemoveLocalTrackError:function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to remove local track: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onRemoveLocalTracks"})},onRemovedLocalTrack:function(a,c){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Successfully removed local track",codebase_version:"Zenon"});return c.data},onRemovingLocalTrack:function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!(c.type!=="removeLocalTrack")){f.next=2;break}return f.abrupt("return",{});case 2:d=c.payload.trackId;f.next=5;return b("regeneratorRuntime").awrap(a.mediaChannelManager.removeTrack(d));case 5:e=g(a,d,!1);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"remove local track with id "+d,codebase_version:"Zenon"});return f.abrupt("return",e);case 8:case"end":return f.stop()}},null,this)},onReplaceLocalTrackError:function(a,c){b("ScotchRTWebUserActionLogger").logError({checkpoint:"Failed to replace local tracks: "+c.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onReplaceLocalTrack"})},onReplacingLocalTrack:function(a,c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!(c.type!=="replaceLocalTrack")){g.next=2;break}return g.abrupt("return");case 2:d=c.payload,e=d.replacementTrack,f=d.trackIdToReplace;g.next=5;return b("regeneratorRuntime").awrap(a.mediaChannelManager.replaceTrack(f,e));case 5:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"replace local track with id "+f+" by track "+e.trackId,codebase_version:"Zenon"});case 6:case"end":return g.stop()}},null,this)},onSetLocalMediaStateVersion:function(a,b){return b.type!=="setLocalMediaStateVersion"?{}:{localMediaStateVersion:b.payload.version}},onStopLocalTrack:function(a,b){if(b.type!=="stopLocalTrack")return;b=b.payload.trackId;a.mediaChannelManager.stopLocalTrack(b)},onUnmuteLocalTrack:function(a,c){if(c.type==="unmuteLocalTrack"){a=g(a,c.payload.trackId,!0);b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"unmute local track",codebase_version:"Zenon"});return a}return{}}};function g(a,b,c){var d=a.mediaChannelManager;c?d.unmuteTrack(b):d.muteTrack(b);var e=[];c=d.getLocalTracksForMWS();c.forEach(function(a){a={enabled:a.enabled,trackID:a.trackId,type:a.contentType};e.push(a)});b=a.localMediaStateVersion+1;d={tracks:e,version:b};a.onLocalMediaStateUpdate(d);return{localMediaStateVersion:b}}e.exports=a}),null);
__d("ZenonPeerConnectionSMGuards",[],(function(a,b,c,d,e,f){"use strict";a={applyRemoteOfferSdpGuard:function(a,b){return b.type==="applyRemoteSdp"&&b.payload.sdp.type==="offer"},iceConnectedEventGuard:function(a,b){return b.type==="iceConnectionStateChange"&&b.payload.iceConnectionState==="connected"},iceConnectedGuard:function(a){return a.iceConnectionState==="connected"||a.iceConnectionState==="completed"},iceDisconnectedEventGuard:function(a,b){return b.type==="iceConnectionStateChange"&&b.payload.iceConnectionState==="disconnected"},iceNotConnectedGuard:function(a){return a.iceConnectionState!=="connected"&&a.iceConnectionState!=="completed"}};e.exports=a}),null);
/**
 * Copyright @ 2015 Atlassian Pty Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Modified by Facebook.
 *
 * @nolint
 * @preserve-header
 * @preserve-whitespace
 * @format
 */__d("ZenonSDPInteropTransform",["sdp-transform"],(function $module_ZenonSDPInteropTransform(global,require,requireDynamic,requireLazy,module,exports){

'use strict';



exports.write=function(session,opts,options){
if(
typeof session!=='undefined'&&
typeof session.media!=='undefined'&&
Array.isArray(session.media))
{
session.media.forEach(function(mLine){







var groupedSsrcs=[];
var ungroupedSsrcs=Object.keys(mLine.sources||{});


if(
typeof mLine.ssrcGroups!=='undefined'&&
Array.isArray(mLine.ssrcGroups))
{
mLine.ssrcGroups.forEach(function(ssrcGroup){
if(
typeof ssrcGroup.ssrcs!=='undefined'&&
Array.isArray(ssrcGroup.ssrcs))
{
groupedSsrcs=groupedSsrcs.concat(ssrcGroup.ssrcs);
ungroupedSsrcs=ungroupedSsrcs.filter(
function(ssrc){return ssrcGroup.ssrcs.indexOf(ssrc)===-1;});

ssrcGroup.ssrcs=ssrcGroup.ssrcs.join(' ');
}
});
}


if(
typeof mLine.sources!=='undefined'&&
Object.keys(mLine.sources).length!==0)
{
mLine.ssrcs=[];
groupedSsrcs.concat(ungroupedSsrcs).forEach(function(ssrc){
var source=mLine.sources[ssrc];
Object.keys(source).forEach(function(attribute){
mLine.ssrcs.push({
attribute:attribute,
id:ssrc,
value:source[attribute]});

});
});
if(options&&options.iceOptions){
mLine.iceOptions=options.iceOptions;
}
delete mLine.sources;
}
});
}


if(
typeof session!=='undefined'&&
typeof session.groups!=='undefined'&&
Array.isArray(session.groups))
{
session.groups.forEach(function(g){
if(typeof g.mids!=='undefined'&&Array.isArray(g.mids)){
g.mids=g.mids.join(' ');
}
});
}

return require("sdp-transform").write(session,opts);
};

exports.parse=function(sdp){
var session=require("sdp-transform").parse(sdp);

if(
typeof session!=='undefined'&&
typeof session.media!=='undefined'&&
Array.isArray(session.media))
{
session.media.forEach(function(mLine){

if(typeof mLine.ssrcs!=='undefined'&&Array.isArray(mLine.ssrcs)){
mLine.sources={};
mLine.ssrcs.forEach(function(ssrc){
if(!mLine.sources[ssrc.id])mLine.sources[ssrc.id]={};
mLine.sources[ssrc.id][ssrc.attribute]=ssrc.value;
});

delete mLine.ssrcs;
}


if(
typeof mLine.ssrcGroups!=='undefined'&&
Array.isArray(mLine.ssrcGroups))
{
mLine.ssrcGroups.forEach(function(ssrcGroup){
if(typeof ssrcGroup.ssrcs==='string'){
ssrcGroup.ssrcs=ssrcGroup.ssrcs.split(' ');
}
});
}
});
}

if(
typeof session!=='undefined'&&
typeof session.groups!=='undefined'&&
Array.isArray(session.groups))
{
session.groups.forEach(function(g){
if(typeof g.mids==='string'){
g.mids=g.mids.split(' ');
}
});
}

return session;
};}),null);
__d("ZenonSDP",["ZenonSDPInteropTransform"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1={};var c=a.sdp;c!=null&&(this.$1=b("ZenonSDPInteropTransform").parse(c));this.$2=a.type;this.$2==="answer"&&(this.$3("audio","sendrecv"),this.$3("video","sendrecv"))}var c=a.prototype;c.$4=function(a,b,c){a=a.split(";");var d=a.findIndex(function(a){return a.startsWith(b+"=")});c=b+"="+c;d>=0?a[d]=c:a.push(c);return""+a.join(";")};c.addFmtpConfig=function(a,b,c){var d=this,e=this.$1.media;e!=null&&e.forEach(function(e){var f=e.rtp.find(function(b){return b.codec===a});if(f!=null){var g=e.fmtp.find(function(a){return a.payload===f.payload});g==null?e.fmtp.push({config:b+"="+c,payload:f.payload}):g.config=d.$4(g.config,b,c)}})};c.maybeAddPtimeForOpusOnly=function(a){var b=this.$1.media.find(function(a){return a.mid==="audio"});if(b===void 0)return;var c=b.rtp.find(function(a){return a.codec==="opus"});if(c===void 0)return;c=b.ptime!==void 0;if(c)return;b.ptime=a};c.removeCodec=function(a){var b=this.$1.media;b!=null&&b.forEach(function(b){var c=b.rtp.filter(function(b){return b.codec===a}).map(function(a){a=a.payload;return a}),d=b.fmtp.filter(function(a){a=a.config.match(/apt=(\d*)/);return a!=null?c.includes(Number(a[1])):!1}).map(function(a){a=a.payload;return a}),e=c.concat(d);if(e.length<1)return;b.rtp=b.rtp.filter(function(a){return!e.includes(a.payload)});b.fmtp=b.fmtp.filter(function(a){return!e.includes(a.payload)});b.rtcpFb!=null&&(b.rtcpFb=b.rtcpFb.filter(function(a){return!e.includes(a.payload)}));b.rtcpFbTrrInt!=null&&(b.rtcpFbTrrInt=b.rtcpFbTrrInt.filter(function(a){return!e.includes(a.payload)}));d=new RegExp("("+e.join("|")+") ?","g");b.payloads=b.payloads.replace(d,"").trim()})};c.preferCodec=function(a,b){var c=b.preferredCodec,d=b.preferredCodecRate;b=this.$1.media;b!=null&&b.forEach(function(b){if(b.type===a){var e=b.rtp.find(function(a){return a.codec===c&&a.rate===d});e!=null&&(b.payloads=b.payloads.replace(e.payload+" ",""),b.payloads=e.payload+" "+b.payloads)}})};c.preferH264Codec=function(a){var b=this.$1.media;b!=null&&b.forEach(function(b){if(b.type==="video"){var c=[];b.rtp.forEach(function(a){a.codec==="H264"&&c.push(a.payload)});var d=a.levelAsymmetryAllowed?"1":"0",e=a.packetizationMode?"1":"0",f=new RegExp("level-asymmetry-allowed="+d+";packetization-mode="+e+";profile-level-id="+a.profileLevelId);d=b.fmtp.find(function(a){return a.config.match(f)&&c.includes(a.payload)});d!=null&&(b.payloads=b.payloads.replace(d.payload+" ",""),b.payloads=d.payload+" "+b.payloads)}})};c.$3=function(a,b){var c=this.$1.media;c!=null&&c.forEach(function(c){c.type===a&&(c.direction=b)})};c.setVersion=function(a){this.$1.origin.sessionVersion=a};c.toDesc=function(){return{sdp:b("ZenonSDPInteropTransform").write(this.$1,{},{iceOptions:"trickle fb-force-5245"}),type:this.$2}};return a}();e.exports=a}),null);
__d("ZenonPeerConnectionSdpActions",["regeneratorRuntime","Promise","ScotchRTWebUserActionLogger","ZenonSDP"],(function(a,b,c,d,e,f){"use strict";function g(a,b){b&&b.tracks.forEach(function(b){var c=b.enabled;b=b.trackID;if(b==="data"||b==="stream_label")return;c?a.unmuteTrack(b):a.muteTrack(b)})}a={applyLocalSdp:function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(c.type==="applyLocalSdp")){e.next=6;break}d=a.localMediaStateVersion+1;e.next=4;return b("regeneratorRuntime").awrap(a.sdpManager.createAndSetLocalSdp(d,"offer"));case 4:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply local SDP",codebase_version:"Zenon"});return e.abrupt("return",{localMediaStateVersion:d});case 6:return e.abrupt("return",b("Promise").resolve({}));case 7:case"end":return e.stop()}},null,this)},applyRemoteAnswer:function(a,c){var d,e,f,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:d=a.mediaChannelManager,e=a.sdpManager;if(!(c.type==="applyRemoteSdp")){j.next=8;break}f=c.payload.sdp,h=f.sdp,i=f.type;if(!(i==="answer")){j.next=7;break}j.next=6;return b("regeneratorRuntime").awrap(e.setRemoteSdp(new(b("ZenonSDP"))({sdp:h,type:i})));case 6:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply remote answer",codebase_version:"Zenon"});case 7:g(d,c.payload.mediaStates);case 8:case"end":return j.stop()}},null,this)},applyRemoteOfferAndSetLocalAnswer:function(a,c){var d,e,f,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d=a.mediaChannelManager,e=a.sdpManager;if(!(c.type==="applyRemoteSdp")){k.next=12;break}f=c.payload.sdp,h=f.sdp,i=f.type;if(!(i==="offer")){k.next=12;break}k.next=6;return b("regeneratorRuntime").awrap(e.setRemoteSdp(new(b("ZenonSDP"))({sdp:h,type:i})));case 6:g(d,c.payload.mediaStates);j=a.localMediaStateVersion+1;k.next=10;return b("regeneratorRuntime").awrap(a.sdpManager.createAndSetLocalSdp(j,"answer"));case 10:b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"apply remote offer and set local answer",codebase_version:"Zenon"});return k.abrupt("return",{localMediaStateVersion:j});case 12:return k.abrupt("return",{});case 13:case"end":return k.stop()}},null,this)},logInviteResponseProcessed:function(a){a.logEvent({name:"inviteResponseProcessed"})},logNegotiationCompleted:function(a){a.logEvent({name:"negotiationComplete"})},onLocalSdpSet:function(a,b){var c=a.sdpManager.getLocalSdp();b=b.data;if(c!==null&&b.localMediaStateVersion!=null){c=c.toDesc();var d=c.sdp;c=c.type;a.onLocalSdpSet({sdp:d,type:c,version:b.localMediaStateVersion})}return b}};e.exports=a}),null);
__d("ZenonPeerConnectionTerminatingState",["Promise","ScotchRTWebUserActionLogger"],(function(a,b,c,d,e,f){"use strict";a={cleanUp:function(a,c){c.type==="endCall"&&(c.payload.stopLocalTracks&&a.mediaChannelManager.stopLocalTracks(),c.payload.error!=null&&a.onConnectionDestroyed(c.payload.error),a.sdpManager.closePeerConnection(),a.mediaChannelManager.cleanUp());return b("Promise").resolve(b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"cleaning up peer connection",codebase_version:"Zenon"}))},done:function(a,b){}};e.exports=a}),null);
__d("ZenonPeerConnectionStateMachine",["ZenonDebugLogger","ZenonDeferrableStateMachine","ZenonPeerConnectionDataActions","ZenonPeerConnectionIceActions","ZenonPeerConnectionMediaActions","ZenonPeerConnectionSdpActions","ZenonPeerConnectionSMGuards","ZenonPeerConnectionTerminatingState","xstate"],(function(a,b,c,d,e,f){"use strict";var g,h,i,j=b("xstate").Machine;a=b("xstate").assign;c=function(){function a(a,c){var d=this;c===void 0&&(c="init");a=babelHelpers["extends"]({},m,{context:babelHelpers["extends"]({},a,{iceConnectionState:"new",localMediaStateVersion:1}),initial:c});this.$1=b("ZenonDeferrableStateMachine").interpret(j(a,{guards:b("ZenonPeerConnectionSMGuards")}));this.$2=Date.now();b("ZenonDebugLogger").getInstance().startQPL(64239068,this.$2);this.$1.onTransition(function(a){a.value==="terminated"&&b("ZenonDebugLogger").getInstance().endQPL(64239068,d.$2)})}var c=a.prototype;c.processEvent=function(a){n.has(a.type)||b("ZenonDebugLogger").getInstance().logStateMachine("PeerConnectionStateMachine",this.getState(),a.type,this.$2.toString()),this.$1.send(a)};c.getState=function(){var a=this.$1.state.toStrings();return a.length>0?this.$1.state.toStrings()[0]:"init"};c.getContext=function(){return this.$1.state.context};c.getLocalMediaStateVersion=function(){return this.$1.state.context.localMediaStateVersion};return a}();f={actions:[a((d=b("ZenonPeerConnectionIceActions")).onIceConnectionStateChanged)]};var k={actions:[b("ZenonPeerConnectionDataActions").onDataChannelMessageReceived]},l={actions:[(g=b("ZenonPeerConnectionMediaActions")).onForceEncodingEnabled]},m={initial:"init",states:{init:{on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{cond:(h=b("ZenonPeerConnectionSMGuards")).applyRemoteOfferSdpGuard,target:"renegotiating"},createDataChannel:{actions:[b("ZenonPeerConnectionDataActions").onCreateDataChannel]},dataChannelMessageReceived:k,forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},iceConnectionStateChange:f,muteLocalTrack:{actions:[a(g.onMuteLocalTrack)]},removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},setLocalMediaStateVersion:{actions:[a(g.onSetLocalMediaStateVersion)]},stopLocalTrack:{actions:[g.onStopLocalTrack]},unmuteLocalTrack:{actions:[a(g.onUnmuteLocalTrack)]}}},applyingLocalSdp:{invoke:{id:"applyLocalSdpInvoke",onDone:{actions:[a((i=b("ZenonPeerConnectionSdpActions")).onLocalSdpSet)],target:"hasLocalSdp"},onError:{target:"terminating"},src:i.applyLocalSdp},on:{addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},iceConnectionStateChange:f,muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},hasLocalSdp:{on:{addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{target:"applyingRemoteSdp"},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:[g.onIceCandidateReady]},iceConnectionStateChange:f,muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},applyingRemoteSdp:{invoke:[{id:"applyRemoteSdpInvoke",onDone:[{actions:[i.logInviteResponseProcessed],cond:h.iceNotConnectedGuard,target:"negotiated"},{actions:[i.logInviteResponseProcessed,d.onIceConnected],cond:h.iceConnectedGuard,target:"connected"}],onError:{target:"terminating"},src:i.applyRemoteAnswer}],on:{addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:[g.onIceCandidateReady]},iceConnectionStateChange:f,muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},negotiated:{entry:[i.logNegotiationCompleted],on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:[g.applyRemoteIceCandidate]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:l,iceCandidateReady:{actions:[g.onIceCandidateReady]},iceConnectionStateChange:[{actions:[a(d.onIceConnectionStateChanged)],cond:h.iceConnectedEventGuard,target:"connected"},{actions:[a(d.onIceConnectionStateChanged)]}],muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},connected:{on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteIceCandidate:{actions:[g.applyRemoteIceCandidate]},applyRemoteSdp:{cond:h.applyRemoteOfferSdpGuard,target:"renegotiating"},createDataChannel:{actions:[b("ZenonPeerConnectionDataActions").onCreateDataChannel]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:l,iceCandidateReady:{actions:[g.onIceCandidateReady]},iceConnectionStateChange:[{actions:[a(d.onIceConnectionStateChanged)],cond:h.iceDisconnectedEventGuard,target:"negotiated"},{actions:[a(d.onIceConnectionStateChanged)]}],muteLocalTrack:{actions:[a(g.onMuteLocalTrack)]},removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},stopLocalTrack:{actions:[g.onStopLocalTrack]},unmuteLocalTrack:{actions:[a(g.onUnmuteLocalTrack)]}}},addingLocalTracks:{invoke:{id:"addLocalTracksInvoke",onDone:{actions:[a(g.onAddedLocalTracks)],target:"connected"},onError:{actions:[g.onAddLocalTracksError],target:"connected"},src:g.onAddingLocalTracks},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},removingLocalTrack:{invoke:{id:"removeLocalTrackInvoke",onDone:{actions:[a(g.onRemovedLocalTrack)],target:"connected"},onError:{actions:[g.onRemoveLocalTrackError],target:"connected"},src:g.onRemovingLocalTrack},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},replacingLocalTrack:{invoke:{id:"replaceLocalTrackInvoke",onDone:{target:"connected"},onError:{actions:[g.onReplaceLocalTrackError],target:"connected"},src:g.onReplacingLocalTrack},on:{applyLocalSdp:{actions:["defer"]},addLocalTracks:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},applyRemoteSdp:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,iceConnectionStateChange:f,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceCandidateReady:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},renegotiating:{invoke:{id:"applyRemoteSdpInvoke",onDone:[{actions:[a(i.onLocalSdpSet)],cond:h.iceNotConnectedGuard,target:"negotiated"},{actions:[a(i.onLocalSdpSet)],cond:h.iceConnectedGuard,target:"connected"}],onError:{target:"terminating"},src:i.applyRemoteOfferAndSetLocalAnswer},on:{addLocalTracks:{actions:["defer"]},applyLocalSdp:{actions:["defer"]},applyRemoteIceCandidate:{actions:["defer"]},createDataChannel:{actions:["defer"]},dataChannelMessageReceived:k,endCall:{target:"terminating"},forceEncodingEnabled:{actions:["defer"]},iceConnectionStateChange:{actions:["defer"]},muteLocalTrack:{actions:["defer"]},removeLocalTrack:{actions:["defer"]},replaceLocalTrack:{actions:["defer"]},stopLocalTrack:{actions:["defer"]},unmuteLocalTrack:{actions:["defer"]}}},terminating:{exit:[b("ZenonPeerConnectionTerminatingState").done],invoke:[{onDone:{target:"terminated"},src:b("ZenonPeerConnectionTerminatingState").cleanUp}]},terminated:{}}},n=new Set(["dataChannelMessageReceived"]);e.exports=c}),null);
__d("ZenonEventListenerCache",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.add=function(a,b){var c=this.getByType(a);c.push(b);this.$1.set(a,c)};b["delete"]=function(a,b){var c=this.getByType(a);c=c.filter(function(a){return a!==b});c.length<1?this.$1["delete"](a):this.$1.set(a,c)};b.getByType=function(a){return(a=this.$1.get(a))!=null?a:[]};b.getCachedEventTypes=function(){return Array.from(this.$1.keys())};b.getAll=function(){return this.$1};return a}();e.exports=a}),null);
__d("ZenonSimulcastSdpUtils",["Random","UserAgent","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g="\r\n";function h(a){a=a.filter(function(a){return a.startsWith("a=ssrc:")}).map(function(a){return a.split(" ")[0].split(":")[1]});return new Set(a)}function i(a,b){var c=new RegExp("^a=ssrc:\\d+ "+b+":");b=a.filter(function(a){return c.test(a)})[0];return b.split(" ")[1].split(":")[1]}function j(a){a=a.filter(function(a){return a.startsWith("a=ssrc-group:FID")}).map(function(a){return a.split(" ")[2]});return new Set(a)}function k(a){var b=new RegExp("^a=ssrc:\\d+ msid:");a=a.filter(function(a){return b.test(a)})[0];a=a.split(" ");return a.length>2?a[2]:null}function l(a,c){var d=[];for(var e=0;e<a;e++){var f=0;while(f===0||c.has(f.toString()))f=b("Random").uint32();c.add(f.toString());d.push(f.toString())}return d}function a(a,c){if(!b("UserAgent").isBrowser("Chrome >= 69")){b("recoverableViolation")("Attempted to add plan-b simulcast in unsupported browser","rtc_www");return a}if(c<=1||c>3){b("recoverableViolation")("Unsupported number of layers passed: "+c,"rtc_www");return a}var d=a.trim().split(g),e=h(d),f=d.findIndex(function(a){return/^m=video/.test(a)});if(f===-1)return a;a=f+1;while(a<d.length){if(d[a].startsWith("m="))break;a++}a=d.splice(f,a-f);var m=h(a),n=j(a);m=new Set(Array.from(m).filter(function(a){return!n.has(a)}));if(m.size!==1||n.size>1)return[].concat(d.slice(0,f),a,d.slice(f)).join(g);var o=n.size===1;m=Array.from(m)[0];var p="";o&&(p=Array.from(n)[0]);var q=i(a,"cname"),r=i(a,"msid"),s=k(a);s!=null&&(r+=" "+s);var t=i(a,"mslabel"),u=i(a,"label");s=[m].concat(l(c-1,e));m=[];o&&(s.forEach(function(a){return e.add(a)}),m=[p].concat(l(c-1,e)));var v=[];v.push("a=ssrc-group:SIM "+s.join(" "));for(var p=0;p<m.length;p++)v.push("a=ssrc-group:FID "+s[p]+" "+m[p]);c=[];if(o)for(var p=0;p<s.length;p++)c.push(s[p]),c.push(m[p]);else c=s;c.forEach(function(a){v.push("a=ssrc:"+a+" cname:"+q),v.push("a=ssrc:"+a+" msid:"+r),v.push("a=ssrc:"+a+" mslabel:"+t),v.push("a=ssrc:"+a+" label:"+u)});a=a.filter(function(a){return!a.startsWith("a=ssrc")});a=[].concat(a,v);return[].concat(d.slice(0,f),a,d.slice(f)).join(g)+g}e.exports={addSimulcastToPlanBOffer:a}}),null);
__d("ZenonRTCPeerConnectionWrapper",["regeneratorRuntime","Promise","FBLogger","ScotchRTWebUserActionLogger","UserAgent","ZenonEventListenerCache","ZenonRTCPeerConnectionHelper","ZenonSDP","ZenonSimulcastSdpUtils","qex","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e){c===void 0&&(c={}),d===void 0&&(d={}),e===void 0&&(e=!1),this.$4=new(b("ZenonEventListenerCache"))(),this.$7=!1,this.$2=c,this.$3=d,this.$1=b("ZenonRTCPeerConnectionHelper").createPeerConnection(a,c,d),this.$5=new Map(),this.$6=e,this.getSdpSemantics()==="plan-b"&&e&&(this.$7=!0)}var c=a.prototype;c.createOffer=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:a===void 0&&(a={});e.next=3;return b("regeneratorRuntime").awrap(this.$8(a));case 3:c=e.sent;this.$7&&(c.sdp!=null&&(c.sdp=b("ZenonSimulcastSdpUtils").addSimulcastToPlanBOffer(c.sdp,(d=b("qex")._("1574288"))!=null?d:1)),this.$7=!1);return e.abrupt("return",new(b("ZenonSDP"))(c));case 6:case"end":return e.stop()}},null,this)};c.setLocalDescription=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!this.$9()){d.next=12;break}d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,d){c.$1.setLocalDescription(a.toDesc(),b,d)}));case 4:d.next=10;break;case 6:d.prev=6;d.t0=d["catch"](1);b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error processing legacy API setLocalDescription in ZenonRTCPeerConnectionWrapper.");throw d.t0;case 10:d.next=21;break;case 12:d.prev=12;d.next=15;return b("regeneratorRuntime").awrap(this.$1.setLocalDescription(a.toDesc()));case 15:d.next=21;break;case 17:d.prev=17;d.t1=d["catch"](12);b("FBLogger")("rtc_www").catching(d.t1).mustfix("Error processing modern API setLocalDescription in ZenonRTCPeerConnectionWrapper.");throw d.t1;case 21:case"end":return d.stop()}},null,this,[[1,6],[12,17]])};c.createAnswer=function(){var a=this,c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$9()){e.next=7;break}d=function(){return new(b("Promise"))(function(b,c){return a.$1.createAnswer(b,c)})};e.next=4;return b("regeneratorRuntime").awrap(d());case 4:c=e.sent;e.next=10;break;case 7:e.next=9;return b("regeneratorRuntime").awrap(this.$1.createAnswer());case 9:c=e.sent;case 10:return e.abrupt("return",new(b("ZenonSDP"))(c));case 11:case"end":return e.stop()}},null,this)};c.setRemoteDescription=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!this.$9()){d.next=12;break}d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,d){c.$1.setRemoteDescription(a.toDesc(),b,d)}));case 4:d.next=10;break;case 6:d.prev=6;d.t0=d["catch"](1);b("FBLogger")("rtc_www").catching(d.t0).mustfix("Error processing legacy API setRemoteDescription in ZenonRTCPeerConnectionWrapper.");throw d.t0;case 10:d.next=21;break;case 12:d.prev=12;d.next=15;return b("regeneratorRuntime").awrap(this.$1.setRemoteDescription(a.toDesc()));case 15:d.next=21;break;case 17:d.prev=17;d.t1=d["catch"](12);b("FBLogger")("rtc_www").catching(d.t1).mustfix("Error processing modern API setRemoteDescription in ZenonRTCPeerConnectionWrapper.");throw d.t1;case 21:case"end":return d.stop()}},null,this,[[1,6],[12,17]])};c.setRemoteIceCandidate=function(a){return this.$1.addIceCandidate(a)};c.close=function(){b("ZenonRTCPeerConnectionHelper").closePeerConnection(this.$1)};c.addEventListener=function(a,b){this.$4.add(a,b),this.$1.addEventListener(a,b)};c.createDataChannel=function(a,c){if(!this.$5.has(a)){var d=this.$1.createDataChannel(a);d?(d.onmessage=function(a){return c(a.data)},this.$5.set(a,d)):b("recoverableViolation")("Unable to create requested data channel: "+a,"rtc_www")}};c.getAllEventListeners=function(){return this.$4.getAll()};c.getEventListenersForType=function(a){return(a=this.$4.getByType(a))!=null?a:[]};c.removeEventListener=function(a,b){this.$4["delete"](a,b),this.$1.removeEventListener(a,b)};c.removeAllEventListeners=function(){var a=this,b=this.$4.getCachedEventTypes();b.forEach(function(b){var c=a.$4.getByType(b);c.forEach(function(c){a.$1.removeEventListener(b),a.$4["delete"](b,c)})})};c.addTrack=function(a,b){return b==null?this.$1.addTrack(a):this.$1.addTrack(a,b)};c.getReceivers=function(){return this.$1.getReceivers()};c.getSenders=function(){return this.$1.getSenders()};c.getRemoteStreams=function(){return this.$1.getRemoteStreams()};c.getStats=function(a){return this.$1.getStats(a)};c.removeTrack=function(a){var c=!1;for(var d=this.$1.getSenders(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;g.track===a&&(this.$1.removeTrack(g),c=!0)}c||b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ZenonRTCPeerConnectionWrapper.removeTrack: Could not find sender for track "+a.id,codebase_version:"Zenon"})};c.supportsSimulcast=function(){return this.$6};c.$9=function(){return b("UserAgent").isBrowser("Chrome < 51")||b("UserAgent").isBrowser("Opera < 43")};c.$8=function(a){var c=this;return this.$9()?new(b("Promise"))(function(b,d){return c.$1.createOffer(b,d,a)}):b("Promise").resolve(this.$1.createOffer(a))};c.getSdpSemantics=function(){return this.$2.sdpSemantics==="unified-plan"?"unified-plan":"plan-b"};return a}();e.exports=a}),null);
__d("ZenonSDPManager",["regeneratorRuntime","ZenonPlatformExperiments"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$2=null,this.$3=null,this.$1=a,this.$4=b.getZenonSdpTransformConfig()}var c=a.prototype;c.getLocalSdp=function(){return this.$2};c.createAndSetLocalSdp=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(c==="offer")){e.next=6;break}e.next=3;return b("regeneratorRuntime").awrap(this.$1.createOffer({offerToReceiveVideo:!0,preserveH264:this.$4.isPreserveH264()}));case 3:e.t0=e.sent;e.next=9;break;case 6:e.next=8;return b("regeneratorRuntime").awrap(this.$1.createAnswer());case 8:e.t0=e.sent;case 9:d=e.t0;this.$4.isPreferIsacForGroupAudio()&&d.preferCodec("audio",{preferredCodec:"ISAC",preferredCodecRate:16e3});this.$4.isPreferH264ForMwCall()&&(this.$4.isPreferSwH264()?d.preferH264Codec({levelAsymmetryAllowed:!0,packetizationMode:!0,profileLevelId:"42e01f"}):d.preferCodec("video",{preferredCodec:"H264",preferredCodecRate:9e4}));this.$4.isDisableOpusStereo()&&d.addFmtpConfig("opus","stereo","0");b("ZenonPlatformExperiments").isOpusMungeEnabled()&&d.maybeAddPtimeForOpusOnly(b("ZenonPlatformExperiments").getOpusPtimeMungeValue());this.$4.isPreserveH264()||d.removeCodec("H264");d.setVersion(a);e.next=18;return b("regeneratorRuntime").awrap(this.$1.setLocalDescription(d));case 18:this.$2=d;return e.abrupt("return",d);case 20:case"end":return e.stop()}},null,this)};c.setRemoteSdp=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:b("ZenonPlatformExperiments").isOpusMungeEnabled()&&a.maybeAddPtimeForOpusOnly(b("ZenonPlatformExperiments").getOpusPtimeMungeValue());c.next=3;return b("regeneratorRuntime").awrap(this.$1.setRemoteDescription(a));case 3:this.$3=a;case 4:case"end":return c.stop()}},null,this)};c.setRemoteIceCandidate=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$1.setRemoteIceCandidate(a));case 2:case"end":return c.stop()}},null,this)};c.closePeerConnection=function(){this.$1.close()};return a}();e.exports=a}),null);
__d("ZenonPeerConnectionManager",["ZenonMediaChannelManager","ZenonPeerConnectionStateMachine","ZenonRTCPeerConnectionConfig","ZenonRTCPeerConnectionWrapper","ZenonRTCVideoResolutionHelper","ZenonSDPManager","ZenonSimulcastExperiments","ZenonSimulcastManager"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c){var d=this;c===void 0&&(c=!1);this.$5=null;this.$6=function(){};this.$7=new Set();this.$10=function(a){a=a.target;a=a.iceConnectionState;d.$1.processEvent({payload:{iceConnectionState:a},type:"iceConnectionStateChange"})};this.$11=function(a){a=a.candidate;a&&d.$1.processEvent({payload:a,type:"iceCandidateReady"})};this.$12=function(){b("ZenonRTCVideoResolutionHelper").maybeLimitEncodingResolutionByParticipantCount(d.$4.getSenders(),d.$4.getReceivers(),d.$4.supportsSimulcast())};this.$8=c;this.$5=null;this.$4=new(b("ZenonRTCPeerConnectionWrapper"))(a,babelHelpers["extends"]({},b("ZenonRTCPeerConnectionConfig").getConfigZenonPlatform()),{},c);this.$2=new(b("ZenonMediaChannelManager"))(this.$4,function(a){return d.$6({mediaStats:a,name:"setMediaStats"})});this.$3=new(b("ZenonSDPManager"))(this.$4,a);this.$1=new(b("ZenonPeerConnectionStateMachine"))(babelHelpers["extends"]({},this.$9(),{logEvent:function(a){return d.$6(a)},mediaChannelManager:this.$2,sdpManager:this.$3}));this.$4.addEventListener("iceconnectionstatechange",this.$10);this.$4.addEventListener("icecandidate",this.$11);this.$4.addEventListener("addstream",this.$12);this.$4.addEventListener("removestream",this.$12)}var c=a.prototype;c.getLocalMediaStateVersion=function(){return this.$1.getLocalMediaStateVersion()};c.setLocalMediaStateVersion=function(a){this.$1.processEvent({payload:{version:a},type:"setLocalMediaStateVersion"})};c.addLocalTracks=function(a){this.$1.processEvent({payload:{tracks:a},type:"addLocalTracks"})};c.removeLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"removeLocalTrack"})};c.replaceLocalTrack=function(a,b){this.$1.processEvent({payload:{replacementTrack:b,trackIdToReplace:a},type:"replaceLocalTrack"})};c.createDataChannel=function(a){var b=this;this.$7.add(a);this.$1.processEvent({payload:{dataChannelLabel:a,onDataChannelMessage:function(c){b.$1.processEvent({payload:{data:c,dataChannelLabel:a},type:"dataChannelMessageReceived"})}},type:"createDataChannel"})};c.getDataChannelLabels=function(){return this.$7};c.muteLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"muteLocalTrack"})};c.unmuteLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"unmuteLocalTrack"})};c.stopLocalTrack=function(a){this.$1.processEvent({payload:{trackId:a},type:"stopLocalTrack"})};c.applyLocalSdp=function(){this.$1.processEvent({type:"applyLocalSdp"})};c.applyRemoteSdp=function(a,b){this.$1.processEvent({payload:{mediaStates:b,sdp:a},type:"applyRemoteSdp"})};c.applyRemoteIceCandidate=function(a){this.$1.processEvent({payload:a,type:"applyRemoteIceCandidate"})};c.forceEncodingEnabled=function(a){this.$1.processEvent({payload:{enabled:a},type:"forceEncodingEnabled"})};c.end=function(a){this.$6({name:"logTSData",time_series:this.$2.timeSeries()}),this.$1.processEvent({payload:{stopLocalTracks:a},type:"endCall"})};c.getTracks=function(){return this.$2.getTracks()};c.getLocalTracksForMWS=function(){return this.$2.getLocalTracksForMWS()};c.getRtpSenders=function(){return this.$4.getSenders()};c.getRtpReceivers=function(){return this.$4.getReceivers()};c.setPeerConnectionEventHandlers=function(a){this.$5=a};c.registerTrackListener=function(a){this.$2.registerTrackListener(a)};c.setTrackListenersFromManager=function(a){this.$2.setTrackListenersFromManager(a.$2)};c.setLoggingEventHandler=function(a){this.$6=a};c.$9=function(){return{onConnectionDestroyed:this.$13("onConnectionDestroyed"),onConnectionDropped:this.$13("onConnectionDropped"),onConnectionEstablished:this.$13("onConnectionEstablished"),onDataChannelMessageReceived:this.$13("onDataChannelMessageReceived"),onIceCandidateReady:this.$13("onIceCandidateReady"),onLocalMediaStateUpdate:this.$13("onLocalMediaStateUpdate"),onLocalSdpSet:this.$13("onLocalSdpSet")}};c.$13=function(a){var b=this;return function(){if(b.$5&&b.$5[a]){var c;(c=b.$5)[a].apply(c,arguments)}}};c.handleSimulcastUploadRequest=function(a){var c;if(!b("ZenonSimulcastExperiments").isCurrentBrowserCompatibleWithSimulcast()||!this.$4.supportsSimulcast()||typeof ((c=window.RTCRtpSender)==null?void 0:c.prototype.getParameters)!=="function")return;c=this.$4.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(c.length===0)return;c=c[0];a=b("ZenonSimulcastManager").getSimulcastEncodingParameters(c.getParameters(),a,b("ZenonSimulcastManager").getSimulcastSsrcToLayerMap(((a=this.$3.getLocalSdp())==null?void 0:a.toDesc().sdp)||""));c.setParameters(a)};return a}();e.exports=a}),null);
__d("OverlayConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a={OverlayConfigNumParameters:476,OverlayConfigNotPresentFlagValue:-1};e.exports=a}),null);
__d("OverlayConfigLayer",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getLayerSource=function(){return this.$1};b.getValue=function(a){return this.$2[a]};b.logExposure=function(a){};return a}();e.exports=a}),null);
__d("OverlayConfigLayerBuilder",["OverlayConfigConstants","OverlayConfigLayer","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=new Array(b("OverlayConfigConstants").OverlayConfigNumParameters).fill(b("OverlayConfigConstants").OverlayConfigNotPresentFlagValue),this.$2=a}var c=a.prototype;c.build=function(){return new(b("OverlayConfigLayer"))(this.$2,this.$1)};c.$3=function(a,c){a>=b("OverlayConfigConstants").OverlayConfigNumParameters&&b("unrecoverableViolation")("Parameter ID passed in exceeds max parameter id","rtc_www"),this.$1[a]=c};c.$4=function(a,b){this.$3(a,b?1:0)};c.setExampleConfigEnabled=function(a){this.$4(0,a)};c.setExampleConfigSomeBoolean=function(a){this.$4(2,a)};c.setExampleConfigSomeInteger=function(a){this.$3(1,a)};c.setExampleConfigSomeOtherInteger=function(a){this.$3(3,a)};c.setZenonSdpTransformConfigPreserveH264=function(a){this.$4(244,a)};c.setZenonSdpTransformConfigPreferH264ForMwCall=function(a){this.$4(420,a)};c.setZenonSdpTransformConfigPreferSwH264=function(a){this.$4(421,a)};c.setZenonSdpTransformConfigAddAudioNack=function(a){this.$4(245,a)};c.setZenonSdpTransformConfigDisableOpusStereo=function(a){this.$4(246,a)};c.setZenonSdpTransformConfigDtlsSrtpKeyAgreement=function(a){this.$4(247,a)};c.setZenonSdpTransformConfigPreferIsacForGroupAudio=function(a){this.$4(248,a)};c.setZenonPeerConnectionConfigDtlsSrtpKeyAgreement=function(a){this.$4(301,a)};c.setZenonPeerConnectionConfigRtpDataChannels=function(a){this.$4(302,a)};c.setZenonStartCallImmediatelyConfigEnabled=function(a){this.$4(308,a)};c.setZenonMultiCallSupportConfigMaxConnectedCalls=function(a){this.$3(309,a)};c.setZenonPlatformSupportConfigSupportsZenonPlatform=function(a){this.$4(316,a)};c.setZenonPlatformSupportConfigStartImmediatelyEnabled=function(a){this.$4(318,a)};c.setZenonPlatformSupportConfigMaxConnectedCalls=function(a){this.$3(317,a)};c.setZenonPlatformSupportConfigParentWindowConnectionTimeoutMs=function(a){this.$3(319,a)};c.setZenonSimulcastConfigSimulcastEnabled=function(a){this.$4(453,a)};return a}();e.exports=a}),null);
__d("OverlayConfigLayerSource",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,DEFAULT:1,MOBILECONFIG:2,APP_CRUCIBLE:3,APP_JNI:4,UNIT_TEST:5,SERVER:6,PLACEHOLDER:7,LS_MOBILECONFIG:8,APP_LS:9,APP_JS:10,BROWSER:11,APP_OVRRTC:12,APP_IG:13,MLITE4A_LEGACY_QE:14,APP_MLITE4A:15,APP_PORTAL:16,IG_LAUNCHER:17});e.exports=a}),null);
__d("ChromeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();e.exports=a}),null);
__d("EdgeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();e.exports=a}),null);
__d("FirefoxOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=new(b("OverlayConfigLayerBuilder"))(b("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();e.exports=a}),null);
__d("StructuredConfigBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getBool=function(a){return this.$1.getValue(a)>0};b.getInt=function(a){return this.$1.getValue(a)};return a}();e.exports=a}),null);
__d("Configs",["StructuredConfigBase"],(function(a,b,c,d,e,f){"use strict";c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ExampleConfig1=c.getBool(0),c.$ExampleConfig2=c.getBool(2),c.$ExampleConfig3=c.getInt(1),c.$ExampleConfig4=c.getInt(3),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ExampleConfig1=this.getBool(0),this.$ExampleConfig2=this.getBool(2),this.$ExampleConfig3=this.getInt(1),this.$ExampleConfig4=this.getInt(3)};c.isEnabled=function(){return this.$ExampleConfig1};c.isSomeBoolean=function(){return this.$ExampleConfig2};c.getSomeInteger=function(){return this.$ExampleConfig3};c.getSomeOtherInteger=function(){return this.$ExampleConfig4};return b}(a=b("StructuredConfigBase"));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonSdpTransformConfig1=c.getBool(244),c.$ZenonSdpTransformConfig2=c.getBool(420),c.$ZenonSdpTransformConfig3=c.getBool(421),c.$ZenonSdpTransformConfig4=c.getBool(245),c.$ZenonSdpTransformConfig5=c.getBool(246),c.$ZenonSdpTransformConfig6=c.getBool(247),c.$ZenonSdpTransformConfig7=c.getBool(248),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonSdpTransformConfig1=this.getBool(244),this.$ZenonSdpTransformConfig2=this.getBool(420),this.$ZenonSdpTransformConfig3=this.getBool(421),this.$ZenonSdpTransformConfig4=this.getBool(245),this.$ZenonSdpTransformConfig5=this.getBool(246),this.$ZenonSdpTransformConfig6=this.getBool(247),this.$ZenonSdpTransformConfig7=this.getBool(248)};c.isPreserveH264=function(){return this.$ZenonSdpTransformConfig1};c.isPreferH264ForMwCall=function(){return this.$ZenonSdpTransformConfig2};c.isPreferSwH264=function(){return this.$ZenonSdpTransformConfig3};c.isAddAudioNack=function(){return this.$ZenonSdpTransformConfig4};c.isDisableOpusStereo=function(){return this.$ZenonSdpTransformConfig5};c.isDtlsSrtpKeyAgreement=function(){return this.$ZenonSdpTransformConfig6};c.isPreferIsacForGroupAudio=function(){return this.$ZenonSdpTransformConfig7};return b}(a);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonPeerConnectionConfig1=c.getBool(301),c.$ZenonPeerConnectionConfig2=c.getBool(302),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonPeerConnectionConfig1=this.getBool(301),this.$ZenonPeerConnectionConfig2=this.getBool(302)};c.isDtlsSrtpKeyAgreement=function(){return this.$ZenonPeerConnectionConfig1};c.isRtpDataChannels=function(){return this.$ZenonPeerConnectionConfig2};return b}(a);b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonStartCallImmediatelyConfig1=c.getBool(308),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonStartCallImmediatelyConfig1=this.getBool(308)};c.isEnabled=function(){return this.$ZenonStartCallImmediatelyConfig1};return b}(a);var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonMultiCallSupportConfig1=c.getInt(309),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonMultiCallSupportConfig1=this.getInt(309)};c.getMaxConnectedCalls=function(){return this.$ZenonMultiCallSupportConfig1};return a}(a),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonPlatformSupportConfig1=c.getBool(316),c.$ZenonPlatformSupportConfig2=c.getBool(318),c.$ZenonPlatformSupportConfig3=c.getInt(317),c.$ZenonPlatformSupportConfig4=c.getInt(319),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonPlatformSupportConfig1=this.getBool(316),this.$ZenonPlatformSupportConfig2=this.getBool(318),this.$ZenonPlatformSupportConfig3=this.getInt(317),this.$ZenonPlatformSupportConfig4=this.getInt(319)};c.isSupportsZenonPlatform=function(){return this.$ZenonPlatformSupportConfig1};c.isStartImmediatelyEnabled=function(){return this.$ZenonPlatformSupportConfig2};c.getMaxConnectedCalls=function(){return this.$ZenonPlatformSupportConfig3};c.getParentWindowConnectionTimeoutMs=function(){return this.$ZenonPlatformSupportConfig4};return a}(a);a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonSimulcastConfig1=c.getBool(453),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonSimulcastConfig1=this.getBool(453)};c.isSimulcastEnabled=function(){return this.$ZenonSimulcastConfig1};return b}(a);e.exports={ExampleConfig:c,ZenonSdpTransformConfig:d,ZenonPeerConnectionConfig:f,ZenonStartCallImmediatelyConfig:b,ZenonMultiCallSupportConfig:g,ZenonPlatformSupportConfig:h,ZenonSimulcastConfig:a}}),null);
__d("OverlayConfigDefaults",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze([1,0,0,20,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,0,1,0,2e3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);e.exports=a}),null);
__d("OverlayConfigDefaultsLayer",["OverlayConfigDefaults","OverlayConfigLayerSource"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.getLayerSource=function(){return b("OverlayConfigLayerSource").DEFAULT};c.getValue=function(a){return b("OverlayConfigDefaults")[a]};c.logExposure=function(a){};return a}();e.exports=a}),null);
__d("OverlayConfigLayerManager",["OverlayConfigConstants","OverlayConfigDefaultsLayer","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[new(b("OverlayConfigDefaultsLayer"))()]}var c=a.prototype;c.getValue=function(a){for(var c=this.$1.length-1;c>=0;c--){var d=this.$1[c].getValue(a);if(d>b("OverlayConfigConstants").OverlayConfigNotPresentFlagValue)return d}throw b("unrecoverableViolation")("OverlayConfigLayerManager: No value found for id "+String(a),"rtc_www")};c.addLayer=function(a){this.$1.push(a);return this.$1.length-1};c.replaceLayer=function(a,c){if(a===0)throw b("unrecoverableViolation")("OverlayConfigLayerManager: Tried to replace default layer!","rtc_www");else if(this.$1[a]==null)throw b("unrecoverableViolation")("OverlayConfigLayerManager: Layer does not exist at index "+String(a),"rtc_www");this.$1[a]=c};return a}();e.exports=a}),null);
__d("OverlayConfigManager",["Configs","OverlayConfigLayerManager"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("Configs")).ExampleConfig,h=a.ZenonSdpTransformConfig,i=a.ZenonPeerConnectionConfig,j=a.ZenonStartCallImmediatelyConfig,k=a.ZenonMultiCallSupportConfig,l=a.ZenonPlatformSupportConfig,m=a.ZenonSimulcastConfig;c=function(){function a(){this.layerManager=new(b("OverlayConfigLayerManager"))()}var c=a.prototype;c.getExampleConfig=function(){return new g(this.layerManager)};c.getZenonSdpTransformConfig=function(){return new h(this.layerManager)};c.getZenonPeerConnectionConfig=function(){return new i(this.layerManager)};c.getZenonStartCallImmediatelyConfig=function(){return new j(this.layerManager)};c.getZenonMultiCallSupportConfig=function(){return new k(this.layerManager)};c.getZenonPlatformSupportConfig=function(){return new l(this.layerManager)};c.getZenonSimulcastConfig=function(){return new m(this.layerManager)};return a}();e.exports=c}),null);
__d("ZenonOverlayConfigManager",["ChromeOverlayConfigLayer","EdgeOverlayConfigLayer","FirefoxOverlayConfigLayer","OverlayConfigManager","RTWebSignalingListener","UserAgentData"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$2=new(b("OverlayConfigManager"))();var c={Chrome:b("ChromeOverlayConfigLayer"),"Edge (Chromium Based)":b("EdgeOverlayConfigLayer"),Firefox:b("FirefoxOverlayConfigLayer")};c=c[b("UserAgentData").browserName];c&&this.$2.layerManager.addLayer(c);a.appConfig&&this.$2.layerManager.addLayer(a.appConfig)}var c=a.prototype;c.getSignalingListener=function(){var a;return(a=this.$1.signalingListener)!=null?a:new(b("RTWebSignalingListener"))()};c.getConfigManager=function(){return this.$2};return a}();e.exports=a}),null);
__d("ZenonCallSDK",["regeneratorRuntime","EventEmitter","ScotchCallModelEmitter","ScotchRTWebUserActionLogger","ScotchSignalingEventEmitter","ScotchUtils","ZenonCallsManager","ZenonCallsModelEmitter","ZenonOverlayConfigManager","ZenonPlatformExperiments","ZenonTransportEventEmitter","gkx","immutable"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;c=new(b("ZenonOverlayConfigManager"))(c);var e=c.getConfigManager().getZenonPlatformSupportConfig().isSupportsZenonPlatform()&&b("ZenonPlatformExperiments").isZenonPlatform();d.$ZenonCallSDK1=e?new(b("ZenonCallsManager"))(c):new(b("ScotchUtils"))(c);c=e?b("ZenonCallsModelEmitter"):b("ScotchCallModelEmitter");c.CallsModelEmitterInstance.addListener("callsModelUpdate",function(a){d.emit("callsModelUpdate",a)});e?b("ZenonTransportEventEmitter").addListener("transportPlatformEvent",function(a){d.emit("signalingEvent",a)}):b("ScotchSignalingEventEmitter").addListener("signalingPlatformEvent",function(a){d.emit("signalingEvent",a)});return d}var d=c.prototype;d.initSignaling=function(a,b,c){this.$ZenonCallSDK1.initializeSignaling(a,b,c)};d.endCall=function(a,b,c){this.$ZenonCallSDK1.endCall(a,b,c)};d.join=function(a){this.$ZenonCallSDK1.join(a)};d.ringParticipants=function(a,b){this.$ZenonCallSDK1.ringParticipants(a,b)};d.removeParticipants=function(a,b){this.$ZenonCallSDK1.removeParticipants(a,b)};d.sendCompositingServiceDataMessageRequest=function(a,b,c){this.$ZenonCallSDK1.sendCompositingServiceDataMessageRequest(a,b,c)};d.forceEncodingEnabled=function(a,b){this.$ZenonCallSDK1.forceEncodingEnabled(a,b)};d.addLocalTrack=function(a,b){this.$ZenonCallSDK1.addLocalTrack(a,b)};d.removeLocalTrack=function(a,b){this.$ZenonCallSDK1.removeLocalTrack(a,b)};d.replaceLocalTrack=function(a,b,c,d){d===void 0&&(d=!1);return this.$ZenonCallSDK1.replaceLocalTrack(a,b,c,d)};d.muteTrack=function(a,b){this.$ZenonCallSDK1.muteTrack(a,b)};d.unmuteTrack=function(a,b){this.$ZenonCallSDK1.unmuteTrack(a,b)};d.stopLocalVideo=function(a,b){this.$ZenonCallSDK1.stopLocalVideo(a,b)};d.acceptVideoEscalation=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.$ZenonCallSDK1.acceptVideoEscalation());case 2:case"end":return a.stop()}},null,this)};d.declineVideoEscalation=function(a){this.$ZenonCallSDK1.declineVideoEscalation()};d.cancelVideoEscalation=function(a){this.$ZenonCallSDK1.cancelVideoEscalation()};d.startVideoEscalation=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.$ZenonCallSDK1.startVideoEscalation());case 2:case"end":return a.stop()}},null,this)};d.createDataMessageSubscription=function(a,b,c){this.$ZenonCallSDK1.createDataMessageSubscription(a,b,c)};d.removeDataMessageSubscription=function(a,b,c){this.$ZenonCallSDK1.removeDataMessageSubscription(a,b,c)};d.sendGenericDataMessage=function(a,b,c,d,e){this.$ZenonCallSDK1.sendGenericDataMessage(a,b,c,d,e)};d.logWithLogIdentifiers=function(a,b){this.$ZenonCallSDK1.logWithLogIdentifiers(a,b)};d.subscribeToRemoteVideo=function(a,c,d){b("gkx")("1390244")&&this.$ZenonCallSDK1.subscribeToRemoteVideo(a,c,d)};d.unsubscribeFromStateSyncTopic=function(a,c){b("gkx")("1418215")&&this.$ZenonCallSDK1.unsubscribeFromStateSyncTopic(a,c)};d.subscribeToStateSyncTopic=function(a,c){b("gkx")("1418215")&&this.$ZenonCallSDK1.updateStateSyncTopic(a,c,null)};d.updateStateSyncTopic=function(a,c,d){b("gkx")("1418215")&&this.$ZenonCallSDK1.updateStateSyncTopic(a,c,d)};d.approveParticipants=function(a,c){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){var d=c.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Product is trying to approve users "+d});return}this.$ZenonCallSDK1.approveParticipants(a,c)};d.denyParticipants=function(a,c){if(!b("ZenonPlatformExperiments").shouldUseLobbyMode()){var d=c.toArray().join(", ");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[WR] Product is trying to deny users "+d});return}this.$ZenonCallSDK1.denyParticipants(a,c)};d.getPlatformType=function(){return this.$ZenonCallSDK1.getPlatformType()};d.notifyScreenShareStart_DEPRECATED=function(a){this.$ZenonCallSDK1.notifyScreenShareStart(a)};d.notifyScreenShareEnd_DEPRECATED=function(a){this.$ZenonCallSDK1.notifyScreenShareEnd(a)};d.getCallProtocolType_DEPRECATED=function(a){return this.$ZenonCallSDK1.getCallProtocolType()};d.initV2Infrastructure_DEPRECATED=function(a,b){this.$ZenonCallSDK1.initializeV2Infrastructure(a,b)};d.submitRating_DEPRECATED=function(a,b,c,d){c===void 0&&(c=null),d===void 0&&(d=null),this.$ZenonCallSDK1.submitRating(a,b,c,d)};d.setRatingImpression_DEPRECATED=function(a,b,c){b===void 0&&(b=!1),c===void 0&&(c=!1),this.$ZenonCallSDK1.setRatingImpression(b,c)};return c}(b("EventEmitter"));e.exports=a}),null);
__d("ScotchRTCStateSyncReducer",["ScotchRTCStateSyncStore"],(function(a,b,c,d,e,f){"use strict";a={setState:function(a,c){switch(c.type){case"SET_INPUT_SYNC_STATE":var d=b("ScotchRTCStateSyncStore").getState().inputStates.set(c.topic,{version:c.version,data:c.inputData});return a.set("inputStates",d);case"SET_OUTPUT_SYNC_STATE":d=b("ScotchRTCStateSyncStore").getState().outputStates.set(c.topic,{version:c.version,data:c.outputData});return a.set("outputStates",d)}return a},setSubscription:function(a,c){var d=b("ScotchRTCStateSyncStore").getState().subscribedTopics;switch(c.type){case"STATE_SYNC_SUBSCRIBE":return a.set("subscribedTopics",d.add(c.topic));case"STATE_SYNC_UNSUBSCRIBE":return a.set("subscribedTopics",d["delete"](c.topic))}return a}};e.exports=a}),null);
__d("ScotchRTCStateSyncStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";c={inputStates:(a=b("immutable")).Map([]),outputStates:a.Map([]),subscribedTopics:a.Set([])};d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.Record(c));e.exports=d}),null);
__d("ScotchRTCStateSyncStore",["FluxReduceStore","ScotchRTCAppDispatcher","ScotchRTCGroupCallActions","ScotchRTCStateSyncReducer","ScotchRTCStateSyncStoreState","ScotchRTWebUserActionLogger","ZenonStateSyncSerializer"],(function(a,b,c,d,e,f){"use strict";var g=[b("ScotchRTCStateSyncReducer").setState,b("ScotchRTCStateSyncReducer").setSubscription];a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ScotchRTCStateSyncStoreState"))()};d.reduce=function(a,b){return g.reduce(function(a,c){return c(a,b)},a)};d.setUpdatedInputState=function(a,c){var d=b("ZenonStateSyncSerializer").serializeInputState(a,c),e=1;if(this.getState().inputStates.has(a)){var f=this.getState().inputStates.get(a);e=f.version+1}b("ScotchRTCGroupCallActions").setStateSyncInput(a,e,c);return{version:e,data:d}};d.setOutputState=function(a,c){if(!this.getState().subscribedTopics.has(a)){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] User is not subscribed to topic: "+a+", dropping output state."});return}var d=-1;if(this.getState().outputStates.has(a)){var e=this.getState().outputStates.get(a);d=e.version}if(c.version<=d){b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"[SS] Client version: "+d+" is ahead of server version: "+c.version+", dropping output state"});return}e=b("ZenonStateSyncSerializer").deserializeOutputState(a,c.data);b("ScotchRTCGroupCallActions").setStateSyncOutput(a,c.version,e);return};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ScotchRTCAppDispatcher"))}),null);
/**
 * License: https://www.facebook.com/legal/license/4tlmzNX1_Tc/
 */
__d("ZenonSDPInterop",["sdp-interop-transform"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.cache={mlB2UMap:{},mlU2BMap:{},localMediaLines:[],remoteMediaLines:[],localDescriptionType:"offer",offer:null,answer:null,pranswer:null,rollback:null},this.planBRemoteDescription=null,this.midToMWTrackId=new Map(),this.mwTrackIdToWebrtcTrackId=new Map()}var c=a.prototype;c.setLocalDescriptionType=function(a){this.cache.localDescriptionType=a};c.setPlanBRemoteDescription=function(a){this.planBRemoteDescription=a};c.getPlanBRemoteDescription=function(){return this.planBRemoteDescription};c.correlateWebrtcTrackIdsByMid=function(a,b){b=this.midToMWTrackId.get(b);b!=null&&this.mwTrackIdToWebrtcTrackId.set(b,a)};c.getWebrtcTrackIdFromMWTrackId=function(a){var b=this.mwTrackIdToWebrtcTrackId.get(a);return b?b:a};c.candidateToUnifiedPlan=function(a){a=new RTCIceCandidate(a);a.sdpMLineIndex=this.cache.mlB2UMap[a.sdpMLineIndex];return a};c.candidateToPlanB=function(a){a=new RTCIceCandidate(a);var b=a.sdpMid;if(b!=null)if(b.indexOf("audio")===0)a.sdpMid="audio";else if(b.indexOf("video")===0)a.sdpMid="video";else throw new Error("candidate with "+b+" not allowed");a.sdpMLineIndex=this.cache.mlU2BMap[a.sdpMLineIndex];return a};c.getFirstSendingIndexFromAnswer=function(a){if(!this.cache.answer)return null;var c=b("sdp-interop-transform").parse(this.cache.answer);if(c&&c.media&&Array.isArray(c.media))for(var d=0;d<c.media.length;d++)if(c.media[d].type===a&&(!c.media[d].direction||c.media[d].direction==="sendrecv"||c.media[d].direction==="sendonly"))return d;return null};c.cacheUnifiedPlanOffer=function(a){var c=this,d=[];if(typeof a!=="object"||a===null||typeof a.sdp!=="string")return a;var e=b("sdp-interop-transform").parse(a.sdp);if(e.media===void 0||!Array.isArray(e.media)||e.media.length===0)return a;if(e.media.length<=3&&e.media.every(function(a){a=a.mid;return["video","audio","data"].includes(a)}))return a;var f=a.sdp,g=!1,h=function(a){var f=e.media[a];d.push(f.type);f.rtp.forEach(function(d){if(d.codec==="NULL"){g=!0;var e=b("sdp-interop-transform").parse(c.cache.offer);d.codec=e.media[a].rtp[0].codec}})};for(var i=0;i<e.media.length;i++)h(i);g&&(f=b("sdp-interop-transform").write(e));this.cache[a.type]=f;this.cache.localDescriptionType=a.type;this.cache.localMediaLines=d};c.toUnifiedPlan=function(c){var d=this,e=this;if(typeof c!=="object"||c===null||typeof c.sdp!=="string")return c;if(c.type!=="answer"&&c.type!=="offer")return c;var f=b("sdp-interop-transform").parse(c.sdp);if(f.media===void 0||!Array.isArray(f.media)||f.media.length===0)return c;var g=[];f.media.forEach(function(a){a=a.mid;g.push(a)});var h=[],i;this.cache[c.type]!=null&&(i=b("sdp-interop-transform").parse(this.cache[c.type]));var j={audio:{},video:{}},k={},l=0,m=0;f.media.forEach(function(a){if(a.type==="application"){a.mid=String(a.mid);k[a.mid]=a;return}var b=a.sources,f=a.ssrcGroups,g=a.candidates,h=a.iceUfrag,n=a.icePwd,p=a.fingerprint,q=a.port;typeof b==="object"&&(delete a.sources,delete a.ssrcGroups,delete a.candidates,delete a.iceUfrag,delete a.icePwd,delete a.fingerprint,delete a.port,delete a.mid);var r={};f!==void 0&&Array.isArray(f)&&f.forEach(function(a){if(a.semantics==="SIM")return;a.ssrcs!==void 0&&Array.isArray(a.ssrcs)&&a.ssrcs.forEach(function(b){r[b]===void 0&&(r[b]=[]),r[b].push(a)})});var s={};typeof b==="object"?Object.keys(b).forEach(function(t){var f;if(c.type===d.cache.localDescriptionType&&!b[t].msid){j[a.type][t]=b[t];return}r[t]!==void 0&&Array.isArray(r[t])&&r[t].some(function(a){a=a.ssrcs;return a.some(function(a){if(typeof s[a]==="object"){f=s[a];return!0}})});if(typeof f==="object")f.sources[t]=b[t],delete b[t].msid;else{f=Object.create(a);s[t]=f;b[t].msid!==void 0&&(f.msid=b[t].msid);f.sources={};f.sources[t]=b[t];f.ssrcGroups=r[t];i!==void 0&&i.media!==void 0&&Array.isArray(i.media)&&i.media.forEach(function(a){typeof a.sources==="object"&&Object.keys(a.sources).forEach(function(b){b===t&&(f.mid=String(a.mid))})});if(f.mid===void 0){if(c.type===d.cache.localDescriptionType)throw new Error("An unmapped SSRC was found.");f.mid=[a.type,"-",t].join("")}f.candidates=g;f.iceUfrag=h;f.icePwd=n;f.fingerprint=p;f.port=q;f.type=a.type;k[f.mid]=f;e.cache.mlU2BMap[m]=l;e.cache.mlB2UMap[l]===void 0&&(e.cache.mlB2UMap[l]=m);m++}}):(a.mid=String(a.mid),k[a.mid]=a);l++});f.media=[];g=[];if(c.type===this.cache.localDescriptionType){this.cache[c.type]!=null&&(i=b("sdp-interop-transform").parse(this.cache[c.type]));if(i!==void 0)for(var n=0;n<i.media.length;n++){var o=i.media[n];k[o.mid]===void 0&&(delete o.msid,delete o.sources,delete o.ssrcGroups,!o.direction||o.direction==="sendrecv"?o.direction="recvonly":o.direction==="sendonly"&&(o.direction="inactive"));f.media.push(o);typeof o.mid==="string"&&g.push(o.mid)}}else i!==void 0&&i.media!==void 0&&Array.isArray(i.media)&&i.media.forEach(function(a){var b=String(a.mid);g.push(b);k[b]!==void 0?f.media.push(k[b]):(delete a.msid,delete a.sources,delete a.ssrcGroups,(!a.direction||a.direction==="sendrecv")&&(a.direction="recvonly"),(!a.direction||a.direction==="sendonly")&&(a.direction="inactive"),f.media.push(a))}),Object.keys(k).forEach(function(a){g.includes(a)||(g.push(a),k[a].direction==="recvonly"?f.media.some(function(b){var c=b.direction,d=b.sources;b=b.type;if((c==="sendrecv"||c==="sendonly")&&b===k[a].type){Object.keys(k[a].sources).forEach(function(b){d[b]=k[a].sources[b]});return!0}}):f.media.push(k[a]))});this.cache[c.type]===null&&(f.media=a.sortRemoteSourcesToMatchLocalOrder(this.cache.localMediaLines,f.media));g=[];for(var o=0;o<f.media.length;o++)f.media[o].mid=String(o),g.push(String(o)),h.push(f.media[o].type);this.cacheMidToMWTrackId(f.media);["audio","video"].forEach(function(a){if(!f||!f.media||!Array.isArray(f.media))return;var b=null;if(Object.keys(j[a]).length>0){b=e.getFirstSendingIndexFromAnswer(a);if(b===null)for(var c=0;c<f.media.length;c++)if(f.media[c].type===a){b=c;break}}if(b&&f.media.length>b){var d=f.media[b];Object.keys(j[a]).forEach(function(b){d.sources&&d.sources[b],d.sources||(d.sources={}),d.sources[b]=j[a][b]})}});f.groups.some(function(a){if(a.type==="BUNDLE"){a.mids=g.join(" ");return!0}});f.msidSemantic={semantic:"WMS",token:"*"};n=b("sdp-interop-transform").write(f);this.cache.remoteMediaLines=h;this.cache[c.type]=n;return{sdp:n,type:c.type}};c.getTrackTypesToMatchDescription=function(){var a=[],b=this.cache,c=b.localMediaLines;b=b.remoteMediaLines;if(b.length<=c.length)return a;for(var d=0;d<b.length;d++)c[d]==null&&a.push(b[d]);return a};a.sortRemoteSourcesToMatchLocalOrder=function(a,b){var c=0,d=0;while(c<a.length&&d<b.length){if(b[d].type===a[c]){var e=b[c];b[c]=b[d];b[d]=e;c++;d=0}d++}return b};c.cacheMidToMWTrackId=function(b){var c=this;b.forEach(function(b){var d=b.sources;if(d!=null&&b.type!=="application"){var e=Object.keys(d);e.length>=1&&e.forEach(function(e){e=d[e].msid;e=a.getMWTrackIdFromMsid(e);e!=null&&c.midToMWTrackId.set(b.mid,e)})}})};a.getMWTrackIdFromMsid=function(a){if(a!=null){a=a.split(" ");if(a.length>=2)return a[1]}return null};return a}();e.exports=a}),null);
__d("ScotchFBRTCPeerConnectionCurrent",["Promise","regeneratorRuntime","requireCond","cr:1412113","FBLogger","FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","FBRTCExperiment","RTCConfig","RTCIceCandidate","RTCPeerConnection","ScotchFBRTCSdpUtils","ScotchRTCSessionDescription","ScotchRTWebBrowserFeatureSupport","ScotchRTWebExperiments","ScotchRTWebUserActionLogger","UserAgent","ZenonSDPInterop","ZenonSimulcastExperiments","ZenonSimulcastManager","ZenonSimulcastSdpUtils","gkx","webrtc-adapter"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").SDPSemantics,h=b("FBRTCConstants").SignalingProtocol,i=b("ScotchRTWebBrowserFeatureSupport").isGetSendersSupported;a=function(){function a(a,c,d){var e=this;c===void 0&&(c={});d===void 0&&(d={});this.$3=[];this.$4=[];this.$7=new Map();this.$10=g.PLAN_B;this.$12=!1;this.$13=null;this.addEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)||(c=[],this.$7.set(a,c));c.push(b);this.$5.addEventListener(a,b)};this.removeEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)&&(c=c.filter(function(a){return a!==b}),c.length<1?this.$7["delete"](a):this.$7.set(a,c));this.$5.removeEventListener(a,b)};this.$15=function(a){a=a.candidate;a&&e.$4.push(a)};this.$16=function(a){a=a.channel;e.$18(a)};this.$6=a;this.$1=c;this.$2=d;b("ScotchRTWebExperiments").shouldUseUnifiedPlan()?(this.$10=g.UNIFIED_PLAN,this.$11=new(b("ZenonSDPInterop"))()):this.$6===h.MULTIWAY&&b("ScotchRTWebExperiments").shouldUseMWUnifiedPlanSDP()?(this.$10=g.UNIFIED_PLAN,this.$11=new(b("ZenonSDPInterop"))()):this.$6===h.P2P&&b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP()&&(this.$10=g.UNIFIED_PLAN);this.$5=this.$14()}var c=a.prototype;c.$14=function(){b("webrtc-adapter")==null&&b("FBLogger")("rtc_www").mustfix("Webrtc-adapter should be loaded");b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"Creating peer connection with semantics "+this.$10});var a=new(b("RTCPeerConnection"))(babelHelpers["extends"]({},this.$1,{sdpSemantics:this.$10}),this.$2);a.addEventListener("icecandidate",this.$15);a.addEventListener("datachannel",this.$16);for(var c=this.$7.entries(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;a.addEventListener(g,j)}}return a};c.removeAllListeners=function(){for(var a=this.$7.entries(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;var e=d[0];d=d[1];for(var d=d,f=Array.isArray(d),g=0,d=f?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=d.length)break;h=d[g++]}else{g=d.next();if(g.done)break;h=g.value}h=h;this.$5.removeEventListener(e,h)}}this.$5.removeEventListener("datachannel",this.$16);this.$5.removeEventListener("icecandidate",this.$15)};c.reset=function(){var a=this,c=this.getSenders(),d=this.$5;for(var e=this.$7.entries(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h[0];h=h[1];for(var h=h,j=Array.isArray(h),k=0,h=j?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=h.length)break;l=h[k++]}else{k=h.next();if(k.done)break;l=k.value}l=l;d.removeEventListener(i,l)}}d.removeEventListener("datachannel",this.$16);d.removeEventListener("icecandidate",this.$15);this.$3=[];this.$4=[];this.$5=this.$14();for(var l=d.getLocalStreams(),k=Array.isArray(l),j=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(j>=l.length)break;h=l[j++]}else{j=l.next();if(j.done)break;h=j.value}i=h;this.$17(i,c)&&this.addStream(i)}return b("Promise").race([new(b("Promise"))(function(b){var c=a.$5,e=function a(e){e=e.target;e.iceConnectionState!=="checking"&&e.iceConnectionState!=="new"&&(b(),c.removeEventListener("iceconnectionstatechange",a),n(d))};c.addEventListener("iceconnectionstatechange",e)}),new(b("Promise"))(function(a){return window.setTimeout(a,5e3)})])["catch"](function(a){return b("Promise").resolve()}).then(function(){n(d)})};c.$17=function(c,d){return!b("FBRTCConfig").isVCEndpointCall()||!b("RTCConfig").CollabWhitelistedBrowserGK?!0:a.shouldUseAddTrackForUnifiedPlan()?c.getTracks().some(function(a){return d!=null?d.some(function(b){return b.track===a}):!1}):c.active};c.close=function(){n(this.$5)};c.getCreatedIceCandidates=function(){return this.$4};c.$18=function(a){var b=this;a.addEventListener("close",function(){b.$3=b.$3.filter(function(b){return b!==a})});this.$3.push(a)};c.$19=function(a){return this.$9&&this.$9[a]||a};c.rewriteLocalIceCandidate=function(a,b){return[this.$8&&this.$8[a]||a,b]};c.transformLocalSdp=function(a){return b("ScotchFBRTCSdpUtils").transformSdpMids(a,this.$8)};c.transformRemoteSdp=function(a){return b("ScotchFBRTCSdpUtils").transformSdpMids(a,this.$9)};c.processRemoteOfferSdpForP2PVideoEscalation=function(a){if(!this.$8&&!this.$9)return a;var c=b("ScotchFBRTCSdpUtils").constructMidMapFromRemoteOffer(a),d=c.localSdpMap;c=c.remoteSdpMap;this.$8=d;this.$9=c;return this.transformRemoteSdp(a)};c.onReceivedRemoteIceCandidate=function(a){var c=a.sdp,d=a.label;a=a.sdp_mid;a=this.$19(a);d=new(b("RTCIceCandidate"))({sdpMLineIndex:d,candidate:b("ScotchFBRTCSdpUtils").fixMobileIceSdp(c),sdpMid:a});return b("Promise").resolve(this.$5.addIceCandidate(d))};c.getSignalingProtocol=function(){return this.$6};c.getLocalStreams=function(){return this.$5.getLocalStreams()};c.getRemoteStreams=function(){return this.$5.getRemoteStreams()};a.shouldUseAddTrackForUnifiedPlan=function(){return b("ScotchRTWebExperiments").shouldUseUnifiedPlan()||(b("UserAgent").isBrowser("Firefox")||b("ScotchRTWebExperiments").shouldUseP2PUnifiedPlanSDP())&&o("addTrack")&&i()};c.addStream=function(a,b){var c=this,d=this.getSenders(),e=[],f=function(){if(h){if(i>=g.length)return"break";j=g[i++]}else{i=g.next();if(i.done)return"break";j=i.value}var f=j,k=d.find(function(a){return a.track===f});k===void 0&&(k=c.$5.addTrack(f,a),e.push(k));b&&k&&b(k)};for(var g=a.getTracks(),h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j,k=f();if(k==="break")break}return e};c.removeStream=function(a){var b=a.getTracks();a=this.getSenders().filter(function(a){return b.includes(a.track)});for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;this.$5.removeTrack(e)}};c.removeTrack=function(a){this.$5.removeTrack(a)};c.addTrack=function(a,b){return this.$5.addTrack(a,b)};c.replaceTrack=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=this.getSenders().find(function(a){return a.track===c});if(!(d===void 0)){e.next=3;break}throw new Error("track to be replaced is not found");case 3:return e.abrupt("return",b("Promise").resolve(d.replaceTrack(a)));case 4:case"end":return e.stop()}},null,this)};c.createOffer=function(a,c,d){var e=this,f,i,k,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:a===void 0&&(a={});c===void 0&&(c={});d===void 0&&(d={});if(!j){n.next=9;break}n.next=6;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,c){e.$5.createOffer(b,c,l(a))}));case 6:n.t0=n.sent;n.next=12;break;case 9:n.next=11;return b("regeneratorRuntime").awrap(this.$5.createOffer(l(a)));case 11:n.t0=n.sent;case 12:f=n.t0;this.$10==g.PLAN_B&&this.$6==h.MULTIWAY&&b("UserAgent").isBrowser("Chrome >= 69")&&!this.$12&&b("ZenonSimulcastExperiments").shouldUsePlanBChromeSimulcast()&&(f.sdp=b("ZenonSimulcastSdpUtils").addSimulcastToPlanBOffer(f.sdp,b("ScotchRTWebExperiments").getNumSimulcastLayers()),this.$12=!0,this.$13=b("ZenonSimulcastManager").getSimulcastSsrcToLayerMap(f.sdp));f=r(f,d,a);i=b("ScotchFBRTCSdpUtils").constructMidMap(f.sdp),k=i.localSdpMap,m=i.remoteSdpMap;this.$8=k;this.$9=m;this.$11!=null&&this.$11.cacheUnifiedPlanOffer(f);return n.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,f,c));case 20:case"end":return n.stop()}},null,this)};c.createAnswer=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a===void 0&&(a={});if(!j){d.next=7;break}d.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(this.$5.createAnswer));case 4:d.t0=d.sent;d.next=10;break;case 7:d.next=9;return b("regeneratorRuntime").awrap(this.$5.createAnswer());case 9:d.t0=d.sent;case 10:c=d.t0;return d.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,c,a));case 12:case"end":return d.stop()}},null,this)};c.setLocalDescription=function(a){var c=this,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a.toDesc();e.prev=1;if(!m){e.next=7;break}e.next=5;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(a,b){c.$5.setLocalDescription(d,a,b)}));case 5:e.next=9;break;case 7:e.next=9;return b("regeneratorRuntime").awrap(this.$5.setLocalDescription(d));case 9:b("cr:1412113")&&b("cr:1412113").onSetLocalDescription(a);b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCPeerConnection_setLocalSDP:\r\n"+b("ScotchFBRTCSdpUtils").toLoggingString(a.toSdp())});e.next=17;break;case 13:e.prev=13;e.t0=e["catch"](1);b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_setLocalSDP",errorType:e.t0.toString()});throw e.t0;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},null,this,[[1,13]])};c.setRemoteDescription=function(a){var c=this,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a;if(!(this.$11!=null)){e.next=5;break}e.next=4;return b("regeneratorRuntime").awrap(this.renegotiateDescriptionsForUnified(a,this.$11));case 4:d=e.sent;case 5:e.prev=5;if(!m){e.next=11;break}e.next=9;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(a,b){c.$5.setRemoteDescription(d.toDesc(),a,b)}));case 9:e.next=13;break;case 11:e.next=13;return b("regeneratorRuntime").awrap(this.$5.setRemoteDescription(d.toDesc()));case 13:b("cr:1412113")&&b("cr:1412113").onSetRemoteDescription(a);b("gkx")("1439080")&&b("ScotchRTWebUserActionLogger").logCheckpoint({checkpoint:"ScotchFBRTCPeerConnection_setRemoteSDP:\r\n"+b("ScotchFBRTCSdpUtils").toLoggingString(a.toSdp())});e.next=21;break;case 17:e.prev=17;e.t0=e["catch"](5);b("ScotchRTWebUserActionLogger").logError({errorDomain:"ScotchFBRTCPeerConnection_setRemoteSDP",errorType:e.t0.toString()});throw e.t0;case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}},null,this,[[5,17]])};c.renegotiateDescriptionsForUnified=function(a,c){var d=this,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c.setPlanBRemoteDescription(a);e=c.toUnifiedPlan(a.toDesc());if(!(a.type==="answer")){h.next=11;break}f=c.getTrackTypesToMatchDescription();if(!(f.length>0)){h.next=11;break}f.forEach(function(a){a=d.$5.addTransceiver(a);a.direction="recvonly"});h.next=8;return b("regeneratorRuntime").awrap(this.createOffer());case 8:g=h.sent;h.next=11;return b("regeneratorRuntime").awrap(this.setLocalDescription(g));case 11:return h.abrupt("return",new(b("ScotchRTCSessionDescription"))(this.$6,e));case 12:case"end":return h.stop()}},null,this)};c.getLocalDescription=function(){return new(b("ScotchRTCSessionDescription"))(this.$6,this.$5.localDescription||{})};c.getRemoteDescription=function(){return new(b("ScotchRTCSessionDescription"))(this.$6,this.$5.remoteDescription||{})};c.getRemoteDescriptionForSMU=function(){var a=null;this.$11!=null&&(a=this.$11.getPlanBRemoteDescription());return a!=null?a:this.getRemoteDescription()};c.getSignalingState=function(){return this.$5.signalingState};c.getIceGatheringState=function(){return this.$5.iceGatheringState};c.getIceConnectionState=function(){return this.$5.iceConnectionState};c.getSenders=function(){return i()===!1?[]:this.$5.getSenders()};c.getReceivers=function(){return o("getReceivers")===!1?[]:this.$5.getReceivers()};c.processUnifiedTrackIdTranslation=function(a,b){this.$11!=null&&a!=null&&b!=null&&this.$11.correlateWebrtcTrackIdsByMid(a,b)};c.getWebrtcTrackIdFromMWTrackId=function(a){return this.$11!=null?this.$11.getWebrtcTrackIdFromMWTrackId(a):a};c.getStats=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$5.getStats(a));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},null,this)};c.createDataChannel=function(a,b){if(this.$5.createDataChannel){a=this.$5.createDataChannel(a,b);this.$18(a);return a}return null};c.getDataChannelByLabel=function(a){return this.$3.find(function(b){return b.label===a})};c.getSdpMidMaps=function(){return{localSdpMap:this.$8,remoteSdpMap:this.$9}};c.getSdpSemantics=function(){return this.$10};c.supportsSimulcast=function(){return this.$12};c.getSsrcToSimulcastLayerMap=function(){return this.$13};return a}();var j=b("UserAgent").isBrowser("Chrome < 59")||b("UserAgent").isBrowser("Opera < 46")||b("UserAgent").isBrowser("Firefox < 37"),k=b("UserAgent").isBrowser("Chrome < 38")||b("UserAgent").isBrowser("Opera < 26");function l(a){var b=a.offerToReceiveAudio;b=b===void 0?!0:b;var c=a.offerToReceiveVideo;c=c===void 0?!0:c;a=babelHelpers.objectWithoutPropertiesLoose(a,["offerToReceiveAudio","offerToReceiveVideo"]);return k?Object.keys(a).length>0?{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c},optional:babelHelpers["extends"]({},p(a))}:{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c}}:babelHelpers["extends"]({offerToReceiveAudio:b,offerToReceiveVideo:c},a)}var m=b("UserAgent").isBrowser("Chrome < 51")||b("UserAgent").isBrowser("Opera < 38")||b("UserAgent").isBrowser("Firefox < 37");function n(a){a&&a.signalingState!=="closed"&&a.close()}function o(a){return typeof b("RTCPeerConnection").prototype[a]==="function"}function p(a){var b={},c=Object.keys(a);for(var d=0;d<c.length;d++){var e=c[d],f=""+e.substr(0,1).toUpperCase()+e.substr(1);b[f]=a[e]}return b}function q(a,c){if(b("FBRTCConfig").isVCEndpointCall())return!1;a=a.video&&a.video.match(/H264/);if(!a&&!c.preserveH264){a=b("FBRTCExperiment").gen("rtc_browser_use_h264");return a.getParam("allow_h264","no")!=="yes"}return!1}function r(a,c,d){d===void 0&&(d={});var e=c.audio,f=c.video,g=a.sdp;q(c,d)&&(g=b("ScotchFBRTCSdpUtils").removeH264(g));e&&(g=b("ScotchFBRTCSdpUtils").preferCodec(g,e,!1));f&&(g=b("ScotchFBRTCSdpUtils").preferCodec(g,f,!0));return{sdp:g,type:a.type}}e.exports=a}),null);
__d("FeatureToggle",["requireCond","cr:1619161"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1619161");e.exports=a}),null);
__d("GKURLHelper",[],(function(a,b,c,d,e,f){"use strict";e.exports={asGKMap:function(a){if(typeof a!=="object"||a==null)return null;var b={};for(var c in a){if(typeof a[c]!=="boolean")return null;b[c]=a[c]}return b},assignURL:function(a,b){var c=e.exports.fromURL(a),d=babelHelpers["extends"]({},c,b),f=[],g=[];Object.keys(d).forEach(function(a){d[a]?f.push(a):g.push(a)});a.searchParams.set("gk_debug","1");a.searchParams["delete"]("gk_enable");a.searchParams["delete"]("gk_disable");f.length>0&&a.searchParams.set("gk_enable",f.join(","));g.length>0&&a.searchParams.set("gk_disable",g.join(","))},clearURL:function(a){a.searchParams["delete"]("gk_debug"),a.searchParams["delete"]("gk_enable"),a.searchParams["delete"]("gk_disable")},fromURL:function(a){var b=a.searchParams.get("gk_disable");a=a.searchParams.get("gk_enable");var c={};b!==null&&b.split(",").forEach(function(a){c[a]=!1});a!==null&&a.split(",").forEach(function(a){c[a]=!0});return c}}}),null);
__d("useFeatureToggle",["FeatureToggle","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c;c=g.useState((c=b("FeatureToggle")==null?void 0:b("FeatureToggle").getFeatureValue(a))!=null?c:!1);var d=c[0],e=c[1];g.useEffect(function(){return b("FeatureToggle")==null?void 0:b("FeatureToggle").subscribe(a,function(a){e(a)}).remove},[a]);return d}}),null);
__d("ZenonEmployeeControlsDialog.react",["FDSText.react","FeatureToggle","GKURLHelper","PlatformType","React","SUIBusinessTheme","SUIButton.react","SUIModal.react","SUIModalHeader.react","SUIThemeContainer.react","ZenonCallsHooks","gkx","goURI","stylex","useFeatureToggle"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h=Math.min(window.innerWidth,564);function i(a){var c=new URL(window.location.href);a==null?b("GKURLHelper").clearURL(c):b("GKURLHelper").assignURL(c,a);b("goURI")(c.toString())}function j(a){var c;return g.jsxs("div",{className:"dncz0pse prklkq8o f87u49d9 foed1vyy",children:[g.jsx(b("FDSText.react"),{color:"placeholder",size:"header3",children:(c=a.title)!=null?c:"GK: "+a.id}),g.jsx(b("SUIButton.react"),{label:a.value?"Disable":"Enable",onClick:function(){var b;return i((b={},b[a.id]=!a.value,b))},use:a.value?"special":void 0})]})}function k(a){var c=a.featureName,d=b("useFeatureToggle")(c);return g.jsxs("div",{className:"dncz0pse prklkq8o f87u49d9 foed1vyy",children:[g.jsx(b("FDSText.react"),{color:"placeholder",size:"header3",children:"Feature: "+c}),g.jsx(b("SUIButton.react"),{label:d?"Disable":"Enable",onClick:function(){return b("FeatureToggle")==null?void 0:b("FeatureToggle").setFeatureStatus(c,!d)},use:d?"special":void 0})]})}function a(a){var c=b("ZenonCallsHooks").useGetPlatformType()===b("PlatformType").ZENON,d=b("ZenonCallsHooks").useEndCall();return g.jsx(b("SUIThemeContainer.react"),{theme:b("SUIBusinessTheme"),children:g.jsxs(b("SUIModal.react"),{footer:null,header:g.jsx(b("SUIModalHeader.react"),{title:"Employee Controls"}),isShown:!0,label:"Video and audio call settings",onHide:a.onHideDialog,shouldShowCloseButton:!0,width:h,children:[g.jsx(j,{id:"rtc_www_enable_darktheme",value:b("gkx")("1376351")}),g.jsx(k,{featureName:"Zenon Stats Overlay"}),g.jsx("hr",{}),g.jsxs("div",{className:"dncz0pse prklkq8o f87u49d9 foed1vyy",children:[g.jsx("span",{}),g.jsx(b("SUIButton.react"),{label:"Remove all GK Overrides",onClick:function(){return i(null)},use:"flat"})]}),g.jsxs("div",{className:"dncz0pse prklkq8o f87u49d9 foed1vyy",children:[g.jsx("span",{}),g.jsx(b("SUIButton.react"),{label:"Cause connection drop",onClick:function(){return d("ConnectionDropped","timeout")},use:"flat"})]}),g.jsxs("div",{className:"dncz0pse prklkq8o f87u49d9 foed1vyy",children:["Your call is using "+(c?"Zenon Platform":"Scotch"),"."]})]})})}e.exports=a}),null);
__d("ZenonChildQPLLogProcessor",["QPLUserFlow"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.processEvent=function(a){switch(a.name){case"callConnected":b("QPLUserFlow").addPoint(64232269,"call_connected");break;case"peerConnectionStateChanged":b("QPLUserFlow").addPoint(64232269,"peer_connection_state_changed");break;case"callEnded":b("QPLUserFlow").endSuccess(64232269);break;case"inviteSent":b("QPLUserFlow").addPoint(64232269,"invite_sent");break;case"inviteResponseReceived":b("QPLUserFlow").addPoint(64232269,"invite_response_received");break;case"inviteResponseProcessed":b("QPLUserFlow").addPoint(64232269,"invite_response_processed");break;case"mediaConnected":b("QPLUserFlow").addPoint(64232269,"media_connected");break;case"setRemoteSignalingID":b("QPLUserFlow").addPoint(64232269,"set_remote_signaling_id");break;case"startHeartbeat":b("QPLUserFlow").addPoint(64232269,"start_heartbeat");break;case"callJoinRequest":b("QPLUserFlow").start(64232269,{annotations:{bool:{isCaller:a.isCaller}}});break}};return a}();e.exports=a}),null);
__d("FeatureToggleImpl",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();a={_getFeatureStatus:function(a){var b=g.get(a)||{listeners:new Set(),status:null};g.set(a,b);return b},getFeatureValue:function(a){a=this._getFeatureStatus(a);return a==null?null:a.status},setFeatureStatus:function(a,b){a=this._getFeatureStatus(a);a.status=b;a.listeners.forEach(function(a){return a(b)})},subscribe:function(a,b){var c=this,d=this._getFeatureStatus(a);d.listeners.add(b);return{remove:function(){var d=c._getFeatureStatus(a);d.listeners["delete"](b)}}}};b=a;e.exports=b}),null);